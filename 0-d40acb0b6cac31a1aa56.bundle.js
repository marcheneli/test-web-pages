(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[0],{1467:function(e,t,n){"use strict";var o=n(10),r=n.n(o),i=n(7),c=n.n(i),a=n(8),u=n.n(a),s=n(6),l=n.n(s),f=n(11),p=n.n(f),h=n(2),d=(n(1601),function(e){function t(){return l()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.navigation,o=e.styles,r=e.className;return h.createElement("div",{ref:"content",className:"FullScreen"+(r?" "+r:""),style:o},h.createElement("div",{className:"FullScreen__top"},n),h.createElement("div",{className:"FullScreen__content"},t))}}]),t}(h.Component)),m=n(1474),v=n.n(m),b=n(190),g=n.n(b),y=n(24),_=n.n(y),O=n(863),w=n.n(O),j=n(13),k=n(0),R=(n(1603),n(3)),E=n(71),P=n(1592),T=n(14),S=n(325),I=n.n(S),x=n(19),N=n.n(x),C=n(386),A=function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},$=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e){function t(e){l()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={remainingReconnectionTime:new k.None,intervalId:new k.None},n}return u()(t,e),r()(t,[{key:"updateRemainingReconnectionTime",value:function(e){this.setState(R(this.state,{remainingReconnectionTime:{$set:this.getRemainingReconnectionTime(e)}}))}},{key:"startInterval",value:function(e){var t=this,n=setInterval(function(){t.updateRemainingReconnectionTime(e)},1e3);this.setState(R(this.state,{remainingReconnectionTime:{$set:this.getRemainingReconnectionTime(e)},intervalId:{$set:Object(k.toOption)(n)}}))}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=this;this.state.intervalId.foreach(function(t){clearInterval(t),e.setState(R(e.state,{remainingReconnectionTime:{$set:new k.None},intervalId:{$set:new k.None}}))})})},{key:"componentDidMount",value:function(){this.props.websocket.lastReconnectingTime.nonEmpty()&&this.startInterval(this.props),this.props.websocket.lastReconnectingTime.isEmpty()&&this.clearInterval()}},{key:"componentWillReceiveProps",value:function(e){this.props.websocket.lastReconnectingTime.isEmpty()&&e.websocket.lastReconnectingTime.nonEmpty()&&this.startInterval(e),this.props.websocket.lastReconnectingTime.nonEmpty()&&e.websocket.lastReconnectingTime.isEmpty()&&this.clearInterval()}},{key:"getRemainingReconnectionTime",value:function(e){return e.websocket.lastReconnectingTime.flatMap(function(t){return e.websocket.reconnectionTimeout.map(function(e){return(e-((new Date).getTime()-t))/1e3})})}},{key:"render",value:function(){var e=this;return h.createElement("div",null,this.props.websocket.reconnecting||this.state.remainingReconnectionTime.filter(function(e){return e<0}).nonEmpty()?this.props.i18n.t("Связь с сервером потеряна, идет восстановление соединения..."):this.props.i18n.t("Связь с сервером потеряна, до следующей попытки соединения")+this.state.remainingReconnectionTime.map(function(t){return" "+Math.round(t)+" "+e.props.i18n.t("сек.")}).getOrElse(function(){return""}))}}]),t}(h.Component);D=A([j.autobind,$("design:paramtypes",[Object])],D);var F=Object(T.connect)(function(e){return{websocket:e.websocket,i18n:e.i18n}})(D),L=function(e){function t(){return l()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"hideNotification",value:function(){this.props.dispatch(Object(E.f)())}},{key:"handleReconnect",value:function(){C.a.reconnect()}},{key:"render",value:function(){return h.createElement("div",null,h.createElement(I.a,{open:!this.props.active&&(this.props.websocketError.nonEmpty()||this.props.closed)&&!this.props.screenSnackbaropen,message:h.createElement(F,null),autoHideDuration:0,action:this.props.reconnecting?[]:[h.createElement(N.a,{key:"undo",color:"secondary",size:"small",onClick:this.handleReconnect},this.props.i18n.t("Подключиться"))]}))}}]),t}(h.Component);L=A([j.autobind],L);var K=Object(T.connect)(function(e){return{active:e.websocket.active,closed:e.websocket.closed,websocketError:e.websocket.error,reconnecting:e.websocket.reconnecting,screenSnackbaropen:e.screen.snackbar.open,i18n:e.i18n}})(L),J=n(1473),z=n.n(J),H=n(241),M=n.n(H),W=n(243),B=n.n(W),q=n(242),U=n.n(q),G=n(261),V=n.n(G),Q=function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},X=function(e){function t(){return l()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"handleDialogClose",value:function(e){this.props.dispatch(Object(E.e)(e))}},{key:"render",value:function(){var e=this;this.props.screen.dialog;return h.createElement(M.a,{fullScreen:this.props.fullScreen,fullWidth:!0,maxWidth:"md",open:this.props.screen.dialog.open,onClose:function(){return e.handleDialogClose(!1)},className:"Screen__dialog"},h.createElement(V.a,{style:{borderBottom:"none"}},this.props.screen.dialog.title.getOrElse(function(){return""})),h.createElement(U.a,null,this.props.screen.dialog.body.getOrElse(function(){return h.createElement("div",null)})),h.createElement(B.a,{style:{borderTop:"none"}},this.props.screen.dialog.actions))}}]),t}(h.Component);X=Q([j.autobind],X);var Y=Object(T.connect)(function(e){return{screen:e.screen}})(z()()(X)),Z=function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},ee=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},te=function e(t,n){l()(this,e),this.disabled=!1,this.disabled=n,this.label=t},ne=(function(e){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];l()(this,t);var r=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return r.actionType=-1,r.actionType=n,r}u()(t,e)}(te),function(e){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];l()(this,t);var r=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return r.execute=function(){},r.execute=n,r}u()(t,e)}(te),function(e){function t(e,n){l()(this,t);var o=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.state=n,o}return u()(t,e),r()(t,[{key:"handleDialogClose",value:function(e){this.props.dispatch(Object(E.e)(e))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments[4];this.props.dispatch(Object(E.g)({title:new k.Some(e),body:new k.Some(t),actions:n,onlyManualClose:o,options:r||new k.None}))}},{key:"scrollBottom",value:function(){window.document.body.scrollTop=window.document.body.scrollHeight}},{key:"scrollTop",value:function(){window.document.body.scrollTop=0}},{key:"renderNavigation",value:function(){throw"renderNavigation() should be defined in Screen implementation"}},{key:"closePopover",value:function(){this.setState(R(this.state,{popover:{$set:R(this.state.popover,{open:{$set:!1}})}}))}},{key:"openPopover",value:function(e,t){this.setState(R(this.state,{popover:{$set:{open:!0,actions:t,anchorElement:e}}}))}},{key:"onPopoverAction",value:function(e){this.closePopover(),e.execute()}},{key:"renderPopover",value:function(){var e=this;return this.state.popover.anchorElement.map(function(t){return h.createElement(g.a,{open:e.state.popover.open,anchorEl:t,anchorOrigin:{horizontal:"left",vertical:"bottom"},transformOrigin:{horizontal:"left",vertical:"top"},onClose:e.closePopover},h.createElement(w.a,null,e.state.popover.actions))})}},{key:"renderDrawer",value:function(){var e=this;return h.createElement(v.a,{open:this.state.drawer.open,onClose:function(t){return e.setState(R(e.state,{drawer:{open:{$set:t}}}))}},this.state.drawer.actions.map(function(e){return h.createElement(_.a,{onClick:e.execute},e.label)}))}},{key:"renderScreenBody",value:function(e,t){return h.createElement(d,Object.assign({},e,{navigation:h.createElement("div",null)}),h.createElement("div",{className:"Screen__container"},h.createElement(Y,null),this.renderPopover().getOrNull(),t,h.createElement(P.a,null),h.createElement(K,null)))}}],[{key:"screenInitialState",value:function(){return{popover:{anchorElement:new k.None,open:!1,actions:[]},drawer:{open:!1,actions:[]}}}}]),t}(h.PureComponent));ne=Z([j.autobind,ee("design:paramtypes",[Object,Object])],ne);t.a=ne},1469:function(e,t,n){"use strict";var o=n(17),r=n(1),i=n(6),c=n.n(i),a=n(7),u=n.n(a),s=n(8),l=n.n(s),f=n(18),p=function(e){function t(){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","GetOrganisationInfo",{}))}return l()(t,e),t}(f.a),h=function(e){function t(e){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","Check",{token:e}))}return l()(t,e),t}(f.a),d=(function(e){function t(e,n){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AppLogin",{apiKey:e,captcha:n}))}l()(t,e)}(f.a),function(e){function t(e,n){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","HashLinkLogin",{hash:e,captcha:n}))}l()(t,e)}(f.a),function(e){function t(e){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","TwoFactorVerificationCode",{code:e}))}return l()(t,e),t}(f.a)),m=function(e){function t(e,n,o,r,i){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","UserLogin",{username:e,password:n,terminal:o,organisationId:r,captcha:i}))}return l()(t,e),t}(f.a),v=function(e){function t(e,n,o,r){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AccountRegister",{name:e,email:n,password:o,captcha:r}))}return l()(t,e),t}(f.a),b=function(e){function t(e,n,o){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AccountLogin",{email:e,password:n,captcha:o}))}return l()(t,e),t}(f.a),g=function(e){function t(e,n,o){return c()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","EnrichedAccountLogin",{email:e,password:n,captcha:o}))}return l()(t,e),t}(f.a),y=n(257),_=n(69),O=n(79),w=n(547),j=(n(320),n(0),n(201),n(1511));n(111);n.d(t,"d",function(){return R}),n.d(t,"g",function(){return E}),n.d(t,"h",function(){return P}),n.d(t,"b",function(){return T}),n.d(t,"a",function(){return S}),n.d(t,"e",function(){return I}),n.d(t,"c",function(){return x}),n.d(t,"f",function(){return N});var k=function(e,t){switch(e.tpe.value){case r.UserInfo.$Type.value:t(Object(_.v)(e));break;case r.AccountInfo.$Type.value:t(Object(w.a)()).then(function(){t(Object(_.m)(e))});break;case r.AppInfo.$Type.value:t(Object(_.o)(e)),t(Object(j.b)(e));break;case r.TwoFactorCodeRequired.$Type.value:t(Object(_.t)()),t(Object(O.Lb)())}},R=function(e){return function(t){return new Promise(function(n,r){e||r(),t(Object(_.p)()),o.a.send(new h(e),function(e){return e}).then(function(e){k(e,t),n(e)}).catch(function(e){r(e)})})}},E=function(e){return function(t){return new Promise(function(n,r){e||r(),t(Object(_.p)()),o.a.send(new d(e),function(e){return e}).then(function(e){k(e,t),n(e)}).catch(function(e){r(e)})})}},P=function(e,t,n,r,i){return function(c){return c(Object(_.s)()),o.a.send(new m(e,t,n,r,i),function(e){return e}).then(function(e){return c(Object(_.u)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},T=function(e,t,n,r){return function(i){return i(Object(_.s)()),o.a.send(new v(e,t,n,r),function(e){return e}).then(function(e){return i(Object(_.l)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},S=function(e,t,n){return function(i){return i(Object(_.s)()),o.a.send(new b(e,t,n),function(e){return e}).then(function(e){return function(e,t){switch(e.tpe.value){case r.AccountInfo.$Type.value:t(Object(w.a)()).then(function(){t(Object(_.m)(e))});break;case r.TwoFactorCodeRequired.$Type.value:t(Object(_.t)()),t(Object(O.Lb)())}}(e,i),e}).catch(function(e){throw console.error(e.message,e),e})}},I=function(e,t,n){return function(r){return r(Object(_.s)()),o.a.send(new g(e,t,n),function(e){return e}).then(function(e){return r(Object(_.l)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},x=function(e,t){return function(n){return o.a.send(new y.b(e,t),function(e){return e}).then(function(e){return n(Object(_.u)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},N=function(){return o.a.send(new p,function(e){return e})}},1511:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s});var o=n(4),r=n.n(o),i=n(1),c=n(0),a=n(3),u=function(e){return function(t,n){if(e.appType instanceof i.ApplicationTypePrivateCabinet){var o=e.token,a=localStorage.getItem("platform5_embedded_user_tokens_map");Object(c.toOption)(a).matchWith(function(e){var t=JSON.parse(e);return n().appKey.appKey.map(function(e){return Object.assign(t,r()({},e,o))})},function(){return n().appKey.appKey.map(function(e){return r()({},e,o)})}).foreach(function(e){localStorage.setItem("platform5_embedded_user_tokens_map",JSON.stringify(e))})}}},s=function(){return function(e,t){var n=localStorage.getItem("platform5_embedded_user_tokens_map");Object(c.toOption)(n).map(function(e){var n=JSON.parse(e);return t().appKey.appKey.map(function(e){return a(n,{$unset:[e]})})}).foreach(function(e){localStorage.setItem("platform5_embedded_user_tokens_map",JSON.stringify(e))})}}},1592:function(e,t,n){"use strict";var o=n(6),r=n.n(o),i=n(10),c=n.n(i),a=n(7),u=n.n(a),s=n(8),l=n.n(s),f=n(11),p=n.n(f),h=n(2),d=n(14),m=n(13),v=n(325),b=n.n(v),g=n(71),y=function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},_=function(e){function t(){return r()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l()(t,e),c()(t,[{key:"hideNotification",value:function(){this.props.dispatch(Object(g.f)())}},{key:"render",value:function(){var e=this;return h.createElement(b.a,{open:this.props.screen.snackbar.open,autoHideDuration:4e3,onClose:function(){return e.hideNotification()},message:h.createElement("div",null,this.props.screen.snackbar.message)})}}]),t}(h.Component);_=y([m.autobind],_),t.a=Object(d.connect)(function(e){return{screen:e.screen}})(_)},1601:function(e,t,n){var o=n(1602);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(o,r);o.locals&&(e.exports=o.locals)},1602:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FullScreen {\n  height: 100%;\n  display: flex;\n  flex-direction: column; }\n\n.FullScreen__top {\n  width: 100%; }\n\n.FullScreen__content {\n  display: flex;\n  flex-direction: row;\n  flex: 1 1 auto;\n  min-height: 0; }\n",""])},1603:function(e,t,n){var o=n(1604);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(o,r);o.locals&&(e.exports=o.locals)},1604:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".Screen__container {\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 auto;\n  min-height: 0;\n  overflow: hidden;\n  background-color: #eeeded;\n  padding: 8px;\n  box-sizing: border-box; }\n\n.DefaultPage__paper {\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  width: 100%;\n  overflow: auto; }\n",""])}}]);