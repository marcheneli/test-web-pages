(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[65],{2688:function(e,t,n){var o=n(2689);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(o,r);o.locals&&(e.exports=o.locals)},2689:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".GeoMarker-container {\n  position: absolute; }\n\n.markerHolder:hover .GeoMarker-popover-container {\n  z-index: 1100; }\n\n.markerHolder:hover .GeoMarker-container {\n  z-index: 1100; }\n\n.GeoMarker-container:hover .GeoMarker-popover-container {\n  display: block; }\n\n.GeoMarker-container-selected .GeoMarker-popover-container {\n  z-index: 1100; }\n\n.GeoMarker-container-selected {\n  z-index: 1100; }\n\n.GeoMarker-container-selected .GeoMarker-popover-container {\n  display: block; }\n\n.GeoMarker-popover-container {\n  position: absolute;\n  display: none;\n  left: 50%;\n  transform: translate(-50%, 20px);\n  bottom: 100%;\n  padding-bottom: 24px; }\n",""])},2691:function(e,t,n){var o=n(2692);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(o,r);o.locals&&(e.exports=o.locals)},2692:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".pac-control {\n  margin-top: 10px;\n  border: 1px solid transparent;\n  border-radius: 2px 0 0 2px;\n  box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  height: 32px;\n  outline: none;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3); }\n\n.pac-input {\n  background-color: #fff;\n  font-family: Roboto;\n  font-size: 15px;\n  font-weight: 300;\n  margin-left: 12px;\n  padding: 0 11px 0 13px;\n  text-overflow: ellipsis;\n  max-width: 300px; }\n\n.pac-input:focus {\n  border-color: #4d90fe; }\n",""])},2730:function(e,t,n){"use strict";n.r(t);var o=n(6),r=n.n(o),a=n(10),i=n.n(a),l=n(7),s=n.n(l),u=n(8),c=n.n(u),p=n(2),d=n(14),f=n(1453),h=n(1452),g=n(1),m=n(215),k=n(0),v=n(82),b=n(2103),y=n.n(b),O=n(11),M=n.n(O),E=n(13),x=n(93),C=n.n(x),w=n(25),P=n.n(w),j=n(2690),I=n.n(j),S=(n(2688),function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":M()(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}),$=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),i()(t,[{key:"round",value:function(e){return parseFloat(e.toFixed(6))}},{key:"buttonRef",value:function(e){var t=this;Object(k.toOption)(e).foreach(function(e){e.addEventListener("click",function(e){e.stopImmediatePropagation(),t.props.onLocationSelect&&t.props.onLocationSelect(t.props.lat,t.props.lng)})})}},{key:"containerRef",value:function(e){var t=this;Object(k.toOption)(e).foreach(function(e){e.addEventListener("touchstart",function(e){e.stopImmediatePropagation(),t.props.onMarkerSelect(t.props.markerId)}),e.addEventListener("touchend",function(e){e.stopImmediatePropagation()}),e.addEventListener("click",function(e){e.stopImmediatePropagation()}),e.addEventListener("mouseleave",function(e){e.stopImmediatePropagation(),t.props.onMarkerUnselect(t.props.markerId)})})}},{key:"getContainerClass",value:function(){var e=this;return"GeoMarker-container "+this.props.selectedMarkerId.filter(function(t){return e.props.markerId===t}).map(function(e){return"GeoMarker-container-selected"}).getOrElse(function(){return""})}},{key:"render",value:function(){this.props.lat,this.props.lng;return p.createElement("div",{className:this.getContainerClass(),style:this.props.style,ref:this.containerRef},p.createElement("div",{className:"GeoMarker-popover-container"},p.createElement(C.a,{className:"GeoMarker-popover"},p.createElement("div",{style:{display:"flex",padding:"5px",alignItems:"center"}},p.createElement("div",{style:{flex:1}},p.createElement("div",null,this.props.label),p.createElement("div",null,this.round(this.props.lat),", ",this.round(this.props.lng))),this.props.onLocationSelect&&p.createElement("div",{style:{flex:0,flexShrink:0,marginLeft:"5px"}},p.createElement(P.a,{buttonRef:this.buttonRef},p.createElement(I.a,null)))))),this.props.icon)}}]),t}(p.Component),N=$=S([E.autobind],$),G=n(94),R=n.n(G),L=function(e){return p.createElement(R.a,Object.assign({},e),p.createElement("g",null,p.createElement("path",{d:"m12 0c-4.4183 2.3685e-15 -8 3.5817-8 8 0 1.421 0.3816 2.75 1.0312 3.906 0.1079 0.192 0.221 0.381 0.3438 0.563l6.625 11.531 6.625-11.531c0.102-0.151 0.19-0.311 0.281-0.469l0.063-0.094c0.649-1.156 1.031-2.485 1.031-3.906 0-4.4183-3.582-8-8-8zm0 4c2.209 0 4 1.7909 4 4 0 2.209-1.791 4-4 4-2.2091 0-4-1.791-4-4 0-2.2091 1.7909-4 4-4z",fill:"#e74c3c"}),p.createElement("path",{d:"m12 3c-2.7614 0-5 2.2386-5 5 0 2.761 2.2386 5 5 5 2.761 0 5-2.239 5-5 0-2.7614-2.239-5-5-5zm0 2c1.657 0 3 1.3431 3 3s-1.343 3-3 3-3-1.3431-3-3 1.343-3 3-3z",fill:"#c0392b"})))},_=n(59),D=n(3),U=n(173),B=function(e){function t(e){r()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={markerId:_.v4(),selectedMarkerId:new k.None},n}return c()(t,e),i()(t,[{key:"onMarkerSelect",value:function(e){this.setState(D(this.state,{selectedMarkerId:{$set:Object(k.toOption)(e)}}))}},{key:"onMarkerUnselect",value:function(e){this.setState(D(this.state,{selectedMarkerId:{$set:new k.None}}))}},{key:"render",value:function(){var e=this,t=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new g.ElementProportions});return this.props.value.map(function(n){return p.createElement("div",{style:{flex:t.width.map(function(e){return"auto"===e?"0 0 1":"0 0 "+e}).getOrElse(function(){return"0 0 auto"})}},p.createElement("div",{style:Object.assign({width:"100%",height:t.height.getOrElse(function(){return"200px"})},{zIndex:1e3})},n.lat&&n.lng&&p.createElement(y.a,{bootstrapURLKeys:{key:v.default.google_map_app_key,region:e.props.i18n.code,language:e.props.i18n.code},center:{lat:n.lat,lng:n.lng},defaultZoom:11},p.createElement(N,{lat:n.lat,lng:n.lng,label:Object(U.e)(e.props.display.label.text),markerId:e.state.markerId,selectedMarkerId:e.state.selectedMarkerId,onMarkerSelect:e.onMarkerSelect,onMarkerUnselect:e.onMarkerUnselect,key:"value",$markerHolderClassName:"markerHolder",style:{transform:"translate(-12px, -24px)"},icon:p.createElement(L,null)}))))}).getOrElse(function(){return p.createElement("div",null)})}}]),t}(p.Component),z=Object(d.connect)(function(e,t){return{i18n:e.i18n,value:Object(m.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e.tpe.value===g.ValueGeoPoint.$Type.value})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&e.i18n===t.i18n}})(B),V=n(26),H=n.n(V),T=n(160),W=n.n(T),q=n(267),F=n.n(q),A=n(2693),J=n.n(A),K=function(e){return p.createElement(R.a,Object.assign({},e),p.createElement("path",{fill:"#000000",d:"M2 12C2 6.48 6.48 2 12 2s10 4.48 10 10-4.48 10-10 10S2 17.52 2 12zm10 6c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6z"}))},Z=n(1454),X=n(105),Y=(n(2691),function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":M()(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i}),Q=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":M()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ee={lat:51.5074,lng:.1278},te=function(e){function t(e){r()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.searchBoxInput=new k.None;e.output;var o=e.value.filter(function(e){return e instanceof g.ValueGeoPoint}).map(function(e){return e});o.map(function(e){return e.lng}),o.map(function(e){return e.lat});return n.state={loading:o.isEmpty(),currentPositionMarker:new k.None,valuePositionMarker:o.map(function(e){return{position:{lat:e.lat,lng:e.lng},label:new k.None,id:_.v4()}}),mapCenterPosition:new k.None,markers:[],tripOrigin:new k.None,latMouseDiff:0,lngMouseDiff:0,isMapDraggable:!0,selectedMarkerId:new k.None},n}return c()(t,e),i()(t,[{key:"componentDidMount",value:function(){this.findCurrentPosition(this.props)}},{key:"findCurrentPosition",value:function(e){var t=this;Object(k.toOption)(navigator.geolocation).foreach(function(n){n.getCurrentPosition(function(n){t.setState(D(t.state,{loading:{$set:!1},currentPositionMarker:{$set:Object(k.toOption)({position:{lat:n.coords.latitude,lng:n.coords.longitude},label:new k.None,id:_.v4()})},mapCenterPosition:{$set:Object(k.toOption)(e.value.filter(function(e){return e instanceof g.ValueGeoPoint}).map(function(e){return e}).matchWith(function(e){return{position:{lat:e.lat,lng:e.lng},label:new k.None,id:_.v4()}},function(){return{position:{lat:n.coords.latitude,lng:n.coords.longitude},label:new k.None,id:_.v4()}}))}}))},function(e){t.setState(D(t.state,{loading:{$set:!1},currentPositionMarker:{$set:Object(k.toOption)({position:ee,label:new k.None,id:_.v4()})},mapCenterPosition:{$set:Object(k.toOption)({position:ee,label:new k.None,id:_.v4()})}}))})})}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(!Object(k.isEqual)(e.value,this.props.value)){e.output;var n=e.value.filter(function(e){return e instanceof g.ValueGeoPoint}).map(function(e){return e}),o=(n.map(function(e){return e.lng}),n.map(function(e){return e.lat}),_.v4());this.setState(D(this.state,{loading:{$set:!1},tripOrigin:{$set:new k.None},markers:{$set:[]},mapCenterPosition:{$set:n.matchWith(function(e){return Object(k.toOption)({position:{lat:e.lat,lng:e.lng},label:new k.None,id:_.v4()})},function(){return t.state.mapCenterPosition})},valuePositionMarker:{$set:n.matchWith(function(e){return Object(k.toOption)({position:{lat:e.lat,lng:e.lng},label:new k.None,id:o})},function(){return t.state.valuePositionMarker})},selectedMarkerId:{$set:Object(k.toOption)(o)}}))}}},{key:"onLongitudeChanged",value:function(e){var t=parseFloat(e.target.value);isNaN(t)||this.props.onChange(this.props.value.filter(function(e){return e instanceof g.ValueGeoPoint}).map(function(e){return e.updateLongitude(t)}).getOrElse(function(){return new g.ValueGeoPoint(t,0)}),this.props.output)}},{key:"onLatitudeChanged",value:function(e){var t=parseFloat(e.target.value);isNaN(t)||this.props.onChange(this.props.value.filter(function(e){return e instanceof g.ValueGeoPoint}).map(function(e){return e.updateLatitude(t)}).getOrElse(function(){return new g.ValueGeoPoint(t,0)}),this.props.output)}},{key:"onMarkerMouseDown",value:function(e,t,n){var o=this;this.state.valuePositionMarker.map(function(e){return e.id!==t.markerId}).getOrElse(function(){return!0})||this.state.valuePositionMarker.foreach(function(e){o.setState(D(o.state,{isMapDraggable:{$set:!1},latMouseDiff:{$set:e.position.lat-n.lat},lngMouseDiff:{$set:e.position.lng-n.lng}}))})}},{key:"onMarkerMouseMove",value:function(e,t,n){var o=this;this.state.isMapDraggable||this.setState(D(this.state,{valuePositionMarker:{$set:this.state.valuePositionMarker.matchWith(function(e){return Object(k.toOption)({position:{lat:n.lat+o.state.latMouseDiff,lng:n.lng+o.state.lngMouseDiff},label:new k.None,id:e.id})},function(){return Object(k.toOption)({position:{lat:n.lat+o.state.latMouseDiff,lng:n.lng+o.state.lngMouseDiff},label:new k.None,id:_.v4()})})}}))}},{key:"onMarkerMouseUp",value:function(e,t,n){var o=this;this.state.isMapDraggable||Object(k.toOption)(n.lat).flatMap(function(e){return Object(k.toOption)(n.lng).map(function(t){return{lat:e,lng:t}})}).matchWith(function(e){o.setState(D(o.state,{valuePositionMarker:{$set:Object(k.toOption)({position:{lat:e.lat,lng:e.lng},label:new k.None,id:_.v4()})},isMapDraggable:{$set:!0}}),function(){o.props.onChange(new g.ValueGeoPoint(e.lat,e.lng),o.props.output)})},function(){o.setState(D(o.state,{valuePositionMarker:{$set:o.props.value.filter(function(e){return e instanceof g.ValueGeoPoint}).map(function(e){return e}).map(function(e){return{position:{lat:e.lat,lng:e.lng},label:new k.None,id:_.v4()}})},isMapDraggable:{$set:!0}}))})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"round",value:function(e){return parseFloat(e.toFixed(6))}},{key:"onChangeLocationClick",value:function(e,t){this.searchBoxInput.foreach(function(e){e.value=""}),this.props.onChange(new g.ValueGeoPoint(e,t),this.props.output)}},{key:"onClick",value:function(e){var t=e.lat,n=e.lng,o=e.event.pageX,r=e.event.pageY;this.showTripOrigin(t,n,r-20,o)}},{key:"showTripOrigin",value:function(e,t,n,o){var r=_.v4();this.setState(D(this.state,{tripOrigin:{$set:Object(k.toOption)({position:{lat:e,lng:t},label:new k.None,id:r})},selectedMarkerId:{$set:Object(k.toOption)(r)}}))}},{key:"onMarkerSelect",value:function(e){this.setState(D(this.state,{selectedMarkerId:{$set:Object(k.toOption)(e)}}))}},{key:"onMarkerUnselect",value:function(e){this.setState(D(this.state,{selectedMarkerId:{$set:new k.None}}))}},{key:"onGoogleApiLoaded",value:function(e){var t=this,n=e.map,o=e.maps,r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("class","pac-input pac-control"),r.addEventListener("click",function(e){e.stopPropagation()}),r.style.setProperty("width",n.getDiv().getBoundingClientRect().width-126-45-20+"px");var a=new o.places.SearchBox(r);n.controls[o.ControlPosition.TOP_LEFT].push(r),this.searchBoxInput=Object(k.toOption)(r),n.addListener("bounds_changed",function(){r.style.setProperty("width",n.getDiv().getBoundingClientRect().width-126-45-20+"px"),a.setBounds(n.getBounds())}),a.addListener("places_changed",function(){var e=a.getPlaces();t.setState(D(t.state,{markers:{$set:e.map(function(e){return{label:Object(k.toOption)(e.name),position:{lat:e.geometry.location.lat(),lng:e.geometry.location.lng()},id:_.v4()}})},mapCenterPosition:{$set:Object(k.headOption)(e).matchWith(function(e){return Object(k.toOption)({position:{lat:e.geometry.location.lat(),lng:e.geometry.location.lng()},label:new k.None,id:_.v4()})},function(){return t.state.mapCenterPosition})}}))})}},{key:"render",value:function(){var e=this,t=this.props.display,n=(this.props.output,this.props.value.filter(function(e){return e instanceof g.ValueGeoPoint}).map(function(e){return e})),o=this.props.error,r=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new g.ElementProportions});return p.createElement("div",{style:{flex:r.width.map(function(e){return"auto"===e?"0 0 1":"0 0 "+e}).getOrElse(function(){return"0 0 auto"})}},Object(U.c)(this.props.display.label.text),p.createElement("div",{style:Object.assign({width:"100%",height:r.height.getOrElse(function(){return"200px"})},{zIndex:1e3})},this.state.loading?p.createElement(W.a,null):p.createElement(y.a,{bootstrapURLKeys:{key:v.default.google_map_app_key,region:this.props.i18n.code,language:this.props.i18n.code,libraries:["places"]},center:this.state.mapCenterPosition.map(function(e){return e.position}).getOrElse(function(){return ee}),defaultZoom:11,options:{mapTypeControl:!0},onGoogleApiLoaded:this.onGoogleApiLoaded,draggable:this.state.isMapDraggable,onClick:this.onClick,onChildMouseDown:this.onMarkerMouseDown,onChildMouseMove:this.onMarkerMouseMove,onChildMouseUp:this.onMarkerMouseUp,yesIWantToUseGoogleMapApiInternals:!0},this.state.tripOrigin.matchWith(function(t){return p.createElement(N,{lat:t.position.lat,lng:t.position.lng,key:"trip-origin",markerId:t.id,selectedMarkerId:e.state.selectedMarkerId,onMarkerSelect:e.onMarkerSelect,onMarkerUnselect:e.onMarkerUnselect,$markerHolderClassName:"markerHolder",style:{transform:"translate(-12px, -12px)"},onLocationSelect:e.onChangeLocationClick,icon:p.createElement(K,null)})},function(){return null}),this.state.currentPositionMarker.matchWith(function(t){return p.createElement(N,{lat:t.position.lat,lng:t.position.lng,key:"current",markerId:t.id,selectedMarkerId:e.state.selectedMarkerId,onMarkerSelect:e.onMarkerSelect,onMarkerUnselect:e.onMarkerUnselect,$markerHolderClassName:"markerHolder",style:{transform:"translate(-12px, -12px)"},label:e.props.i18n.t("Текущее местоположение"),onLocationSelect:e.onChangeLocationClick,icon:p.createElement(J.a,null)})},function(){return null}),this.state.markers.map(function(t,n){return p.createElement(N,{key:n,lat:t.position.lat,lng:t.position.lng,label:t.label.getOrElse(function(){return""}),markerId:t.id,selectedMarkerId:e.state.selectedMarkerId,onMarkerSelect:e.onMarkerSelect,onMarkerUnselect:e.onMarkerUnselect,$markerHolderClassName:"markerHolder",style:{transform:"translate(-12px, -12px)"},onLocationSelect:e.onChangeLocationClick,icon:p.createElement(F.a,null)})}),this.state.valuePositionMarker.matchWith(function(n){return p.createElement(N,{lat:n.position.lat,lng:n.position.lng,label:Object(U.e)(t.label.text),key:"value",markerId:n.id,selectedMarkerId:e.state.selectedMarkerId,onMarkerSelect:e.onMarkerSelect,onMarkerUnselect:e.onMarkerUnselect,$markerHolderClassName:"markerHolder",style:{transform:"translate(-12px, -24px)"},icon:p.createElement(L,null)})},function(){return null}))),this.props.control.showCoordFields&&p.createElement("div",{style:{display:"flex"}},p.createElement(H.a,{label:this.props.i18n.t("Широта"),onChange:this.onLatitudeChanged,placeholder:this.props.i18n.t("Широта"),value:n.map(function(e){return e.lat.toString()}).getOrElse(function(){return""}),style:{flex:1,marginRight:"5px"},disabled:n.map(function(e){return e.tpe.value===g.ValueGenerated.$Type.value}).getOrElse(function(){return!1}),error:o.nonEmpty(),onBlur:this.onBlur}),p.createElement(H.a,{label:this.props.i18n.t("Долгота"),onChange:this.onLongitudeChanged,placeholder:this.props.i18n.t("Долгота"),value:n.map(function(e){return e.lng.toString()}).getOrElse(function(){return""}),style:{flex:1,marginLeft:"5px"},disabled:n.map(function(e){return e.tpe.value===g.ValueGenerated.$Type.value}).getOrElse(function(){return!1}),error:o.nonEmpty(),onBlur:this.onBlur})),p.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}}]),t}(p.Component);te=Y([E.autobind,Q("design:paramtypes",[Object])],te);var ne=Object(d.connect)(function(e,t){return{value:Object(m.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}),error:Object(m.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Object(X.a)(te)),oe=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),i()(t,[{key:"renderDisplayControl",value:function(){return p.createElement(h.a,{display:this.props.display,blockStyle:this.props.blockStyle},p.createElement(z,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return p.createElement(ne,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return p.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(f.a);t.default=Object(d.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(oe)}}]);