(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[13],{1459:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c});var a=n(79),i=n(104),r=n(82),o=function(){return function(e,t){return e(r.default.isA5000?Object(a.Mb)():Object(a.h)())}},c=function(e,t){return function(n,r){return r().eventLine.data.foreach(function(o){Object(i.e)(r().forms,e).foreach(function(i){n(Object(a.H)(o.id,i.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var a=n(6),i=n.n(a),r=n(10),o=n.n(r),c=n(7),l=n.n(c),u=n(8),s=n.n(u),f=n(2),p=n(14),h=n(1469),d=n(1459),m=n(320),g=n(69),y=n(0),v=n(624);t.a=function(e){return Object(p.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return i()(this,n),l()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s()(n,t),o()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(y.toOption)(this.props.routing.location).map(function(t){Object(y.liftKey)(Object(v.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(h.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(h.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(h.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(g.r)()),this.props.dispatch(Object(m.c)()),this.props.dispatch(Object(d.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?f.createElement(e,this.props):f.createElement("div",null)}}]),n}(f.Component)}(e))}},1490:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),r=(0,a(n(44)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M2 12.5C2 9.46 4.46 7 7.5 7H18c2.21 0 4 1.79 4 4s-1.79 4-4 4H9.5C8.12 15 7 13.88 7 12.5S8.12 10 9.5 10H17v2H9.41c-.55 0-.55 1 0 1H18c1.1 0 2-.9 2-2s-.9-2-2-2H7.5C5.57 9 4 10.57 4 12.5S5.57 16 7.5 16H17v2H7.5C4.46 18 2 15.54 2 12.5z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"})),"Attachment");t.default=r},1500:function(e,t,n){"use strict";var a=n(6),i=n.n(a),r=n(10),o=n.n(r),c=n(7),l=n.n(c),u=n(8),s=n.n(u),f=n(11),p=n.n(f),h=n(2),d=n(14),m=n(95),g=n(13),y=n(26),v=n.n(y),b=n(32),E=n.n(b),O=n(34),S=n.n(O),k=n(30),j=n.n(k),C=n(25),w=n.n(C),x=n(1490),P=n.n(x),R=n(1),D=n(3),T=n(1472),_=n.n(T),M=n(538),I=n.n(M),B=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},F=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),o()(t,[{key:"onDeleteClick",value:function(){this.props.onRemove(this.props.idx)}},{key:"render",value:function(){return h.createElement(_.a,{style:{marginRight:"5px"},label:this.props.name,avatar:h.createElement(I.a,null,h.createElement(P.a,null)),onDelete:this.onDeleteClick})}}]),t}(h.Component);F=B([g.autobind],F);var $=Object(d.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(F),A=n(0),H=n(99),L=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},z=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},V=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={files:[]},n}return s()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(H.d)(this.props.attachments.map(function(e){return e.fileId})))}},{key:"onAddFileButtonClick",value:function(){this.fileUpload(this.fileChanged)}},{key:"fileUpload",value:function(e){this.fileInput.foreach(function(e){return e.click()})}},{key:"onRemove",value:function(e){this.props.onChange(D(this.props.attachments,{$splice:[[e,1]]}))}},{key:"fileChanged",value:function(e){var t=this,n=e.target.files[0];Object(H.h)(n,this.props.cdnAddress,this.props.auth.token,this.props.organisation.organisationId,this.props.eventLine.eventLineId,new A.None,new A.Some(new R.FileTypeMailAttach),"true").then(function(e){Object(H.b)(e).then(function(e){t.setState(D(t.state,{files:{$push:[e.record]}}))}),t.props.onChange(D(t.props.attachments,{$push:[new R.AttachmentFileAttachment(e)]}))}).catch(function(e){console.error("File uploaded with error",e)})}},{key:"fileInputHandler",value:function(e){this.fileInput=Object(A.toOption)(e)}},{key:"render",value:function(){var e=this;return h.createElement("div",null,h.createElement("input",{ref:this.fileInputHandler,type:"file",onChange:this.fileChanged,style:{display:"none"}}),h.createElement("div",null,this.state.files.map(function(t,n){return h.createElement($,{key:n,idx:n,name:t.entity.originalName,onRemove:e.onRemove})})),h.createElement("div",null,h.createElement(w.a,{onClick:this.onAddFileButtonClick,style:{marginRight:"10px"}},h.createElement(P.a,null))))}}]),t}(h.Component);V=L([g.autobind,z("design:paramtypes",[Object])],V);var N=Object(d.connect)(function(e,t){return{i18n:e.i18n,cdnAddress:e.config.cdnAddress,auth:e.auth,organisation:e.organisation,eventLine:e.eventLine}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.config.cdnAddress===t.config.cdnAddress},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.cdnAddress===t.cdnAddress}})(V),W=n(16),q=n(424),U=n(245),K=n(246),Y=n(247),J=n(266),G=n(292),Q=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},X=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Z=new W.CompositeDecorator([{strategy:U.b,component:U.a},{strategy:K.b,component:K.a},{strategy:Y.b,component:Y.a}]),ee=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=Object(J.a)(n.props.html,Z,[],[],[],n.props.i18n.t);W.EditorState.moveSelectionToEnd(a);return n.state={editorState:a,htmlBody:n.props.html,showHtml:!1},n}return s()(t,e),o()(t,[{key:"onEditorStateChange",value:function(e){var t=this;this.setState(D(this.state,{editorState:{$set:e}}),function(){setTimeout(function(){t.state.editorState===e&&t.props.onChange(Object(G.a)(Object(W.convertToRaw)(e.getCurrentContent())))},200)})}},{key:"onShowHTMLChange",value:function(e){this.setState(D(this.state,{showHtml:{$set:e}}))}},{key:"onHtmlChange",value:function(e){var t=this;this.setState(D(this.state,{htmlBody:{$set:e}}),function(){t.props.onChange(e)})}},{key:"render",value:function(){return h.createElement(q.a,{showInsertionButtons:!1,formId:new A.None,organisationId:this.props.organisationId,html:this.state.htmlBody,showHtml:this.state.showHtml,editorState:this.state.editorState,onChange:this.onEditorStateChange,onShowHTMLChange:this.onShowHTMLChange,onHtmlChange:this.onHtmlChange,fields:[],insertions:[],attachments:[],urlLinks:[],onAttachmentsChange:function(){},onInsertionsChange:function(){},onUrlLinksChange:function(){}})}}]),t}(h.Component);ee=Q([g.autobind,X("design:paramtypes",[Object])],ee);var te=Object(d.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(ee),ne=n(136),ae=n(648);n.d(t,"a",function(){return re});var ie=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},re="EmailDataObjectReplyForm",oe=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),o()(t,[{key:"renderMailBoxSelect",value:function(){return h.createElement(E.a,{fullWidth:!0},h.createElement(S.a,null,this.props.i18n.t("Ящик отправки")),h.createElement(j.a,{native:!0,value:this.props.fields.mailBoxId.value,onChange:this.props.fields.mailBoxId.onChange},h.createElement("option",{value:""}),this.props.mailBoxConfigs.list.map(function(e){return h.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)})))}},{key:"render",value:function(){var e=this.props,t=e.fields,n=t.subject,a=t.replyTo,i=t.attachments,r=(t.body,t.html),o=t.cc,c=t.bcc,l=e.handleSubmit;return h.createElement("form",{style:{width:"100%"},onSubmit:l},this.props.showMailBoxSelector&&this.renderMailBoxSelect(),h.createElement(v.a,{value:a.value,onChange:a.onChange,fullWidth:!0,label:this.props.i18n.t("Кому")}),h.createElement(v.a,{value:o.value,onChange:o.onChange,fullWidth:!0,label:this.props.i18n.t("Сс")}),h.createElement(v.a,{value:c.value,onChange:c.onChange,fullWidth:!0,label:this.props.i18n.t("Bcc")}),h.createElement(v.a,{value:n.value,onChange:n.onChange,fullWidth:!0,label:this.props.i18n.t("Тема")}),h.createElement(te,{html:r.value||"<div></div>",onChange:r.onChange,organisationId:this.props.organisationId}),h.createElement(N,{attachments:i.value||[],onChange:i.onChange}))}}]),t}(h.Component);oe=ie([g.autobind],oe);t.b=Object(d.connect)(function(e){return{i18n:e.i18n,mailBoxConfigs:e.mailBoxConfigs,eventLineId:e.eventLine.eventLineId}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:re,fields:["subject","mailBoxId","emailId","attachments","replyTo","html","body","cc","bcc"],validate:function(e,t){return{}}})(Object(ne.a)(function(e){e.isTokenChecked&&e.eventLineId.foreach(function(t){e.dispatch(Object(ae.a)(t))})})(oe)))},1519:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),r=(0,a(n(44)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Autorenew");t.default=r},1526:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var a=n(381),i=n(637),r=function(e,t,n,r){return function(o,c){return o(Object(a.f)()),i.h(e,t,n,r).then(function(e){return o(Object(a.g)({total:e.page.total,list:e.page.records})),e}).catch(function(e){throw o(Object(a.e)(e)),e})}},o=function(e,t,n,r){return function(o,c){return o(Object(a.f)()),i.g(e,t,n,r).then(function(e){return o(Object(a.g)({total:e.page.total,list:e.page.records})),e}).catch(function(e){throw o(Object(a.e)(e)),e})}}},1527:function(e,t,n){"use strict";var a=n(6),i=n.n(a),r=n(10),o=n.n(r),c=n(7),l=n.n(c),u=n(8),s=n.n(u),f=n(11),p=n.n(f),h=n(2),d=n(14),m=n(13),g=n(3),y=n(26),v=n.n(y),b=n(162),E=n.n(b),O=n(24),S=n.n(O),k=n(1593),j=n.n(k),C=n(1594),w=n.n(C),x=n(1528),P=n.n(x),R=n(262),D=n(0),T=n(1),_=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},M=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={searchValue:new D.None,searchField:Object(D.toOption)(new T.EmailFieldTypeHtmlText)},n}return s()(t,e),o()(t,[{key:"onSearchFormSubmit",value:function(){var e=this;this.props.onSearch(this.state.searchField.flatMap(function(t){return e.state.searchValue.map(function(e){return new T.EmailFilterExpressionFullTextSearch(e,t)})}))}},{key:"openDataSourceMenu",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[h.createElement(S.a,{key:"byHtmlText",onClick:function(){return t.onSearchFieldChange(new T.EmailFieldTypeHtmlText)}},this.props.i18n.t("Html письма")),h.createElement(S.a,{key:"byPlainText",onClick:function(){return t.onSearchFieldChange(new T.EmailFieldTypePlainText)}},this.props.i18n.t("Текст письма")),h.createElement(S.a,{key:"bySubject",onClick:function(){return t.onSearchFieldChange(new T.EmailFieldTypeSubject)}},this.props.i18n.t("Тема письма"))])}},{key:"onSearchValueChange",value:function(e){this.setState(g(this.state,{searchValue:{$set:Object(D.toOption)(e.target.value).filter(function(e){return""!==e})}}))}},{key:"onSearchFieldChange",value:function(e){var t=this;this.setState(g(this.state,{searchField:{$set:Object(D.toOption)(e)}}),function(){t.props.closeMenu()})}},{key:"onSearchValueClear",value:function(){var e=this;this.setState(g(this.state,{searchValue:{$set:new D.None}}),function(){e.props.onSearch(new D.None)})}},{key:"getPlaceholder",value:function(){var e=this;return this.state.searchField.matchWith(function(t){switch(t.tpe.value){case T.EmailFieldTypeHtmlText.$Type.value:return e.props.i18n.t("html");case T.EmailFieldTypePlainText.$Type.value:return e.props.i18n.t("текст");case T.EmailFieldTypeSubject.$Type.value:return e.props.i18n.t("тема");default:throw"unknown email field type"}},function(){return""})}},{key:"render",value:function(){return h.createElement("form",{onSubmit:this.onSearchFormSubmit,style:{display:"flex",flex:1,flexWrap:"nowrap"}},h.createElement(v.a,{fullWidth:!0,style:{marginRight:28,marginTop:0,marginBottom:0},variant:"outlined",value:this.state.searchValue.getOrElse(function(){return""}),placeholder:this.getPlaceholder(),onChange:this.onSearchValueChange,InputProps:{startAdornment:h.createElement(E.a,{position:"start"},h.createElement(P.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.openDataSourceMenu})),endAdornment:h.createElement(E.a,{position:"end"},h.createElement(j.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.onSearchFormSubmit}),this.state.searchValue.nonEmpty()&&h.createElement(w.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.onSearchValueClear}))}}))}}]),t}(h.Component);I=_([m.autobind,M("design:paramtypes",[Object])],I),t.a=Object(d.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(R.a)(I))},1532:function(e,t,n){"use strict";var a,i=n(10),r=n.n(i),o=n(7),c=n.n(o),l=n(8),u=n.n(l),s=n(6),f=n.n(s),p=n(4),h=n.n(p),d=n(11),m=n.n(d),g=n(2),y=n(14),v=n(13),b=n(220),E=n.n(b),O=n(1472),S=n.n(O),k=n(538),j=n.n(k),C=n(1490),w=n.n(C),x=n(1),P=n(0),R=n(623),D=n(3),T=n(25),_=n.n(T),M=n(1610),I=n.n(M),B=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},F=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$=function(e){function t(e){f()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!1},n}return u()(t,e),r()(t,[{key:"onShowToggle",value:function(){this.setState(D(this.state,{show:{$set:!this.state.show}}))}},{key:"render",value:function(){return g.createElement("div",null,g.createElement(_.a,{onClick:this.onShowToggle},g.createElement(I.a,null)),this.state.show&&g.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.text}}))}}]),t}(g.Component),A=$=B([v.autobind,F("design:paramtypes",[Object])],$),H=n(56),L=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},z=(a={},h()(a,x.MessageAttachmentFile.$Type.value,function(e,t){return g.createElement(S.a,{key:e.fileId.value,style:{marginRight:"5px"},label:e.name,avatar:g.createElement(j.a,null,g.createElement(w.a,null)),onClick:function(n){return t.onSaveFileClick(e.fileId)}})}),h()(a,x.MessageAttachmentLink.$Type.value,function(e,t){return g.createElement(S.a,{key:e.attachId,style:{marginRight:"5px"},label:e.name,avatar:g.createElement(j.a,null,g.createElement(w.a,null)),onClick:function(n){return t.onSaveAttachLinkClick(e.attachId)}})}),a),V=function e(){f()(this,e)},N=function(e){function t(e){f()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.text=e,n}return u()(t,e),t}(V),W=function(e){function t(e){f()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.text=e,n}return u()(t,e),t}(V),q=function(e){function t(){return f()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"onSaveFileClick",value:function(e){var t=this;this.props.authToken.map(function(n){return Object(R.b)(e,n,t.props.cdnAddress)})}},{key:"onSaveAttachLinkClick",value:function(e){var t=this;this.props.authToken.foreach(function(n){return Object(R.a)(t.props.email.id.value,e,n,t.props.serverAddress)})}},{key:"getEmailSections",value:function(e){var t=e.indexOf("<blockquote"),n=e.lastIndexOf("</blockquote>")+"</blockquote>".length;return[new N(t>0?e.substring(0,t):e.substring(0))].concat(t<0||n<0?[]:[new W(e.substring(t,n))]).concat(t<0||n<0||n+1===e.length?[]:[new N(e.substring(n))])}},{key:"onEmailSectionClick",value:function(e){e.nativeEvent.preventDefault(),e.nativeEvent.stopImmediatePropagation(),Object(P.toOption)(e.nativeEvent.target.getAttribute("href")).foreach(function(e){window.open(e,"_blank")})}},{key:"renderEmailSection",value:function(e,t){if(e instanceof N)return g.createElement("div",{key:t,contentEditable:this.props.email.entity.meta.emailStatus.tpe.value===x.EmailStatusDraft.$Type.value,onClick:this.onEmailSectionClick,dangerouslySetInnerHTML:{__html:e.text}});if(e instanceof W)return g.createElement(A,{key:t,text:e.text});throw"Unknown section type"}},{key:"renderEmail",value:function(e){var t=this;return this.getEmailSections(e).map(function(e,n){return t.renderEmailSection(e,n)})}},{key:"renderAttachmentComponent",value:function(e){var t=this;return Object(H.b)(e.tpe.value)(z).matchWith(function(n){return n(e,t)},function(){throw"uknown attachment type"})}},{key:"render",value:function(){var e=this,t=this.props.email.entity.msgBody,n=t.attachments;return g.createElement("div",{style:{display:"flex",flex:1,flexDirection:"column"}},g.createElement("div",{style:{display:"flex",flexShrink:0,marginBottom:"10px"}},g.createElement("div",{style:{flexShrink:0}},g.createElement("span",{style:{fontWeight:600,fontSize:"16px"}},t.from.name),g.createElement("span",null," <"+t.from.email+">")),g.createElement("div",{style:{display:"flex",flex:1,justifyContent:"flex-end"}},new Date(this.props.email.entity.created).toLocaleString())),g.createElement("div",{style:{overflow:"auto"}},this.renderEmail(t.html.text)),n.length>0&&g.createElement("div",{style:{marginTop:"10px",flexShrink:0}},g.createElement(E.a,null),g.createElement("div",{style:{marginTop:"10px"}},n.map(function(t,n){return e.renderAttachmentComponent(t)}))))}}]),t}(g.Component);q=L([v.autobind],q);t.a=Object(y.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,cdnAddress:e.config.cdnAddress,serverAddress:e.config.serverAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(q)},1591:function(e,t,n){"use strict";var a=n(17),i=n(6),r=n.n(i),o=n(7),c=n.n(o),l=n(8),u=n.n(l),s=n(18),f=function(e){function t(e){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Request",{id:e}))}return u()(t,e),t}(s.a),p=(function(e){function t(e){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","List",{orgId:e}))}u()(t,e)}(s.a),function(e){function t(e){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","ListDescriptions",{orgId:e}))}return u()(t,e),t}(s.a)),h=function(e){function t(e){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Create",{page:e}))}return u()(t,e),t}(s.a),d=function(e){function t(e){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Update",{page:e}))}return u()(t,e),t}(s.a),m=function(e){function t(e){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Delete",{id:e}))}return u()(t,e),t}(s.a),g=(n(296),n(449)),y=n(21);n.d(t,"a",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return E}),n.d(t,"d",function(){return O}),n.d(t,"c",function(){return S});var v=function(e){return a.a.send(new h(e),Object(y.f)())},b=function(e){return a.a.send(new d(e),Object(y.f)())},E=function(e){return a.a.send(new m(e),Object(y.f)())},O=function(e){return function(t){return t(Object(g.e)()),a.a.send(new f(e),Object(y.e)()).then(function(e){return t(Object(g.f)(e.record)),e}).catch(function(e){throw t(Object(g.d)(e)),e})}},S=function(e){return a.a.send(new p(e),function(e){return e})}},1593:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),r=(0,a(n(44)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Search");t.default=r},1595:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c});var a=n(296),i=n(1591),r=n(87),o=function(e){return function(t,n){return t(Object(a.h)()),i.c(e).then(function(e){return t(Object(a.i)(e)),e}).catch(function(e){throw t(Object(a.g)(e)),e})}},c=function(e){return function(t){return t(Object(r.b)(function(e){return!e.webPages.descriptionsFetching&&e.webPages.descriptionsFetching},o(e)))}}},1610:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),r=(0,a(n(44)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),i.default.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),"MoreHoriz");t.default=r},1624:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),r=(0,a(n(44)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Markunread");t.default=r},1625:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),r=(0,a(n(44)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{d:"M21.99 8c0-.72-.37-1.35-.94-1.7L12 1 2.95 6.3C2.38 6.65 2 7.28 2 8v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2l-.01-10zM12 13L3.74 7.84 12 3l8.26 4.84L12 13z"}),i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Drafts");t.default=r},1626:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),r=(0,a(n(44)).default)(i.default.createElement(i.default.Fragment,null,i.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),i.default.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})),"Visibility");t.default=r},2058:function(e,t,n){"use strict";var a=n(6),i=n.n(a),r=n(10),o=n.n(r),c=n(7),l=n.n(c),u=n(8),s=n.n(u),f=n(11),p=n.n(f),h=n(2),d=n(14),m=n(13),g=n(3),y=n(62),v=n.n(y),b=n(93),E=n.n(b),O=n(19),S=n.n(O),k=n(24),j=n.n(k),C=n(25),w=n.n(C),x=n(115),P=n.n(x),R=n(414),D=n.n(R),T=n(1625),_=n.n(T),M=n(1624),I=n.n(M),B=n(1519),F=n.n(B),$=n(1626),A=n.n($),H=n(1),L=n(0),z=n(46),V=n(216),N=n(415),W=n(83),q=n(262),U=n(626),K=n(1526),Y=n(1532),J=n(1500),G=n(637),Q=n(275),X=n(633),Z=n(1527),ee=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},te=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":p()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ne=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={currentPage:0,rowPerPage:20,emailStatus:H.EmailStatusInbox.$Type,searchExpr:new L.None},n}return s()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.fetchEmailDataObjects()}},{key:"fetchEmailDataObjects",value:function(){this.props.dispatch(Object(K.a)(this.props.eventLineId,this.state.currentPage,this.state.rowPerPage,Object(L.toOption)(new H.EmailFilterGroup([new H.EmailFilterCondition(new H.EmailFilterExpressionStatus(Object(Q.a)(this.state.emailStatus)),new H.EmailFilterOperatorEq)].concat(this.state.searchExpr.matchWith(function(e){return[new H.EmailFilterCondition(e,new H.EmailFilterOperatorContains)]},function(){return[]})),new H.EmailFilterPredicateAnd))))}},{key:"onSearch",value:function(e){var t=this;this.setState(g(this.state,{searchExpr:{$set:e}}),function(){t.fetchEmailDataObjects()})}},{key:"onRenewClick",value:function(){this.onFirstPage()}},{key:"onFirstPage",value:function(){var e=this;this.setState(g(this.state,{currentPage:{$set:0}}),function(){return e.fetchEmailDataObjects()})}},{key:"onLastPage",value:function(){var e=this;this.setState(g(this.state,{currentPage:{$set:Math.ceil(this.props.emailService.total.getOrElse(function(){return 0})/this.state.rowPerPage)-1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onNextPage",value:function(){var e=this;this.setState(g(this.state,{currentPage:{$set:this.state.currentPage+1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onPrevPage",value:function(){var e=this;this.setState(g(this.state,{currentPage:{$set:this.state.currentPage-1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onPageSizeChanged",value:function(e){var t=this;this.setState(g(this.state,{rowPerPage:{$set:e}}),function(){return t.fetchEmailDataObjects()})}},{key:"onCreateDraftClick",value:function(e,t){var n=this;return this.createDraftFromValues(e).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Письмо сохранено")),new L.None)}).catch(function(e){n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Ошибка при сохранении письма")),new L.None)})}},{key:"onSendDraftClick",value:function(e,t){var n=this;return this.createDraftFromValues(e).then(function(e){return Object(G.k)(e)}).then(function(){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Письмо отправлено")),new L.None)}).catch(function(e){n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Ошибка при отправке письма")),new L.None)})}},{key:"getEmailMessageBody",value:function(e,t){return new H.EmailMessageBody(new H.MessageSubject(Object(L.toOption)(e.subject).filter(function(e){return""!==e})),new H.MessageBody(e.body||""),new H.MessageHtml(e.html),(e.replyTo||"").split(",").filter(function(e){return""!==e}).map(function(e){return new H.MessageAddress("",e.trim())}),t.entity.address,e.attachments||[],[],new L.None,(e.cc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new H.MessageAddress("",e.trim())}),(e.bcc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new H.MessageAddress("",e.trim())}))}},{key:"createDraftFromValues",value:function(e){var t=this;return Object(L.headOption)(this.props.mailBoxConfigs.list.filter(function(t){return t.id.value===e.mailBoxId})).matchWith(function(n){return Object(G.a)(n.id,new L.None,t.getEmailMessageBody(e,n),[]).then(function(e){return e.id})},function(){return new Promise(function(e,t){return t()})})}},{key:"editDraftFromValues",value:function(e){var t=this;return Object(L.headOption)(this.props.mailBoxConfigs.list.filter(function(t){return t.id.value===e.mailBoxId})).matchWith(function(n){return Object(G.d)(H.Id.createId(e.emailId).getOrElse(function(){throw"wrong email data object id"}),t.getEmailMessageBody(e,n)).then(function(e){return e.id})},function(){return new Promise(function(e,t){return t()})})}},{key:"openDraftEditForm",value:function(e,t,n,a,i){var r=this,o=function(){return r.props.handleDialogClose(s)},c=!1,l=!1,u=void 0,s=this.props.openDialog(e,h.createElement(J.b,{ref:function(e){return u=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},showMailBoxSelector:t,initialValues:i,organisationId:this.props.organisation.organisationId,onSubmit:function(e){if(c)return n(e,o);if(l)return a(e,o);throw"unknown butoon clicked"}}),[h.createElement(S.a,{key:"cancel",variant:"raised",onClick:o,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),h.createElement(X.a,{key:"save",style:{marginRight:"10px"},formName:J.a,variant:"raised",onClick:function(){return u.foreach(function(e){c=!0,e.submit()})}},this.props.i18n.t("Сохранить как черновик")),h.createElement(X.a,{key:"send",formName:J.a,variant:"raised",onClick:function(){return u.foreach(function(e){l=!0,e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onCreateRequested",value:function(){this.openDraftEditForm(this.props.i18n.t("Новое сообщение"),!0,this.onCreateDraftClick,this.onSendDraftClick)}},{key:"onEditClick",value:function(e){}},{key:"onDeleteRequested",value:function(e){}},{key:"onSaveDraftClick",value:function(e,t){var n=this;return this.editDraftFromValues(e).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Письмо сохранено")),new L.None)}).catch(function(e){n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Ошибка при сохранении письма")),new L.None)})}},{key:"onSendEditedDraftClick",value:function(e,t){var n=this;return this.editDraftFromValues(e).then(function(e){return Object(G.k)(e)}).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Письмо отправлено")),new L.None)}).catch(function(e){n.props.openSnackbar(h.createElement("span",null,n.props.i18n.t("Ошибка при отправлении письма")),new L.None)})}},{key:"onDraftEdit",value:function(e){var t=this;this.openDraftEditForm(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),!1,this.onSaveDraftClick,this.onSendEditedDraftClick,{emailId:e.id.value,replyTo:e.entity.msgBody.to.map(function(e){return e.email}).join(", "),subject:e.entity.msgBody.subject.text.getOrElse(function(){return""}),html:e.entity.msgBody.html.text,cc:e.entity.msgBody.cc.map(function(e){return e.email}).join(", "),bcc:e.entity.msgBody.bcc.map(function(e){return e.email}).join(", "),mailBoxId:e.entity.rels.mailBoxId.map(function(e){return e.value}).getOrUndefined()})}},{key:"onInboxOrSentView",value:function(e){var t=this;Object(L.toOption)(e).filter(function(e){return!e.entity.meta.readStatus}).foreach(function(e){Object(G.f)(e.id).then(function(){t.fetchEmailDataObjects()})});var n=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),h.createElement(Y.a,{email:e}),[h.createElement(S.a,{key:"cancel",variant:"raised",onClick:function(){return t.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),h.createElement(S.a,{key:"reply",variant:"raised",onClick:function(n){return t.onReplyToClick(e)},color:"primary"},this.props.i18n.t("Ответить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onViewClick",value:function(e){e.entity.meta.emailStatus instanceof H.EmailStatusDraft?this.onDraftEdit(e):this.onInboxOrSentView(e)}},{key:"onReplyToSubmit",value:function(e,t,n){var a=this;return t.entity.rels.mailBoxId.matchWith(function(n){return Object(G.j)(t.id,n,new H.MessageSubject(Object(L.toOption)(e.subject).filter(function(e){return""!==e})),new H.MessageBody(e.body||""),new H.MessageHtml(e.html),e.attachments||[],[],t.entity.meta.msgUid,(e.cc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new H.MessageAddress("",e.trim())}),(e.bcc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new H.MessageAddress("",e.trim())}))},function(){return new Promise(function(e,t){return t()})}).then(function(e){n(),a.fetchEmailDataObjects(),a.props.openSnackbar(h.createElement("span",null,a.props.i18n.t("Письмо отправлено")),new L.None)}).catch(function(e){a.props.openSnackbar(h.createElement("span",null,a.props.i18n.t("Ошибка при отправлении письма")),new L.None)})}},{key:"onReplyToClick",value:function(e){var t=this,n=function(){return t.props.handleDialogClose(i)},a=void 0,i=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),h.createElement(J.b,{ref:function(e){return a=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},initialValues:{replyTo:e.entity.msgBody.from.email,subject:e.entity.msgBody.subject.text.getOrElse(function(){return""}),cc:e.entity.msgBody.cc.map(function(e){return e.email}).join(", "),bcc:e.entity.msgBody.bcc.map(function(e){return e.email}).join(", ")},organisationId:this.props.organisation.organisationId,onSubmit:function(a){return t.onReplyToSubmit(a,e,n)}}),[h.createElement(S.a,{key:"cancel",variant:"raised",onClick:n,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),h.createElement(S.a,{key:"send",variant:"raised",onClick:function(){return a.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onSelectAll",value:function(){}},{key:"onEmailSelected",value:function(){}},{key:"renderMassActionIcons",value:function(){return[h.createElement("div",null)]}},{key:"getReadStatusIcon",value:function(e){return e.entity.meta.readStatus?h.createElement(I.a,{style:z.g}):h.createElement(_.a,{style:z.g})}},{key:"onReadStatusToggle",value:function(e){var t=this;(e.entity.meta.readStatus?Object(G.e)(e.id):Object(G.f)(e.id)).then(function(){t.fetchEmailDataObjects()})}},{key:"getEmailDate",value:function(e){var t=new Date(e.entity.created),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?t.toLocaleTimeString():t.toLocaleDateString()}},{key:"wrapBySpan",value:function(e,t){return h.createElement("span",{style:e.entity.meta.readStatus?{}:{fontWeight:600}},t)}},{key:"onEmailStatusChanged",value:function(e){var t=this;this.setState(g(this.state,{emailStatus:{$set:e}}),function(){t.fetchEmailDataObjects(),t.props.closeMenu()})}},{key:"onEmailStatusMenuClick",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[h.createElement(j.a,{key:H.EmailStatusInbox.$Type.value,value:H.EmailStatusInbox.$Type.value,onClick:function(){return t.onEmailStatusChanged(H.EmailStatusInbox.$Type)}},Object(Q.b)(H.EmailStatusInbox.$Type,this.props.i18n.t)),h.createElement(j.a,{key:H.EmailStatusSent.$Type.value,value:H.EmailStatusSent.$Type.value,onClick:function(){return t.onEmailStatusChanged(H.EmailStatusSent.$Type)}},Object(Q.b)(H.EmailStatusSent.$Type,this.props.i18n.t)),h.createElement(j.a,{key:H.EmailStatusDraft.$Type.value,value:H.EmailStatusDraft.$Type.value,onClick:function(){return t.onEmailStatusChanged(H.EmailStatusDraft.$Type)}},Object(Q.b)(H.EmailStatusDraft.$Type,this.props.i18n.t)),h.createElement(j.a,{key:H.EmailStatusRejected.$Type.value,value:H.EmailStatusRejected.$Type.value,onClick:function(){return t.onEmailStatusChanged(H.EmailStatusRejected.$Type)}},Object(Q.b)(H.EmailStatusRejected.$Type,this.props.i18n.t)),h.createElement(j.a,{key:H.EmailStatusDelivered.$Type.value,value:H.EmailStatusDelivered.$Type.value,onClick:function(){return t.onEmailStatusChanged(H.EmailStatusDelivered.$Type)}},Object(Q.b)(H.EmailStatusDelivered.$Type,this.props.i18n.t)),h.createElement(j.a,{key:H.EmailStatusBounce.$Type.value,value:H.EmailStatusBounce.$Type.value,onClick:function(){return t.onEmailStatusChanged(H.EmailStatusBounce.$Type)}},Object(Q.b)(H.EmailStatusBounce.$Type,this.props.i18n.t)),h.createElement(j.a,{key:H.EmailStatusComplaint.$Type.value,value:H.EmailStatusComplaint.$Type.value,onClick:function(){return t.onEmailStatusChanged(H.EmailStatusComplaint.$Type)}},Object(Q.b)(H.EmailStatusComplaint.$Type,this.props.i18n.t))])}},{key:"getEmailReadStatusIcon",value:function(e){var t=this;return e.entity.meta.opened.map(function(e){return h.createElement(P.a,{title:t.props.i18n.t("Просмотрено получателем")},h.createElement(A.a,{style:{fill:v.a[500],fontSize:"10px"}}))}).getOrNull()}},{key:"render",value:function(){var e=this;return h.createElement(E.a,{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto",flex:1,padding:15}},h.createElement(V.b,null,h.createElement(S.a,{style:{marginTop:0,flexShrink:0},variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать")),h.createElement(w.a,{style:{marginLeft:"10px",marginRight:"10px",flexShrink:0},onClick:this.onRenewClick},h.createElement(F.a,null)),h.createElement(Z.a,{onSearch:this.onSearch}),h.createElement(S.a,{style:{marginLeft:"10px",marginTop:0,flexShrink:0},onClick:this.onEmailStatusMenuClick},Object(Q.b)(this.state.emailStatus,this.props.i18n.t))),h.createElement(N.a,{showId:!1,error:this.props.emailService.error,fetching:this.props.emailService.fetching,onSelectAll:this.onSelectAll,onRecordMarked:this.onEmailSelected,onRecordSelected:this.onViewClick,onSort:function(){},empty:!this.props.emailService.fetching&&0===this.props.emailService.list.length,withActions:!0,headers:[{id:"senderName",title:this.props.i18n.t("Отправитель")},{id:"emailSubject",title:this.props.i18n.t("Тема")},{id:"emailReadStatus",title:""},{id:"emailDate",title:this.props.i18n.t("Время отправки")}],columnStyles:[{flex:1},{flex:8},{flex:"0 0 10px"},{flex:1}],rows:this.props.emailService.list.map(function(t,n){return{id:t.id.value,payload:t,fields:[e.wrapBySpan(t,t.entity.msgBody.from.name),e.wrapBySpan(t,t.entity.msgBody.subject.text.getOrElse(function(){return""})),h.createElement("div",{style:{display:"flex",alignItems:"center"}},e.getEmailReadStatusIcon(t)),e.wrapBySpan(t,e.getEmailDate(t))],buttons:[h.createElement(w.a,{key:"readStatus",style:z.f,onClick:function(n){n.stopPropagation(),e.onReadStatusToggle(t)}},e.getReadStatusIcon(t)),h.createElement(w.a,{key:"delete",style:z.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},h.createElement(D.a,{style:z.g}))]}})}),h.createElement(V.a,{nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,fromToEnd:!0,changePageSize:this.onPageSizeChanged,currentPage:this.state.currentPage,rowPerPage:this.state.rowPerPage,totalRecords:this.props.emailService.total.getOrElse(function(){return 0}),shouldShowMassActions:!1,massActionsComponents:this.renderMassActionIcons(),formSearchEnabled:!1}))}}]),t}(h.Component);ne=ee([m.autobind,te("design:paramtypes",[Object])],ne),t.a=Object(d.connect)(function(e,t){return{i18n:e.i18n,emailService:e.emailService,organisation:e.organisation,mailBoxConfigs:e.mailBoxConfigs}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.emailService===t.emailService&&e.organisation===t.organisation&&e.mailBoxConfigs===t.mailBoxConfigs},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.emailService===t.emailService&&e.organisation===t.organisation&&e.mailBoxConfigs===t.mailBoxConfigs}})(Object(W.a)(Object(U.a)(Object(q.a)(ne))))}}]);