(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[32],{1470:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return l});var r=n(623),a=n(109),i=function(e){return function(t,n){return n().auth.token.foreach(function(t){Object(r.b)(e,t,n().config.cdnAddress)})}},o=function(e){return function(t,n){return Object(a.a)(n().auth,e,n().config.cdnAddress)}},l=function(e){return function(t){return e.settings.ui.defaultImg.map(function(e){return t(o(e)).getOrElse(function(){return n(622)})})}}},1477:function(e,t,n){"use strict";var r=n(17),a=n(21),i=n(6),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(18),d=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Create",{document:e}))}return u()(t,e),t}(p.a),f=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Update",{document:e}))}return u()(t,e),t}(p.a),h=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Delete",{id:e}))}return u()(t,e),t}(p.a),m=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","List",{form:e}))}return u()(t,e),t}(p.a),g=function(e){function t(e,n){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListFormData",{formId:e,formDataId:n}))}return u()(t,e),t}(p.a),v=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListIds",{ids:e}))}return u()(t,e),t}(p.a),y=n(193);n.d(t,"c",function(){return b}),n.d(t,"d",function(){return O}),n.d(t,"e",function(){return E}),n.d(t,"f",function(){return C}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return k});var b=function(e){return function(t){return t(Object(y.q)(e)),r.a.send(new m(e),Object(a.g)()).then(function(n){return t(Object(y.r)({formId:e,documents:n.list})),n}).catch(function(n){throw t(Object(y.p)({formId:e,error:n})),n})}},O=function(e){return function(t){return t(Object(y.k)()),r.a.send(new v(e),Object(a.g)()).then(function(e){return t(Object(y.l)(e.list)),e}).catch(function(e){throw t(Object(y.j)(e)),e})}},E=function(e,t){return function(n){return n(Object(y.n)(t)),r.a.send(new g(e,t),Object(a.g)()).then(function(e){return n(Object(y.o)({formDataId:t,documents:e.list})),e}).catch(function(e){throw n(Object(y.m)({formDataId:t,error:e})),e})}},C=function(e){return r.a.send(new f(e),Object(a.f)())},j=function(e){return r.a.send(new d(e),Object(a.f)())},k=function(e){return r.a.send(new h(e),Object(a.f)())}},1479:function(e,t,n){"use strict";var r=n(6),a=n.n(r),i=n(10),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(2),d=n(52),f=n.n(d),h=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){return p.createElement(f.a,{component:"div",style:Object.assign({overflowY:"auto"},this.props.style)},this.props.children)}}]),t}(p.PureComponent);t.a=h},1519:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(2)),i=(0,r(n(44)).default)(a.default.createElement(a.default.Fragment,null,a.default.createElement("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),a.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Autorenew");t.default=i},1546:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return l});var r=n(130),a=n(1469),i=n(425),o=function(){return function(e,t){t().organisation.infoFetching||t().organisation.infoFetched||(e(Object(r.t)()),a.f().then(function(t){e(Object(r.q)(t))}).catch(function(t){e(Object(r.s)(t))}))}},l=function(e){return function(t){return t(Object(r.m)()),i.e(e).then(function(e){return t(Object(r.n)(e.list)),e}).catch(function(e){throw t(Object(r.l)(e)),e})}}},1548:function(e,t,n){"use strict";var r=n(17),a=n(6),i=n.n(a),o=n(7),l=n.n(o),s=n(8),c=n.n(s),u=n(18),p=(function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Request",{id:e}))}c()(t,e)}(u.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","List",{orgId:e}))}return c()(t,e),t}(u.a)),d=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Update",{page:e}))}return c()(t,e),t}(u.a),f=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Create",{page:e}))}return c()(t,e),t}(u.a),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Delete",{id:e}))}return c()(t,e),t}(u.a),m=n(21);n.d(t,"c",function(){return g}),n.d(t,"d",function(){return v}),n.d(t,"a",function(){return y}),n.d(t,"b",function(){return b});var g=function(e){return r.a.send(new p(e),Object(m.g)())},v=function(e){return r.a.send(new d(e),Object(m.f)())},y=function(e){return r.a.send(new f(e),Object(m.c)())},b=function(e){return r.a.send(new h(e),Object(m.d)())}},1589:function(e,t,n){"use strict";var r=n(17),a=n(6),i=n.n(a),o=n(7),l=n.n(o),s=n(8),c=n.n(s),u=n(18),p=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","List",{organisationId:e}))}return c()(t,e),t}(u.a),d=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","Update",{connection:e}))}return c()(t,e),t}(u.a),f=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","Create",{connection:e}))}return c()(t,e),t}(u.a),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","Delete",{id:e}))}return c()(t,e),t}(u.a),m=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","XeroConnect",{connectionId:e}))}return c()(t,e),t}(u.a),g=n(21);n.d(t,"d",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"b",function(){return b}),n.d(t,"c",function(){return O}),n.d(t,"a",function(){return E});var v=function(e){return r.a.send(new p(e),Object(g.g)())},y=function(e){return r.a.send(new d(e),Object(g.f)())},b=function(e){return r.a.send(new f(e),Object(g.c)())},O=function(e){return r.a.send(new h(e),Object(g.d)())},E=function(e){return r.a.send(new m(e),function(e){return e})}},1596:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return l});var r=n(445),a=n(1548),i=n(87),o=function(e){return function(t,n){return t(Object(r.e)()),a.c(e).then(function(e){return t(Object(r.f)(e.list)),e.list}).catch(function(e){throw t(Object(r.d)(e)),e})}},l=function(e){return function(t){return t(Object(i.b)(function(e){return!e.internetDomains.fetching&&e.internetDomains.fetched},o(e)))}}},1597:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(2)),i=(0,r(n(44)).default)(a.default.createElement(a.default.Fragment,null,a.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),a.default.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"})),"CloudDownload");t.default=i},1599:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(446),a=n(1589),i=function(e){return function(t,n){return n().socialConnections.fetched?new Promise(function(e,t){e(n().socialConnections.list)}):t(o(e))}},o=function(e){return function(t,n){return t(Object(r.e)()),a.d(e).then(function(e){return t(Object(r.f)(e.list)),e.list}).catch(function(e){throw t(Object(r.d)(e)),e})}}},1627:function(e,t,n){e.exports=n(97)(363)},1775:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return l});var r=n(483),a=n(553),i=n(672),o=function(e){return function(t){return t(Object(r.e)()),a.e(e).then(function(e){return t(Object(r.f)(e.record)),e.record}).catch(function(e){throw t(Object(r.d)(e)),e})}},l=function(e){return function(t,n){return n().role.data.matchWith(function(e){return new Promise(function(t,n){return t(e)})},function(){return Object(i.b)(n().roles,e).matchWith(function(e){return t(Object(r.f)(e)),new Promise(function(t,n){return t(e)})},function(){return t(o(e))})})}}},1837:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u});var r=n(1964),a=n.n(r),i=n(485),o=n(82),l="https://www.facebook.com/v2.11/dialog/oauth",s="https://accounts.google.com/o/oauth2/v2/auth",c="https://www.linkedin.com/oauth/v2/authorization",u=function(){return function(e){e(Object(i.e)()),a()({method:"post",url:o.default.server_address+"/api/oauth/params"}).then(function(t){e(Object(i.f)({facebook:{clientId:t.data.facebook.clientId,redirectUrl:t.data.facebook.redirectUrl},google:{clientId:t.data.google.clientId,redirectUrl:t.data.google.redirectUrl},linkedIn:{clientId:t.data.linkedin.clientId,redirectUrl:t.data.linkedin.redirectUrl}}))}).catch(function(t){e(Object(i.d)(t))})}}},1839:function(e,t,n){"use strict";var r=n(6),a=n.n(r),i=n(10),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(14),m=n(95),g=n(13),v=n(30),y=n.n(v),b=n(24),O=n.n(b),E=n(34),C=n.n(E),j=n(32),k=n.n(j),T=n(26),w=n.n(T),P=n(54),S=n.n(P),I=n(156),_=n.n(I),D=n(1),x=n(0),R=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},N=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"onDomainTargetTypeChanged",value:function(e){this.props.fields.domainTargetType.onChange(e.target.value)}},{key:"getDomainValue",value:function(){return"https://"+this.props.fields.domain.value}},{key:"onDomainChange",value:function(e){this.props.fields.domain.onChange(e.target.value.slice(8))}},{key:"render",value:function(){var e=this.props.fields,t=e.name,n=e.domainTargetType,r=e.domain;return f.createElement("form",{style:{display:"flex",flexWrap:"wrap"}},f.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Название"),error:t.touched&&t.error,helperText:t.touched&&Object(x.toOption)(t.error).map(function(e){return e}).getOrNull()}),f.createElement(k.a,{fullWidth:!0},f.createElement(C.a,null,this.props.i18n.t("Тип")),f.createElement(y.a,{value:n.value,onChange:this.onDomainTargetTypeChanged,error:n.touched&&n.error,fullWidth:!0},f.createElement(O.a,{value:D.DomainTargetOrganisation.$Type.value},f.createElement(S.a,{primary:this.props.i18n.t("Организация")})),f.createElement(O.a,{value:D.DomainTargetWebPage.$Type.value},f.createElement(S.a,{primary:this.props.i18n.t("Веб страница")}))),Object(x.toOption)(n.error).map(function(e){return f.createElement(_.a,null,e)}).getOrNull()),f.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:this.getDomainValue(),onChange:this.onDomainChange,label:this.props.i18n.t("Домен"),error:r.touched&&r.error,helperText:r.touched&&Object(x.toOption)(r.error).map(function(e){return e}).getOrNull()}))}}]),t}(f.Component);N=R([g.autobind],N),t.a=Object(h.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:"newDomainForm",fields:["name","domainTargetType","domain"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.domainTargetType&&0!==e.domainTargetType.trim().length||(n.domainTargetType=t.i18n.t("Обязательное значение")),e.domain&&0!==e.domain.trim().length?!/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/i.test(e.domain)&&e.domain.indexOf("localhost")<0&&(n.domain=t.i18n.t("Неверный домен")):n.domain=t.i18n.t("Обязательное значение"),n}})(N))},1840:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=function(e,t){return new r.InternetDomain(e.name,t,e.domain,function(e){switch(e.domainTargetType){case r.DomainTargetOrganisation.$Type.value:return new r.DomainTargetOrganisation;case r.DomainTargetWebPage.$Type.value:return new r.DomainTargetWebPage;default:throw"Unknown domain target type"}}(e))}},1846:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var a=r(n(1983))},1847:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var a=r(n(1984))},1886:function(e,t,n){"use strict";var r=n(496),a=n(17),i=n(6),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(18),d=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Printers","List",{}))}return u()(t,e),t}(p.a),f=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Printers","Scan",{}))}return u()(t,e),t}(p.a),h=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Printers","PrintFile",{fileId:e}))}return u()(t,e),t}(p.a),m=n(21);n.d(t,"a",function(){return g}),n.d(t,"c",function(){return v}),n.d(t,"b",function(){return y});var g=function(){return function(e){return e(Object(r.e)()),a.a.send(new d,Object(m.g)()).then(function(t){return e(Object(r.f)(t.list)),t}).catch(function(t){throw e(Object(r.d)(t)),t})}},v=function(){return function(e){return e(Object(r.e)()),a.a.send(new f,Object(m.i)()).then(function(t){return e(g()),t}).catch(function(t){throw e(Object(r.d)(t)),t})}},y=function(e){return a.a.send(new h(e),function(e){return e})}},1914:function(e,t,n){"use strict";var r=n(6),a=n.n(r),i=n(10),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(14),m=n(13),g=n(417),v=n(25),y=n.n(v),b=n(1597),O=n.n(b),E=n(99),C=n(139),j=n(0),k=n(626),T=n(1470),w=(n(1985),function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}),P=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.fetchFileMeta(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(j.isEqual)(this.props.fileId.map(function(e){return e.value}),e.fileId.map(function(e){return e.value}))||this.fetchFileMeta(e)}},{key:"fetchFileMeta",value:function(e){e.fileId.filter(function(t){return 0===e.fileMetas.list.filter(function(e){return e.id.value===t.value}).length}).foreach(function(t){Object(E.b)(t).then(function(t){e.dispatch(Object(C.e)([t.record]))})})}},{key:"onFilesDrop",value:function(e){var t=this;Object(j.headOption)(e).foreach(function(e){Object(E.h)(e,t.props.cdnAddress,t.props.auth.token,t.props.organisation.organisationId,t.props.eventLine.eventLineId,new j.None,new j.None).then(function(e){Object(E.b)(e).then(function(n){t.props.dispatch(Object(C.e)([n.record])),t.props.onFileIdChanged(e),t.props.openSnackbar(f.createElement("span",null,t.props.i18n.t("Файл успешно загружен")),new j.None)})})})}},{key:"onDownloadClick",value:function(){var e=this;this.props.fileId.foreach(function(t){e.props.dispatch(Object(T.c)(t))})}},{key:"render",value:function(){var e=this;return f.createElement("div",null,f.createElement("p",null,this.props.label),f.createElement("div",{style:{display:"flex"}},f.createElement("p",{style:{flex:1}},this.props.fileId.flatMap(function(t){return Object(j.headOption)(e.props.fileMetas.list.filter(function(e){return e.id.value===t.value}))}).map(function(e){return e.entity.originalName}).getOrElse(function(){return e.props.i18n.t("Файл не найден")})),this.props.fileId.nonEmpty()&&f.createElement(y.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onDownloadClick},f.createElement(O.a,null))),f.createElement(g,{className:"DropZoneField__dropzone",onDrop:this.onFilesDrop},function(t){var n=t.isDragActive;return f.createElement("div",{className:n?"DropZoneField__dropzone-wrapper":""},f.createElement("div",{className:"DropZoneField__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}))}}]),t}(f.Component);P=w([m.autobind],P),t.a=Object(h.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,auth:e.auth,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)})(Object(k.a)(P))},1983:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.styles=void 0;var a=r(n(36)),i=r(n(39)),o=r(n(2)),l=(r(n(31)),r(n(47))),s=r(n(93)),c=r(n(38)),u={root:{overflow:"hidden"}};function p(e){var t=e.classes,n=e.className,r=e.raised,c=(0,i.default)(e,["classes","className","raised"]);return o.default.createElement(s.default,(0,a.default)({className:(0,l.default)(t.root,n),elevation:r?8:1},c))}t.styles=u,p.defaultProps={raised:!1};var d=(0,c.default)(u,{name:"MuiCard"})(p);t.default=d},1984:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.styles=void 0;var a=r(n(36)),i=r(n(39)),o=r(n(2)),l=(r(n(31)),r(n(47))),s=(n(61),r(n(38))),c={root:{padding:16,"&:last-child":{paddingBottom:24}}};function u(e){var t=e.classes,n=e.className,r=e.component,s=(0,i.default)(e,["classes","className","component"]);return o.default.createElement(r,(0,a.default)({className:(0,l.default)(t.root,n)},s))}t.styles=c,u.defaultProps={component:"div"};var p=(0,s.default)(c,{name:"MuiCardContent"})(u);t.default=p},1985:function(e,t,n){var r=n(1986);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},1986:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".DropZoneField__dropzone {\n  position: relative;\n  width: 100%;\n  height: 200px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.DropZoneField__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.DropZoneField__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n",""])},2004:function(e,t,n){e.exports=n(49)(124)},2010:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var a=r(n(2642))},2011:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var a=r(n(2643))},2629:function(e,t,n){var r=n(2630);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},2630:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".OrganisationSettings {\n  display: flex;\n  height: 100%; }\n\n.OrganisationSettings__menu {\n  width: 256px;\n  margin: 4px 4px 4px 0;\n  height: fit-content; }\n\n.OrganisationSettings__content {\n  flex: 1;\n  margin: 4px 0 4px 4px; }\n",""])},2631:function(e,t,n){var r=n(2632);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},2632:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".OrganisationSettingsFonts {\n  height: 100%;\n  overflow-y: auto; }\n\n.OrganisationSettingsFonts__dropzone {\n  position: relative;\n  width: 100%;\n  height: 100px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.OrganisationSettingsFonts__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.OrganisationSettingsFonts__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n",""])},2633:function(e,t,n){var r=n(2634);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},2634:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".OrganisationSettingsMessageTransports {\n  height: 100%;\n  overflow-y: auto; }\n",""])},2635:function(e,t,n){var r=n(2636);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},2636:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".OrganisationSettingsPayments {\n  height: 100%;\n  overflow-y: auto; }\n",""])},2637:function(e,t,n){var r=n(2638);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},2638:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".OrganisationSettingsDomains {\n  height: 100%;\n  overflow-y: auto; }\n",""])},2639:function(e,t,n){var r=n(2640);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},2640:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},2641:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(2)),i=(0,r(n(44)).default)(a.default.createElement(a.default.Fragment,null,a.default.createElement("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"}),a.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Mail");t.default=i},2642:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.styles=void 0;var a=r(n(36)),i=r(n(39)),o=r(n(2)),l=(r(n(31)),r(n(47))),s=(n(61),r(n(108)),r(n(38))),c=function(e){return{root:{display:"flex",justifyContent:"center",height:56,backgroundColor:e.palette.background.paper}}};function u(e){var t=e.children,n=e.classes,r=e.className,s=e.component,c=e.onChange,u=e.showLabels,p=e.value,d=(0,i.default)(e,["children","classes","className","component","onChange","showLabels","value"]),f=(0,l.default)(n.root,r),h=o.default.Children.map(t,function(e,t){if(!o.default.isValidElement(e))return null;var n=void 0===e.props.value?t:e.props.value;return o.default.cloneElement(e,{selected:n===p,showLabel:void 0!==e.props.showLabel?e.props.showLabel:u,value:n,onChange:c})});return o.default.createElement(s,(0,a.default)({className:f},d),h)}t.styles=c,u.defaultProps={component:"div",showLabels:!1};var p=(0,s.default)(c,{name:"MuiBottomNavigation"})(u);t.default=p},2643:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.styles=void 0;var a=r(n(36)),i=r(n(55)),o=r(n(39)),l=r(n(73)),s=r(n(74)),c=r(n(76)),u=r(n(77)),p=r(n(78)),d=r(n(2)),f=(r(n(31)),r(n(47))),h=r(n(38)),m=r(n(328)),g=(r(n(885)),function(e){return{root:{transition:e.transitions.create(["color","padding-top"],{duration:e.transitions.duration.short}),padding:"6px 12px 8px",minWidth:80,maxWidth:168,color:e.palette.text.secondary,flex:"1","&$iconOnly":{paddingTop:16},"&$selected":{paddingTop:6,color:e.palette.primary.main}},selected:{},iconOnly:{},wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"100%",flexDirection:"column"},label:{fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(12),opacity:1,transition:"font-size 0.2s, opacity 0.2s",transitionDelay:"0.1s","&$iconOnly":{opacity:0,transitionDelay:"0s"},"&$selected":{fontSize:e.typography.pxToRem(14)}}}});t.styles=g;var v=function(e){function t(){var e,n;(0,l.default)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=(0,c.default)(this,(e=(0,u.default)(t)).call.apply(e,[this].concat(a)))).handleChange=function(e){var t=n.props,r=t.onChange,a=t.value,i=t.onClick;r&&r(e,a),i&&i(e)},n}return(0,p.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e,t,n=this.props,r=n.classes,l=n.className,s=n.icon,c=n.label,u=(n.onChange,n.onClick,n.selected),p=n.showLabel,h=(n.value,(0,o.default)(n,["classes","className","icon","label","onChange","onClick","selected","showLabel","value"])),g=(0,f.default)(r.root,(e={},(0,i.default)(e,r.selected,u),(0,i.default)(e,r.iconOnly,!p&&!u),e),l),v=(0,f.default)(r.label,(t={},(0,i.default)(t,r.selected,u),(0,i.default)(t,r.iconOnly,!p&&!u),t));return d.default.createElement(m.default,(0,a.default)({className:g,focusRipple:!0,onClick:this.handleChange},h),d.default.createElement("span",{className:r.wrapper},s,d.default.createElement("span",{className:v},c)))}}]),t}(d.default.Component),y=(0,h.default)(g,{name:"MuiBottomNavigationAction"})(v);t.default=y},2644:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(2)),i=(0,r(n(44)).default)(a.default.createElement(a.default.Fragment,null,a.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),a.default.createElement("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})),"Restore");t.default=i},2645:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(2)),i=(0,r(n(44)).default)(a.default.createElement(a.default.Fragment,null,a.default.createElement("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"}),a.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"LocationOn");t.default=i},2646:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(2)),i=(0,r(n(44)).default)(a.default.createElement(a.default.Fragment,null,a.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),a.default.createElement("path",{d:"M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})),"Navigation");t.default=i},2651:function(e,t,n){var r=n(2652);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,a);r.locals&&(e.exports=r.locals)},2652:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".terminals_toolbar {\n  background-color: transparent !important; }\n  .terminals_toolbar .toolbar_group {\n    display: flex;\n    justify-content: space-around !important;\n    align-items: center !important; }\n  .terminals_toolbar .toolbar_group > button {\n    margin-right: 0 !important;\n    padding-left: 8px !important;\n    padding-right: 8px !important; }\n  .terminals_toolbar .table_header {\n    overflow: hidden; }\n\n.TerminalsPage__paper {\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  width: 100%;\n  overflow-y: auto; }\n",""])},2722:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),i=n(10),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(13),m=n(14),g=n(1467),v=n(136),y=n(1461),b=n(425),O=n(1546),E=n(93),C=n.n(E),j=n(3),k=(n(2629),n(4)),T=n.n(k),w=n(634),P=n(25),S=n.n(P),I=n(19),_=n.n(I),D=n(856),x=n.n(D),R=n(857),N=n.n(R),F=n(1),L=(n(2631),n(0)),$=n(99),M=n(414),A=n.n(M),W=n(556),U=n(216),q=n(415),H=n(71),z=n(417),K=n(95),V=n(30),B=n.n(V),G=n(24),X=n.n(G),Y=n(34),Z=n.n(Y),J=n(32),Q=n.n(J),ee=n(156),te=n.n(ee),ne=n(26),re=n.n(ne),ae=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ie=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},oe=["ttf","otf","woff","woff2"],le=["normal","italic","oblique","inherit"],se=["bold","bolder","lighter","normal","100","200","300","400","500","600","700","800","900"],ce=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileLoadingStatus:new L.None},n}return u()(t,e),o()(t,[{key:"handleFileLoadingStatus",value:function(e){this.setState(j(this.state,{fileLoadingStatus:{$set:Object(L.toOption)(e)}}))}},{key:"render",value:function(){var e=this,t=this.props,n=(t.i18n,t.onSubmit),r=t.handleSubmit,a=t.fields,i=a.fontFamily,o=a.fontStretch,l=a.fontStyle,s=a.fontWeight,c=a.fontUnicodeRange,u=a.fontFormat,p=a.files;return f.createElement("form",{onSubmit:function(e){e.preventDefault(),r(n)}},f.createElement("div",null,f.createElement(re.a,{style:{width:"30%"},label:this.props.i18n.t("Семейство"),value:i.value,onChange:i.onChange,error:i.touched&&i.error,helperText:i.touched&&Object(L.toOption)(i.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull()}),f.createElement(Q.a,{style:{width:"30%",marginLeft:15},error:u.touched&&u.error},f.createElement(Z.a,null,this.props.i18n.t("Формат")),f.createElement(B.a,{value:u.value,onChange:u.onChange},oe.map(function(e,t){return f.createElement(X.a,{key:t,value:e},e)})),u.touched&&Object(L.toOption)(u.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull()),f.createElement(Q.a,{style:{width:"30%",marginLeft:15},error:l.touched&&l.error},f.createElement(Z.a,null,this.props.i18n.t("Стиль")),f.createElement(B.a,{value:l.value,onChange:l.onChange},le.map(function(e,t){return f.createElement(X.a,{key:t,value:e},e)})),l.touched&&Object(L.toOption)(l.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull())),f.createElement("div",null,f.createElement(Q.a,{style:{width:"30%"},error:s.touched&&s.error},f.createElement(Z.a,null,this.props.i18n.t("Толщина")),f.createElement(B.a,{value:s.value,onChange:s.onChange},se.map(function(e,t){return f.createElement(X.a,{key:t,value:e},e)})),s.touched&&Object(L.toOption)(s.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull()),f.createElement(re.a,{style:{width:"30%",marginLeft:15},label:this.props.i18n.t("Ширина"),value:o.value,onChange:o.onChange}),f.createElement(re.a,{style:{width:"30%",marginLeft:15,marginBottom:60},label:this.props.i18n.t("Диапазон (Юникод)"),value:c.value,onChange:c.onChange}),f.createElement(z,{className:"OrganisationSettingsFonts__dropzone",onDrop:p.onChange,onDropAccepted:function(){return e.handleFileLoadingStatus(!0)},onDropRejected:function(){return e.handleFileLoadingStatus(!1)}},function(t){var n=t.isDragActive;return f.createElement("div",{className:n?"OrganisationSettingsFonts__dropzone-wrapper":""},f.createElement("div",{className:"OrganisationSettingsFonts__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром"),f.createElement("div",{style:{margin:15,color:"red"}},p.touched&&p.error),e.state.fileLoadingStatus.map(function(t){return t?f.createElement("div",{style:{margin:15,color:"green"}},e.props.i18n.t("Файл прикреплен")):f.createElement("div",{style:{margin:15,color:"red"}},e.props.i18n.t("Файл не прикреплен"))}).getOrNull()))})))}}]),t}(f.Component);ce=ae([h.autobind,ie("design:paramtypes",[Object])],ce);var ue,pe=Object(m.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(K.reduxForm)({form:"OrganisationSettingsFontsForm",fields:["fontFamily","fontStretch","fontStyle","fontWeight","fontUnicodeRange","fontFormat","files"],validate:function(e,t){var n={};return e.fontFamily&&0!==e.fontFamily.trim().length||(n.fontFamily=t.i18n.t("Обязательное значение")),e.fontFormat&&0!==e.fontFormat.trim().length||(n.fontFormat=t.i18n.t("Обязательное значение")),e.fontWeight&&0!==e.fontWeight.trim().length||(n.fontWeight=t.i18n.t("Обязательное значение")),e.files&&0!==e.files.length||(n.files=t.i18n.t("Файл не прикреплен")),n}})(ce)),de=n(201),fe=n(46),he=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},me=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e[e.PRINT_FONTS=0]="PRINT_FONTS",e[e.WEB_FONTS=1]="WEB_FONTS"}(ue||(ue={}));var ge=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileInput:new L.None,selectedIndex:ue.PRINT_FONTS,formValues:{files:[],fontFamily:"",fontFormat:"",fontStretch:"",fontStyle:"",fontUnicodeRange:"",fontWeight:""}},n}return u()(t,e),o()(t,[{key:"onAddPrintFont",value:function(){var e=this;this.props.openDialog(this.props.i18n.t("Добавление шрифта"),f.createElement(z,{className:"OrganisationSettingsFonts__dropzone",onDrop:this.handleFontFilesDrop,accept:".ttf"},function(t){var n=t.isDragActive;return f.createElement("div",{className:n?"OrganisationSettingsFonts__dropzone-wrapper":""},f.createElement("div",{className:"OrganisationSettingsFonts__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),[f.createElement(_.a,{variant:"raised",onClick:function(){e.props.handleDialogClose(!0)}},this.props.i18n.t("Отмена"))])}},{key:"onAddWebFont",value:function(){var e=this,t=void 0;this.props.openDialog(this.props.i18n.t("Добавление шрифта"),f.createElement(pe,{ref:function(e){return t=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},initialValues:{},onSubmit:function(t){e.setState(j(e.state,{formValues:{$set:t}}),function(){return e.handleFontFilesDrop(t.files).then(function(){e.props.handleDialogClose(!0)}).catch(function(t){return e.props.dispatch(Object(de.a)(t))})})}}),[f.createElement(_.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})}},this.props.i18n.t("Сохранить")),f.createElement(_.a,{variant:"raised",onClick:function(){e.props.handleDialogClose(!0)}},this.props.i18n.t("Отмена"))])}},{key:"handleFontFilesDrop",value:function(e){var t=this;if(0===e.length)throw"There are not files to process";return this.processUploadQuery(e).then(function(e){t.props.handleDialogClose(!0),t.props.auth.token.foreach(function(e){return t.state.selectedIndex===ue.WEB_FONTS?t.props.dispatch(Object(W.b)(e)):t.props.dispatch(Object(W.a)(e))}),t.props.dispatch(Object(H.h)(t.props.i18n.t("Файлы успешно загружены")))})}},{key:"processUploadQuery",value:function(e){var t=this;if(0===e.length)return new Promise(function(e,t){return e()});for(var n=[],r=0;r<3;r++){var a=e.shift();if(!a)break;n.push(a)}var i=this.state.formValues,o=i.fontFamily,l=i.fontFormat,s=i.fontStretch,c=i.fontStyle,u=i.fontUnicodeRange,p=i.fontWeight,d=this.state.selectedIndex===ue.WEB_FONTS?new F.FileTypeFont(new F.FontAttributesBlock(o,Object(L.toOption)(s),Object(L.toOption)(c),Object(L.toOption)(p),Object(L.toOption)(u)),l):new F.FileTypeFont(new F.FontAttributesNormal,"ttf");return Promise.all(n.map(function(e){return Object($.h)(e,t.props.cdnAddress,t.props.auth.token,t.props.organisation.organisationId,new L.None,new L.None,new L.Some(d))})).then(function(){return t.processUploadQuery(e)})}},{key:"onDeleteRequested",value:function(e){var t=this;this.props.openDialog(this.props.i18n.t("Удаление шрифта"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить шрифт, это действие нельзя будет отменить?")),[f.createElement(_.a,{variant:"raised",onClick:function(){t.props.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Нет")),f.createElement(_.a,{variant:"raised",onClick:function(){Object($.a)(e).then(function(){t.props.auth.token.foreach(function(e){return t.state.selectedIndex===ue.WEB_FONTS?t.props.dispatch(Object(W.b)(e)):t.props.dispatch(Object(W.a)(e))}),t.props.handleDialogClose(!0),t.props.dispatch(Object(H.h)(t.props.i18n.t("Шрифт успешно удалён")))}).catch(function(e){t.props.dispatch(Object(de.a)(e))})},color:"primary"},this.props.i18n.t("Да"))])}},{key:"onSelected",value:function(e){this.setState(j(this.state,{selectedIndex:{$set:e}}))}},{key:"onAttributesChange",value:function(e,t){this.setState(j(this.state,T()({},e,{$set:t})))}},{key:"renderTabContents",value:function(){var e=this;switch(this.state.selectedIndex){case ue.PRINT_FONTS:return f.createElement("div",{className:"OrganisationSettingsFonts",style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onAddPrintFont,color:"primary"},this.props.i18n.t("Загрузить"))),f.createElement(q.a,{showId:!1,error:this.props.fonts.error,fetching:this.props.fonts.fetching,empty:!this.props.fonts.fetching&&0==this.props.fonts.list.length,withActions:!0,headers:[{id:"fontName",title:this.props.i18n.t("Название")},{id:"fontFamily",title:this.props.i18n.t("Семейство")}],rows:Object(w.default)(this.props.fonts.list.map(function(t){return t.fonts.map(function(n){return{id:n.id.value,payload:n,fields:[n.getName(),t.name],buttons:[f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(t){t.stopPropagation(),e.onDeleteRequested(n.id)}},f.createElement(A.a,{style:fe.g}))]}})}))}));case ue.WEB_FONTS:return f.createElement("div",{className:"OrganisationSettingsFonts",style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onAddWebFont,color:"primary"},this.props.i18n.t("Загрузить"))),f.createElement(q.a,{showId:!1,error:this.props.fonts.error,fetching:this.props.fonts.blockFontsFetching,empty:!this.props.fonts.blockFontsFetching&&0==this.props.fonts.blockFontsList.length,withActions:!0,headers:[{id:"fontFamily",title:this.props.i18n.t("Семейство")},{id:"fontStyle",title:this.props.i18n.t("Стиль")},{id:"fontWeight",title:this.props.i18n.t("Толщина")},{id:"fontFormat",title:this.props.i18n.t("Формат")}],rows:Object(w.default)(this.props.fonts.blockFontsList.map(function(t){return{id:t.id,payload:t,fields:[t.entity.fileType.attrs.family,t.entity.fileType.attrs.style.getOrElse(function(){return""}),t.entity.fileType.attrs.weight.getOrElse(function(){return""}),t.entity.fileType.format],buttons:[f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t.id)}},f.createElement(A.a,{style:fe.g}))]}}))}));default:return f.createElement("div",null,"unknown content")}}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},f.createElement(N.a,{value:this.state.selectedIndex,onChange:function(t,n){return e.onSelected(n)},indicatorColor:"primary",textColor:"primary",fullWidth:!0,centered:!0},f.createElement(x.a,{value:ue.PRINT_FONTS,label:this.props.i18n.t("Печатные шрифты")}),f.createElement(x.a,{value:ue.WEB_FONTS,label:this.props.i18n.t("Веб-шрифты")})),this.renderTabContents())}}]),t}(f.Component);ge=he([h.autobind,me("design:paramtypes",[Object])],ge);var ve=Object(m.connect)(function(e){return{i18n:e.i18n,auth:e.auth,fonts:e.fonts,organisation:e.organisation,organisations:e.organisations,cdnAddress:e.config.cdnAddress}})(Object(v.a)(function(e){e.isTokenChecked&&e.auth.token.foreach(function(t){e.dispatch(Object(W.b)(t)),e.dispatch(Object(W.a)(t))})},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.auth.token.foreach(function(t){e.dispatch(Object(W.b)(t)),e.dispatch(Object(W.a)(t))})})(ge)),ye=n(45),be=n.n(ye),Oe=n(555),Ee=n.n(Oe),Ce=n(552),je=n.n(Ce),ke=(n(2633),n(86)),Te=n.n(ke),we=n(75),Pe=n.n(we),Se=n(33),Ie=n.n(Se),_e=n(54),De=n.n(_e),xe=n(82),Re=n(1599),Ne=n(72),Fe=n.n(Ne),Le=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},$e=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"onHeaderDelete",value:function(e){this.props.onChange(j(this.props.headers,{$splice:[[e,1]]}))}},{key:"onHeaderAdd",value:function(){this.props.onChange(j(this.props.headers,{$push:[new F.EmailHeader("","")]}))}},{key:"onHeaderKeyChange",value:function(e,t,n){this.props.onChange(j(this.props.headers,{$splice:[[e,1,j(t,{key:{$set:n}})]]}))}},{key:"onHeaderValueChange",value:function(e,t,n){this.props.onChange(j(this.props.headers,{$splice:[[e,1,j(t,{value:{$set:n}})]]}))}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{marginTop:"10px"}},f.createElement("div",null,this.props.i18n.t("Заголовки")),this.props.headers.map(function(t,n){return f.createElement("div",{style:{display:"flex"},key:n},f.createElement(re.a,{fullWidth:!0,style:{marginRight:"15px"},placeholder:e.props.i18n.t("Ключ"),value:t.key,onChange:function(r){return e.onHeaderKeyChange(n,t,r.target.value)}}),f.createElement(re.a,{fullWidth:!0,placeholder:e.props.i18n.t("Значение"),value:t.value,onChange:function(r){return e.onHeaderValueChange(n,t,r.target.value)}}),f.createElement(S.a,{style:{alignSelf:"center",flexShrink:0},onClick:function(t){return e.onHeaderDelete(n)}},f.createElement(Fe.a,null)))}),f.createElement(_.a,{variant:"raised",color:"primary",onClick:this.onHeaderAdd},this.props.i18n.t("Добавить заголовок")))}}]),t}(f.Component),Me=$e=Le([h.autobind],$e),Ae=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},We=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"onEmailTransportTypeChanged",value:function(e){this.props.fields.emailTransportType.onChange(e.target.value)}},{key:"onRegionChanged",value:function(e){this.props.fields.region.onChange(e.target.value)}},{key:"renderTransportTypeSelector",value:function(){var e=this.props.fields.transportType;return f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Тип сообщения")),f.createElement(B.a,{value:e.value,onChange:e.onChange,error:e.touched&&e.error,fullWidth:!0},f.createElement(X.a,{value:F.MessageTransports.Email},f.createElement(De.a,{primary:this.props.i18n.t("Email")})),f.createElement(X.a,{value:F.MessageTransports.SMS},f.createElement(De.a,{primary:this.props.i18n.t("SMS")}))),Object(L.toOption)(e.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull())}},{key:"renderSmtpSettings",value:function(){var e=this.props.fields,t=e.smtpHost,n=e.smtpUsername,r=e.smtpPassword,a=e.isStartTLS,i=e.isAuth,o=e.smtpPort,l=e.ssl;e.emailHeaders;return f.createElement(f.Fragment,null,f.createElement("h4",null,this.props.i18n.t("Smtp")),f.createElement(re.a,{fullWidth:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Хост"),error:t.touched&&t.error,helperText:t.touched&&Object(L.toOption)(t.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:o.value,onChange:o.onChange,label:this.props.i18n.t("Порт"),error:o.touched&&o.error,helperText:o.touched&&Object(L.toOption)(o.error).map(function(e){return e}).getOrNull()}),f.createElement(Q.a,{fullWidth:!0},f.createElement(Ie.a,{label:this.props.i18n.t("TLS"),control:f.createElement(Pe.a,{checked:a.value,onChange:function(e,t){return a.onChange(t)}})})),f.createElement(Q.a,{fullWidth:!0},f.createElement(Ie.a,{label:this.props.i18n.t("SSL"),control:f.createElement(Pe.a,{checked:l.value,onChange:function(e,t){return l.onChange(t)}})})),f.createElement(Q.a,{fullWidth:!0},f.createElement(Ie.a,{label:this.props.i18n.t("Авторизация"),control:f.createElement(Pe.a,{checked:i.value,onChange:function(e,t){return i.onChange(t)}})})),i.value&&f.createElement("div",null,f.createElement(re.a,{fullWidth:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Логин"),error:n.touched&&n.error,helperText:n.touched&&Object(L.toOption)(n.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:r.value,onChange:r.onChange,label:this.props.i18n.t("Пароль"),error:r.touched&&r.error,helperText:r.touched&&Object(L.toOption)(r.error).map(function(e){return e}).getOrNull()})),f.createElement(Me,{headers:this.props.fields.emailHeaders.value||[],onChange:this.props.fields.emailHeaders.onChange,i18n:this.props.i18n}))}},{key:"renderImapSetting",value:function(){var e=this.props.fields,t=e.imapHost,n=e.imapUsername,r=e.imapPassword,a=e.imapPort;return f.createElement(f.Fragment,null,f.createElement("h4",null,this.props.i18n.t("Imap")),f.createElement(re.a,{fullWidth:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Хост"),error:t.touched&&t.error,helperText:t.touched&&Object(L.toOption)(t.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,type:"number",value:a.value,onChange:a.onChange,label:this.props.i18n.t("Порт"),error:a.touched&&a.error,helperText:a.touched&&Object(L.toOption)(a.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Логин"),error:n.touched&&n.error,helperText:n.touched&&Object(L.toOption)(n.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:r.value,onChange:r.onChange,label:this.props.i18n.t("Пароль"),error:r.touched&&r.error,helperText:r.touched&&Object(L.toOption)(r.error).map(function(e){return e}).getOrNull()}))}},{key:"renderSmtpImapSettings",value:function(){return f.createElement(f.Fragment,null,this.renderSmtpSettings(),this.renderImapSetting())}},{key:"renderEmailTransportEditor",value:function(){var e=this.props.fields,t=e.emailTransportType,n=e.secretKey,r=e.accessKey,a=e.region,i=e.apiKey,o=e.gmailConnection,l=e.configSetName;return f.createElement("div",null,f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Тип")),f.createElement(B.a,{value:t.value,onChange:this.onEmailTransportTypeChanged,error:t.touched&&t.error,fullWidth:!0},f.createElement(X.a,{value:F.EmailTransportSmtpImap.$Type.value},f.createElement(De.a,{primary:this.props.i18n.t("SMTP & IMAP")})),!xe.default.isA5000&&f.createElement(X.a,{value:F.EmailTransportAmazonSES.$Type.value},f.createElement(De.a,{primary:this.props.i18n.t("Amazon SES")})),!xe.default.isA5000&&f.createElement(X.a,{value:F.EmailTransportSendGrid.$Type.value},f.createElement(De.a,{primary:this.props.i18n.t("SendGrid")})),!xe.default.isA5000&&f.createElement(X.a,{value:F.EmailTransportGmail.$Type.value},f.createElement(De.a,{primary:this.props.i18n.t("Gmail")}))),Object(L.toOption)(t.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull()),t.value===F.EmailTransportAmazonSES.$Type.value&&f.createElement("div",null,f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Регион")),f.createElement(B.a,{value:a.value,onChange:this.onRegionChanged,error:a.touched&&a.error,fullWidth:!0},f.createElement(X.a,{value:"us-east-1"},f.createElement(De.a,{primary:this.props.i18n.t("US East 1")})),f.createElement(X.a,{value:"us-west-2"},f.createElement(De.a,{primary:this.props.i18n.t("US West 2")})),f.createElement(X.a,{value:"eu-west-1"},f.createElement(De.a,{primary:this.props.i18n.t("EU West 1")}))),Object(L.toOption)(a.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull()),f.createElement(re.a,{fullWidth:!0,value:r.value,onChange:r.onChange,label:this.props.i18n.t("Access Key ID"),error:r.touched&&r.error,helperText:r.touched&&Object(L.toOption)(r.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Access Key Secret"),error:n.touched&&n.error,helperText:n.touched&&Object(L.toOption)(n.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:l.value,onChange:l.onChange,label:this.props.i18n.t("Название конфигурации"),error:l.touched&&l.error,helperText:l.touched&&Object(L.toOption)(l.error).map(function(e){return e}).getOrNull()})),t.value===F.EmailTransportSendGrid.$Type.value&&f.createElement("div",null,f.createElement(re.a,{fullWidth:!0,value:i.value,onChange:i.onChange,label:this.props.i18n.t("Ключ приложения"),error:i.touched&&i.error,helperText:i.touched&&Object(L.toOption)(i.error).map(function(e){return e}).getOrNull()})),t.value===F.EmailTransportGmail.$Type.value&&f.createElement("div",null,f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("GMail соединение")),f.createElement(B.a,{fullWidth:!0,value:o.value,onChange:o.onChange},this.props.socialConnections.list.filter(function(e){return e.entity.connector.tpe.value===F.GoogleApp.$Type.value}).map(function(e,t){return f.createElement(X.a,{key:t,value:e.id.value},e.entity.name)}))),f.createElement(Ie.a,{label:this.props.i18n.t("Черновик"),control:f.createElement(be.a,{checked:this.props.fields.isDraft.value,onChange:this.props.fields.isDraft.onChange})})),t.value===F.EmailTransportSmtpImap.$Type.value&&this.renderSmtpImapSettings())}},{key:"renderSmsTransportEditor",value:function(){var e=this.props.fields,t=e.smsTransportType,n=e.sid,r=e.token,a=e.from,i=e.login,o=e.password,l=e.sender;return f.createElement("div",null,f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Тип")),f.createElement(B.a,{value:t.value,onChange:t.onChange,error:t.touched&&t.error},!xe.default.isA5000&&f.createElement(X.a,{value:F.SmsTransportTwilio.$Type.value},f.createElement(De.a,{primary:this.props.i18n.t("Twilio")})),!xe.default.isA5000&&f.createElement(X.a,{value:F.SmsTransportIqSms.$Type.value},f.createElement(De.a,{primary:this.props.i18n.t("IqSms")}))),Object(L.toOption)(t.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull()),t.value===F.SmsTransportTwilio.$Type.value&&f.createElement("div",{style:{width:"100%"}},f.createElement(re.a,{fullWidth:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("SID"),error:n.touched&&n.error,helperText:n.touched&&Object(L.toOption)(n.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:r.value,onChange:r.onChange,label:this.props.i18n.t("Token"),error:r.touched&&r.error,helperText:r.touched&&Object(L.toOption)(r.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:a.value,onChange:a.onChange,label:this.props.i18n.t("MPU SID"),error:a.touched&&a.error,helperText:a.touched&&Object(L.toOption)(a.error).map(function(e){return e}).getOrNull()})),t.value===F.SmsTransportIqSms.$Type.value&&f.createElement("div",{style:{width:"100%"}},f.createElement(re.a,{fullWidth:!0,value:i.value,onChange:i.onChange,label:this.props.i18n.t("Логин"),error:i.touched&&i.error,helperText:i.touched&&Object(L.toOption)(i.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:o.value,onChange:o.onChange,label:this.props.i18n.t("Пароль"),error:o.touched&&o.error,helperText:o.touched&&Object(L.toOption)(o.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:l.value,onChange:l.onChange,label:this.props.i18n.t("Отправитель"),error:l.touched&&l.error,helperText:l.touched&&Object(L.toOption)(l.error).map(function(e){return e}).getOrNull()})))}},{key:"render",value:function(){var e=this.props.fields,t=e.name,n=e.transportType;return f.createElement("form",null,f.createElement(re.a,{fullWidth:!0,autoFocus:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Название"),error:t.touched&&t.error,helperText:t.touched&&Object(L.toOption)(t.error).map(function(e){return e}).getOrNull()}),this.renderTransportTypeSelector(),n.value===F.MessageTransports.Email&&this.renderEmailTransportEditor(),n.value===F.MessageTransports.SMS&&this.renderSmsTransportEditor())}}]),t}(f.Component);We=Ae([h.autobind],We);var Ue=Object(m.connect)(function(e){return{i18n:e.i18n,currentForm:e.currentForm,formFields:e.fields,socialConnections:e.socialConnections,organisation:e.organisation}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(K.reduxForm)({form:"MessageTransportForm",fields:["name","transportType","emailTransportType","password","isStartTLS","ssl","isAuth","region","accessKey","secretKey","apiKey","mailBoxes","transportId","smsTransportType","sid","token","from","login","smtpPassword","imapPassword","smtpUsername","imapUsername","smtpPort","imapPort","smtpHost","imapHost","sender","isDefault","gmailConnection","isDraft","emailHeaders","configSetName"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(Object(v.a)(function(e){e.isTokenChecked&&e.fields.transportType.value===F.MessageTransports.Email&&e.fields.emailTransportType.value===F.EmailTransportGmail.$Type.value&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(Re.a)(t))})},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.fields.transportType.value===F.MessageTransports.Email&&e.fields.emailTransportType.value===F.EmailTransportGmail.$Type.value&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(Re.a)(t))}),e.fields.emailTransportType.value!==t.fields.emailTransportType.value&&e.fields.transportType.value===F.MessageTransports.Email&&e.fields.emailTransportType.value===F.EmailTransportGmail.$Type.value&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(Re.a)(t))})})(We))),qe=n(83),He=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ze=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"getSmsTransport",value:function(e){switch(e.smsTransportType){case F.SmsTransportTwilio.$Type.value:return new F.SmsTransportTwilio(e.sid,e.token,e.from);case F.SmsTransportIqSms.$Type.value:return new F.SmsTransportTwilio(e.login,e.password,e.sender);default:throw"Unknown sms transport type"}}},{key:"getSmsInitialValues",value:function(e,t,n){switch(e.tpe.value){case F.SmsTransportTwilio.$Type.value:var r=e;return{name:t,isDefault:n,transportType:F.MessageTransports.SMS,smsTransportType:r.tpe.value,sid:r.sid,token:r.token,from:r.from};case F.SmsTransportIqSms.$Type.value:var a=e;return{name:t,isDefault:n,transportType:F.MessageTransports.SMS,smsTransportType:a.tpe.value,login:a.login,password:a.password,sender:a.sender};default:throw"Unknown sms transport type"}}},{key:"getEmailTransport",value:function(e){switch(e.emailTransportType){case F.EmailTransportAmazonSES.$Type.value:return new F.EmailTransportAmazonSES(e.region,e.accessKey,e.secretKey,[],Object(L.toOption)(e.configSetName));case F.EmailTransportSendGrid.$Type.value:return new F.EmailTransportSendGrid(e.apiKey);case F.EmailTransportGmail.$Type.value:return new F.EmailTransportGmail(F.Id.createId(e.gmailConnection).getOrElse(function(){throw"wrong connection id"}),e.isDraft||!1);case F.EmailTransportSmtpImap.$Type.value:return new F.EmailTransportSmtpImap(Object(L.toOption)(new F.EmailTransportSmtp(e.smtpHost||"",e.smtpUsername||"",e.smtpPassword||"",e.isStartTLS||!1,e.isAuth||!1,parseInt(e.smtpPort),e.ssl||!1,e.emailHeaders||[])),Object(L.toOption)(new F.EmailTransportImap(e.imapHost,parseInt(e.imapPort),e.imapUsername,e.imapPassword)));default:throw"Unknown email transport type"}}},{key:"getEmailInitialValues",value:function(e,t,n){switch(e.tpe.value){case F.EmailTransportAmazonSES.$Type.value:var r=e;return{emailTransportType:r.tpe.value,name:t,isDefault:n,transportType:F.MessageTransports.Email,region:r.region,accessKey:r.accessKey,secretKey:r.secretKey,configSetName:r.configSetName.getOrUndefined()};case F.EmailTransportSendGrid.$Type.value:var a=e;return{emailTransportType:a.tpe.value,name:t,isDefault:n,transportType:F.MessageTransports.Email,apiKey:a.apiKey};case F.EmailTransportGmail.$Type.value:var i=e;return{emailTransportType:i.tpe.value,name:t,isDefault:n,transportType:F.MessageTransports.Email,gmailConnection:i.connectionId.value,isDraft:i.isDraft};case F.EmailTransportSmtpImap.$Type.value:var o=e;return{emailTransportType:o.tpe.value,name:t,isDefault:n,transportType:F.MessageTransports.Email,imapHost:o.imap.map(function(e){return e.host}).getOrUndefined(),imapUsername:o.imap.map(function(e){return e.userName}).getOrUndefined(),imapPassword:o.imap.map(function(e){return e.password}).getOrUndefined(),imapPort:o.imap.map(function(e){return e.port}).getOrUndefined(),smtpHost:o.smtp.map(function(e){return e.host}).getOrUndefined(),smtpUsername:o.smtp.map(function(e){return e.username}).getOrUndefined(),smtpPassword:o.smtp.map(function(e){return e.password}).getOrUndefined(),isStartTLS:o.smtp.map(function(e){return e.isStartTLS}).getOrUndefined(),ssl:o.smtp.map(function(e){return e.ssl}).getOrUndefined(),isAuth:o.smtp.map(function(e){return e.isAuth}).getOrUndefined(),smtpPort:o.smtp.map(function(e){return e.port}).getOrUndefined(),emailHeaders:o.smtp.map(function(e){return e.headers}).getOrUndefined()};default:throw"Unknown email transport type"}}},{key:"getMessageTransport",value:function(e){if(e.transportType===F.MessageTransports.Email)return this.getEmailTransport(e);if(e.transportType===F.MessageTransports.SMS)return this.getSmsTransport(e);throw"unknow message transport type"}},{key:"getMessageTransportConfig",value:function(e,t){return new F.MessageTransportConfig(e,t.isDefault||!1,t.name,this.getMessageTransport(t))}},{key:"getInitialValues",value:function(e){if(e.entity.transport instanceof F.EmailTransport)return this.getEmailInitialValues(e.entity.transport,e.entity.name,e.entity.isDefault);if(e.entity.transport instanceof F.SmsTransport)return this.getSmsInitialValues(e.entity.transport,e.entity.name,e.entity.isDefault);throw"unknow message transport type"}},{key:"onCreateRequested",value:function(){var e=this,t=void 0,n=this.props.openDialog(this.props.i18n.t("Создание конфигурации сервиса отправителя"),f.createElement(Ue,{ref:function(e){return t=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return new Promise(function(r,a){return e.props.organisation.data.map(function(i){Object(b.a)(i.id,e.getMessageTransportConfig(i.id,t)).then(function(t){r(t),e.props.dispatch(Object(O.a)(i.id)),e.props.dispatch(Object(H.h)(e.props.i18n.t("Успешно создано"))),e.props.handleDialogClose(n)}).catch(function(e){a(e)})}).getOrElse(function(){a("Organisation has not been provided")})}).catch(function(t){return e.props.dispatch(Object(de.a)(t))})}(t)}}),[f.createElement(_.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(n)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditRequest",value:function(e,t){var n=this,r=void 0,a=this.props.openDialog(this.props.i18n.t("Редактирование конфигурации сервиса отправителя"),f.createElement(Ue,{ref:function(e){return r=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return new Promise(function(r,i){return n.props.organisation.data.map(function(o){Object(b.j)(o.id,j(e,{entity:{$set:n.getMessageTransportConfig(o.id,t)}})).then(function(e){r(e),n.props.dispatch(Object(O.a)(o.id)),n.props.dispatch(Object(H.h)(n.props.i18n.t("Успешно сохранено"))),n.props.handleDialogClose(a)}).catch(function(e){i(e)})}).getOrElse(function(){i("Organisation has not been provided")})}).catch(function(e){return n.props.dispatch(Object(de.a)(e))})}(t)},initialValues:this.getInitialValues(e)}),[f.createElement(_.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return n.props.handleDialogClose(a)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return r.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteRequested",value:function(e){var t=this,n=this.props.openDialog(this.props.i18n.t("Удаление конфигурации отправки"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить конфигурацию, это действие нельзя будет отменить?")),[f.createElement(_.a,{variant:"raised",onClick:function(){t.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Нет")),f.createElement(_.a,{variant:"raised",onClick:function(){t.props.organisation.data.foreach(function(r){Object(b.d)(r.id,e.id).then(function(){t.props.handleDialogClose(n),t.props.dispatch(Object(O.a)(r.id)),t.props.dispatch(Object(H.h)(t.props.i18n.t("Успешно удалено")))}).catch(function(e){t.props.dispatch(Object(de.a)(e))})})},color:"primary"},this.props.i18n.t("Да"))])}},{key:"onDefaultSmsSelected",value:function(e,t){var n=this;this.props.organisation.data.matchWith(function(e){Object(b.h)(e.id,t.id).then(function(){n.props.dispatch(Object(O.a)(e.id))}).catch(function(e){n.props.dispatch(Object(de.a)(e))})},function(){n.props.dispatch(Object(H.h)(n.props.i18n.t("Организация не найдена")))})}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"OrganisationSettingsMessageTransports",style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(q.a,{showId:!1,error:this.props.organisation.messageTransports.error,fetching:this.props.organisation.messageTransports.fetching,onRecordSelected:this.onEditRequest,empty:!this.props.organisation.messageTransports.fetching&&0===this.props.organisation.messageTransports.list.length,withActions:!0,headers:[{id:"transportName",title:this.props.i18n.t("Название")},{id:"default",title:this.props.i18n.t("По умолчанию")}],rows:this.props.organisation.messageTransports.list.map(function(t,n){return{id:n.toString(),payload:t,fields:[t.entity.name,f.createElement("div",{onClick:function(e){return e.stopPropagation()}},f.createElement(be.a,{style:{width:"44px",height:"44"},disabled:t.entity.isDefault,onChange:function(n){return e.onDefaultSmsSelected(n,t)},checked:t.entity.isDefault,icon:f.createElement(Ee.a,{style:{fontSize:"20px"}}),checkedIcon:f.createElement(je.a,{style:{fontSize:"20px"}})}))],buttons:[f.createElement(S.a,{key:"edit",style:fe.f,onClick:function(r){r.stopPropagation(),e.onEditRequest(t,n)}},f.createElement(Te.a,{style:fe.g})),f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},f.createElement(A.a,{style:fe.g}))]}})}))}}]),t}(f.Component);ze=He([h.autobind],ze);var Ke=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation}})(Object(qe.a)(ze)),Ve=(n(2635),function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}),Be=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"onPaymentConfigTypeChanged",value:function(e){this.props.fields.paymentConfigType.onChange(e.target.value)}},{key:"render",value:function(){var e=this.props.fields,t=e.name,n=e.paymentConfigType,r=e.apiKey,a=e.publicKey;return f.createElement("form",null,f.createElement(re.a,{fullWidth:!0,autoFocus:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Название"),error:t.touched&&t.error,helperText:t.touched&&Object(L.toOption)(t.error).map(function(e){return e}).getOrNull()}),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Тип")),f.createElement(B.a,{value:n.value,onChange:this.onPaymentConfigTypeChanged,error:n.touched&&n.error,fullWidth:!0},f.createElement(X.a,{value:F.PaymentServiceConfigStripe.$Type.value},f.createElement(De.a,{primary:this.props.i18n.t("Stripe")}))),Object(L.toOption)(n.error).map(function(e){return f.createElement(te.a,null,e)}).getOrNull()),n.value===F.PaymentServiceConfigStripe.$Type.value&&f.createElement("div",null,f.createElement(re.a,{fullWidth:!0,value:r.value,onChange:r.onChange,label:this.props.i18n.t("Secret key"),error:r.touched&&r.error,helperText:r.touched&&Object(L.toOption)(r.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:a.value,onChange:a.onChange,label:this.props.i18n.t("Publishable key"),error:a.touched&&a.error,helperText:a.touched&&Object(L.toOption)(a.error).map(function(e){return e}).getOrNull()})))}}]),t}(f.Component);Be=Ve([h.autobind],Be);var Ge=Object(m.connect)(function(e){return{i18n:e.i18n,currentForm:e.currentForm,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(K.reduxForm)({form:"newPaymentServiceConfigForm",fields:["name","paymentConfigType","apiKey","publicKey","currency"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(Be)),Xe=n(1826),Ye=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Ze=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"getPaymentServiceConfig",value:function(e){switch(e.paymentConfigType){case F.PaymentServiceConfigStripe.$Type.value:return new F.PaymentServiceConfigStripe(e.apiKey,e.publicKey);case F.PaymentServiceConfigUniteller.$Type.value:return new F.PaymentServiceConfigUniteller(e.shopIDP,e.customerIDP,e.lifeTime,e.meanType,e.eMoneyType,e.signature,e.password);default:throw"Unknown payment service config type"}}},{key:"getInitialValues",value:function(e){switch(e.cfg.tpe.value){case F.PaymentServiceConfigStripe.$Type.value:var t=e.cfg;return{paymentConfigType:t.tpe.value,name:e.name,apiKey:t.apiKey,publicKey:t.publicKey};default:throw"Unknown payment service config type"}}},{key:"onCreateRequested",value:function(){var e=this,t=void 0;this.props.openDialog(this.props.i18n.t("Создание конфигурации платежной системы"),f.createElement(Ge,{ref:function(e){return t=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return new Promise(function(n,r){return e.props.organisation.data.map(function(a){Object(Xe.a)(new F.PaymentConfig(a.id,e.getPaymentServiceConfig(t),t.name)).then(function(t){n(t),e.props.dispatch(Object(Xe.c)()),e.props.dispatch(Object(H.h)(e.props.i18n.t("Конфигурация платежной системы успешно создана!"))),e.props.handleDialogClose(!1)}).catch(function(e){r(e)})}).getOrElse(function(){r("Organisation has not been provided")})}).catch(function(t){return e.props.dispatch(Object(de.a)(t))})}(t)}}),[f.createElement(_.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditRequest",value:function(e){var t=this,n=void 0;this.props.openDialog(this.props.i18n.t("Редактирование конфигурации платежной системы"),f.createElement(Ge,{ref:function(e){return n=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(n){return function(n){return Object(Xe.e)(j(e,{entity:{cfg:{$set:t.getPaymentServiceConfig(n)},name:{$set:n.name}}})).then(function(e){t.props.dispatch(Object(Xe.c)()),t.props.dispatch(Object(H.h)(t.props.i18n.t("Изменения в конфигурации платежной системы успешно сохранены!"))),t.props.handleDialogClose(!1)}).catch(function(e){t.props.dispatch(Object(de.a)(e))})}(n)},initialValues:this.getInitialValues(e.entity)}),[f.createElement(_.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return t.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return n.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteRequested",value:function(e){var t=this;this.props.openDialog(this.props.i18n.t("Удаление конфигурации платежной системы"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить конфигурацию платежной системы, это действие нельзя будет отменить?")),[f.createElement(_.a,{variant:"raised",onClick:function(){t.props.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Нет")),f.createElement(_.a,{variant:"raised",onClick:function(){Object(Xe.b)(e.id).then(function(){t.props.dispatch(Object(Xe.c)()),t.props.handleDialogClose(!0),t.props.dispatch(Object(H.h)(t.props.i18n.t("Конфигурация успешно удалёна")))}).catch(function(e){t.props.dispatch(Object(de.a)(e))})},color:"primary"},this.props.i18n.t("Да"))])}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"OrganisationSettingsPayments",style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(q.a,{showId:!1,error:this.props.paymentConfigs.error,fetching:this.props.paymentConfigs.fetching,onRecordSelected:this.onEditRequest,empty:!this.props.paymentConfigs.fetching&&0===this.props.paymentConfigs.list.length,withActions:!0,headers:[{id:"paymentConfigName",title:this.props.i18n.t("Название")}],rows:this.props.paymentConfigs.list.map(function(t,n){return{id:t.id.value,payload:t,fields:[t.entity.name],buttons:[f.createElement(S.a,{key:"edit",style:fe.f,onClick:function(n){n.stopPropagation(),e.onEditRequest(t)}},f.createElement(Te.a,{style:fe.g})),f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},f.createElement(A.a,{style:fe.g}))]}})}))}}]),t}(f.Component);Ze=Ye([h.autobind],Ze);var Je=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation,paymentConfigs:e.paymentConfigs}})(Object(v.a)(function(e){e.isTokenChecked&&e.dispatch(Object(Xe.c)())},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.dispatch(Object(Xe.c)())})(Ze)),Qe=(n(2637),n(1839)),et=n(1548),tt=n(1596),nt=n(620),rt=n(1840),at=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},it=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"getInitialValues",value:function(e){return{name:e.name,domainTargetType:e.target.tpe.value,domain:e.domain}}},{key:"onCreateRequested",value:function(){var e=this,t=void 0;this.props.openDialog(this.props.i18n.t("Создание домена"),f.createElement(Qe.a,{ref:function(e){return t=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return new Promise(function(n,r){return e.props.organisation.data.map(function(a){Object(et.a)(Object(rt.a)(t,a.id)).then(function(t){n(t),e.props.dispatch(Object(tt.a)(a.id)),e.props.dispatch(Object(H.h)(e.props.i18n.t("Домен создан!"))),e.props.handleDialogClose(!1)}).catch(function(e){r(e)})}).getOrElse(function(){r("Organisation has not been provided")})}).catch(function(t){return e.props.dispatch(Object(de.a)(t))})}(t)}}),[f.createElement(_.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditRequest",value:function(e,t){var n=this,r=void 0;this.props.openDialog(this.props.i18n.t("Редактирование домена"),f.createElement(Qe.a,{ref:function(e){return r=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return new Promise(function(r,a){return n.props.organisation.data.map(function(i){Object(et.d)(j(e,{entity:{$set:Object(rt.a)(t,i.id)}})).then(function(e){r(e),n.props.dispatch(Object(tt.a)(i.id)),n.props.dispatch(Object(H.h)(n.props.i18n.t("Домен сохранен!"))),n.props.handleDialogClose(!1)}).catch(function(e){a(e)})}).getOrElse(function(){a("Organisation has not been provided")})}).catch(function(e){return n.props.dispatch(Object(de.a)(e))})}(t)},initialValues:this.getInitialValues(e.entity)}),[f.createElement(_.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return n.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return r.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteRequested",value:function(e){var t=this;this.props.openDialog(this.props.i18n.t("Удаление домена"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить домен, это действие нельзя будет отменить?")),[f.createElement(_.a,{variant:"raised",onClick:function(){t.props.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Нет")),f.createElement(_.a,{variant:"raised",onClick:function(){t.props.organisation.data.foreach(function(n){Object(et.b)(e.id).then(function(){t.props.handleDialogClose(!0),t.props.dispatch(Object(tt.a)(n.id)),t.props.dispatch(Object(H.h)(t.props.i18n.t("Домен удален")))}).catch(function(e){t.props.dispatch(Object(de.a)(e))})})},color:"primary"},this.props.i18n.t("Да"))])}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"OrganisationSettingsDomains",style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(q.a,{showId:!1,error:this.props.internetDomains.error,fetching:this.props.internetDomains.fetching,onRecordSelected:this.onEditRequest,empty:0===this.props.internetDomains.list.length,withActions:!0,headers:[{id:"internetDomainName",title:this.props.i18n.t("Название")}],rows:this.props.internetDomains.list.map(function(t,n){return{id:n.toString(),payload:t,fields:[t.entity.name],buttons:[f.createElement(S.a,{key:"edit",onClick:function(r){r.stopPropagation(),e.onEditRequest(t,n)}},f.createElement(Te.a,null)),f.createElement(S.a,{key:"delete",onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},f.createElement(A.a,null))]}})}))}}]),t}(f.Component);it=at([h.autobind],it);var ot=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation,internetDomains:e.internetDomains}})(Object(nt.a)([function(e){e.organisation.organisationId.foreach(function(t){e.dispatch(Object(tt.b)(t))})}])(it)),lt=(n(2639),n(1914)),st=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ct=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"renderXeroTypeSelector",value:function(){var e=this.props.fields.xeroType;return f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Тип соединения xero")),f.createElement(B.a,{value:e.value,onChange:e.onChange},f.createElement(X.a,{value:F.XeroAppTypePrivateApp.$Type.value},this.props.i18n.t("Приватное")),f.createElement(X.a,{value:F.XeroAppTypePublicApp.$Type.value},this.props.i18n.t("Публичное"))))}},{key:"onXeroPrivateKeyFileIdChange",value:function(e){this.props.fields.xeroPrivateKeyFileId.onChange(e.value)}},{key:"renderXeroPrivateSettings",value:function(){return f.createElement("div",null,f.createElement(re.a,{fullWidth:!0,label:this.props.i18n.t("Конфигурация"),multiline:!0,rows:8,rowsMax:8,value:this.props.fields.xeroPrivateConfig.value,onChange:this.props.fields.xeroPrivateConfig.onChange}),f.createElement(re.a,{fullWidth:!0,label:this.props.i18n.t("Ключ webhook"),value:this.props.fields.xeroPrivateWebHookKey.value,onChange:this.props.fields.xeroPrivateWebHookKey.onChange}),f.createElement(lt.a,{label:this.props.i18n.t("Файл ключа безопасности"),fileId:F.Id.createId(this.props.fields.xeroPrivateKeyFileId.value),onFileIdChanged:this.onXeroPrivateKeyFileIdChange}))}},{key:"render",value:function(){var e=this.props,t=e.fields,n=t.name,r=t.connectorProfiles,a=t.isLogged,i=t.connectionId,o=t.connectorType,l=t.xeroType,s=e.handleSubmit,c=e.onSubmit;return f.createElement("form",{onSubmit:function(e){e.preventDefault(),s(c)}},!!i.value&&f.createElement(re.a,{value:i.value,disabled:!0,fullWidth:!0,label:this.props.i18n.t("Идентификатор")}),f.createElement(re.a,{value:n.value,onChange:n.onChange,fullWidth:!0,label:this.props.i18n.t("Название"),autoFocus:!0}),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Тип соединения")),f.createElement(B.a,{disabled:!!i.value,value:o.value,onChange:o.onChange},f.createElement(X.a,{value:F.FacebookPagesApp.$Type.value},this.props.i18n.t("Facebook")),f.createElement(X.a,{value:F.LinkedInApp.$Type.value},this.props.i18n.t("LinkedIn")),f.createElement(X.a,{value:F.GoogleApp.$Type.value},this.props.i18n.t("GoogleApp")),f.createElement(X.a,{value:F.XeroApp.$Type.value},this.props.i18n.t("Xero")))),o.value===F.XeroApp.$Type.value&&this.renderXeroTypeSelector(),l.value===F.XeroAppTypePrivateApp.$Type.value&&this.renderXeroPrivateSettings(),!!i.value&&f.createElement("div",null,f.createElement("div",null,this.props.i18n.t("Статус"),": ",a.checked?this.props.i18n.t("Активный"):this.props.i18n.t("Неактивный")),(this.props.fields.connectorType.value===F.FacebookPagesApp.$Type.value||this.props.fields.connectorType.value===F.LinkedInApp.$Type.value)&&f.createElement("div",null,f.createElement("h2",null,this.props.i18n.t("Страницы")),f.createElement(q.a,{showId:!1,error:new L.None,fetching:!1,onRecordSelected:function(){},empty:!r.value||0===r.value.length,withActions:!0,headers:[{id:"socialConnectorsName",title:this.props.i18n.t("Название")}],rows:r.value?r.value.map(function(e,t){return{id:e.id,payload:e,fields:[e.name],buttons:[]}}):[]}))))}}]),t}(f.Component);ct=st([h.autobind],ct);var ut=Object(m.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(K.reduxForm)({form:"SocialConnectionForm",fields:["connectionId","connectorType","xeroType","xeroPrivateConfig","xeroPrivateKeyFileId","xeroPrivateWebHookKey","name","connectorProfiles","isLogged"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(ct)),pt=n(1837),dt=n(1589),ft=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ht=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"getFacebookUrl",value:function(e){return this.props.oauth.data.map(function(t){return pt.a+"?client_id="+t.facebook.clientId+"&redirect_uri="+t.facebook.redirectUrl+"/api/oauth/connectorredirect&scope=manage_pages,publish_pages,pages_show_list,publish_actions,user_managed_groups&state="+e.value+"' + \n            '&response_type=code"})}},{key:"getGoogleUrl",value:function(e){return this.props.oauth.data.map(function(e){return e.google}).map(function(t){return pt.c+"?client_id="+t.clientId+"&access_type=offline&redirect_uri="+t.redirectUrl+"/api/oauth/connectorredirect&response_type=code&state="+e.value+"&prompt=consent&scope=https://www.googleapis.com/auth/gmail.readonly https://www.googleapis.com/auth/gmail.compose https://www.googleapis.com/auth/gmail.insert https://www.googleapis.com/auth/gmail.send https://www.googleapis.com/auth/gmail.labels profile email"})}},{key:"getLinkedInUrl",value:function(e){return this.props.oauth.data.map(function(e){return e.linkedIn}).map(function(t){return decodeURI(pt.d+"?client_id="+t.clientId+"&redirect_uri="+t.redirectUrl+"/api/oauth/connectorredirect&scope=r_fullprofile r_emailaddress rw_company_admin&state="+e.value+"&response_type=code")})}},{key:"openOauthWindow",value:function(e){var t=this,n=Math.min(window.innerHeight-100,500),r=Math.min(window.innerWidth-100,800),a=(window.innerWidth-r)/2,i=(window.innerHeight-n)/2;Object(L.toOption)(window.open(e,"_blank","toolbar=yes,scrollbars=yes,resizable=yes,top="+i+",left="+a+",width="+r+",height="+n)).foreach(function(e){t.addOauthWindowMessageListener(e)})}},{key:"addOauthWindowMessageListener",value:function(e){var t=this;window.addEventListener("message",function n(r){r.data.data.error?(e.close(),t.props.dispatch(Object(H.h)(t.props.i18n.t("Ошибка при активации соединения!")))):(e.close(),t.props.organisation.organisationId.foreach(function(e){t.props.dispatch(Object(Re.b)(e))})),window.removeEventListener("message",n)})}},{key:"getXeroAppType",value:function(e){if(e.xeroType===F.XeroAppTypePrivateApp.$Type.value)return new F.XeroAppTypePrivateApp(e.xeroPrivateConfig,new F.Id(e.xeroPrivateKeyFileId),e.xeroPrivateWebHookKey);if(e.xeroType===F.XeroAppTypePublicApp.$Type.value)return new F.XeroAppTypePublicApp;throw"unknown xero app type"}},{key:"getConnector",value:function(e,t){switch(e){case F.FacebookPagesApp.$Type.value:return new F.FacebookPagesApp;case F.LinkedInApp.$Type.value:return new F.LinkedInApp;case F.GoogleApp.$Type.value:return new F.GoogleApp;case F.XeroApp.$Type.value:return new F.XeroApp(this.getXeroAppType(t));default:throw"unknown connector type"}}},{key:"onCreateSave",value:function(e,t){var n=this;return new Promise(function(r,a){return n.props.organisation.organisationId.map(function(i){Object(dt.b)(new F.SocialConnection(e.name,i,n.getConnector(e.connectorType,e),!1)).then(function(e){r(e),n.props.dispatch(Object(Re.b)(i)),n.props.dispatch(Object(H.h)(n.props.i18n.t("Конфигурации соединения успешно создана!"))),n.props.handleDialogClose(t)}).catch(function(e){a(e)})}).getOrElse(function(){return a()})}).catch(function(e){return n.props.dispatch(Object(de.a)(e))})}},{key:"onCreateRequested",value:function(){var e=this,t=void 0,n=this.props.openDialog(this.props.i18n.t("Создание профиля соединения"),f.createElement(ut,{ref:function(e){return t=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(t){return e.onCreateSave(t,n)}}),[f.createElement(_.a,{key:"close",variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(n)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{key:"save",variant:"raised",color:"primary",onClick:function(){return t.map(function(e){return e.submit()})}},this.props.i18n.t("Сохранить"))])}},{key:"getConnectorProfiles",value:function(e){switch(e.tpe.value){case F.FacebookPagesApp.$Type.value:return e.pages.concat(e.groups);case F.LinkedInApp.$Type.value:return e.companies;case F.GoogleApp.$Type.value:case F.XeroApp.$Type.value:return[];default:throw"unknown connector type"}}},{key:"onEditSave",value:function(e,t,n){var r=this;return Object(dt.e)(j(t,{entity:{name:{$set:e.name},connector:{$set:this.getConnector(e.connectorType,e)}}})).then(function(e){r.props.organisation.organisationId.foreach(function(e){r.props.dispatch(Object(Re.b)(e)),r.props.dispatch(Object(H.h)(r.props.i18n.t("Изменения в конфигурации соединения успешно сохранены!"))),r.props.handleDialogClose(n)})}).catch(function(e){r.props.dispatch(Object(de.a)(e))})}},{key:"onEditRequest",value:function(e){var t=this,n=void 0,r=this.props.openDialog(this.props.i18n.t("Редактирование конфигурации соединения"),f.createElement(ut,{ref:function(e){return n=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},onSubmit:function(n){return t.onEditSave(n,e,r)},initialValues:Object.assign({name:e.entity.name,connectionId:e.id.value,connectorProfiles:this.getConnectorProfiles(e.entity.connector),connectorType:e.entity.connector.tpe.value,isLogged:e.entity.isLogged},e.entity.connector instanceof F.XeroApp?Object.assign({xeroType:e.entity.connector.appType.tpe.value},e.entity.connector.appType instanceof F.XeroAppTypePrivateApp?{xeroPrivateConfig:e.entity.connector.appType.config,xeroPrivateKeyFileId:e.entity.connector.appType.privateKeyFile.value,xeroPrivateWebHookKey:e.entity.connector.appType.webhookKey}:{}):{})}),[f.createElement(_.a,{key:"close",variant:"raised",style:{marginRight:"10px"},onClick:function(){return t.props.handleDialogClose(r)}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{key:"save",variant:"raised",color:"primary",onClick:function(){return n.map(function(e){return e.submit()})}},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteClick",value:function(e,t){var n=this;Object(dt.c)(e.id).then(function(){n.props.organisation.organisationId.foreach(function(e){n.props.dispatch(Object(Re.b)(e)),n.props.dispatch(Object(H.h)(n.props.i18n.t("Конфигурация успешно удалёна"))),n.props.handleDialogClose(t)})}).catch(function(e){n.props.dispatch(Object(de.a)(e))})}},{key:"onDeleteRequested",value:function(e){var t=this,n=this.props.openDialog(this.props.i18n.t("Удаление конфигурации соединения"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить конфигурацию соединения, это действие нельзя будет отменить?")),[f.createElement(_.a,{key:"close",variant:"raised",style:{marginRight:"10px"},onClick:function(){return t.props.handleDialogClose(n)}},this.props.i18n.t("Нет")),f.createElement(_.a,{key:"save",variant:"raised",color:"primary",onClick:function(){return t.onDeleteClick(e,n)}},this.props.i18n.t("Да"))])}},{key:"onConnectionActivateClick",value:function(e){var t=this;switch(e.entity.connector.tpe.value){case F.FacebookPagesApp.$Type.value:this.getFacebookUrl(e.id).foreach(function(e){t.openOauthWindow(e)});break;case F.LinkedInApp.$Type.value:this.getLinkedInUrl(e.id).foreach(function(e){t.openOauthWindow(e)});break;case F.GoogleApp.$Type.value:this.getGoogleUrl(e.id).foreach(function(e){t.openOauthWindow(e)});break;default:throw"unknown connector type"}}},{key:"onConnectionDeactivateClick",value:function(e){}},{key:"getStatusElement",value:function(e){var t=this;return e.entity.connector instanceof F.XeroApp?null:e.entity.isLogged?f.createElement("div",null,this.props.i18n.t("Активно")+" (",f.createElement("a",{href:"#",onClick:function(n){n.preventDefault(),n.stopPropagation(),t.onConnectionDeactivateClick(e)}},this.props.i18n.t("деактивировать")),")"):f.createElement("div",null,this.props.i18n.t("Неактивно")+" (",f.createElement("a",{href:"#",onClick:function(n){n.preventDefault(),n.stopPropagation(),t.onConnectionActivateClick(e)}},this.props.i18n.t("активировать")),")")}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"OrganisationSettingsSocialConnections",style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Добавить"))),f.createElement(q.a,{showId:!0,error:this.props.socialConnections.error,fetching:this.props.socialConnections.fetching,onRecordSelected:function(){},empty:!this.props.socialConnections.fetching&&0===this.props.socialConnections.list.length,withActions:!0,headers:[{id:"socialConnectionName",title:this.props.i18n.t("Название")},{id:"socialConnectionStatus",title:this.props.i18n.t("Статус")}],rows:this.props.socialConnections.list.map(function(t,n){return{id:t.id.value,payload:t,fields:[t.entity.name,e.getStatusElement(t)],buttons:[f.createElement(S.a,{key:"edit",style:fe.f,onClick:function(n){n.stopPropagation(),e.onEditRequest(t)}},f.createElement(Te.a,{style:fe.g})),f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},f.createElement(A.a,{style:fe.g}))]}})}))}}]),t}(f.Component);ht=ft([h.autobind],ht);var mt,gt=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation,socialConnections:e.socialConnections,oauth:e.oauth}})(Object(v.a)(function(e){e.isTokenChecked&&(e.organisation.organisationId.foreach(function(t){e.dispatch(Object(Re.b)(t))}),e.oauth.data.isEmpty()&&e.dispatch(Object(pt.b)()))},function(){},function(e,t){!e.oauth.fetching&&e.oauth.error.isEmpty()&&e.oauth.data.isEmpty()&&e.dispatch(Object(pt.b)()),e.oauth.data.isEmpty()&&e.isTokenChecked&&!t.isTokenChecked&&e.dispatch(Object(pt.b)()),Object(L.isEqual)(e.organisation.organisationId,t.organisation.organisationId)||e.organisation.organisationId.foreach(function(t){e.dispatch(Object(Re.a)(t))}),Object(L.isEqual)(e.organisation.organisationId,t.organisation.organisationId)&&e.isTokenChecked&&!t.isTokenChecked&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(Re.a)(t))})})(Object(qe.a)(ht))),vt=n(2004),yt=n(293),bt=n.n(yt),Ot=n(38),Et=n.n(Ot),Ct=n(163),jt=n.n(Ct),kt=n(47),Tt=n.n(kt),wt=n(1846),Pt=n.n(wt),St=n(1847),It=n.n(St),_t=n(98),Dt=n.n(_t),xt=n(52),Rt=n.n(xt),Nt=n(557),Ft=n(107),Lt=n.n(Ft),$t=n(538),Mt=n.n($t),At=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"getStyle",value:function(){return{backgroundColor:this.props.color}}},{key:"render",value:function(){return f.createElement(Mt.a,Object.assign({},this.props,{className:Tt()(this.props.className,this.props.classes.root),style:this.getStyle()}))}}]),t}(f.PureComponent),Wt=Et()(function(e){return{root:{borderColor:e.palette.grey[300],borderStyle:"solid",borderWidth:1}}})(At),Ut=n(105),qt=n(23),Ht={vertical:"bottom",horizontal:"left"},zt=function(e){function t(){a()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleClick=function(t){e.props.openPopover(Object(qt.toOption)(t.currentTarget),f.createElement(Nt.SketchPicker,{color:e.props.value,onChangeComplete:e.handleChange}),void 0,void 0,Ht)},e.handleClose=function(){e.props.closePopover()},e.handleChange=function(t){var n="rgba("+t.rgb.r+", "+t.rgb.g+", "+t.rgb.b+", "+t.rgb.a+")";e.props.onChange(e.props.name,n)},e}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props.classes;return f.createElement(f.Fragment,null,f.createElement(Lt.a,{button:!0,onClick:this.handleClick},f.createElement(Wt,{className:e.avatar,color:this.props.value}),f.createElement(De.a,{primary:this.props.label})))}}]),t}(f.Component),Kt=Et()(function(){return{avatar:{height:25,width:25}}})(Object(Ut.a)(zt)),Vt=n(407),Bt=function(e){function t(){a()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleChange=function(t,n){var r;e.props.onChange(e.props.name,Object.assign({},e.props.palette,T()({},t,n),"main"===t?(r={},T()(r,"light",Object(Vt.a)(Object(Vt.d)(n),50)),T()(r,"dark",Object(Vt.a)(Object(Vt.d)(n),-50)),r):{}))},e}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.palette,a=t.rootClassName,i=t.label,o=t.fields;return f.createElement(Pt.a,{className:Tt()(a,n.root)},f.createElement(It.a,null,f.createElement(Rt.a,{className:n.title,color:"textSecondary"},i)),f.createElement(Dt.a,{dense:!0},o.map(function(t){return f.createElement(Kt,{key:t.name,label:t.label,name:t.name,onChange:e.handleChange,value:r[t.name]})})))}}]),t}(f.PureComponent),Gt=Et()(function(e){return{root:{paddingBottom:e.spacing.unit},title:{fontSize:14}}})(Bt),Xt={common:[{label:"Black",name:"black"},{label:"White",name:"white"}],background:[{label:"Paper",name:"paper"},{label:"Default",name:"default"}],primary:[{label:"Main",name:"main"},{label:"Light",name:"light"},{label:"Dark",name:"dark"},{label:"Contrast text",name:"contrastText"}],secondary:[{label:"Main",name:"main"},{label:"Light",name:"light"},{label:"Dark",name:"dark"},{label:"Contrast text",name:"contrastText"}],error:[{label:"Main",name:"main"},{label:"Light",name:"light"},{label:"Dark",name:"dark"},{label:"Contrast text",name:"contrastText"}],text:[{label:"Primary",name:"primary"},{label:"Secondary",name:"secondary"},{label:"Disabled",name:"disabled"},{label:"Hint",name:"hint"}]},Yt=function(e){function t(){a()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleChangePalette=function(t,n){e.props.onChange(Object.assign({},e.props.theme,{palette:Object.assign({},e.props.theme.palette,T()({},t,n))}))},e}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.rootClassName;return f.createElement("aside",{className:Tt()(t.root,n)},f.createElement(Gt,{label:"Primary colors",name:"primary",fields:Xt.primary,onChange:this.handleChangePalette,palette:this.props.theme.palette.primary,rootClassName:t.card}),f.createElement(Gt,{label:"Secondary colors",name:"secondary",fields:Xt.secondary,onChange:this.handleChangePalette,palette:this.props.theme.palette.secondary,rootClassName:t.card}),f.createElement(Gt,{label:"Text colors",name:"text",fields:Xt.text,onChange:this.handleChangePalette,palette:this.props.theme.palette.text,rootClassName:t.card}),f.createElement(Gt,{label:"Error colors",name:"error",fields:Xt.error,onChange:this.handleChangePalette,palette:this.props.theme.palette.error,rootClassName:t.card}))}}]),t}(f.PureComponent),Zt=Et()(function(e){return jt()({root:{overflowY:"auto"},card:{margin:e.spacing.unit},logo:{maxWidth:150}})})(Yt),Jt=n(551),Qt=n.n(Jt),en=n(441),tn=n.n(en),nn=n(218),rn=n.n(nn),an=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props.classes;return f.createElement("div",{className:e.root},f.createElement(tn.a,{className:e.item,position:"relative",color:"default"},f.createElement(rn.a,null,f.createElement(Rt.a,{variant:"title",color:"inherit"},"Default App Bar"))),f.createElement(tn.a,{className:e.item,position:"relative",color:"primary"},f.createElement(rn.a,null,f.createElement(Rt.a,{variant:"title",color:"inherit"},"Primary App Bar"))),f.createElement(tn.a,{className:e.item,position:"relative",color:"secondary"},f.createElement(rn.a,null,f.createElement(Rt.a,{variant:"title",color:"inherit"},"Secondary App Bar"))))}}]),t}(f.PureComponent),on=Et()(function(e){return{root:{padding:e.spacing.unit},item:{marginBottom:e.spacing.unit}}})(an),ln=n(674),sn=n.n(ln),cn=n(2641),un=n.n(cn),pn=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props.classes;return f.createElement("div",{className:e.root},f.createElement(sn.a,{className:e.margin,badgeContent:4,color:"primary"},f.createElement(un.a,null)),f.createElement(sn.a,{className:e.margin,badgeContent:10,color:"secondary"},f.createElement(un.a,null)),f.createElement(sn.a,{className:e.margin,badgeContent:42,color:"error"},f.createElement(un.a,null)))}}]),t}(f.PureComponent),dn=Et()(function(e){return{root:{padding:e.spacing.unit},margin:{margin:e.spacing.unit}}})(pn),fn=n(2010),hn=n.n(fn),mn=n(2011),gn=n.n(mn),vn=n(2644),yn=n.n(vn),bn=n(797),On=n.n(bn),En=n(2645),Cn=n.n(En),jn=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props.classes;return f.createElement("div",{className:e.root},f.createElement(hn.a,{className:e.item,showLabels:!0,value:0},f.createElement(gn.a,{label:"Recents",icon:f.createElement(yn.a,null)}),f.createElement(gn.a,{label:"Favorites",icon:f.createElement(On.a,null)}),f.createElement(gn.a,{label:"Nearby",icon:f.createElement(Cn.a,null)})))}}]),t}(f.PureComponent),kn=Et()(function(e){return{root:{padding:e.spacing.unit},item:{maxWidth:500}}})(jn),Tn=n(265),wn=n.n(Tn),Pn=n(2646),Sn=n.n(Pn),In=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props.classes;return f.createElement(f.Fragment,null,f.createElement("div",{className:e.root},f.createElement(_.a,{className:e.button},"Default"),f.createElement(_.a,{color:"primary",className:e.button},"Primary"),f.createElement(_.a,{color:"secondary",className:e.button},"Secondary"),f.createElement(_.a,{disabled:!0,className:e.button},"Disabled"),f.createElement(_.a,{href:"#text-buttons",className:e.button},"Link")),f.createElement("div",{className:e.root},f.createElement(_.a,{className:e.button,variant:"outlined"},"Default"),f.createElement(_.a,{color:"primary",className:e.button,variant:"outlined"},"Primary"),f.createElement(_.a,{color:"secondary",className:e.button,variant:"outlined"},"Secondary"),f.createElement(_.a,{disabled:!0,className:e.button,variant:"outlined"},"Disabled"),f.createElement(_.a,{href:"#text-buttons",className:e.button,variant:"outlined"},"Link")),f.createElement("div",{className:e.root},f.createElement(_.a,{className:e.button,variant:"contained"},"Default"),f.createElement(_.a,{color:"primary",className:e.button,variant:"contained"},"Primary"),f.createElement(_.a,{color:"secondary",className:e.button,variant:"contained"},"Secondary"),f.createElement(_.a,{disabled:!0,className:e.button,variant:"contained"},"Disabled"),f.createElement(_.a,{href:"#text-buttons",className:e.button,variant:"contained"},"Link")),f.createElement("div",{className:e.root},f.createElement(_.a,{color:"primary",className:e.button,variant:"fab"},f.createElement(wn.a,null)),f.createElement(_.a,{color:"secondary",className:e.button,variant:"fab"},f.createElement(A.a,null)),f.createElement(_.a,{disabled:!0,className:e.button,variant:"fab"},f.createElement(Sn.a,null)),f.createElement(_.a,{href:"#text-buttons",className:e.button,variant:"fab"},"Link")))}}]),t}(f.PureComponent),_n=Et()(function(e){return{root:{padding:e.spacing.unit},button:{margin:e.spacing.unit}}})(In),Dn=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props.classes;return f.createElement(C.a,{className:e.root},f.createElement(on,null),f.createElement(dn,null),f.createElement(kn,null),f.createElement(_n,null))}}]),t}(f.PureComponent),xn=Et()(function(e){return{root:{backgroundColor:e.palette.background.default,flex:1}}})(Dn),Rn=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){return f.createElement(Qt.a,{theme:this.props.theme},f.createElement(xn,null))}}]),t}(f.PureComponent),Nn=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props.classes;return f.createElement("section",{className:e.root},f.createElement(Rn,{theme:this.props.theme}))}}]),t}(f.PureComponent),Fn=Et()(function(e){return jt()({root:{display:"flex",flex:3,flexDirection:"column"}})})(Nn),Ln=j(bt()(),{palette:{$merge:fe.d}}),$n=function(e){function t(){a()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={theme:e.props.organisationTheme.isEmpty()?Ln:e.getMuiThemeWithOrgPalette()},e.handleChangeTheme=function(t){return e.setState({theme:t})},e.handleOrganisationThemeEnable=function(t,n){return e.props.handleOrganisationThemeEnable(n,e.state.theme)},e.handleOrganisationThemeApply=function(){return e.props.handleOrganisationThemeApply(e.state.theme)},e.handleOrganisationThemeReset=function(){return e.setState({theme:bt()(fe.i)})},e}return u()(t,e),o()(t,[{key:"getMuiThemeWithOrgPalette",value:function(){return this.props.organisationTheme.map(function(e){return j(Ln,{palette:{$merge:JSON.parse(e).palette}})}).getOrElse(function(){return Ln})}},{key:"render",value:function(){var e=this.props.classes;return f.createElement(f.Fragment,null,f.createElement(U.b,{leftButtonGroup:[f.createElement(Ie.a,{key:"org-style-checkbox",label:this.props.i18n.t("Включить стиль организации"),control:f.createElement(be.a,{checked:this.props.organisationThemeEnabled,onChange:this.handleOrganisationThemeEnable})}),f.createElement(_.a,{key:"reset-style",color:"secondary",variant:"contained",onClick:this.handleOrganisationThemeReset,disabled:!this.props.organisationThemeEnabled,style:{marginTop:0,marginRight:15}},this.props.i18n.t("Сбросить тему")),f.createElement(_.a,{key:"apply-current-style",color:"primary",variant:"contained",onClick:this.handleOrganisationThemeApply,disabled:!this.props.organisationThemeEnabled,style:{marginTop:0}},this.props.i18n.t("Применить текущий стиль"))]}),f.createElement("main",{className:e.root},f.createElement(Zt,{rootClassName:e.edition,onChange:this.handleChangeTheme,theme:this.state.theme}),f.createElement(Fn,{theme:this.state.theme,i18n:this.props.i18n})))}}]),t}(f.Component),Mn=Et()(function(e){return jt()({root:{backgroundColor:e.palette.background.default,display:"flex",flex:1,flexDirection:"row"},edition:{minWidth:250,maxWidth:350,flex:2},button:{position:"fixed",bottom:2*e.spacing.unit,right:2*e.spacing.unit}})})($n),An=n(547),Wn=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e[e.THEME_COLORS=0]="THEME_COLORS",e[e.ADDITIONAL_COLORS=1]="ADDITIONAL_COLORS"}(mt||(mt={}));var Un={vertical:"bottom",horizontal:"left"},qn=function(e){function t(){a()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={selectedIndex:mt.THEME_COLORS,value:"",colors:e.props.colors},e.openColorPicker=function(t,n){e.props.openPopover(Object(qt.toOption)(t.currentTarget),f.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},f.createElement(Nt.SketchPicker,{color:e.state.value,onChangeComplete:function(t){return e.handleChange(t,n)}}),f.createElement(S.a,{style:fe.f,onClick:function(){return e.onColorRemove(n)}},f.createElement(A.a,{style:fe.g}))),void 0,void 0,Un)},e.handleClose=function(){e.props.closePopover()},e.handleChange=function(t,n){var r="rgba("+t.rgb.r+", "+t.rgb.g+", "+t.rgb.b+", "+t.rgb.a+")";e.setState(j(e.state,{colors:{$splice:[[n,1,r]]}}))},e.handleAddColor=function(){e.setState(j(e.state,{colors:{$push:["#ccc"]}}))},e.onColorRemove=function(t){e.setState(j(e.state,{colors:{$splice:[[t,1]]}})),e.props.closePopover()},e.handleDaveClick=function(){e.props.handleOrganisationAdditionalColorsSave(e.state.colors)},e}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this;return f.createElement(f.Fragment,null,f.createElement(U.b,{leftButtonGroup:[f.createElement(_.a,{key:"save",variant:"contained",color:"primary",onClick:this.handleDaveClick},this.props.i18n.t("Сохранить"))]}),f.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",padding:15}},this.state.colors.map(function(t,n){return f.createElement("div",{key:t+n,style:{padding:5},onClick:function(t){return e.openColorPicker(t,n)}},f.createElement(Wt,{color:t,className:""}))}),f.createElement(S.a,{onClick:this.handleAddColor},f.createElement(wn.a,null))))}}]),t}(f.Component);qn=Wn([h.autobind],qn);var Hn,zn=Object(Ut.a)(qn),Kn=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e[e.THEME_COLORS=0]="THEME_COLORS",e[e.ADDITIONAL_COLORS=1]="ADDITIONAL_COLORS"}(Hn||(Hn={}));var Vn=function(e){function t(){a()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={selectedIndex:Hn.THEME_COLORS},e}return u()(t,e),o()(t,[{key:"onSelected",value:function(e){this.setState(j(this.state,{selectedIndex:{$set:e}}))}},{key:"updateOrganisationSettings",value:function(e){var t=this;this.props.organisation.data.map(function(n){return Object(b.i)(n.id,n.entity.name,n.entity.payment,n.entity.currency,n.entity.logo,n.entity.httpTimeout,n.entity.zoneId.map(function(e){return F.TimeZone.convertToTimeZone(e)}),e).then(function(e){t.props.dispatch(Object(H.h)(t.props.i18n.t("Успешно сохранено"))),t.props.dispatch(Object(b.g)()),t.props.dispatch(Object(b.f)(n.id)),t.props.dispatch(Object(An.b)())}).catch(function(e){t.props.dispatch(Object(H.h)(t.props.i18n.t("Ошибка во время сохранения")))})}).getOrElse(function(){throw new Error("Trying to update not loaded data")})}},{key:"getMuiThemePalette",value:function(e){var t=Object(vt.default)(e.palette,["augmentColor","getContrastText"]);return Object(qt.toOption)(JSON.stringify({palette:t}))}},{key:"handleOrganisationThemeEnable",value:function(e,t){var n=this;this.props.organisation.data.foreach(function(r){var a=n.getMuiThemePalette(t),i=new F.OptionalValue(e,a),o=Object(qt.toOption)(r.entity.uiConfig.map(function(e){return j(e,{muiTheme:{$set:i}})}).getOrElse(function(){return new F.OrganisationUIConfig(i)}));n.updateOrganisationSettings(o),n.setSessionStorageMuiTheme(i)})}},{key:"handleOrganisationThemeApply",value:function(e){var t=this;this.props.organisation.data.foreach(function(n){var r=t.getMuiThemePalette(e),a=new F.OptionalValue(!0,r),i=Object(qt.toOption)(n.entity.uiConfig.map(function(e){return j(e,{muiTheme:{$set:a}})}).getOrElse(function(){return new F.OrganisationUIConfig(a)}));t.updateOrganisationSettings(i),t.setSessionStorageMuiTheme(a)})}},{key:"setSessionStorageMuiTheme",value:function(e){this.props.organisation.organisationId.foreach(function(t){e.value.foreach(function(n){return Object(qt.toOption)(sessionStorage.getItem("platform5_mui_themes_map")).matchWith(function(e){return Object.assign({},JSON.parse(e),T()({},t.value,JSON.parse(n)))},function(){return T()({},t.value,e)}).foreach(function(e){sessionStorage.setItem("platform5_mui_themes_map",JSON.stringify(e))})})})}},{key:"handleOrganisationAdditionalColorsSave",value:function(e){var t=this;this.props.organisation.data.foreach(function(n){var r=n.entity.uiConfig.map(function(e){return e.muiTheme.enabled}).getOrElse(function(){return!1}),a=n.entity.uiConfig.flatMap(function(e){return e.muiTheme.value}),i=new F.OptionalValue(r,a),o=Object(qt.toOption)(n.entity.uiConfig.map(function(t){return j(t,{colors:{$set:e}})}).getOrElse(function(){return new F.OrganisationUIConfig(i,e)}));t.updateOrganisationSettings(o)})}},{key:"renderTabContents",value:function(){var e=this.props.organisation.data.flatMap(function(e){return e.entity.uiConfig.flatMap(function(e){return e.muiTheme.value})}),t=this.props.organisation.data.flatMap(function(e){return e.entity.uiConfig.map(function(e){return e.colors})}).getOrElse(function(){return[]});switch(this.state.selectedIndex){case Hn.THEME_COLORS:var n=this.props.organisation.data.flatMap(function(e){return e.entity.uiConfig.map(function(e){return e.muiTheme.enabled})}).getOrElse(function(){return!1});return f.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},f.createElement(Mn,{i18n:this.props.i18n,organisationTheme:e,organisationThemeEnabled:n,handleOrganisationThemeEnable:this.handleOrganisationThemeEnable,handleOrganisationThemeApply:this.handleOrganisationThemeApply}));case Hn.ADDITIONAL_COLORS:return f.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},f.createElement(zn,{i18n:this.props.i18n,colors:t,handleOrganisationAdditionalColorsSave:this.handleOrganisationAdditionalColorsSave}));default:return f.createElement("div",null,"unknown content")}}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},f.createElement(N.a,{value:this.state.selectedIndex,onChange:function(t,n){return e.onSelected(n)},indicatorColor:"primary",textColor:"primary",fullWidth:!0,centered:!0},f.createElement(x.a,{value:Hn.THEME_COLORS,label:this.props.i18n.t("Цветовая тема")}),f.createElement(x.a,{value:Hn.ADDITIONAL_COLORS,label:this.props.i18n.t("Дополнительные цвета")})),this.renderTabContents())}}]),t}(f.Component);Vn=Kn([h.autobind],Vn);var Bn=Object(m.connect)(function(e,t){return{i18n:e.i18n,organisation:e.organisation}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Vn),Gn=n(2117),Xn=n(1488),Yn=n(1487),Zn=n(2101),Jn=n(2114),Qn=n(650),er=n(543),tr=n.n(er),nr=n(553),rr=n(79),ar=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ir=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,t=e.fields.name,n=e.handleSubmit;return f.createElement("form",{onSubmit:n},f.createElement(re.a,Object.assign({},t,{fullWidth:!0,label:this.props.i18n.t("Имя"),autoComplete:"off",autoFocus:!0})),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Привязка к проекту")),f.createElement(B.a,{fullWidth:!0,value:this.props.fields.linkedEventLineId.value,onChange:this.props.fields.linkedEventLineId.onChange},f.createElement(X.a,{value:""}),this.props.eventLines.list.map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)}))))}}]),t}(f.Component);ir=ar([h.autobind],ir);var or=Object(m.connect)(function(e){return{i18n:e.i18n,user:e.user,eventLines:e.eventLines}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(K.reduxForm)({form:"userForm",fields:["name","permissions","linkedEventLineId"]})(ir)),lr=n(1775),sr=n(649),cr=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ur=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pr=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u()(t,e),o()(t,[{key:"openEditForm",value:function(e,t,n){var r=this,a=void 0;this.props.openDialog(e,f.createElement(or,{ref:function(e){return a=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},initialValues:n,onSubmit:t}),[f.createElement(_.a,{variant:"raised",onClick:function(){return r.props.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return a.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"defaultValues",value:function(){return{name:"",permissions:[]}}},{key:"onCreateRequest",value:function(){var e=this;this.props.organisation.organisationId.foreach(function(t){e.openEditForm(e.props.i18n.t("Новая роль"),function(n){return Object(nr.a)(new F.Role(n.name,t,Array(),F.defaultMainPageConfig,void 0,""===n.linkedEventLineId?new L.None:F.Id.createId(n.linkedEventLineId))).then(function(t){e.props.dispatch(Object(H.h)(e.props.i18n.t("Роль добавлена!"))),e.props.handleDialogClose(!1),e.props.dispatch(Object(sr.c)())}).catch(function(t){e.props.dispatch(Object(de.a)(t))})},e.defaultValues())})}},{key:"onEditRequest",value:function(e){this.props.dispatch(Object(rr.wb)(new F.Id(e.id.toString())))}},{key:"onDeleteRequest",value:function(e){var t=this,n=this.props.i18n;this.props.openDialog(n.t("Удаление роли"),f.createElement("div",null,n.t("Вы действительно хотите удалить роль")," ",f.createElement("strong",null,e.name),"? ",n.t("Это действие нельзя будет отменить"),"."),[f.createElement(_.a,{variant:"raised",onClick:function(){t.props.handleDialogClose(!0)},style:{marginRight:"10px"}},n.t("Нет")),f.createElement(_.a,{variant:"raised",onClick:function(){Object(nr.b)(new F.Id(e.id.toString())).then(function(e){t.props.dispatch(Object(H.h)(t.props.i18n.t("Роль удалена!"))),t.props.handleDialogClose(!1),t.props.dispatch(Object(sr.c)())}).catch(function(e){t.props.dispatch(Object(de.a)(e))})}},n.t("Да"))])}},{key:"onCopyRequest",value:function(e){var t=this;F.Id.createId(e.id).foreach(function(e){t.props.dispatch(Object(lr.b)(e)).then(function(e){return Object(nr.a)(j(e.entity,{name:{$set:e.entity.name+" COPY"}})).then(function(e){t.props.dispatch(Object(H.h)(t.props.i18n.t("Успешно скопировано"))),t.props.handleDialogClose(!1),t.props.dispatch(Object(sr.c)())}).catch(function(e){t.props.dispatch(Object(de.a)(e))})})})}},{key:"getLinkedEventName",value:function(e){var t=this;return e.flatMap(function(e){return Object(L.headOption)(t.props.eventLines.list.filter(function(t){return t.id.value===e.toString()})).map(function(e){return e.entity.name})}).getOrElse(function(){return"-"})}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onCreateRequest,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(q.a,{showId:!0,error:this.props.roles.descriptionsError,fetching:this.props.roles.descriptionsFetching,onRecordSelected:this.onEditRequest,empty:!this.props.roles.descriptionsFetching&&0==this.props.roles.descriptionsList.length,withActions:!0,columnIndexSort:1,headers:[{id:"name",title:this.props.i18n.t("Название")},{id:"eventLineId",title:this.props.i18n.t("Привязка к проекту")}],rows:this.props.roles.descriptionsList.sort(function(e,t){return Number.parseInt(e.id)-Number.parseInt(t.id)}).map(function(t){return{id:t.id.toString(),payload:t,fields:[t.name,e.getLinkedEventName(t.linkedEvent)],buttons:[f.createElement(S.a,{key:"edit",style:fe.f,onClick:function(n){n.stopPropagation(),e.onEditRequest(t)}},f.createElement(tr.a,{style:fe.g})),f.createElement(S.a,{key:"copy",style:fe.f,onClick:function(n){n.stopPropagation(),e.onCopyRequest(t)}},f.createElement(Qn.a,{style:fe.g})),f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequest(t)}},f.createElement(A.a,{style:fe.g}))]}})}))}}]),t}(f.Component);pr=cr([h.autobind,ur("design:paramtypes",[Object])],pr);var dr=Object(m.connect)(function(e){return{roles:e.roles,organisation:e.organisation,i18n:e.i18n,eventLines:e.eventLines}})(pr),fr=n(65),hr=n.n(fr),mr=n(43),gr=n.n(mr),vr=n(160),yr=n.n(vr),br=n(241),Or=n.n(br),Er=n(243),Cr=n.n(Er),jr=n(242),kr=n.n(jr),Tr=n(261),wr=n.n(Tr),Pr=n(1519),Sr=n.n(Pr),Ir=n(50),_r=n(1886),Dr=n(104),xr=n(1477),Rr=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Nr=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"scanServerPrinters",value:function(){this.props.dispatch(Object(_r.c)())}},{key:"componentWillReceiveProps",value:function(e){this.props.fields.formId.value!==e.fields.formId.value&&this.props.dispatch(Object(xr.c)(new F.Id(e.fields.formId.value)))}},{key:"getPrinterConfigFields",value:function(e){var t=this.props.i18n,n=this.props.fields.serverPrinterId,r=this.props.fields.deviceId,a=this.props.fields.terminalId;switch(e){case F.PrinterConfigServerDevice.$Type.value:return f.createElement("div",{style:{display:"flex",alignItems:"center"}},f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Принтер")),f.createElement(B.a,{style:{flex:"1 1 auto"},value:n.value,onChange:function(e){return n.onChange(e.target.value)}},this.props.printers.resolved.map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),this.props.printers.fetching&&f.createElement(yr.a,null),!this.props.printers.fetching&&f.createElement(S.a,{onClick:this.scanServerPrinters},f.createElement(Sr.a,null)));case F.PrinterConfigLocalTerminal.$Type.value:return f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Принтер")),f.createElement(B.a,{fullWidth:!0,value:r.value,onChange:function(e){return r.onChange(e.target.value)}},F.PrinterIds.map(function(e){return f.createElement(X.a,{key:e.id,value:e.id},e.id)})));case F.PrinterConfigRemoteTerminal.$Type.value:return f.createElement("div",null,f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Терминал")),f.createElement(B.a,{fullWidth:!0,value:a.value,onChange:function(e){return a.onChange(e.target.value)}},this.props.terminals.list.filter(function(e){return"WEB"!==e.entity.name}).map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Принтер")),f.createElement(B.a,{fullWidth:!0,value:r.value,onChange:function(e){return r.onChange(e.target.value)}},F.PrinterIds.map(function(e){return f.createElement(X.a,{key:e.id,value:e.id},e.id)}))));case F.PrinterConfigEmptyType.$Type.value:return f.createElement("div",null);default:throw"Unknown printer config type"}}},{key:"render",value:function(){var e=this,t=this.props,n=t.i18n,r=t.handleSubmit,a=t.onSubmit,i=t.fields,o=i.printerConfigType,l=(i.terminalId,i.documentId),s=i.formId,c=i.eventLineId,u=Object(L.liftKey)(this.props.formDocuments.fetching,s.value).getOrElse(function(){return!1}),p=Object(L.liftKey)(this.props.formDocuments.list,s.value).getOrElse(function(){return[]});return f.createElement("form",{onSubmit:function(e){e.preventDefault(),r(a)}},f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,n.t("Проект")),f.createElement(B.a,{value:c.value,onChange:function(e){return c.onChange(e.target.value)}},this.props.eventLines.list.map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,n.t("Форма")),f.createElement(B.a,{value:s.value,onChange:function(e){return s.onChange(e.target.value)}},Object(L.headOption)(this.props.eventLines.list.filter(function(e){return e.id.value===c.value})).map(function(t){return Object(Dr.f)(e.props.forms,t.id).filter(function(e){return F.FormType.isForm(e.entity.formType)}).map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)})}).getOrElse(function(){return[]}))),u?f.createElement(yr.a,null):f.createElement("div",null,f.createElement(Q.a,{fullWidth:!0,error:l.touched&&l.error},f.createElement(Z.a,null,n.t("Документ")),f.createElement(B.a,{value:l.value,onChange:l.onChange},p.map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)})),l.touched&&l.error&&f.createElement(te.a,null,l.error)),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,n.t("Расположение принтера")),f.createElement(B.a,{value:o.value||F.PrinterConfigLocalTerminal.$Type.value,onChange:function(e){return o.onChange(e.target.value)}},F.PrinterConfigTypes.map(function(e){return f.createElement(X.a,{key:e.value,value:e.value},Object(Ir.K)(e,n.t))}))),o.value&&this.getPrinterConfigFields(o.value)))}}]),t}(f.Component);Nr=Rr([h.autobind],Nr);var Fr=Object(m.connect)(function(e){return{i18n:e.i18n,terminals:e.terminals,printers:e.printers,formDocuments:e.formDocuments,forms:e.forms,eventLines:e.eventLines}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(K.reduxForm)({form:"documentPrinterForm",fields:["printerConfigType","serverPrinterId","terminalId","deviceId","documentId","formId","eventLineId"],validate:function(e,t){var n={};return e.documentId&&0!==e.documentId.trim().length||(n.documentId=t.i18n.t("Обязательное значение")),n}})(Nr)),Lr=n(1479),$r=n(374),Mr=n(889),Ar=n.n(Mr),Wr=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Ur=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qr=0,Hr=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={selectedIndex:qr,dialog:{open:!1,title:new L.None,body:new L.None,actions:[]},separator:F.FieldsMassCreationSeparatorLineBreak.$Type},n}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(L.headOption)(this.props.terminals.list.filter(function(t){return t.id.value===e.props.fields.terminalId.value})).map(function(e){return e.entity.docPrinters}).getOrElse(function(){return[]}),n=t.map(function(e){return e.docId});this.props.dispatch(Object(xr.d)(n)).then(function(){return e.props.fields.docPrinters.onChange(t)})}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.fields.docPrinters.value,n=e.fields.docPrinters.value;if(t.length!==n.length){var r=n.map(function(e){return e.docId});this.props.dispatch(Object(xr.d)(r))}}},{key:"onSelected",value:function(e){this.setState(j(this.state,{selectedIndex:{$set:e}}))}},{key:"openDialog",value:function(e,t,n){this.setState(j(this.state,{dialog:{open:{$set:!0},title:{$set:new L.Some(e)},body:{$set:new L.Some(t)},actions:{$set:n}}}))}},{key:"handleDialogClose",value:function(){this.setState(j(this.state,{dialog:{open:{$set:!1},title:{$set:new L.None},body:{$set:new L.None},actions:{$set:[]}}}))}},{key:"scanServerPrinters",value:function(){this.props.dispatch(Object(_r.c)())}},{key:"getPrinterConfigFields",value:function(e){var t=this.props.i18n,n=this.props.fields.serverPrinterId,r=this.props.fields.deviceId,a=this.props.fields.terminalId;switch(e){case F.PrinterConfigServerDevice.$Type.value:return f.createElement("div",{style:{display:"flex",alignItems:"center"}},f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Принтер")),f.createElement(B.a,{style:{flex:"1 1 auto"},value:n.value,onChange:function(e){return n.onChange(e.target.value)}},this.props.printers.resolved.map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),this.props.printers.fetching&&f.createElement(yr.a,null),!this.props.printers.fetching&&f.createElement(S.a,{onClick:this.scanServerPrinters},f.createElement(Sr.a,null)));case F.PrinterConfigLocalTerminal.$Type.value:return f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Принтер")),f.createElement(B.a,{fullWidth:!0,value:r.value,onChange:function(e){return r.onChange(e.target.value)}},F.PrinterIds.map(function(e){return f.createElement(X.a,{key:e.id,value:e.id},e.id)})));case F.PrinterConfigRemoteTerminal.$Type.value:return f.createElement("div",null,f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Терминал")),f.createElement(B.a,{fullWidth:!0,value:a.value,onChange:function(e){return a.onChange(e.target.value)}},this.props.terminals.list.filter(function(e){return"WEB"!==e.entity.name}).map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Принтер")),f.createElement(B.a,{fullWidth:!0,value:r.value,onChange:function(e){return r.onChange(e.target.value)}},F.PrinterIds.map(function(e){return f.createElement(X.a,{key:e.id,value:e.id},e.id)}))));case F.PrinterConfigEmptyType.$Type.value:return f.createElement("div",null);default:throw"Unknown printer config type"}}},{key:"getPrinterConfig",value:function(e){if(!e.printerConfigType||e.printerConfigType===F.PrinterConfigEmptyType.$Type.value)return new L.None;switch(e.printerConfigType){case F.PrinterConfigServerDevice.$Type.value:return Object(L.toOption)(e.serverPrinterId).map(function(e){return new F.PrinterConfigServerDevice(new F.Id(e))});case F.PrinterConfigLocalTerminal.$Type.value:return Object(L.toOption)(e.deviceId).map(function(e){return new F.PrinterConfigLocalTerminal(new F.PrinterId(e))});case F.PrinterConfigRemoteTerminal.$Type.value:return Object(L.toOption)(e.terminalId).map(function(t){return Object(L.toOption)(e.deviceId).map(function(e){return new F.PrinterConfigRemoteTerminal(new F.Id(t),new F.PrinterId(e))})}).flatMap(function(e){return e});default:return new L.None}}},{key:"getInitialValues",value:function(e){var t={printerConfigType:e.printer.tpe.value,serverPrinterId:"",terminalId:"",deviceId:"",documentId:e.docId.value};switch(e.printer.tpe.value){case F.PrinterConfigServerDevice.$Type.value:return Object.assign({},t,{serverPrinterId:e.printer.id.value});case F.PrinterConfigRemoteTerminal.$Type.value:return Object.assign({},t,{terminalId:e.printer.terminalId.value,deviceId:e.printer.deviceId.id});case F.PrinterConfigLocalTerminal.$Type.value:return Object.assign({},t,{deviceId:e.printer.deviceId.id});case F.PrinterConfigEmptyType.$Type.value:default:return Object.assign({},t)}}},{key:"onPrinterDocumentAddRequest",value:function(){var e=this;this.openEditForm(this.props.i18n.t("Добавить принтер для печати документа"),function(t){return new Promise(function(n,r){var a=e.props.fields;a.docPrinters.onChange([].concat(gr()(a.docPrinters.value),[new F.DocumentPrinter(new F.Id(t.documentId),e.getPrinterConfig(t).getOrElse(function(){return new F.PrinterConfigEmptyType}))])),e.handleDialogClose(),n()})})}},{key:"openEditForm",value:function(e,t,n){var r=this,a=void 0;this.openDialog(e,f.createElement(Fr,{ref:function(e){return a=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},initialValues:n,onSubmit:function(e){return t(e)}}),[f.createElement(_.a,{variant:"raised",onClick:function(){return r.handleDialogClose()},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return a.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onPrinterDocumentEditRequest",value:function(e,t){var n=this;this.openEditForm(this.props.i18n.t("Редактировать принтер для печати документа"),function(e){return new Promise(function(r,a){var i=n.props.fields;i.docPrinters.onChange([].concat(gr()(i.docPrinters.value.slice(0,t)),[new F.DocumentPrinter(new F.Id(e.documentId),n.getPrinterConfig(e).getOrElse(function(){return new F.PrinterConfigEmptyType}))],gr()(i.docPrinters.value.slice(t+1)))),n.handleDialogClose(),r()})},this.getInitialValues(e))}},{key:"onPrinterDocumentDeleteRequest",value:function(e){var t=this.props.fields;t.docPrinters.onChange(t.docPrinters.value.filter(function(t,n){return n!==e}))}},{key:"getPrinterName",value:function(e){switch(e.tpe.value){case F.PrinterConfigServerDevice.$Type.value:return Object(L.headOption)(this.props.printers.resolved.filter(function(t){return t.id.value===e.id.value})).map(function(e){return e.entity.name});case F.PrinterConfigRemoteTerminal.$Type.value:return Object(L.toOption)(Object(L.headOption)(this.props.terminals.list.filter(function(t){return t.id.value===e.terminalId.value})).map(function(e){return e.entity.name}).getOrElse(function(){return"undefined"})+"/"+e.deviceId.id);case F.PrinterConfigLocalTerminal.$Type.value:return Object(L.toOption)(e.deviceId.id);default:return new L.None}}},{key:"getFormName",value:function(e){var t=this;return e.map(function(e){return Object(L.headOption)(t.props.forms.list.filter(function(t){return t.id.value===e.entity.form.value}))}).flatMap(function(e){return e}).map(function(e){return e.entity.name}).getOrElse(function(){return t.props.i18n.t("Текущая форма не найдена")})}},{key:"getProjectName",value:function(e){var t=this;return e.flatMap(function(e){return Object(L.headOption)(t.props.forms.list.filter(function(t){return t.id.value===e.entity.form.value}))}).flatMap(function(e){return Object(L.headOption)(t.props.eventLines.list.filter(function(t){return e.entity.eventLineId.value===t.id.value}))}).map(function(e){return e.entity.name}).getOrElse(function(){return t.props.i18n.t("Текущий проект не найден")})}},{key:"renderPrinterParametres",value:function(){var e=this.props,t=e.i18n,n=e.fields,r=n.printerConfigType,a=n.savePdf;return f.createElement(f.Fragment,null,f.createElement(Ie.a,{label:this.props.i18n.t("Сохранять PDF"),control:f.createElement(be.a,{checked:a.value,onChange:a.onChange})}),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,t.t("Расположение принтера")),f.createElement(B.a,{value:r.value||F.PrinterConfigLocalTerminal.$Type.value,onChange:function(e){return r.onChange(e.target.value)}},f.createElement(X.a,{key:F.PrinterConfigEmptyType.$Type.value,value:F.PrinterConfigEmptyType.$Type.value},t.t("Не указан")),F.PrinterConfigTypes.map(function(e){return f.createElement(X.a,{key:e.value,value:e.value},Object(Ir.K)(e,t.t))}))),r.value&&this.getPrinterConfigFields(r.value))}},{key:"renderTabContents",value:function(){var e=this,t=this.props,n=t.i18n,r=t.fields,a=r.name,i=r.customId,o=r.docPrinters,l=r.eventLineId;switch(this.state.selectedIndex){case qr:return f.createElement("div",null,f.createElement(re.a,{fullWidth:!0,autoFocus:!0,value:a.value,onChange:a.onChange,label:this.props.i18n.t("Название"),error:a.touched&&a.error,helperText:a.touched&&Object(L.toOption)(a.error).map(function(e){return e}).getOrNull()}),f.createElement(re.a,{fullWidth:!0,value:i.value,onChange:i.onChange,label:this.props.i18n.t("Определяемый ID"),error:i.touched&&i.error,helperText:i.touched&&Object(L.toOption)(i.error).map(function(e){return e}).getOrNull()}),f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Привязка к проекту")),f.createElement(B.a,{fullWidth:!0,value:l.value,onChange:l.onChange},f.createElement(X.a,{value:""}),this.props.eventLines.list.map(function(e){return f.createElement(X.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),this.renderPrinterParametres());case 1:return f.createElement("div",null,f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onPrinterDocumentAddRequest,color:"primary"},this.props.i18n.t("Добавить"))),f.createElement(q.a,{showId:!0,fetching:this.props.documents.fetching,onRecordSelected:this.onPrinterDocumentEditRequest,error:new L.None,empty:0===o.value.length,withActions:!0,headers:[{id:"projectName",title:this.props.i18n.t("Проект")},{id:"formName",title:this.props.i18n.t("Форма")},{id:"documentName",title:this.props.i18n.t("Документ")},{id:"printer",title:this.props.i18n.t("Расположение")},{id:"printer",title:this.props.i18n.t("Принтер")}],rows:Array.isArray(o.value)?o.value.map(function(t,r){return{payload:t,id:r.toString(),fields:[e.getProjectName(Object(L.headOption)(e.props.documents.list.filter(function(e){return e.id.value===t.docId.value}))),e.getFormName(Object(L.headOption)(e.props.documents.list.filter(function(e){return e.id.value===t.docId.value}))),Object(L.headOption)(e.props.documents.list.filter(function(e){return e.id.value===t.docId.value})).map(function(e){return e.entity.name}).getOrElse(function(){return"undefined"}),Object(Ir.K)(t.printer.tpe,n.t),e.getPrinterName(t.printer).getOrElse(function(){return"undefined"})],buttons:[f.createElement(S.a,{key:"edit",style:fe.f,onClick:function(n){n.stopPropagation(),e.onPrinterDocumentEditRequest(t,r)}},f.createElement(Te.a,{style:fe.g})),f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(t){t.stopPropagation(),e.onPrinterDocumentDeleteRequest(r)}},f.createElement(A.a,{style:fe.g}))]}}):[]}),f.createElement(Or.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose},f.createElement(wr.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),f.createElement(kr.a,null,this.state.dialog.body.getOrElse(function(){return f.createElement("div",null)})),f.createElement(Cr.a,{style:{borderTop:"none"}},this.state.dialog.actions)));default:return f.createElement("div",null,"unknown content")}}},{key:"getSeparatorSymbol",value:function(e){switch(e){case F.FieldsMassCreationSeparatorComa.$Type:return new L.Some(",");case F.FieldsMassCreationSeparatorSemicolon.$Type:return new L.Some(";");case F.FieldsMassCreationSeparatorLineBreak.$Type:return new L.Some("\n");default:return new L.None}}},{key:"getSeparatorTypeName",value:function(e){switch(e){case F.FieldsMassCreationSeparatorComa.$Type:return new L.Some(this.props.i18n.t("Запятая"));case F.FieldsMassCreationSeparatorSemicolon.$Type:return new L.Some(this.props.i18n.t("Точка с запятой"));case F.FieldsMassCreationSeparatorLineBreak.$Type:return new L.Some(this.props.i18n.t("Перенос строки"));default:return new L.None}}},{key:"handleNameChange",value:function(e){this.props.fields.caption.onChange(e.target.value),this.props.fields.name.onChange(Object($r.a)(e.target.value)),this.separateFieldsInText({caption:e.target})}},{key:"separateFieldsInText",value:function(e){var t=this.getSeparatorSymbol(e.separator||this.state.separator).getOrElse(function(){return""}),n=(e.caption||this.props.fields.caption).value.split(t).filter(function(e){return e.match(/[a-яА-Я0-9]/i)}).map(function(e){return e.trim()}).map(function(e){var t=Object($r.a)(e);if(t)return T()({},e,t)}).filter(function(e){return e});this.props.fields.captionName.onChange(n)}},{key:"onSeparatorSelected",value:function(e){this.setState(j(this.state,{separator:{$set:new L.TypeId(e)}})),this.separateFieldsInText({separator:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.i18n,r=t.handleSubmit,a=t.onSubmit;return this.props.massCreation?f.createElement(f.Fragment,null,f.createElement(Q.a,{fullWidth:!0},f.createElement(Z.a,null,this.props.i18n.t("Разделитель")),f.createElement(B.a,{onChange:function(t){return e.onSeparatorSelected(t.target.value)},value:this.state.separator.value,style:{width:"98%"}},F.FieldsMassCreationSeparators.map(function(t,n){return f.createElement(X.a,{key:n,value:t.value},e.getSeparatorTypeName(t).getOrElse(function(){return""}))}))),f.createElement(Q.a,{fullWidth:!0},f.createElement(re.a,{label:this.props.i18n.t("Список полей"),rows:4,error:this.props.fields.caption.touched&&this.props.fields.caption.error,value:this.props.fields.caption.value,onChange:function(t){return e.handleNameChange(t)},fullWidth:!0,multiline:!0}),Object(L.toOption)(this.props.fields.caption.error).map(function(e){return f.createElement(Ar.a,null,e)}).getOrNull()),this.renderPrinterParametres()):f.createElement("form",{onSubmit:function(e){e.preventDefault(),r(a)}},f.createElement(N.a,{centered:!0,onChange:function(t,n){return e.onSelected(n)},value:this.state.selectedIndex,indicatorColor:"primary",textColor:"primary",fullWidth:!0},f.createElement(x.a,{value:qr,label:n.t("Настройки терминала")}),f.createElement(x.a,{value:1,label:n.t("Печать документов")})),f.createElement(Lr.a,null,this.renderTabContents()))}}]),t}(f.Component);Hr=Wr([h.autobind,Ur("design:paramtypes",[Object])],Hr);var zr=Object(m.connect)(function(e){return{i18n:e.i18n,terminals:e.terminals,printers:e.printers,documents:e.documents,forms:e.forms,eventLines:e.eventLines}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(K.reduxForm)({form:"terminalForm",fields:["name","printerConfigType","serverPrinterId","terminalId","deviceId","savePdf","docPrinters","caption","captionName","customId","eventLineId"]})(Hr)),Kr=n(627),Vr=n(282),Br=(n(2651),function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}),Gr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Xr=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(o,l)}s((r=r.apply(e,t||[])).next())})},Yr=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,g.a.screenInitialState()))}return u()(t,e),o()(t,[{key:"renderNavigation",value:function(){return f.createElement(Kr.a,null)}},{key:"openEditForm",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=void 0;this.openDialog(e,f.createElement(zr,{ref:function(e){return i=Object(L.toOption)(e).flatMap(function(e){return Object(L.toOption)(e.wrappedInstance)})},initialValues:n,massCreation:a,onSubmit:function(e){return t(e)}}),[f.createElement(_.a,{variant:"raised",onClick:function(){return r.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(_.a,{variant:"raised",onClick:function(){return i.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"getPrinterConfig",value:function(e){if(!e.printerConfigType||e.printerConfigType===F.PrinterConfigEmptyType.$Type.value)return new L.None;switch(e.printerConfigType){case F.PrinterConfigServerDevice.$Type.value:return Object(L.toOption)(e.serverPrinterId).map(function(e){return new L.Some(new F.PrinterConfigServerDevice(new F.Id(e)))}).getOrElse(function(){throw"Cannot find printer"});case F.PrinterConfigLocalTerminal.$Type.value:return Object(L.toOption)(e.deviceId).map(function(e){return new L.Some(new F.PrinterConfigLocalTerminal(new F.PrinterId(e)))}).getOrElse(function(){throw"Cannot find printer"});case F.PrinterConfigRemoteTerminal.$Type.value:return Object(L.toOption)(e.terminalId).map(function(t){return Object(L.toOption)(e.deviceId).map(function(e){return new L.Some(new F.PrinterConfigRemoteTerminal(new F.Id(t),new F.PrinterId(e)))}).getOrElse(function(){throw"Cannot find printer"})}).getOrElse(function(){throw"Cannot find terminal"});default:throw"Unknown printer config type"}}},{key:"onCreateRequested",value:function(){var e=this;this.openEditForm(this.props.i18n.t("Новый терминал"),function(t){return new Promise(function(n,r){var a=e.getPrinterConfig(t);e.props.organisation.organisationId.map(function(i){Object(Vr.a)(new F.Terminal(t.name,i,a,t.savePdf,new L.None,t.docPrinters,Object(L.toOption)(t.customId).filter(function(e){return""!==e}),F.Id.createId(t.eventLineId))).then(function(t){n(t),e.props.dispatch(Object(H.h)(e.props.i18n.t("Создание успешно завершено"))),e.handleDialogClose(!1),e.props.dispatch(Object(Vr.b)(i))}).catch(function(t){r(t),e.props.dispatch(Object(H.h)(e.props.i18n.t("Создание завершилось ошибкой")))})})})},this.getNewInitialValues())}},{key:"onMassCreationRequested",value:function(){var e=this;this.openEditForm(this.props.i18n.t("Новые терминалы"),function(t){var n=e.getPrinterConfig(t);return e.props.organisation.organisationId.map(function(r){var a;return(a=t.captionName,Xr(e,void 0,void 0,hr.a.mark(function e(){var i,o,l,s,c,u;return hr.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=!0,o=!1,l=void 0,e.prev=3,s=a[Symbol.iterator]();case 5:if(i=(c=s.next()).done){e.next=12;break}return u=c.value,e.next=9,Object(Vr.a)(new F.Terminal(u[Object.keys(u)[0]],r,n,t.savePdf,new L.None,t.docPrinters,new L.None,F.Id.createId(t.eventLineId)));case 9:i=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),o=!0,l=e.t0;case 18:e.prev=18,e.prev=19,!i&&s.return&&s.return();case 21:if(e.prev=21,!o){e.next=24;break}throw l;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])}))).then(function(t){e.props.dispatch(Object(Vr.b)(r)),e.handleDialogClose(!1),e.props.dispatch(Object(H.h)(e.props.i18n.t("Все поля добавлены успешно.")))}).catch(function(t){e.props.dispatch(Object(H.h)(e.props.i18n.t("Сохранение завершилось ошибкой")))})}).getOrElse(function(){return new Promise(function(e,t){t()})})},this.getNewInitialValues(),!0)}},{key:"getNewInitialValues",value:function(){return{printerConfigType:F.PrinterConfigLocalTerminal.$Type.value,deviceId:"1",customId:"",eventLineId:""}}},{key:"onEdit",value:function(e){var t=this;this.openEditForm(this.props.i18n.t("Редактирование терминала"),function(n){return new Promise(function(r,a){Object(Vr.e)(new F.ME(e.id,new F.Terminal(n.name,e.entity.organisationId,t.getPrinterConfig(n),n.savePdf,e.entity.zoneId,n.docPrinters,Object(L.toOption)(n.customId).filter(function(e){return""!==e}),F.Id.createId(n.eventLineId)))).then(function(e){r(e),t.props.dispatch(Object(H.h)(t.props.i18n.t("Сохранение успешно завершено"))),t.handleDialogClose(!1),t.props.organisation.organisationId.map(function(e){t.props.dispatch(Object(Vr.b)(e))}).getOrElse(function(){throw"Organisation has not been provided"})}).catch(function(e){a(e),t.props.dispatch(Object(H.h)(t.props.i18n.t("Сохранение завершилось ошибкой")))})})},this.getInitialValues(e))}},{key:"getInitialValues",value:function(e){var t={name:e.entity.name,savePdf:e.entity.savePdf,printerConfigType:"",serverPrinterId:"",terminalId:e.id.value,deviceId:"",customId:e.entity.customId.getOrElse(function(){return""}),eventLineId:e.entity.linkedEvent.map(function(e){return e.value}).getOrElse(function(){return""})};return e.entity.printer.foreach(function(e){switch(t.printerConfigType=e.tpe.value,e.tpe.value){case F.PrinterConfigServerDevice.$Type.value:t.serverPrinterId=e.id.value;break;case F.PrinterConfigRemoteTerminal.$Type.value:t.terminalId=e.terminalId.value,t.deviceId=e.deviceId.id;break;case F.PrinterConfigLocalTerminal.$Type.value:t.deviceId=e.deviceId.id;break;case F.PrinterConfigEmptyType.$Type.value:break;default:throw"Unknown printer type"}}),t}},{key:"onDelete",value:function(e){var t=this,n=this.props.i18n;this.openDialog(n.t("Удаление терминала"),f.createElement("div",null,n.t("Вы уверены? Данное действие нельзя отменить")),[f.createElement(_.a,{variant:"raised",onClick:function(){t.handleDialogClose(!0)},style:{marginRight:"10px"}},n.t("Нет")),f.createElement(_.a,{variant:"raised",onClick:function(){Object(Vr.d)(e.id).then(function(e){t.props.dispatch(Object(H.h)(t.props.i18n.t("Удаление успешно завершено"))),t.handleDialogClose(!1),t.props.organisation.organisationId.map(function(e){t.props.dispatch(Object(Vr.b)(e))}).getOrElse(function(){throw"Organisation has not been provided"})}).catch(function(e){t.props.dispatch(Object(H.h)(t.props.i18n.t("Удаление завершилось ошибкой")))})}},n.t("Да"))])}},{key:"onCopy",value:function(e){var t=this;Object(Vr.a)(j(e.entity,{name:{$set:e.entity.name+" COPY"}})).then(function(){t.props.organisation.organisationId.map(function(e){t.props.dispatch(Object(Vr.b)(e))}).getOrElse(function(){throw"Organisation has not been provided"}),t.props.dispatch(Object(H.h)(t.props.i18n.t("Копия успешно создана")))})}},{key:"getLinkedEventName",value:function(e){var t=this;return e.flatMap(function(e){return Object(L.headOption)(t.props.eventLines.list.filter(function(t){return t.id.value===e.value})).map(function(e){return e.entity.name})}).getOrElse(function(){return"-"})}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(U.b,null,f.createElement(_.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary",style:{marginRight:10}},this.props.i18n.t("Создать")),f.createElement(_.a,{variant:"raised",onClick:this.onMassCreationRequested,color:"primary"},this.props.i18n.t("Массовое создание"))),f.createElement(q.a,{showId:!0,fetching:this.props.terminals.fetching,onRecordSelected:this.onEdit,error:this.props.terminals.error,empty:!this.props.terminals.fetching&&0==this.props.terminals.list.length,withActions:!0,columnIndexSort:4,headers:[{id:"terminalName",title:this.props.i18n.t("Название")},{id:"printer",title:this.props.i18n.t("Связанное устройство печати")},{id:"zones",title:this.props.i18n.t("Связанные зоны доступа")},{id:"customId",title:this.props.i18n.t("Определяемый Id")},{id:"eventLineId",title:this.props.i18n.t("Привязка к проекту")}],rows:!this.props.terminals.fetching&&this.props.terminals.error.isEmpty()?this.props.terminals.list.map(function(t){return{payload:t,id:t.id.value,fields:[t.entity.name,t.entity.printer?t.entity.printer.map(function(t){return Object(Ir.K)(t.tpe,e.props.i18n.t)}).getOrElse(function(){return e.props.i18n.t("Не указан")}):"-",t.entity.zoneId.map(function(e){return e.value}).getOrElse(function(){return"-"}),t.entity.customId.getOrElse(function(){return"-"}),e.getLinkedEventName(t.entity.linkedEvent)],buttons:[f.createElement(S.a,{key:"edit",style:fe.f,onClick:function(n){n.stopPropagation(),e.onEdit(t)}},f.createElement(Te.a,{style:fe.g})),f.createElement(S.a,{key:"delete",style:fe.f,onClick:function(n){n.stopPropagation(),e.onDelete(t)}},f.createElement(A.a,{style:fe.g})),f.createElement(S.a,{key:"copy",style:fe.f,onClick:function(n){n.stopPropagation(),e.onCopy(t)}},f.createElement(Qn.a,{style:fe.g}))]}}):[]}))}}]),t}(g.a);Yr=Br([h.autobind,Gr("design:paramtypes",[Object])],Yr);var Zr=Object(m.connect)(function(e){return{i18n:e.i18n,forms:e.forms,terminals:e.terminals,organisation:e.organisation,eventLines:e.eventLines}})(Object(y.a)(Object(v.a)(function(e){e.isTokenChecked&&e.dispatch(Object(_r.a)())},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.dispatch(Object(_r.a)())})(Yr))),Jr=n(433),Qr=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ea=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ta=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeMenu:n.selectedIndex()},n}return u()(t,e),o()(t,[{key:"selectedIndex",value:function(){return-1!==location.href.indexOf("/fonts")?0:-1!==location.href.indexOf("/emails")?1:-1!==location.href.indexOf("/payments")?2:-1!==location.href.indexOf("/socialConnections")?3:-1!==location.href.indexOf("/domains")?4:-1!==location.href.indexOf("/sms")?5:-1!==location.href.indexOf("/profile")?6:-1!==location.href.indexOf("/users")?7:-1!==location.href.indexOf("/roles")?8:-1!==location.href.indexOf("/terminals")?9:-1!==location.href.indexOf("/filemanager")?10:-1!==location.href.indexOf("/other")?11:-1!==location.href.indexOf("/colorScheme")?12:6}},{key:"handleMenuSelect",value:function(e){switch(e){case 0:this.props.dispatch(Object(rr.hb)());break;case 1:this.props.dispatch(Object(rr.fb)());break;case 2:this.props.dispatch(Object(rr.kb)());break;case 3:this.props.dispatch(Object(rr.qb)());break;case 4:this.props.dispatch(Object(rr.eb)());break;case 5:this.props.dispatch(Object(rr.nb)());break;case 6:this.props.dispatch(Object(rr.lb)());break;case 7:this.props.dispatch(Object(rr.sb)());break;case 8:this.props.dispatch(Object(rr.mb)());break;case 9:this.props.dispatch(Object(rr.rb)());break;case 10:this.props.dispatch(Object(rr.gb)());break;case 11:this.props.dispatch(Object(rr.ib)());break;case 12:this.props.dispatch(Object(rr.db)())}this.setState(j(this.state,{activeMenu:{$set:e}}))}},{key:"render",value:function(){var e=this;return this.props.organisation.data.map(function(t){return f.createElement(C.a,{style:{display:"flex",flex:1}},f.createElement(Xn.a,{value:e.state.activeMenu,onChange:e.handleMenuSelect},f.createElement(Yn.a,{value:6,label:e.props.i18n.t("Профиль")},f.createElement(Zn.a,{organisation:t,openDialog:e.props.openDialog,handleDialogClose:e.props.handleDialogClose})),f.createElement(Yn.a,{value:0,label:e.props.i18n.t("Шрифты")},f.createElement(ve,{handleDialogClose:e.props.handleDialogClose,openDialog:e.props.openDialog})),f.createElement(Yn.a,{value:1,label:e.props.i18n.t("Сообщения")},f.createElement(Ke,null)),f.createElement(Yn.a,{value:12,label:e.props.i18n.t("Цветовая тема")},f.createElement(Bn,null)),!xe.default.isA5000&&f.createElement(Yn.a,{value:2,label:e.props.i18n.t("Платежи")},f.createElement(Je,{handleDialogClose:e.props.handleDialogClose,openDialog:e.props.openDialog})),!xe.default.isA5000&&f.createElement(Yn.a,{value:3,label:e.props.i18n.t("Соцсети")},f.createElement(gt,null)),f.createElement(Yn.a,{value:4,label:e.props.i18n.t("Домены")},f.createElement(ot,{handleDialogClose:e.props.handleDialogClose,openDialog:e.props.openDialog})),f.createElement(Yn.a,{value:7,label:e.props.i18n.t("Пользователи")},f.createElement(Jn.a,{organisation:t,openDialog:e.props.openDialog,handleDialogClose:e.props.handleDialogClose})),f.createElement(Yn.a,{value:8,label:e.props.i18n.t("Роли")},f.createElement(dr,{openDialog:e.props.openDialog,handleDialogClose:e.props.handleDialogClose})),f.createElement(Yn.a,{value:9,label:e.props.i18n.t("Терминалы")},f.createElement(Zr,null)),f.createElement(Yn.a,{value:10,label:e.props.i18n.t("Файлы")},f.createElement(Jr.a,{organisationId:e.props.organisationId,excludedFolders:[],initialFolder:new qt.None,acceptedFiles:new qt.None,elementId:new qt.None})),xe.default.isA5000?null:f.createElement(Yn.a,{value:11,label:e.props.i18n.t("Другое")},f.createElement(Gn.a,{organisation:t,openDialog:e.props.openDialog,handleDialogClose:e.props.handleDialogClose}))))}).getOrNull()}}]),t}(f.Component);ta=Qr([h.autobind,ea("design:paramtypes",[Object])],ta);var na=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation,organisations:e.organisations}})(ta),ra=(n(2102),n(541)),aa=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ia=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},oa=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(g.a.screenInitialState())))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this;return this.props.organisation.data.map(function(t){return e.renderScreenBody({className:"OrganisationPage"},f.createElement(na,{organisationId:t.id,openDialog:e.openDialog,handleDialogClose:e.handleDialogClose}))}).getOrElse(function(){return f.createElement("div",null)})}}]),t}(g.a);oa=aa([h.autobind,ia("design:paramtypes",[Object])],oa);t.default=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation}})(Object(y.a)(Object(v.a)(function(){},function(e){e.isTokenChecked&&(e.dispatch(Object(ra.c)()),e.dispatch(Object(sr.d)()),e.dispatch(Object(b.g)()),e.organisation.data.foreach(function(t){e.dispatch(Object(O.a)(t.id))}))},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&(e.dispatch(Object(ra.c)()),e.dispatch(Object(sr.d)()),e.dispatch(Object(b.g)()),e.organisation.data.foreach(function(t){e.dispatch(Object(O.a)(t.id))})),!Object(L.isEqual)(e.organisation.data.map(function(e){return e.id.value}),t.organisation.data.map(function(e){return e.id.value}))&&e.isTokenChecked&&e.organisation.data.foreach(function(t){e.dispatch(Object(O.a)(t.id))})})(oa)))}}]);