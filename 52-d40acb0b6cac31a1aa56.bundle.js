(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[52],{1618:function(e,t,n){e.exports=n(97)(40)},1627:function(e,t,n){e.exports=n(97)(363)},1805:function(e,t,n){"use strict";var a=n(2),r=n(94),i=n.n(r);t.a=function(e){return a.createElement(i.a,Object.assign({},e),a.createElement("path",{d:"M14,9H19.5L14,3.5V9M7,2H15L21,8V20A2,2 0 0,1 19,22H7C5.89,22 5,21.1 5,20V4A2,2 0 0,1 7,2M11.93,12.44C12.34,13.34 12.86,14.08 13.46,14.59L13.87,14.91C13,15.07 11.8,15.35 10.53,15.84V15.84L10.42,15.88L10.92,14.84C11.37,13.97 11.7,13.18 11.93,12.44M18.41,16.25C18.59,16.07 18.68,15.84 18.69,15.59C18.72,15.39 18.67,15.2 18.57,15.04C18.28,14.57 17.53,14.35 16.29,14.35L15,14.42L14.13,13.84C13.5,13.32 12.93,12.41 12.53,11.28L12.57,11.14C12.9,9.81 13.21,8.2 12.55,7.54C12.39,7.38 12.17,7.3 11.94,7.3H11.7C11.33,7.3 11,7.69 10.91,8.07C10.54,9.4 10.76,10.13 11.13,11.34V11.35C10.88,12.23 10.56,13.25 10.05,14.28L9.09,16.08L8.2,16.57C7,17.32 6.43,18.16 6.32,18.69C6.28,18.88 6.3,19.05 6.37,19.23L6.4,19.28L6.88,19.59L7.32,19.7C8.13,19.7 9.05,18.75 10.29,16.63L10.47,16.56C11.5,16.23 12.78,16 14.5,15.81C15.53,16.32 16.74,16.55 17.5,16.55C17.94,16.55 18.24,16.44 18.41,16.25M18,15.54L18.09,15.65C18.08,15.75 18.05,15.76 18,15.78H17.96L17.77,15.8C17.31,15.8 16.6,15.61 15.87,15.29C15.96,15.19 16,15.19 16.1,15.19C17.5,15.19 17.9,15.44 18,15.54M8.83,17C8.18,18.19 7.59,18.85 7.14,19C7.19,18.62 7.64,17.96 8.35,17.31L8.83,17M11.85,10.09C11.62,9.19 11.61,8.46 11.78,8.04L11.85,7.92L12,7.97C12.17,8.21 12.19,8.53 12.09,9.07L12.06,9.23L11.9,10.05L11.85,10.09Z"}))}},1888:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(2)),i=(0,a(n(44)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),r.default.createElement("path",{d:"M7.11 8.53L5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47zM6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47zm1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03L7.1 18.32zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93z"})),"RotateLeft");t.default=i},1889:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(2)),i=(0,a(n(44)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),r.default.createElement("path",{d:"M15.55 5.55L11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10l4.55-4.45zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47h2.02zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03zm3.89-2.42l1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48z"})),"RotateRight");t.default=i},2095:function(e,t){},2096:function(e,t){},2097:function(e,t){},2098:function(e,t){},2112:function(e,t,n){var a=n(2700);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(a,r);a.locals&&(e.exports=a.locals)},2113:function(e,t,n){"use strict";var a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(2)),i=(0,a(n(44)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),r.default.createElement("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})),"Fullscreen");t.default=i},2700:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".PdfControlEditor__placeholder:hover {\n  background-color: #eaf8ff; }\n",""])},2738:function(e,t,n){"use strict";n.r(t);var a=n(6),r=n.n(a),i=n(10),o=n.n(i),s=n(7),u=n.n(s),c=n(8),l=n.n(c),d=n(2),p=n(14),f=n(1453),h=n(1452),g=n(11),m=n.n(g),v=n(13),y=n(3),E=n(93),b=n.n(E),k=n(26),R=n.n(k),O=n(324),S=n.n(O),P=n(25),C=n.n(P),N=n(62),F=n.n(N),j=n(160),w=n.n(j),L=n(560),q=n.n(L),x=n(561),I=n.n(x),M=n(1772),$=n.n(M),_=n(1773),z=n.n(_),D=n(1888),V=n.n(D),A=n(1889),T=n.n(A),U=n(2113),H=n.n(U),W=n(1805),Z=n(1),K=n(0),B=n(215),G=n(71),J=n(109),Q=n(83),X=n(46),Y=(n(2112),function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}),ee=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},te=n(2006);te.GlobalWorkerOptions.workerSrc=n(1917);var ne={color:S.a[500]},ae=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={pdfDoc:new K.None,pdfUploading:!1,pdfFetching:!1,pageNum:1,pageRendering:!1,pageNumPending:new K.None,pageScale:1,pageRotation:0},n}return l()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.initPage(this.props),this.subscribeToEvents()}},{key:"componentWillUnmount",value:function(){this.unsubscribeFromEvents()}},{key:"componentWillReceiveProps",value:function(e){Object(K.isEqual)(this.getPdfSrc(this.props),this.getPdfSrc(e))||this.initPage(e)}},{key:"subscribeToEvents",value:function(){var e=this;document.addEventListener("keydown",function(t){return e.initKeyboardControls(t.key)}),document.addEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("fullscreenchange",this.onFullScreenExit,!1),document.addEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"unsubscribeFromEvents",value:function(){var e=this;document.removeEventListener("keydown",function(t){return e.initKeyboardControls(t.key)}),document.removeEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("fullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"initKeyboardControls",value:function(e){var t=this;Object(K.toOption)("ArrowRight"===e).filter(function(e){return e}).foreach(function(){return t.onNextPage()}),Object(K.toOption)("ArrowLeft"===e).filter(function(e){return e}).foreach(function(){return t.onPrevPage()})}},{key:"onFullScreenExit",value:function(){var e=this,t=document,n=t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement;Object(K.toOption)(n).matchWith(function(){},function(){return e.setState(y(e.state,{pageScale:{$set:1}}),function(){return e.queueRenderPage(e.state.pageNum)})})}},{key:"handleCanvasRef",value:function(e){this.canvasRef=Object(K.toOption)(e)}},{key:"showNotification",value:function(e){this.props.dispatch(Object(G.h)(this.props.i18n.t(e)))}},{key:"updateUploadingState",value:function(e){this.setState(y(this.state,{pdfUploading:{$set:e}}))}},{key:"updateFetchingState",value:function(e){this.setState(y(this.state,{pdfFetching:{$set:e}}))}},{key:"getPdfSrc",value:function(e){return e.value.flatMap(function(t){return Object(K.headOption)(t.files).flatMap(function(t){return e.authToken.map(function(n){return Object(J.b)(n,t,e.cdnAddress)})})})}},{key:"initPage",value:function(e){var t=this;this.getPdfSrc(e).foreach(function(e){t.updateFetchingState(!0),te.getDocument(e).then(function(e){t.updateFetchingState(!1),t.setState(y(t.state,{pdfDoc:{$set:Object(K.toOption)(e)}}),function(){return t.renderPage(t.state.pageNum)})})})}},{key:"renderPage",value:function(e){var t=this;this.setState(y(this.state,{pageRendering:{$set:!0}})),this.canvasRef.isEmpty()||this.state.pdfDoc.foreach(function(n){return n.getPage(e).then(function(e){t.canvasRef.foreach(function(n){var a=n.getContext("2d");Object(K.toOption)(a).foreach(function(a){var r=e.getViewport(t.state.pageScale,t.state.pageRotation);n.width=r.width,n.height=r.height,e.render({canvasContext:a,viewport:r}).promise.then(function(){t.setState(y(t.state,{pageRendering:{$set:!1}})),t.state.pageNumPending.nonEmpty()&&(t.renderPage(t.state.pageNumPending.getOrElse(function(){return 1})),t.setState(y(t.state,{pageNumPending:{$set:new K.None}})))})})})})})}},{key:"queueRenderPage",value:function(e){this.state.pageRendering?this.setState(y(this.state,{pageNumPending:{$set:Object(K.toOption)(e)}})):this.renderPage(e)}},{key:"onNextPage",value:function(){var e=this;this.state.pdfDoc.map(function(t){return e.state.pageNum>=t.numPages}).getOrElse(function(){return!1})||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum+1}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onPrevPage",value:function(){var e=this;this.state.pageNum<=1||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum-1}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onZoomOut",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale-.25}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onZoomIn",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale+.25}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onRotateLeft",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation-90}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onRotateRight",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation+90}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onPageNumChange",value:function(e){var t=this,n=this.state.pdfDoc.map(function(e){return e.numPages}).getOrElse(function(){return 1}),a=parseInt(e.target.value);isNaN(a)||a>n||a<1||this.setState(y(this.state,{pageNum:{$set:a}}),function(){return t.queueRenderPage(t.state.pageNum)})}},{key:"toggleFullScreen",value:function(){var e=this;this.canvasRef.foreach(function(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),e.setState(y(e.state,{pageScale:{$set:2}}),function(){return e.queueRenderPage(e.state.pageNum)})})}},{key:"renderControls",value:function(){var e=this;return d.createElement(b.a,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:5,marginBottom:5}},d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(C.a,{style:X.f,disabled:this.state.pageNum<=1,onClick:this.onPrevPage},d.createElement(q.a,{style:X.g})),d.createElement(C.a,{style:X.f,disabled:this.state.pdfDoc.map(function(t){return e.state.pageNum>=t.numPages}).getOrElse(function(){return!1}),onClick:this.onNextPage},d.createElement(I.a,{style:X.g})),d.createElement(R.a,{type:"number",variant:"outlined",style:{backgroundColor:"white",width:70,margin:"0 0 0 5px"},value:this.state.pageNum,onChange:this.onPageNumChange}),"/",this.state.pdfDoc.map(function(e){return e.numPages}).getOrElse(function(){return e.state.pageNum})),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(C.a,{style:X.f,disabled:this.state.pageScale<=.25,onClick:this.onZoomOut},d.createElement(z.a,{style:X.g})),d.createElement(C.a,{style:X.f,onClick:this.onZoomIn},d.createElement($.a,{style:X.g})),d.createElement(C.a,{style:X.f,onClick:this.toggleFullScreen},d.createElement(H.a,{style:X.g}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(C.a,{style:X.f,disabled:this.state.pageScale<=.25,onClick:this.onRotateLeft},d.createElement(V.a,{style:X.g})),d.createElement(C.a,{style:X.f,onClick:this.onRotateRight},d.createElement(T.a,{style:X.g}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}}))}},{key:"renderCanvas",value:function(){return this.state.pdfFetching?d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",border:"2px dashed ".concat(F.a[600]),borderRadius:5,height:200}},d.createElement(w.a,null)):d.createElement("canvas",{ref:this.handleCanvasRef,onClick:this.onNextPage})}},{key:"renderPlaceholder",value:function(){return d.createElement("div",{className:"PdfControlEditor__placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",height:200,width:200,border:"2px dashed ".concat(F.a[600]),borderRadius:5,cursor:"pointer"}},this.state.pdfUploading?d.createElement(w.a,null):d.createElement(W.a,{style:{color:F.a[600]}}))}},{key:"render",value:function(){return d.createElement("div",{style:{textAlign:"center"}},this.getPdfSrc(this.props).nonEmpty()&&this.renderControls(),this.getPdfSrc(this.props).isEmpty()?this.renderPlaceholder():this.renderCanvas(),this.props.error.map(function(e){return d.createElement("p",{style:ne},e)}).getOrNull())}}]),t}(d.Component);ae=Y([v.autobind,ee("design:paramtypes",[Object])],ae);var re=Object(p.connect)(function(e,t){return{value:Object(B.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof Z.ValueFileList}),error:Object(B.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token},areStatePropsEqual:function(e,t){return Object(K.isEqual)(e.value,t.value)&&Object(K.isEqual)(e.error,t.error)&&Object(K.isEqual)(e.authToken,t.authToken)&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display}})(Object(Q.a)(ae)),ie=n(417),oe=n(631),se=n.n(oe),ue=n(414),ce=n.n(ue),le=n(99),de=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},pe=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fe=n(2006);fe.GlobalWorkerOptions.workerSrc=n(1917);var he={color:S.a[500]},ge=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={pdfDoc:new K.None,pdfUploading:!1,pdfFetching:!1,pageNum:1,pageRendering:!1,pageNumPending:new K.None,pageScale:1,pageRotation:0},n}return l()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.initPage(this.props),this.subscribeToEvents()}},{key:"componentWillUnmount",value:function(){this.unsubscribeFromEvents()}},{key:"componentWillReceiveProps",value:function(e){Object(K.isEqual)(this.getPdfSrc(this.props),this.getPdfSrc(e))||this.initPage(e)}},{key:"subscribeToEvents",value:function(){var e=this;document.addEventListener("keydown",function(t){return e.initKeyboardControls(t.key)}),document.addEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("fullscreenchange",this.onFullScreenExit,!1),document.addEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"unsubscribeFromEvents",value:function(){var e=this;document.removeEventListener("keydown",function(t){return e.initKeyboardControls(t.key)}),document.removeEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("fullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"initKeyboardControls",value:function(e){var t=this;Object(K.toOption)("ArrowRight"===e).filter(function(e){return e}).foreach(function(){return t.onNextPage()}),Object(K.toOption)("ArrowLeft"===e).filter(function(e){return e}).foreach(function(){return t.onPrevPage()})}},{key:"onFullScreenExit",value:function(){var e=this,t=document,n=t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement;Object(K.toOption)(n).matchWith(function(){},function(){return e.setState(y(e.state,{pageScale:{$set:1}}),function(){return e.queueRenderPage(e.state.pageNum)})})}},{key:"handleDelete",value:function(){var e=this;this.props.value.flatMap(function(e){return Object(K.headOption)(e.files)}).foreach(function(t){return e.deleteFile(t).then(function(t){return e.onChange(new Z.ValueFileList([]))})})}},{key:"handleCanvasRef",value:function(e){this.canvasRef=Object(K.toOption)(e)}},{key:"showNotification",value:function(e){this.props.dispatch(Object(G.h)(this.props.i18n.t(e)))}},{key:"onChange",value:function(e){var t=this;this.props.formRecordId.matchWith(function(e){Object(le.f)(t.props.formId,e,t.props.output.formField).then(function(e){return Object(K.headOption)(e.list).matchWith(function(e){t.props.onChange(new Z.ValueFileList([e.id]),t.props.output)},function(){t.props.onChange(new Z.ValueFileList([]),t.props.output)})})},function(){t.props.onChange(e,t.props.output)})}},{key:"deleteFile",value:function(e){var t=this;return Object(le.a)(e).then(function(e){t.showNotification("Файл успешно удалено")}).catch(function(e){return t.showNotification("Во время удаления файла произошла ошибка")})}},{key:"updateUploadingState",value:function(e){this.setState(y(this.state,{pdfUploading:{$set:e}}))}},{key:"updateFetchingState",value:function(e){this.setState(y(this.state,{pdfFetching:{$set:e}}))}},{key:"onUploadFileRequested",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Загрузка файла"),d.createElement(ie,{onDrop:function(n){return function(t,n){if(0===t.length)throw"There are not files to process";e.updateUploadingState(!0);var a=t[t.length-1];Object(le.h)(a,e.props.cdnAddress,e.props.authToken,e.props.organisation.organisationId,e.props.eventLine.eventLineId,e.props.formRecordId,new K.None,"false",!1,Object(K.toOption)(e.props.output.formField),Object(K.toOption)(e.props.formId)).then(function(t){e.props.value.flatMap(function(e){return Object(K.headOption)(e.files)}).foreach(function(t){return e.deleteFile(t)}),e.onChange(new Z.ValueFileList([t])),e.updateUploadingState(!1)}).catch(function(t){e.props.dispatch(Object(G.h)(e.props.i18n.t("Во время загрузки файла произошла ошибка"))),e.updateUploadingState(!1)}),e.props.handleDialogClose(n)}(n,t)},multiple:!0,accept:"application/pdf",className:"FileListControlEditor__dropzone"},function(t){var n=t.isDragActive;return d.createElement("div",{className:n?"FileListControlEditor__dropzone-wrapper":""},d.createElement("div",{className:"FileListControlEditor__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),[])}},{key:"getPdfSrc",value:function(e){return e.value.flatMap(function(t){return Object(K.headOption)(t.files).flatMap(function(t){return e.authToken.map(function(n){return Object(J.b)(n,t,e.cdnAddress)})})})}},{key:"initPage",value:function(e){var t=this;this.getPdfSrc(e).foreach(function(e){t.updateFetchingState(!0),fe.getDocument(e).then(function(e){t.updateFetchingState(!1),t.setState(y(t.state,{pdfDoc:{$set:Object(K.toOption)(e)}}),function(){return t.renderPage(t.state.pageNum)})})})}},{key:"renderPage",value:function(e){var t=this;this.setState(y(this.state,{pageRendering:{$set:!0}})),this.canvasRef.isEmpty()||this.state.pdfDoc.foreach(function(n){return n.getPage(e).then(function(e){t.canvasRef.foreach(function(n){var a=n.getContext("2d");Object(K.toOption)(a).foreach(function(a){var r=e.getViewport(t.state.pageScale,t.state.pageRotation);n.width=r.width,n.height=r.height,e.render({canvasContext:a,viewport:r}).promise.then(function(){t.setState(y(t.state,{pageRendering:{$set:!1}})),t.state.pageNumPending.nonEmpty()&&(t.renderPage(t.state.pageNumPending.getOrElse(function(){return 1})),t.setState(y(t.state,{pageNumPending:{$set:new K.None}})))})})})})})}},{key:"queueRenderPage",value:function(e){this.state.pageRendering?this.setState(y(this.state,{pageNumPending:{$set:Object(K.toOption)(e)}})):this.renderPage(e)}},{key:"onNextPage",value:function(){var e=this;this.state.pdfDoc.map(function(t){return e.state.pageNum>=t.numPages}).getOrElse(function(){return!1})||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum+1}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onPrevPage",value:function(){var e=this;this.state.pageNum<=1||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum-1}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onZoomOut",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale-.25}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onZoomIn",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale+.25}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onRotateLeft",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation-90}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onRotateRight",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation+90}}),function(){return e.queueRenderPage(e.state.pageNum)})}},{key:"onPageNumChange",value:function(e){var t=this,n=this.state.pdfDoc.map(function(e){return e.numPages}).getOrElse(function(){return 1}),a=parseInt(e.target.value);isNaN(a)||a>n||a<1||this.setState(y(this.state,{pageNum:{$set:a}}),function(){return t.queueRenderPage(t.state.pageNum)})}},{key:"toggleFullScreen",value:function(){var e=this;this.canvasRef.foreach(function(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),e.setState(y(e.state,{pageScale:{$set:2}}),function(){return e.queueRenderPage(e.state.pageNum)})})}},{key:"renderControls",value:function(){var e=this;return d.createElement(b.a,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:5,marginBottom:5}},d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(C.a,{style:X.f,disabled:this.state.pageNum<=1,onClick:this.onPrevPage},d.createElement(q.a,{style:X.g})),d.createElement(C.a,{style:X.f,disabled:this.state.pdfDoc.map(function(t){return e.state.pageNum>=t.numPages}).getOrElse(function(){return!1}),onClick:this.onNextPage},d.createElement(I.a,{style:X.g})),d.createElement(R.a,{type:"number",variant:"outlined",style:{backgroundColor:"white",width:70,margin:"0 0 0 5px"},value:this.state.pageNum,onChange:this.onPageNumChange}),"/",this.state.pdfDoc.map(function(e){return e.numPages}).getOrElse(function(){return e.state.pageNum})),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(C.a,{style:X.f,disabled:this.state.pageScale<=.25,onClick:this.onZoomOut},d.createElement(z.a,{style:X.g})),d.createElement(C.a,{style:X.f,onClick:this.onZoomIn},d.createElement($.a,{style:X.g})),d.createElement(C.a,{style:X.f,onClick:this.toggleFullScreen},d.createElement(H.a,{style:X.g}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(C.a,{style:X.f,disabled:this.state.pageScale<=.25,onClick:this.onRotateLeft},d.createElement(V.a,{style:X.g})),d.createElement(C.a,{style:X.f,onClick:this.onRotateRight},d.createElement(T.a,{style:X.g}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(C.a,{style:X.f,onClick:this.onUploadFileRequested},d.createElement(se.a,{style:X.g})),d.createElement(C.a,{style:X.f,onClick:this.handleDelete},d.createElement(ce.a,{style:X.g}))))}},{key:"renderCanvas",value:function(){return this.state.pdfFetching?d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",border:"2px dashed ".concat(F.a[600]),borderRadius:5,height:200}},d.createElement(w.a,null)):d.createElement("canvas",{ref:this.handleCanvasRef,onClick:this.onNextPage})}},{key:"renderPlaceholder",value:function(){return d.createElement("div",{onClick:this.onUploadFileRequested,className:"PdfControlEditor__placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",height:200,width:200,border:"2px dashed ".concat(F.a[600]),borderRadius:5,cursor:"pointer"}},this.state.pdfUploading?d.createElement(w.a,null):d.createElement(W.a,{style:{color:F.a[600]}}))}},{key:"render",value:function(){return d.createElement("div",{style:{textAlign:"center"}},this.getPdfSrc(this.props).nonEmpty()&&this.renderControls(),this.getPdfSrc(this.props).isEmpty()?this.renderPlaceholder():this.renderCanvas(),this.props.error.map(function(e){return d.createElement("p",{style:he},e)}).getOrNull())}}]),t}(d.Component);ge=de([v.autobind,pe("design:paramtypes",[Object])],ge);var me=Object(p.connect)(function(e,t){return{value:Object(B.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof Z.ValueFileList}),error:Object(B.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation},areStatePropsEqual:function(e,t){return Object(K.isEqual)(e.value,t.value)&&Object(K.isEqual)(e.error,t.error)&&Object(K.isEqual)(e.authToken,t.authToken)&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(K.isEqual)(e.formRecordId,t.formRecordId)}})(Object(Q.a)(ge)),ve=function(e){function t(){return r()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l()(t,e),o()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(h.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(re,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(h.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(me,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,output:this.props.output,formId:this.props.formId,control:this.props.control,onChange:this.props.onChange}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(f.a);t.default=Object(p.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(K.isEqual)(e.blockStyle,e.blockStyle)&&Object(K.isEqual)(e.formRecordId,e.formRecordId)}})(ve)}}]);