(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[43],{1459:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return l});var i=n(79),o=n(104),r=n(82),a=function(){return function(e,t){return e(r.default.isA5000?Object(i.Mb)():Object(i.h)())}},l=function(e,t){return function(n,r){return r().eventLine.data.foreach(function(a){Object(o.e)(r().forms,e).foreach(function(o){n(Object(i.H)(a.id,o.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var i=n(6),o=n.n(i),r=n(10),a=n.n(r),l=n(7),s=n.n(l),p=n(8),c=n.n(p),u=n(2),d=n(14),f=n(1469),h=n(1459),g=n(320),m=n(69),v=n(0),b=n(624);t.a=function(e){return Object(d.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return o()(this,n),s()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c()(n,t),a()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(v.toOption)(this.props.routing.location).map(function(t){Object(v.liftKey)(Object(b.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(f.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(m.r)()),this.props.dispatch(Object(g.c)()),this.props.dispatch(Object(h.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?u.createElement(e,this.props):u.createElement("div",null)}}]),n}(u.Component)}(e))}},1462:function(e,t,n){"use strict";var i=n(855);Object.defineProperty(t,"__esModule",{value:!0});var o={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.default}});var r=i(n(1464));Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))})},1463:function(e,t,n){"use strict";var i=n(855),o=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(36)),a=o(n(2)),l=(o(n(31)),i(n(1462))),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.breakpoint,i=void 0===n?"sm":n;return(0,l.default)()(function(e){return a.default.createElement(t,(0,r.default)({fullScreen:(0,l.isWidthDown)(i,e.width)},e))})}};t.default=s},1464:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.isWidthDown=t.isWidthUp=void 0;var o=i(n(36)),r=i(n(39)),a=i(n(73)),l=i(n(74)),s=i(n(76)),p=i(n(77)),c=i(n(78)),u=i(n(2)),d=(i(n(31)),i(n(217))),f=i(n(373)),h=(n(61),i(n(539))),g=i(n(263)),m=n(859),v=i(n(860));t.isWidthUp=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?m.keys.indexOf(e)<m.keys.indexOf(t):m.keys.indexOf(e)<=m.keys.indexOf(t)};t.isWidthDown=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?m.keys.indexOf(t)<m.keys.indexOf(e):m.keys.indexOf(t)<=m.keys.indexOf(e)};var b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.withTheme,i=void 0!==n&&n,b=e.noSSR,y=void 0!==b&&b,O=e.initialWidth,I=e.resizeInterval,k=void 0===I?166:I,w=function(e){function n(e){var t;return(0,a.default)(this,n),(t=(0,s.default)(this,(0,p.default)(n).call(this,e))).state={width:y?t.getWidth():void 0},"undefined"!=typeof window&&(t.handleResize=(0,f.default)(function(){var e=t.getWidth();e!==t.state.width&&t.setState({width:e})},k)),t}return(0,c.default)(n,e),(0,l.default)(n,[{key:"componentDidMount",value:function(){var e=this.getWidth();e!==this.state.width&&this.setState({width:e})}},{key:"componentWillUnmount",value:function(){this.handleResize.clear()}},{key:"getWidth",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,t=this.props.theme.breakpoints,n=null,i=1;null===n&&i<m.keys.length;){var o=m.keys[i];if(e<t.values[o]){n=m.keys[i-1];break}i+=1}return n=n||"xl"}},{key:"render",value:function(){var e=(0,v.default)({theme:this.props.theme,name:"MuiWithWidth",props:(0,o.default)({},this.props)}),n=e.initialWidth,a=e.theme,l=e.width,s=(0,r.default)(e,["initialWidth","theme","width"]),p=(0,o.default)({width:l||this.state.width||n||O},s);return void 0===p.width?null:(i&&(p.theme=a),u.default.createElement(u.default.Fragment,null,u.default.createElement(t,p),u.default.createElement(d.default,{target:"window",onResize:this.handleResize})))}}]),n}(u.default.Component);return(0,h.default)(w,t),(0,g.default)()(w)}};t.default=b},1465:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.isHorizontal=I,t.getAnchor=k,t.default=t.styles=void 0;var o=i(n(36)),r=i(n(55)),a=i(n(39)),l=i(n(73)),s=i(n(74)),p=i(n(76)),c=i(n(77)),u=i(n(78)),d=i(n(2)),f=(i(n(31)),i(n(47))),h=i(n(625)),g=i(n(38)),m=i(n(858)),v=i(n(93)),b=n(110),y=n(321),O={left:"right",right:"left",top:"down",bottom:"up"};function I(e){return-1!==["left","right"].indexOf(e.anchor)}function k(e){return"rtl"===e.theme.direction&&I(e)?O[e.anchor]:e.anchor}var w=function(e){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:e.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:"none"},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(e.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(e.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(e.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(e.palette.divider)},modal:{}}};t.styles=w;var E=function(e){function t(){var e,n;(0,l.default)(this,t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(n=(0,p.default)(this,(e=(0,c.default)(t)).call.apply(e,[this].concat(o)))).mounted=!1,n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){var e=this.props,t=(e.anchor,e.BackdropProps),n=e.children,i=e.classes,l=e.className,s=e.elevation,p=e.ModalProps,c=(p=void 0===p?{}:p).BackdropProps,u=(0,a.default)(p,["BackdropProps"]),g=e.onClose,y=e.open,I=e.PaperProps,w=e.SlideProps,E=(e.theme,e.transitionDuration),C=e.variant,j=(0,a.default)(e,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","theme","transitionDuration","variant"]),T=k(this.props),A=d.default.createElement(v.default,(0,o.default)({elevation:"temporary"===C?s:0,square:!0,className:(0,f.default)(i.paper,i["paperAnchor".concat((0,b.capitalize)(T))],(0,r.default)({},i["paperAnchorDocked".concat((0,b.capitalize)(T))],"temporary"!==C))},I),n);if("permanent"===C)return d.default.createElement("div",(0,o.default)({className:(0,f.default)(i.root,i.docked,l)},j),A);var P=d.default.createElement(m.default,(0,o.default)({in:y,direction:O[T],timeout:E,appear:this.mounted},w),A);return"persistent"===C?d.default.createElement("div",(0,o.default)({className:(0,f.default)(i.root,i.docked,l)},j),P):d.default.createElement(h.default,(0,o.default)({BackdropProps:(0,o.default)({},t,c,{transitionDuration:E}),className:(0,f.default)(i.root,i.modal,l),open:y,onClose:g},j,u),P)}}]),t}(d.default.Component);E.defaultProps={anchor:"left",elevation:16,open:!1,transitionDuration:{enter:y.duration.enteringScreen,exit:y.duration.leavingScreen},variant:"temporary"};var C=(0,g.default)(w,{name:"MuiDrawer",flip:!1,withTheme:!0})(E);t.default=C},1473:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var o=i(n(1463))},1474:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var o=i(n(1465))},1476:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),r=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})),"ArrowBack");t.default=r},1478:function(e,t,n){"use strict";var i=n(6),o=n.n(i),r=n(10),a=n.n(r),l=n(7),s=n.n(l),p=n(8),c=n.n(p),u=n(2),d=n(218),f=n.n(d),h=n(25),g=n.n(h),m=n(1476),v=n.n(m),b=(n(1481),n(52)),y=n.n(b),O=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),a()(t,[{key:"render",value:function(){return u.createElement(f.a,{className:"PageHeader__main"},this.props.onGoBackRequested?u.createElement(g.a,{onClick:this.props.onGoBackRequested,style:{flexShrink:0}},u.createElement(v.a,null)):u.createElement("div",{style:{display:"inline-block"}}),u.createElement(y.a,{variant:"title",align:"center",style:{flex:1}},this.props.title),u.createElement("div",{style:{flexShrink:0}},this.props.rightButtonGroup))}}]),t}(u.Component);t.a=O},1481:function(e,t,n){var i=n(1482);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},1482:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".PageHeader__main {\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  margin-bottom: 10px;\n  background-color: #fff !important;\n  height: 48px !important;\n  width: 100% !important;\n  flex-shrink: 0;\n  padding: 0; }\n",""])},1483:function(e,t,n){"use strict";var i=n(17),o=n(21),r=n(6),a=n.n(r),l=n(7),s=n.n(l),p=n(8),c=n.n(p),u=n(18),d=function(e){function t(e,n,i,o,r,l){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Create",{name:e,organisationId:n,roleId:i,eventLineId:o,appType:r,active:l}))}return c()(t,e),t}(u.a),f=function(e){function t(e,n,i,o,r){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Update",{id:e,name:n,roleId:i,appType:o,active:r}))}return c()(t,e),t}(u.a),h=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Delete",{appId:e}))}return c()(t,e),t}(u.a),g=(function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Request",{appId:e}))}c()(t,e)}(u.a),function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListEventLine",{eventLineId:e}))}return c()(t,e),t}(u.a)),m=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListOrganisation",{organisationId:e}))}return c()(t,e),t}(u.a),v=function(e){function t(e,n){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","EnrichContext",{loginValues:e,formId:n}))}return c()(t,e),t}(u.a),b=n(427),y=n(5);Object(y.createAction)("Application.Fetching"),Object(y.createAction)("Application.Resolve"),Object(y.createAction)("Application.Error"),Object(y.createAction)("Auth.SetBlockId",function(e){return e});n.d(t,"d",function(){return O}),n.d(t,"e",function(){return I}),n.d(t,"f",function(){return k}),n.d(t,"a",function(){return w}),n.d(t,"b",function(){return E}),n.d(t,"c",function(){return C});var O=function(e){return function(t){return t(Object(b.e)()),i.a.send(new g(e),Object(o.g)()).then(function(e){return t(Object(b.f)(e.list)),e}).catch(function(e){throw t(Object(b.d)(e)),e})}},I=function(e){return function(t){return t(Object(b.e)()),i.a.send(new m(e),Object(o.g)()).then(function(e){return t(Object(b.f)(e.list)),e}).catch(function(e){throw t(Object(b.d)(e)),e})}},k=function(e,t,n,r,a){return i.a.send(new f(e,t,n,r,a),Object(o.f)())},w=function(e,t,n,r,a,l){return i.a.send(new d(e,t,n,r,a,l),Object(o.f)())},E=function(e){return i.a.send(new h(e),Object(o.f)())},C=function(e,t){return i.a.send(new v(e,t),function(e){return e})}},1841:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n(6),o=n.n(i),r=n(10),a=n.n(r),l=n(7),s=n.n(l),p=n(8),c=n.n(p),u=n(2),d=n(113),f=(n(1842),function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),a()(t,[{key:"render",value:function(){return u.createElement("div",{className:"ColorPickerWrapper__container"},this.props.children,u.createElement("div",{className:"ColorPickerWrapper__picker"},u.createElement(d.a,{value:this.props.color,onChange:this.props.onChange})))}}]),t}(u.Component))},1842:function(e,t,n){var i=n(1843);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},1843:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ColorPickerWrapper__container {\n  position: relative;\n  display: flex; }\n\n.ColorPickerWrapper__picker {\n  cursor: pointer; }\n",""])},1982:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(1),o=n(23),r=function(e){switch(e.appType){case i.ApplicationTypeWebRegistration.$Type.value:return new i.ApplicationTypeWebRegistration(i.Id.createId(e.formId).getOrElse(function(){throw"wrong form id"}),i.Id.createId(e.blockId).getOrElse(function(){throw"wrong webRegistrationBlock id"}),new i.RegistrationStatus(!!e.registrationAllowed,i.Id.createId(e.deniedBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"})));case i.ApplicationTypePrivateCabinet.$Type.value:return new i.ApplicationTypePrivateCabinet(i.Id.createId(e.formId).getOrElse(function(){throw"wrong form id"}),i.Id.createId(e.loginBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"}),i.Id.createId(e.cabinetBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"}),new i.Credentials(e.loginFields),new i.RegistrationStatus(!!e.authAllowed,i.Id.createId(e.loginDeniedBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"})),e.caseInsensitiveLogin,new i.PrivateCabPermissions(e.relationsTree));case i.ApplicationTypeTelegramBot.$Type.value:return new i.ApplicationTypeTelegramBot(e.botName,e.botToken,i.Id.createId(e.formId).getOrElse(function(){throw"wrong form id"}),i.Id.createId(e.userIdField).getOrElse(function(){throw"wrong formField id"}),Object(o.toOption)(e.userTokenField).map(function(e){return i.Id.createId(e)}).getOrElse(function(){throw"wrong formField id"}),!!e.authAllowed,!!e.registrationAllowed,i.Id.createId(e.journeyEventId).getOrElse(function(){throw"wrong event id"}));case i.ApplicationTypeFacebookBot.$Type.value:return new i.ApplicationTypeFacebookBot(e.botName,e.accessToken,e.verifyToken,e.botId,i.Id.createId(e.formId).getOrElse(function(){throw"wrong form id"}),i.Id.createId(e.userIdField).getOrElse(function(){throw"wrong formField id"}),Object(o.toOption)(e.userTokenField).map(function(e){return i.Id.createId(e).getOrElse(function(){throw"wrong formField id"})}),!!e.authAllowed,!!e.registrationAllowed,i.Id.createId(e.journeyEventId).getOrElse(function(){throw"wrong event id"}));case i.ApplicationTypeMobileApp.$Type.value:return new i.ApplicationTypeMobileApp(i.Id.createId(e.formId).getOrElse(function(){throw"wrong form id"}),!!e.registrationAllowed,Object(o.toOption)(new i.ApplicationTypeWebRegistration(i.Id.createId(e.formId).getOrElse(function(){throw"wrong form id"}),i.Id.createId(e.blockId).getOrElse(function(){throw"wrong webRegistrationBlock id"}),new i.RegistrationStatus(!!e.registrationAllowed,i.Id.createId(e.deniedBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"})))),!!e.authAllowed,Object(o.toOption)(new i.ApplicationTypePrivateCabinet(i.Id.createId(e.formId).getOrElse(function(){throw"wrong form id"}),i.Id.createId(e.loginBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"}),i.Id.createId(e.cabinetBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"}),new i.Credentials(e.loginFields),new i.RegistrationStatus(!!e.authAllowed,i.Id.createId(e.loginDeniedBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"})),e.caseInsensitiveLogin,new i.PrivateCabPermissions(e.relationsTree))),new i.MobileAppUIConfig(e.uiColor),e.webPages);case i.ApplicationTypeApiKeys.$Type.value:return new i.ApplicationTypeApiKeys;default:return new i.ApplicationTypeWebRegistration(new i.Id(""),new i.Id(""),new i.RegistrationStatus(!!e.registrationAllowed,i.Id.createId(e.deniedBlockId).getOrElse(function(){throw"wrong webRegistrationBlock id"})))}}},2013:function(e,t,n){"use strict";var i=n(43),o=n.n(i),r=n(6),a=n.n(r),l=n(10),s=n.n(l),p=n(7),c=n.n(p),u=n(8),d=n.n(u),f=n(11),h=n.n(f),g=n(2),m=n(14),v=n(3),b=n(95),y=n(13),O=n(32),I=n.n(O),k=n(26),w=n.n(k),E=n(376),C=n.n(E),j=n(24),T=n.n(j),A=n(30),P=n.n(A),F=n(34),_=n.n(F),R=n(45),B=n.n(R),x=n(33),W=n.n(x),D=n(75),S=n.n(D),N=n(86),M=n.n(N),L=n(1),$=n(103),z=n(104),V=n(29),U=n(176),H=n(0),K=n(188),q=n(659),G=n(68),J=n(82),Y=n(1841),Q=n(25),X=n.n(Q),Z=n(51),ee=n(117),te=n(227),ne=n(98),ie=n.n(ne),oe=n(72),re=n.n(oe),ae=n(226),le=n(229),se=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},pe=function(e){function t(){return a()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.connectDragPreview(Object(le.getEmptyImage)(),{captureDraggingState:!0})}},{key:"render",value:function(){var e=this.props,t=e.connectDragSource,n=e.connectDropTarget,i=e.isDragging,o=e.divided,r={opacity:i?0:1,display:"flex",alignItems:"center",borderBottom:o?"1px solid #aaa":"none",paddingLeft:o?"12px":"0"};return t(n(g.createElement("div",{style:r},g.createElement("div",{style:{flex:1}},this.props.primaryText),this.props.fieldOptions,g.createElement(X.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.props.onRemoveClick},g.createElement(re.a,null)))))}}]),t}(g.Component);pe=se([y.autobind],pe);var ce=Object(ae.a)(Object(ee.DropTarget)("DraggableListItem",{hover:function(e,t,n){if(t&&t.getItem()){var i=t.getItem(),o=i.position,r=e.position;if(o!==r&&n){var a=Z.findDOMNode(n).getBoundingClientRect(),l=(a.bottom-a.top)/2,s=t.getClientOffset().y-a.top;o<r&&s<l||o>r&&s>l||(e.onFieldMoved(o,r),i.position=r)}}}},function(e,t){return{connectDropTarget:e.dropTarget()}}),Object(ee.DragSource)("DraggableListItem",{beginDrag:function(e,t,n){if(!n)return{};var i=Z.findDOMNode(n).getBoundingClientRect();return e.onBeginDrag(e.itemId,i.width),{position:e.position,width:i.width}},endDrag:function(e){e.onEndDrag()}},function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}),Object(m.connect)(function(e){return{i18n:e.i18n}}))(pe),ue=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},de=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fe=function(e){function t(e){a()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={draggableItemId:new H.None,itemWidth:0},n}return d()(t,e),s()(t,[{key:"onRemove",value:function(e){var t=this.props.values.filter(function(t){return t.id!==e});this.props.onChange(t.map(function(e){return e.id}))}},{key:"onMoved",value:function(e,t){var n=e<t?[].concat(o()(this.props.values.slice(0,e)),o()(this.props.values.slice(e+1,t+1)),[this.props.values[e]],o()(this.props.values.slice(t+1))):[].concat(o()(this.props.values.slice(0,t)),[this.props.values[e]],o()(this.props.values.slice(t,e)),o()(this.props.values.slice(e+1)));this.props.onChange(n.map(function(e){return e.id}))}},{key:"onBeginDrag",value:function(e,t){this.setState(v(this.state,{draggableItemId:{$set:Object(H.toOption)(e)},itemWidth:{$set:t}}))}},{key:"onEndDrag",value:function(){this.setState(v(this.state,{draggableItemId:{$set:new H.None},itemWidth:{$set:0}}))}},{key:"renderFieldOptions",value:function(e){return g.createElement("div",{style:{display:"flex",alignItems:"center"}},this.props.options(e))}},{key:"render",value:function(){var e=this,t=this.props,n=t.i18n,i=t.divided;return g.createElement("div",{style:{position:"relative"}},g.createElement(ie.a,null,g.createElement("h4",null,this.props.label),g.createElement("div",null,0===this.props.values.length?this.props.errorText?g.createElement("span",{style:{color:"red"}},this.props.errorText):g.createElement("span",null,n.t("Отсутствуют выбранные элементы.")):this.props.values.map(function(t,n){return g.createElement(ce,{key:t.id,position:n,primaryText:t.label,itemId:t.id,onRemoveClick:function(){return e.onRemove(t.id)},onBeginDrag:e.onBeginDrag,onEndDrag:e.onEndDrag,onFieldMoved:e.onMoved,divided:!!i,fieldOptions:e.renderFieldOptions(t.id)})}))),g.createElement(ve,null,this.state.draggableItemId.map(function(){return g.createElement("div",{style:{display:"flex",alignItems:"center",width:e.state.itemWidth}},g.createElement("div",{style:{flex:1}},e.state.draggableItemId.flatMap(function(t){return Object(H.headOption)(e.props.values.filter(function(e){return e.id===t})).map(function(e){return e.label})}).getOrElse(function(){return n.t("Элемент не выбран")})),g.createElement(X.a,{style:{alignSelf:"center",flexShrink:0}},g.createElement(re.a,null)))}).getOrNull()))}}]),t}(g.Component);fe=ue([y.autobind,de("design:paramtypes",[Object])],fe);var he=Object(m.connect)(function(e){return{i18n:e.i18n}})(Object(te.a)()(fe)),ge={position:"fixed",pointerEvents:"none",zIndex:1054,left:0,top:0,width:"100%",height:"100%"},me=function(e){function t(e){a()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={top:0,left:0},n}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(){var e=Z.findDOMNode(this);if(e){var t=e.getBoundingClientRect();this.setState({top:t.top,left:t.left})}}},{key:"render",value:function(){if(!this.props.isDragging)return null;if(!this.props.currentOffset)return null;var e=this.props.currentOffset,t=e.x,n=e.y;return g.createElement("div",{style:ge},g.createElement("div",{style:{position:"absolute",top:n-this.state.top+"px",left:t-this.state.left+"px"}},this.props.children))}}]),t}(g.Component),ve=Object(ee.DragLayer)(function(e){return{isDragging:e.isDragging(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset()}})(me),be=n(19),ye=n.n(be),Oe=n(71),Ie=n(873),ke=n.n(Ie),we=n(872),Ee=n.n(we),Ce=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},je=function(e){function t(){return a()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.fields,n=t.name,i=t.url,o=t.authorizedOnly,r=e.handleSubmit;return g.createElement("form",{onSubmit:r},g.createElement("div",null,g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Название"),error:n.touched&&n.error,helperText:n.touched&&Object(H.toOption)(n.error).map(function(e){return e}).getOrNull()}),g.createElement(w.a,{fullWidth:!0,value:i.value,onChange:i.onChange,label:this.props.i18n.t("URL"),error:i.touched&&i.error,helperText:i.touched&&Object(H.toOption)(i.error).map(function(e){return e}).getOrNull()}),g.createElement(Ee.a,{label:this.props.i18n.t("Отображать только после авторизации"),control:g.createElement(ke.a,{checked:o.value,onChange:o.onChange})})))}}]),t}(g.Component);je=Ce([y.autobind],je);var Te=Object(m.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(b.reduxForm)({form:"newApplicationWebPageForm",fields:["name","url","authorizedOnly"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.url&&0!==e.url.trim().length||(n.url=t.i18n.t("Обязательное значение")),n}})(je)),Ae=n(107),Pe=n.n(Ae),Fe=n(219),_e=n.n(Fe),Re=n(54),Be=n.n(Re),xe=n(867),We=n.n(xe),De=n(59),Se=n(83),Ne=n(174),Me=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Le=function(e,t){return!e.name||e.name.trim().length,{}},$e=function(e){function t(){return a()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"onFieldChanged",value:function(e){var t=this;e.foreach(function(e){t.props.fields.fieldId.onChange(e.value),t.props.fields.children.onChange([])})}},{key:"getFormFields",value:function(){return Object(V.e)(this.props.formFields,this.props.formId).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===L.ValueTypeObjectRefs.$Type.value})}},{key:"getForm",value:function(){var e=this;return Object(H.toOption)(this.props.fields.fieldId.value).map(function(e){return new L.Id(e)}).flatMap(function(t){return Object(V.d)({fields:e.props.formFields},e.props.formId,t)}).filter(function(e){return e.entity.valueType.tpe.value===L.ValueTypeObjectRefs.$Type.value}).map(function(e){return e.entity.valueType.family})}},{key:"render",value:function(){var e=this,t=this.props.handleSubmit;return g.createElement("form",{onSubmit:t},g.createElement(G.a,{native:!0,fullWidth:!0,labelText:Object(H.toOption)(this.props.i18n.t("Ссылочное поле")),onChanged:this.onFieldChanged,value:Object(H.toOption)(this.props.fields.fieldId.value).map(function(e){return new L.Id(e)}),fields:this.getFormFields(),errorText:new H.None}),this.getForm().map(function(t){return g.createElement(Ve,{formId:t,relations:e.props.fields.children.value||[],onChange:e.props.fields.children.onChange})}).getOrNull())}}]),t}(g.Component);$e=Me([y.autobind],$e);var ze=function(e){function t(){return a()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(Ne.e)(this.props.formId))}},{key:"componentWillReceiveProps",value:function(e){this.props.formId.value!==e.formId.value&&e.dispatch(Object(Ne.e)(e.formId))}},{key:"openEditForm",value:function(e,t,n){var i=this,o=new H.None,r=Object(m.connect)(function(e){return{i18n:e.i18n,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(b.reduxForm)({form:"AllowedFormRelationsForm",fields:["fieldId","children"],formKey:De.v4(),validate:Le})(Object(Se.a)($e))),a=this.props.openDialog(e,g.createElement(r,{ref:function(e){return o=Object(H.toOption)(e).flatMap(function(e){return Object(H.toOption)(e.wrappedInstance)})},formId:this.props.formId,initialValues:n,onSubmit:function(e){return t(e,a)}}),[g.createElement(ye.a,{variant:"raised",onClick:function(){return i.props.handleDialogClose(a)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),g.createElement(ye.a,{variant:"raised",onClick:function(){o.foreach(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"getInitialValues",value:function(e){return{fieldId:e.fieldId.value,children:e.children}}},{key:"getChild",value:function(e){return new L.AllowedFormRelations(this.props.formId,new L.Id(e.fieldId),e.children||[])}},{key:"onAddChildButtonClick",value:function(){var e=this;this.openEditForm("Добавление доступа к дочерним анкетам",function(t,n){return new Promise(function(i,o){e.props.handleDialogClose(n),e.props.onChange(v(e.props.relations,{$push:[e.getChild(t)]})),i()})})}},{key:"onChildEdit",value:function(e,t){var n=this;this.openEditForm("Редактирование доступа к анкетам",function(e,i){return new Promise(function(o,r){n.props.handleDialogClose(i),n.props.onChange(v(n.props.relations,{$splice:[[t,1,n.getChild(e)]]})),o()})},this.getInitialValues(e))}},{key:"onChildRemove",value:function(e){this.props.onChange(v(this.props.relations,{$splice:[[e,1]]}))}},{key:"getFieldName",value:function(e){return Object(V.d)(this.props,this.props.formId,e).map(function(e){return e.entity.caption}).getOrElse(function(){return""})}},{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(We.a,null,this.props.i18n.t("Доступы к дочерним анкетам")),this.props.relations.length>0&&g.createElement(ie.a,null,this.props.relations.map(function(t,n){return g.createElement(Pe.a,{key:n},g.createElement(Be.a,{primary:e.getFieldName(t.fieldId)}),g.createElement(_e.a,null,g.createElement(X.a,{onClick:function(){return e.onChildEdit(t,n)}},g.createElement(M.a,null)),g.createElement(X.a,{onClick:function(){return e.onChildRemove(n)}},g.createElement(re.a,null))))})),g.createElement("div",null,g.createElement(ye.a,{variant:"raised",onClick:this.onAddChildButtonClick,style:{marginRight:"10px"}},this.props.i18n.t("Добавить"))))}}]),t}(g.Component);ze=Me([y.autobind],ze);var Ve=Object(m.connect)(function(e){return{i18n:e.i18n,fields:e.fields}})(Object(Se.a)(ze)),Ue=Ve,He=n(422),Ke=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},qe=function(e){function t(){return a()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillMount",value:function(){this.props.fields.formId.value&&(this.props.dispatch(Object(U.d)(new L.Id(this.props.fields.formId.value))),this.props.dispatch(Object(K.b)(new L.Id(this.props.fields.formId.value))))}},{key:"componentWillReceiveProps",value:function(e){this.props.fields.formId.value!==e.fields.formId.value&&e.fields.formId.value&&(this.props.dispatch(Object(U.d)(new L.Id(e.fields.formId.value))),this.props.dispatch(Object(K.b)(new L.Id(e.fields.formId.value))))}},{key:"handleDialogClose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.props.dispatch(Object(Oe.e)(t))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4];this.props.dispatch(Object(Oe.g)({title:new H.Some(e),body:new H.Some(t),actions:n,onlyManualClose:i,options:o||new H.None}))}},{key:"onAppTypeChanged",value:function(e){this.props.fields.appType.onChange(e.target.value)}},{key:"onBlockIdChanged",value:function(e){this.props.fields.blockId.onChange(e.target.value)}},{key:"onDeniedBlockIdChanged",value:function(e){this.props.fields.deniedBlockId.onChange(e.target.value)}},{key:"onLoginDeniedBlockIdChanged",value:function(e){this.props.fields.loginDeniedBlockId.onChange(e.target.value)}},{key:"onLoginBlockIdChanged",value:function(e){this.props.fields.loginBlockId.onChange(e.target.value)}},{key:"onCabinetBlockIdChanged",value:function(e){this.props.fields.cabinetBlockId.onChange(e.target.value)}},{key:"onFormIdChanged",value:function(e){this.props.fields.formId.onChange(e.target.value)}},{key:"onRoleIdChanged",value:function(e){this.props.fields.roleId.onChange(e.target.value)}},{key:"onLoginFieldsChanged",value:function(e){this.props.fields.loginFields.onChange(e.map(function(e){return e.fieldId}))}},{key:"onWebPageAdd",value:function(){var e=this,t=void 0;this.openDialog(this.props.i18n.t("Веб-страница"),g.createElement(Te,{ref:function(e){return t=Object(H.toOption)(e).flatMap(function(e){return Object(H.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return new Promise(function(n){e.props.fields.webPages.onChange(v(e.props.fields.webPages.value||[],{$push:[new L.MobilePage(t.name,t.url,t.authorizedOnly)]})),e.handleDialogClose(),n()})}(t)},initialValues:{name:"",url:"",authorizedOnly:!1}}),[g.createElement(ye.a,{variant:"raised",onClick:this.handleDialogClose,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),g.createElement(ye.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onWebPageEdit",value:function(e){var t=this,n=this.props.fields.webPages.value||[];Object(H.headOption)(n.filter(function(t){return t.id===e})).foreach(function(i){var r=void 0;t.openDialog(t.props.i18n.t("Веб-страница"),g.createElement(Te,{ref:function(e){return r=Object(H.toOption)(e).flatMap(function(e){return Object(H.toOption)(e.wrappedInstance)})},onSubmit:function(i){return function(i){var r=n.findIndex(function(t){return t.id===e});return new Promise(function(e){t.props.fields.webPages.onChange([].concat(o()(n.slice(0,r)),[new L.MobilePage(i.name,i.url,i.authorizedOnly)],o()(n.slice(r+1)))),t.handleDialogClose(),e()})}(i)},initialValues:{name:i.name,url:i.url,authorizedOnly:i.authorizedOnly}}),[g.createElement(ye.a,{variant:"raised",onClick:t.handleDialogClose,style:{marginRight:"10px"}},t.props.i18n.t("Закрыть")),g.createElement(ye.a,{variant:"raised",onClick:function(){return r.map(function(e){return e.submit()})},color:"primary"},t.props.i18n.t("Сохранить"))])})}},{key:"onWebPagesChanged",value:function(e){var t=this;this.props.fields.webPages.onChange(e.map(function(e){return Object(H.headOption)(t.props.fields.webPages.value.filter(function(t){return t.id===e})).getOrElse(function(){return new L.MobilePage("","",!1)})}))}},{key:"onUserIdFieldChanged",value:function(e){var t=this;e.foreach(function(e){t.props.fields.userIdField.onChange(e.value)})}},{key:"onUserTokenFieldChanged",value:function(e){var t=this;e.foreach(function(e){t.props.fields.userTokenField.onChange(e.value)})}},{key:"renderPrivateCabinetSettings",value:function(){return g.createElement("div",null,!!this.props.fields.formId.value&&g.createElement("div",null,g.createElement(W.a,{label:this.props.i18n.t("Личный кабинет активнен"),control:g.createElement(B.a,{checked:this.props.fields.authAllowed.value,onChange:this.props.fields.authAllowed.onChange})}),g.createElement(Ue,{formId:new L.Id(this.props.fields.formId.value),relations:this.props.fields.relationsTree.value||[],onChange:this.props.fields.relationsTree.onChange}),g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Блок логина")),g.createElement(P.a,{fullWidth:!0,native:!0,value:this.props.fields.loginBlockId.value,onChange:this.onLoginBlockIdChanged},g.createElement("option",{value:""}),Object($.c)(this.props.blocks,new L.Id(this.props.fields.formId.value)).getOrElse(function(){return[]}).map(function(e,t){return g.createElement("option",{key:t,value:e.id.toString()},e.name)}))),g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Блок кабинета")),g.createElement(P.a,{fullWidth:!0,native:!0,value:this.props.fields.cabinetBlockId.value,onChange:this.onCabinetBlockIdChanged},g.createElement("option",{value:""}),Object($.c)(this.props.blocks,new L.Id(this.props.fields.formId.value)).getOrElse(function(){return[]}).map(function(e,t){return g.createElement("option",{key:t,value:e.id.toString()},e.name)}))),g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Блок отказа")),g.createElement(P.a,{fullWidth:!0,native:!0,value:this.props.fields.loginDeniedBlockId.value,onChange:this.onLoginDeniedBlockIdChanged},g.createElement("option",{value:""}),Object($.c)(this.props.blocks,new L.Id(this.props.fields.formId.value)).getOrElse(function(){return[]}).map(function(e,t){return g.createElement("option",{key:t,value:e.id.toString()},e.name)}))),g.createElement(q.a,{exportPipelineFields:this.props.fields.loginFields.value?this.props.fields.loginFields.value.map(function(e,t){return new L.ExportConfigField(e,t,new H.None)}):[],formId:this.props.fields.formId.value,onChange:this.onLoginFieldsChanged,label:this.props.i18n.t("Поле для логина")}),g.createElement(W.a,{label:this.props.i18n.t("Без учета регистра"),control:g.createElement(B.a,{checked:this.props.fields.caseInsensitiveLogin.value,onChange:this.props.fields.caseInsensitiveLogin.onChange})})))}},{key:"renderWebRegistrationSettings",value:function(){return!!this.props.fields.formId.value&&g.createElement("div",null,g.createElement(W.a,{label:this.props.i18n.t("Регистрация активна"),control:g.createElement(B.a,{checked:this.props.fields.registrationAllowed.value,onChange:this.props.fields.registrationAllowed.onChange})}),g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Блок")),g.createElement(P.a,{fullWidth:!0,native:!0,value:this.props.fields.blockId.value,onChange:this.onBlockIdChanged},g.createElement("option",{value:""}),Object($.c)(this.props.blocks,new L.Id(this.props.fields.formId.value)).getOrElse(function(){return[]}).map(function(e,t){return g.createElement("option",{key:t,value:e.id.toString()},e.name)}))),g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Блок отказа")),g.createElement(P.a,{fullWidth:!0,native:!0,value:this.props.fields.deniedBlockId.value,onChange:this.onDeniedBlockIdChanged},g.createElement("option",{value:""}),Object($.c)(this.props.blocks,new L.Id(this.props.fields.formId.value)).getOrElse(function(){return[]}).map(function(e,t){return g.createElement("option",{key:t,value:e.id.toString()},e.name)}))))}},{key:"getFormFields",value:function(){var e=this;return Object(H.toOption)(this.props.fields.formId.value).flatMap(function(t){return Object(V.e)(e.props.formFields,new L.Id(t))}).getOrElse(function(){return[]})}},{key:"renderFacebookBotSettings",value:function(){return g.createElement("div",null,g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:this.props.fields.botName.value,onChange:this.props.fields.botName.onChange,label:this.props.i18n.t("Название бота"),error:this.props.fields.botName.touched&&this.props.fields.botName.error,helperText:this.props.fields.botName.touched&&Object(H.toOption)(this.props.fields.botName.error).map(function(e){return e}).getOrNull()}),g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:this.props.fields.botId.value,onChange:this.props.fields.botId.onChange,label:this.props.i18n.t("Идентификатор страницы"),error:this.props.fields.botId.touched&&this.props.fields.botId.error,helperText:this.props.fields.botId.touched&&Object(H.toOption)(this.props.fields.botId.error).map(function(e){return e}).getOrNull()}),g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:this.props.fields.accessToken.value,onChange:this.props.fields.accessToken.onChange,label:this.props.i18n.t("Токен доступа"),error:this.props.fields.accessToken.touched&&this.props.fields.accessToken.error,helperText:this.props.fields.accessToken.touched&&Object(H.toOption)(this.props.fields.accessToken.error).map(function(e){return e}).getOrNull()}),g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:this.props.fields.verifyToken.value,onChange:this.props.fields.verifyToken.onChange,label:this.props.i18n.t("Токен верификации"),error:this.props.fields.verifyToken.touched&&this.props.fields.verifyToken.error,helperText:this.props.fields.verifyToken.touched&&Object(H.toOption)(this.props.fields.verifyToken.error).map(function(e){return e}).getOrNull()}),!!this.props.fields.formId.value&&g.createElement("div",null,g.createElement(G.a,{native:!0,fullWidth:!0,labelText:Object(H.toOption)(this.props.i18n.t("Поле с ид пользователя")),onChanged:this.onUserIdFieldChanged,value:Object(H.toOption)(this.props.fields.userIdField.value).map(function(e){return new L.Id(e)}),fields:this.getFormFields(),errorText:new H.None}),g.createElement(G.a,{native:!0,fullWidth:!0,labelText:Object(H.toOption)(this.props.i18n.t("Поле с токеном пользователя")),onChanged:this.onUserTokenFieldChanged,value:Object(H.toOption)(this.props.fields.userTokenField.value).map(function(e){return new L.Id(e)}),fields:this.getFormFields(),errorText:new H.None})),g.createElement(W.a,{label:this.props.i18n.t("Включить аутентификацию"),control:g.createElement(B.a,{checked:this.props.fields.authAllowed.value,onChange:this.props.fields.authAllowed.onChange})}),g.createElement(W.a,{label:this.props.i18n.t("Разрешить регистрацию"),control:g.createElement(B.a,{checked:this.props.fields.registrationAllowed.value,onChange:this.props.fields.registrationAllowed.onChange})}),g.createElement(He.a,{label:this.props.i18n.t("Идентификатор события"),fullWidth:!0,eventLineId:this.props.eventLineId,value:this.props.fields.journeyEventId.value,onChange:this.props.fields.journeyEventId.onChange}))}},{key:"renderTelegramBotSettings",value:function(){return g.createElement("div",null,g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:this.props.fields.botName.value,onChange:this.props.fields.botName.onChange,label:this.props.i18n.t("Название бота"),error:this.props.fields.botName.touched&&this.props.fields.botName.error,helperText:this.props.fields.botName.touched&&Object(H.toOption)(this.props.fields.botName.error).map(function(e){return e}).getOrNull()}),g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:this.props.fields.botToken.value,onChange:this.props.fields.botToken.onChange,label:this.props.i18n.t("Токен бота"),error:this.props.fields.botToken.touched&&this.props.fields.botToken.error,helperText:this.props.fields.botToken.touched&&Object(H.toOption)(this.props.fields.botToken.error).map(function(e){return e}).getOrNull()}),!!this.props.fields.formId.value&&g.createElement("div",null,g.createElement(G.a,{native:!0,fullWidth:!0,labelText:Object(H.toOption)(this.props.i18n.t("Поле с ид пользователя")),onChanged:this.onUserIdFieldChanged,value:Object(H.toOption)(this.props.fields.userIdField.value).map(function(e){return new L.Id(e)}),fields:this.getFormFields(),errorText:new H.None}),g.createElement(G.a,{native:!0,fullWidth:!0,labelText:Object(H.toOption)(this.props.i18n.t("Поле с токеном пользователя")),onChanged:this.onUserTokenFieldChanged,value:Object(H.toOption)(this.props.fields.userTokenField.value).map(function(e){return new L.Id(e)}),fields:this.getFormFields(),errorText:new H.None})),g.createElement(W.a,{label:this.props.i18n.t("Включить аутентификацию"),control:g.createElement(B.a,{checked:this.props.fields.authAllowed.value,onChange:this.props.fields.authAllowed.onChange})}),g.createElement(W.a,{label:this.props.i18n.t("Разрешить регистрацию"),control:g.createElement(B.a,{checked:this.props.fields.registrationAllowed.value,onChange:this.props.fields.registrationAllowed.onChange})}),g.createElement(He.a,{label:this.props.i18n.t("Идентификатор события"),fullWidth:!0,eventLineId:this.props.eventLineId,value:this.props.fields.journeyEventId.value,onChange:this.props.fields.journeyEventId.onChange}))}},{key:"renderMobileAppSettings",value:function(){var e=this;return!!this.props.fields.formId.value&&g.createElement("div",null,g.createElement("h3",{className:"Form__header-first"},this.props.i18n.t("Регистрация")),this.renderWebRegistrationSettings(),g.createElement("h3",{className:"Form__header-first"},this.props.i18n.t("Личный кабинет")),this.renderPrivateCabinetSettings(),g.createElement("h3",{className:"Form__header-first"},this.props.i18n.t("Интерфейс")),g.createElement(Y.a,{color:this.props.fields.uiColor.value,onChange:this.props.fields.uiColor.onChange},g.createElement("p",{className:"Form__header-first"},this.props.i18n.t("Цветовая схема"))),g.createElement(he,{values:(this.props.fields.webPages.value||[]).map(function(e){return{id:e.id,label:e.name}}),onChange:this.onWebPagesChanged,label:this.props.i18n.t("Веб-страницы"),options:function(t){return[g.createElement(X.a,{"aria-label":e.props.i18n.t("Изменить"),onClick:function(){return e.onWebPageEdit(t)}},g.createElement(M.a,null))]}}),g.createElement(ye.a,{variant:"raised",onClick:this.onWebPageAdd},this.props.i18n.t("Добавить")))}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields.name,i=t.handleSubmit;return g.createElement("form",{onSubmit:i},g.createElement(w.a,{fullWidth:!0,autoFocus:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Название"),error:n.touched&&n.error,helperText:n.touched&&Object(H.toOption)(n.error).map(function(e){return e}).getOrNull()}),g.createElement(W.a,{label:this.props.i18n.t("Активность приложения"),control:g.createElement(S.a,{checked:this.props.fields.active.value,onChange:function(t,n){return e.props.fields.active.onChange(n)}})}),!!this.props.fields.apiKey.value&&this.props.fields.appType.value!==L.ApplicationTypeTelegramBot.$Type.value&&g.createElement("div",null,g.createElement(C.a,null,this.props.i18n.t("Ключ приложения")),g.createElement("p",{style:{width:"100%",wordWrap:"break-word"}},this.props.fields.apiKey.value)),g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Роль")),g.createElement(P.a,{fullWidth:!0,value:this.props.fields.roleId.value,onChange:this.onRoleIdChanged},this.props.roles.descriptionsList.map(function(e){return g.createElement(T.a,{key:e.id.toString(),value:e.id.toString()},e.name)}))),g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Тип использования")),g.createElement(P.a,{fullWidth:!0,value:this.props.fields.appType.value,onChange:this.onAppTypeChanged},g.createElement(T.a,{value:L.ApplicationTypeWebRegistration.$Type.value},this.props.i18n.t("Регистрация")),g.createElement(T.a,{value:L.ApplicationTypePrivateCabinet.$Type.value},this.props.i18n.t("Личный кабинет")),g.createElement(T.a,{value:L.ApplicationTypeMobileApp.$Type.value},this.props.i18n.t("Мобильное приложение")),g.createElement(T.a,{value:L.ApplicationTypeApiKeys.$Type.value},this.props.i18n.t("API keys")),!J.default.isA5000&&g.createElement(T.a,{value:L.ApplicationTypeTelegramBot.$Type.value},this.props.i18n.t("Бот в телеграмме")),!J.default.isA5000&&g.createElement(T.a,{value:L.ApplicationTypeFacebookBot.$Type.value},this.props.i18n.t("Бот в facebook")))),(this.props.fields.appType.value===L.ApplicationTypeWebRegistration.$Type.value||this.props.fields.appType.value===L.ApplicationTypePrivateCabinet.$Type.value||this.props.fields.appType.value===L.ApplicationTypeMobileApp.$Type.value||this.props.fields.appType.value===L.ApplicationTypeFacebookBot.$Type.value||this.props.fields.appType.value===L.ApplicationTypeTelegramBot.$Type.value)&&g.createElement(I.a,{fullWidth:!0},g.createElement(_.a,null,this.props.i18n.t("Форма")),g.createElement(P.a,{fullWidth:!0,value:this.props.fields.formId.value,onChange:this.onFormIdChanged},this.props.eventLine.data.map(function(t){return Object(z.f)(e.props.forms,t.id)}).getOrElse(function(){return[]}).filter(function(e){return L.FormType.isApplicationForm(e.entity.formType)}).map(function(e,t){return g.createElement(T.a,{key:t,value:e.id.value},e.entity.name)}))),this.props.fields.appType.value===L.ApplicationTypeWebRegistration.$Type.value&&this.renderWebRegistrationSettings(),this.props.fields.appType.value===L.ApplicationTypePrivateCabinet.$Type.value&&this.renderPrivateCabinetSettings(),this.props.fields.appType.value===L.ApplicationTypeMobileApp.$Type.value&&this.renderMobileAppSettings(),this.props.fields.appType.value===L.ApplicationTypeTelegramBot.$Type.value&&this.renderTelegramBotSettings(),this.props.fields.appType.value===L.ApplicationTypeFacebookBot.$Type.value&&this.renderFacebookBotSettings())}}]),t}(g.Component);qe=Ke([y.autobind],qe);t.a=Object(m.connect)(function(e){return{i18n:e.i18n,roles:e.roles,forms:e.forms,blocks:e.blocks,eventLine:e.eventLine,webPages:e.webPages,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(b.reduxForm)({form:"newApplicationForm",fields:["name","appType","active","apiKey","roleId","formId","blockId","deniedBlockId","loginBlockId","loginDeniedBlockId","cabinetBlockId","loginFields","botName","botId","botToken","accessToken","verifyToken","userIdField","userTokenField","authAllowed","registrationAllowed","uiColor","caseInsensitiveLogin","webPages","relationsTree","journeyEventId"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(Object(Se.a)(qe)))},2710:function(e,t,n){"use strict";n.r(t);var i=n(6),o=n.n(i),r=n(10),a=n.n(r),l=n(7),s=n.n(l),p=n(8),c=n.n(p),u=n(11),d=n.n(u),f=n(2),h=n(14),g=n(13),m=n(1),v=n(160),b=n.n(v),y=n(2013),O=n(1483),I=n(0),k=n(71),w=n(201),E=n(136),C=n(649),j=n(19),T=n.n(j),A=n(93),P=n.n(A),F=n(1478),_=n(79),R=n(1461),B=n(1467),x=n(1592),W=n(1982),D=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},S=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},N=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,B.a.screenInitialState()))}return c()(t,e),a()(t,[{key:"getInitialValues",value:function(e){var t=this;return Object(I.headOption)(this.props.applications.list.filter(function(t){return t.id.value===e.value})).map(function(e){return Object.assign({name:e.entity.name,appType:e.entity.appType.tpe.value,active:e.entity.active,apiKey:e.entity.apiKey,roleId:e.entity.roleId.value,uiColor:"#607D8B",registrationAllowed:!0,authAllowed:!0},t.getInitialValuesForAppType(e.entity.appType))}).getOrElse(function(){return{}})}},{key:"getInitialValuesForAppType",value:function(e){var t=this,n={botName:"",botToken:"",userIdField:"",userTokenField:"",webPages:[]};return e instanceof m.ApplicationTypeWebRegistration?Object.assign({},n,{formId:e.formId.value,deniedBlockId:e.regStatus.deniedBlock.value,blockId:e.blockId.value,registrationAllowed:e.regStatus.allowed}):e instanceof m.ApplicationTypePrivateCabinet?Object.assign({},n,{formId:e.formId.value,loginDeniedBlockId:e.regStatus.deniedBlock.value,loginBlockId:e.signinBlockId.value,cabinetBlockId:e.cabinetBlockId.value,loginFields:e.credentials.fields,authAllowed:e.regStatus.allowed,caseInsensitiveLogin:e.caseInsensitiveLogin,relationsTree:e.permissions.relationsTree}):e instanceof m.ApplicationTypeMobileApp?Object.assign({},n,e.cab.map(function(e){return t.getInitialValuesForAppType(e)}).getOrElse(function(){return{}}),e.webReg.map(function(e){return t.getInitialValuesForAppType(e)}).getOrElse(function(){return{}}),{formId:e.formId.value,registrationAllowed:e.webRegActive,authAllowed:e.cabActive,uiColor:e.uiConfig.color,webPages:e.pages}):e instanceof m.ApplicationTypeTelegramBot?Object.assign({},n,{formId:e.formId.value,botName:e.botName,botToken:e.botToken,userIdField:e.userIdField.value,userTokenField:e.userTokenField.map(function(e){return e.value}).getOrElse(function(){return""}),authAllowed:e.authAllowed,registrationAllowed:e.registrationAllowed,journeyEventId:e.journeyEventId.value}):e instanceof m.ApplicationTypeFacebookBot?Object.assign({},n,{formId:e.formId.value,botName:e.botName,botId:e.botId,accessToken:e.accessToken,verifyToken:e.verifyToken,userIdField:e.userIdField.value,userTokenField:e.userTokenField.map(function(e){return e.value}).getOrElse(function(){return""}),authAllowed:e.authAllowed,registrationAllowed:e.registrationAllowed,journeyEventId:e.journeyEventId.value}):Object.assign({},n)}},{key:"onGoBackRequested",value:function(){this.props.dispatch(Object(_.j)(new m.Id(this.props.params.eventLineId)))}},{key:"onSave",value:function(e){var t=this;return new Promise(function(n,i){return Object(O.f)(new m.Id(t.props.params.appId),e.name,new m.Id(e.roleId),Object(W.a)(e),e.active).then(function(e){n(e),t.props.dispatch(Object(k.h)(t.props.i18n.t("Изменения в приложении успешно сохранены!")))}).catch(function(e){i(e)})}).catch(function(e){return t.props.dispatch(Object(w.b)(e))})}},{key:"refHandler",value:function(e){this.formInstance=Object(I.toOption)(e).flatMap(function(e){return Object(I.toOption)(e.wrappedInstance)})}},{key:"onSaveClick",value:function(){this.formInstance.map(function(e){return e.submit()})}},{key:"render",value:function(){var e=this;return this.renderScreenBody({className:""},f.createElement(P.a,{style:{padding:15,margin:8,height:"90vh",overflowY:"auto"}},this.props.applications.fetching?f.createElement(b.a,{size:150,thickness:2,style:{position:"absolute",left:"50%",top:"50%"}}):f.createElement(f.Fragment,null,f.createElement(F.a,{title:this.props.i18n.t("Конфигурация приложения"),onGoBackRequested:this.onGoBackRequested,rightButtonGroup:[f.createElement(T.a,{color:"primary",variant:"raised",style:{margin:"0px 15px",flexShrink:0},onClick:this.onSaveClick},this.props.i18n.t("Сохранить"))]}),f.createElement(y.a,{ref:this.refHandler,onSubmit:function(t){return e.onSave(t)},eventLineId:m.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong event id"}),initialValues:this.getInitialValues(new m.Id(this.props.params.appId))}),f.createElement(x.a,null))))}}]),t}(B.a);N=D([g.autobind,S("design:paramtypes",[Object])],N),t.default=Object(h.connect)(function(e,t){return{applications:e.applications,i18n:e.i18n}},function(e,t){return{dispatch:function(t){return e(t)}}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.applications===t.applications&&e.i18n===t.i18n}})(Object(R.a)(Object(E.a)(function(e){e.isTokenChecked&&(e.dispatch(Object(O.d)(new m.Id(e.params.eventLineId))),e.dispatch(Object(C.a)()))},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&(e.dispatch(Object(C.a)()),e.dispatch(Object(O.d)(new m.Id(e.params.eventLineId))))})(N)))}}]);