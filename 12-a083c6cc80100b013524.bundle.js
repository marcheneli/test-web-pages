(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[12],{1977:function(e,t,n){var a=n(2206);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(116)(a,r);a.locals&&(e.exports=a.locals)},2206:function(e,t,n){(e.exports=n(115)(!1)).push([e.i,".PdfControlEditor__placeholder:hover{background-color:#eaf8ff}\n",""])},2211:function(e,t){},2212:function(e,t){},2213:function(e,t){},2214:function(e,t){},2402:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),i=n(10),o=n.n(i),s=n(4),c=n.n(s),u=n(5),l=n.n(u),d=n(1),p=n(11),h=n(73),f=n(36),g=n(12),m=n.n(g),v=n(15),y=n(8),b=n(722),E=n(724),k=n(447),R=n.n(k),S=n(253),P=n(61),C=n.n(P),O=n(463),F=n(1938),j=n.n(F),N=n(1939),w=n.n(N),L=n(1981),I=n.n(L),x=n(1980),q=n.n(x),$=n(712),D=n.n($),_=n(713),W=n.n(_),M=n(1982),A=n.n(M),T=n(554),U=function(e){return d.createElement(T.a,Object.assign({},e),d.createElement("path",{d:"M14,9H19.5L14,3.5V9M7,2H15L21,8V20A2,2 0 0,1 19,22H7C5.89,22 5,21.1 5,20V4A2,2 0 0,1 7,2M11.93,12.44C12.34,13.34 12.86,14.08 13.46,14.59L13.87,14.91C13,15.07 11.8,15.35 10.53,15.84V15.84L10.42,15.88L10.92,14.84C11.37,13.97 11.7,13.18 11.93,12.44M18.41,16.25C18.59,16.07 18.68,15.84 18.69,15.59C18.72,15.39 18.67,15.2 18.57,15.04C18.28,14.57 17.53,14.35 16.29,14.35L15,14.42L14.13,13.84C13.5,13.32 12.93,12.41 12.53,11.28L12.57,11.14C12.9,9.81 13.21,8.2 12.55,7.54C12.39,7.38 12.17,7.3 11.94,7.3H11.7C11.33,7.3 11,7.69 10.91,8.07C10.54,9.4 10.76,10.13 11.13,11.34V11.35C10.88,12.23 10.56,13.25 10.05,14.28L9.09,16.08L8.2,16.57C7,17.32 6.43,18.16 6.32,18.69C6.28,18.88 6.3,19.05 6.37,19.23L6.4,19.28L6.88,19.59L7.32,19.7C8.13,19.7 9.05,18.75 10.29,16.63L10.47,16.56C11.5,16.23 12.78,16 14.5,15.81C15.53,16.32 16.74,16.55 17.5,16.55C17.94,16.55 18.24,16.44 18.41,16.25M18,15.54L18.09,15.65C18.08,15.75 18.05,15.76 18,15.78H17.96L17.77,15.8C17.31,15.8 16.6,15.61 15.87,15.29C15.96,15.19 16,15.19 16.1,15.19C17.5,15.19 17.9,15.44 18,15.54M8.83,17C8.18,18.19 7.59,18.85 7.14,19C7.19,18.62 7.64,17.96 8.35,17.31L8.83,17M11.85,10.09C11.62,9.19 11.61,8.46 11.78,8.04L11.85,7.92L12,7.97C12.17,8.21 12.19,8.53 12.09,9.07L12.06,9.23L11.9,10.05L11.85,10.09Z"}))},z=n(3),V=n(0),Z=n(22),K=n(43),H=n(76),B=n(67),G=n(40),J=(n(1977),n(50)),Q=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},X=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Y=n(1978);Y.GlobalWorkerOptions.workerSrc=n(1979);var ee={color:R.a[500]},te=function(e){function t(e){r()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={pdfDoc:new V.b,pdfUploading:!1,pdfFetching:!1,pageNum:1,pageRendering:!1,pageNumPending:new V.b,pageScale:1,pageRotation:0},n}return l()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.initPage(this.props),this.subscribeToEvents()}},{key:"componentWillUnmount",value:function(){this.unsubscribeFromEvents()}},{key:"componentWillReceiveProps",value:function(e){Object(V.h)(this.getPdfSrc(this.props),this.getPdfSrc(e))||this.initPage(e)}},{key:"subscribeToEvents",value:function(){var e=this;document.addEventListener("keydown",(function(t){return e.initKeyboardControls(t.key)})),document.addEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("fullscreenchange",this.onFullScreenExit,!1),document.addEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"unsubscribeFromEvents",value:function(){var e=this;document.removeEventListener("keydown",(function(t){return e.initKeyboardControls(t.key)})),document.removeEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("fullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"initKeyboardControls",value:function(e){var t=this;Object(V.l)("ArrowRight"===e).filter((function(e){return e})).foreach((function(){return t.onNextPage()})),Object(V.l)("ArrowLeft"===e).filter((function(e){return e})).foreach((function(){return t.onPrevPage()}))}},{key:"onFullScreenExit",value:function(){var e=this,t=document,n=t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement;Object(V.l)(n).matchWith((function(){}),(function(){return e.setState(y(e.state,{pageScale:{$set:1}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}))}},{key:"handleCanvasRef",value:function(e){this.canvasRef=Object(V.l)(e)}},{key:"showNotification",value:function(e){this.props.dispatch(Object(K.f)(this.props.i18n.t(e)))}},{key:"updateUploadingState",value:function(e){this.setState(y(this.state,{pdfUploading:{$set:e}}))}},{key:"updateFetchingState",value:function(e,t){this.setState(y(this.state,{pdfFetching:{$set:e}}),t)}},{key:"getPdfSrc",value:function(e){return e.value.flatMap((function(t){return Object(V.g)(t.files).flatMap((function(t){return e.authToken.map((function(n){return Object(H.b)(n,t,e.cdnAddress)}))}))}))}},{key:"initPage",value:function(e){var t=this;this.getPdfSrc(e).foreach((function(e){t.updateFetchingState(!0,(function(){Y.getDocument(e).then((function(e){t.setState(y(t.state,{pdfDoc:{$set:Object(V.l)(e)},pdfFetching:{$set:!1}}),(function(){t.props.control.hideWhenWrongFormat&&t.props.dispatch(Object(J.x)({blockRendererId:t.props.blockRendererId,displayId:t.props.display.id,visibility:!0})),t.renderPage(t.state.pageNum)}))})).catch((function(e){t.setState(y(t.state,{pdfFetching:{$set:!1}}),(function(){t.props.control.hideWhenWrongFormat&&"InvalidPDFException"===e.name&&t.props.dispatch(Object(J.x)({blockRendererId:t.props.blockRendererId,displayId:t.props.display.id,visibility:!1}))}))}))}))}))}},{key:"renderPage",value:function(e){var t=this;this.setState(y(this.state,{pageRendering:{$set:!0}})),this.canvasRef.isEmpty()||this.state.pdfDoc.foreach((function(n){return n.getPage(e).then((function(e){t.canvasRef.foreach((function(n){var a=n.getContext("2d");Object(V.l)(a).foreach((function(a){var r=e.getViewport(t.state.pageScale,t.state.pageRotation);n.width=r.width,n.height=r.height,e.render({canvasContext:a,viewport:r}).promise.then((function(){t.setState(y(t.state,{pageRendering:{$set:!1}})),t.state.pageNumPending.nonEmpty()&&(t.renderPage(t.state.pageNumPending.getOrElse((function(){return 1}))),t.setState(y(t.state,{pageNumPending:{$set:new V.b}})))}))}))}))}))}))}},{key:"queueRenderPage",value:function(e){this.state.pageRendering?this.setState(y(this.state,{pageNumPending:{$set:Object(V.l)(e)}})):this.renderPage(e)}},{key:"onNextPage",value:function(){var e=this;this.state.pdfDoc.map((function(t){return e.state.pageNum>=t.numPages})).getOrElse((function(){return!1}))||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum+1}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onPrevPage",value:function(){var e=this;this.state.pageNum<=1||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum-1}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onZoomOut",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale-.25}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onZoomIn",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale+.25}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onRotateLeft",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation-90}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onRotateRight",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation+90}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onPageNumChange",value:function(e){var t=this,n=this.state.pdfDoc.map((function(e){return e.numPages})).getOrElse((function(){return 1})),a=parseInt(e.target.value);isNaN(a)||a>n||a<1||this.setState(y(this.state,{pageNum:{$set:a}}),(function(){return t.queueRenderPage(t.state.pageNum)}))}},{key:"toggleFullScreen",value:function(){var e=this;this.canvasRef.foreach((function(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),e.setState(y(e.state,{pageScale:{$set:2}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}))}},{key:"renderControls",value:function(){var e=this;return d.createElement(b.a,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:5,marginBottom:5}},d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(S.a,{style:G.d,disabled:this.state.pageNum<=1,onClick:this.onPrevPage},d.createElement(j.a,{style:G.e})),d.createElement(S.a,{style:G.d,disabled:this.state.pdfDoc.map((function(t){return e.state.pageNum>=t.numPages})).getOrElse((function(){return!1})),onClick:this.onNextPage},d.createElement(w.a,{style:G.e})),d.createElement(E.a,{type:"number",variant:"outlined",style:{backgroundColor:"white",width:70,margin:"0 0 0 5px"},value:this.state.pageNum,onChange:this.onPageNumChange}),"/",this.state.pdfDoc.map((function(e){return e.numPages})).getOrElse((function(){return e.state.pageNum}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(S.a,{style:G.d,disabled:this.state.pageScale<=.25,onClick:this.onZoomOut},d.createElement(q.a,{style:G.e})),d.createElement(S.a,{style:G.d,onClick:this.onZoomIn},d.createElement(I.a,{style:G.e})),d.createElement(S.a,{style:G.d,onClick:this.toggleFullScreen},d.createElement(A.a,{style:G.e}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(S.a,{style:G.d,disabled:this.state.pageScale<=.25,onClick:this.onRotateLeft},d.createElement(D.a,{style:G.e})),d.createElement(S.a,{style:G.d,onClick:this.onRotateRight},d.createElement(W.a,{style:G.e}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}}))}},{key:"renderCanvas",value:function(){return this.state.pdfFetching?d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",border:"2px dashed ".concat(C.a[600]),borderRadius:5,height:200}},d.createElement(O.a,null)):d.createElement("canvas",{ref:this.handleCanvasRef,onClick:this.onNextPage})}},{key:"renderPlaceholder",value:function(){return d.createElement("div",{className:"PdfControlEditor__placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",height:200,width:200,border:"2px dashed ".concat(C.a[600]),borderRadius:5,cursor:"pointer"}},this.state.pdfUploading?d.createElement(O.a,null):d.createElement(U,{style:{color:C.a[600]}}))}},{key:"render",value:function(){return d.createElement("div",{style:{textAlign:"center"}},this.getPdfSrc(this.props).nonEmpty()&&this.renderControls(),this.getPdfSrc(this.props).isEmpty()?this.renderPlaceholder():this.renderCanvas(),this.props.error.map((function(e){return d.createElement("p",{style:ee},e)})).getOrNull())}}]),t}(d.Component);te=Q([v.autobind,X("design:paramtypes",[Object])],te);var ne=Object(p.connect)((function(e,t){return{value:Object(Z.e)(e.dataOutput,t.blockRendererId,t.output).map((function(e){return e.value})).filter((function(e){return e instanceof z.ValueFileList})),error:Object(Z.n)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,cdnAddress:e.config.cdnAddress}}),(function(e){return{dispatch:e}}),(function(e,t,n){return Object.assign(Object.assign(Object.assign({},e),t),n)}),{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token},areStatePropsEqual:function(e,t){return Object(V.h)(e.value,t.value)&&Object(V.h)(e.error,t.error)&&Object(V.h)(e.authToken,t.authToken)&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display}})(Object(B.a)(te)),ae=n(534),re=n(277),ie=n.n(re),oe=n(192),se=n.n(oe),ce=n(81),ue=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},le=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},de=n(1978);de.GlobalWorkerOptions.workerSrc=n(1979);var pe={color:R.a[500]},he=function(e){function t(e){r()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={pdfDoc:new V.b,pdfUploading:!1,pdfFetching:!1,pageNum:1,pageRendering:!1,pageNumPending:new V.b,pageScale:1,pageRotation:0},n}return l()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.initPage(this.props),this.subscribeToEvents()}},{key:"componentWillUnmount",value:function(){this.unsubscribeFromEvents()}},{key:"componentWillReceiveProps",value:function(e){Object(V.h)(this.getPdfSrc(this.props),this.getPdfSrc(e))||this.initPage(e)}},{key:"subscribeToEvents",value:function(){var e=this;document.addEventListener("keydown",(function(t){return e.initKeyboardControls(t.key)})),document.addEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.addEventListener("fullscreenchange",this.onFullScreenExit,!1),document.addEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"unsubscribeFromEvents",value:function(){var e=this;document.removeEventListener("keydown",(function(t){return e.initKeyboardControls(t.key)})),document.removeEventListener("webkitfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("mozfullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("fullscreenchange",this.onFullScreenExit,!1),document.removeEventListener("MSFullscreenChange",this.onFullScreenExit,!1)}},{key:"initKeyboardControls",value:function(e){var t=this;Object(V.l)("ArrowRight"===e).filter((function(e){return e})).foreach((function(){return t.onNextPage()})),Object(V.l)("ArrowLeft"===e).filter((function(e){return e})).foreach((function(){return t.onPrevPage()}))}},{key:"onFullScreenExit",value:function(){var e=this,t=document,n=t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement;Object(V.l)(n).matchWith((function(){}),(function(){return e.setState(y(e.state,{pageScale:{$set:1}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}))}},{key:"handleDelete",value:function(){var e=this;this.props.value.flatMap((function(e){return Object(V.g)(e.files)})).foreach((function(t){return e.deleteFile(t).then((function(t){return e.onChange(new z.ValueFileList([]))}))}))}},{key:"handleCanvasRef",value:function(e){this.canvasRef=Object(V.l)(e)}},{key:"showNotification",value:function(e){this.props.dispatch(Object(K.f)(this.props.i18n.t(e)))}},{key:"onChange",value:function(e){var t=this;this.props.formRecordId.matchWith((function(e){Object(ce.f)(t.props.formId,e,t.props.output.formField).then((function(e){return Object(V.g)(e.list).matchWith((function(e){t.props.onChange(new z.ValueFileList([e.id]),t.props.output)}),(function(){t.props.onChange(new z.ValueFileList([]),t.props.output)}))}))}),(function(){t.props.onChange(e,t.props.output)}))}},{key:"deleteFile",value:function(e){var t=this;return Object(ce.a)(e).then((function(e){t.showNotification("Файл успешно удалено")})).catch((function(e){return t.showNotification("Во время удаления файла произошла ошибка")}))}},{key:"updateUploadingState",value:function(e){this.setState(y(this.state,{pdfUploading:{$set:e}}))}},{key:"updateFetchingState",value:function(e,t){this.setState(y(this.state,{pdfFetching:{$set:e}}),t)}},{key:"onUploadFileRequested",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Загрузка файла"),d.createElement(ae,{onDrop:function(n){return function(t,n){if(0===t.length)throw"There are not files to process";e.updateUploadingState(!0);var a=t[t.length-1];Object(ce.h)(a,e.props.cdnAddress,e.props.authToken,e.props.organisation.organisationId,e.props.eventLine.eventLineId,e.props.formRecordId,new V.b,"false",!1,Object(V.l)(e.props.output.formField),Object(V.l)(e.props.formId)).then((function(t){e.props.value.flatMap((function(e){return Object(V.g)(e.files)})).foreach((function(t){return e.deleteFile(t)})),e.onChange(new z.ValueFileList([t])),e.updateUploadingState(!1)})).catch((function(t){e.props.dispatch(Object(K.f)(e.props.i18n.t("Во время загрузки файла произошла ошибка"))),e.updateUploadingState(!1)})),e.props.handleDialogClose(n)}(n,t)},multiple:!0,accept:"application/pdf",className:"FileListControlEditor__dropzone"},(function(t){var n=t.isDragActive;return d.createElement("div",{className:n?"FileListControlEditor__dropzone-wrapper":""},d.createElement("div",{className:"FileListControlEditor__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))})),[])}},{key:"getPdfSrc",value:function(e){return e.value.flatMap((function(t){return Object(V.g)(t.files).flatMap((function(t){return e.authToken.map((function(n){return Object(H.b)(n,t,e.cdnAddress)}))}))}))}},{key:"initPage",value:function(e){var t=this;this.getPdfSrc(e).foreach((function(e){t.updateFetchingState(!0,(function(){de.getDocument(e).then((function(e){t.setState(y(t.state,{pdfDoc:{$set:Object(V.l)(e)},pdfFetching:{$set:!1}}),(function(){t.props.control.hideWhenWrongFormat&&t.props.dispatch(Object(J.x)({blockRendererId:t.props.blockRendererId,displayId:t.props.display.id,visibility:!0})),t.renderPage(t.state.pageNum)}))})).catch((function(e){t.setState(y(t.state,{pdfFetching:{$set:!1}}),(function(){t.props.control.hideWhenWrongFormat&&"InvalidPDFException"===e.name&&t.props.dispatch(Object(J.x)({blockRendererId:t.props.blockRendererId,displayId:t.props.display.id,visibility:!1}))}))}))}))}))}},{key:"renderPage",value:function(e){var t=this;this.setState(y(this.state,{pageRendering:{$set:!0}})),this.canvasRef.isEmpty()||this.state.pdfDoc.foreach((function(n){return n.getPage(e).then((function(e){t.canvasRef.foreach((function(n){var a=n.getContext("2d");Object(V.l)(a).foreach((function(a){var r=e.getViewport(t.state.pageScale,t.state.pageRotation);n.width=r.width,n.height=r.height,e.render({canvasContext:a,viewport:r}).promise.then((function(){t.setState(y(t.state,{pageRendering:{$set:!1}})),t.state.pageNumPending.nonEmpty()&&(t.renderPage(t.state.pageNumPending.getOrElse((function(){return 1}))),t.setState(y(t.state,{pageNumPending:{$set:new V.b}})))}))}))}))}))}))}},{key:"queueRenderPage",value:function(e){this.state.pageRendering?this.setState(y(this.state,{pageNumPending:{$set:Object(V.l)(e)}})):this.renderPage(e)}},{key:"onNextPage",value:function(){var e=this;this.state.pdfDoc.map((function(t){return e.state.pageNum>=t.numPages})).getOrElse((function(){return!1}))||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum+1}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onPrevPage",value:function(){var e=this;this.state.pageNum<=1||this.setState(y(this.state,{pageNum:{$set:this.state.pageNum-1}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onZoomOut",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale-.25}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onZoomIn",value:function(){var e=this;this.setState(y(this.state,{pageScale:{$set:this.state.pageScale+.25}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onRotateLeft",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation-90}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onRotateRight",value:function(){var e=this;this.setState(y(this.state,{pageRotation:{$set:this.state.pageRotation+90}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}},{key:"onPageNumChange",value:function(e){var t=this,n=this.state.pdfDoc.map((function(e){return e.numPages})).getOrElse((function(){return 1})),a=parseInt(e.target.value);isNaN(a)||a>n||a<1||this.setState(y(this.state,{pageNum:{$set:a}}),(function(){return t.queueRenderPage(t.state.pageNum)}))}},{key:"toggleFullScreen",value:function(){var e=this;this.canvasRef.foreach((function(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),e.setState(y(e.state,{pageScale:{$set:2}}),(function(){return e.queueRenderPage(e.state.pageNum)}))}))}},{key:"renderControls",value:function(){var e=this;return d.createElement(b.a,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:5,marginBottom:5}},d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(S.a,{style:G.d,disabled:this.state.pageNum<=1,onClick:this.onPrevPage},d.createElement(j.a,{style:G.e})),d.createElement(S.a,{style:G.d,disabled:this.state.pdfDoc.map((function(t){return e.state.pageNum>=t.numPages})).getOrElse((function(){return!1})),onClick:this.onNextPage},d.createElement(w.a,{style:G.e})),d.createElement(E.a,{type:"number",variant:"outlined",style:{backgroundColor:"white",width:70,margin:"0 0 0 5px"},value:this.state.pageNum,onChange:this.onPageNumChange}),"/",this.state.pdfDoc.map((function(e){return e.numPages})).getOrElse((function(){return e.state.pageNum}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(S.a,{style:G.d,disabled:this.state.pageScale<=.25,onClick:this.onZoomOut},d.createElement(q.a,{style:G.e})),d.createElement(S.a,{style:G.d,onClick:this.onZoomIn},d.createElement(I.a,{style:G.e})),d.createElement(S.a,{style:G.d,onClick:this.toggleFullScreen},d.createElement(A.a,{style:G.e}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(S.a,{style:G.d,disabled:this.state.pageScale<=.25,onClick:this.onRotateLeft},d.createElement(D.a,{style:G.e})),d.createElement(S.a,{style:G.d,onClick:this.onRotateRight},d.createElement(W.a,{style:G.e}))),d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement(S.a,{style:G.d,onClick:this.onUploadFileRequested},d.createElement(ie.a,{style:G.e})),d.createElement(S.a,{style:G.d,onClick:this.handleDelete},d.createElement(se.a,{style:G.e}))))}},{key:"renderCanvas",value:function(){return this.state.pdfFetching?d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",border:"2px dashed ".concat(C.a[600]),borderRadius:5,height:200}},d.createElement(O.a,null)):d.createElement("canvas",{ref:this.handleCanvasRef,onClick:this.onNextPage})}},{key:"renderPlaceholder",value:function(){return d.createElement("div",{onClick:this.onUploadFileRequested,className:"PdfControlEditor__placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",height:200,width:200,border:"2px dashed ".concat(C.a[600]),borderRadius:5,cursor:"pointer"}},this.state.pdfUploading?d.createElement(O.a,null):d.createElement(U,{style:{color:C.a[600]}}))}},{key:"render",value:function(){return d.createElement("div",{style:{textAlign:"center"}},this.getPdfSrc(this.props).nonEmpty()&&this.renderControls(),this.getPdfSrc(this.props).isEmpty()?this.renderPlaceholder():this.renderCanvas(),this.props.error.map((function(e){return d.createElement("p",{style:pe},e)})).getOrNull())}}]),t}(d.Component);he=ue([v.autobind,le("design:paramtypes",[Object])],he);var fe=Object(p.connect)((function(e,t){return{value:Object(Z.e)(e.dataOutput,t.blockRendererId,t.output).map((function(e){return e.value})).filter((function(e){return e instanceof z.ValueFileList})),error:Object(Z.n)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}}),(function(e){return{dispatch:e}}),(function(e,t,n){return Object.assign(Object.assign(Object.assign({},e),t),n)}),{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation},areStatePropsEqual:function(e,t){return Object(V.h)(e.value,t.value)&&Object(V.h)(e.error,t.error)&&Object(V.h)(e.authToken,t.authToken)&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(V.h)(e.formRecordId,t.formRecordId)}})(Object(B.a)(he)),ge=n(27),me=function(e){function t(){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l()(t,e),o()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(f.a,{display:this.props.display,style:this.props.visibility?{}:{display:"none"},blockStyle:this.props.blockStyle},d.createElement(ne,{control:this.props.control,display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(f.a,{display:this.props.display,blockStyle:this.props.blockStyle,style:this.props.visibility?{}:{display:"none"}},d.createElement(fe,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,output:this.props.output,formId:this.props.formId,control:this.props.control,onChange:this.props.onChange}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(h.a);t.default=Object(p.connect)((function(e,t){return{i18n:e.i18n,visibility:!t.control.hideWhenWrongFormat||Object(ge.d)(e.blockRendererContext,t.blockRendererId,t.display.id).getOrElse((function(){return!1}))}}),(function(e,t){return{dispatch:e}}),(function(e,t,n){return Object.assign(Object.assign(Object.assign({},e),t),n)}),{areStatesEqual:function(e,t){return e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.visibility===t.visibility},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(V.h)(e.blockStyle,e.blockStyle)&&Object(V.h)(e.formRecordId,e.formRecordId)}})(me)}}]);