(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[61],{1483:function(e,t,n){"use strict";var r=n(17),i=n(21),o=n(6),a=n.n(o),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(18),d=function(e){function t(e,n,r,i,o,s){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Create",{name:e,organisationId:n,roleId:r,eventLineId:i,appType:o,active:s}))}return p()(t,e),t}(u.a),f=function(e){function t(e,n,r,i,o){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Update",{id:e,name:n,roleId:r,appType:i,active:o}))}return p()(t,e),t}(u.a),h=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Delete",{appId:e}))}return p()(t,e),t}(u.a),m=(function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Request",{appId:e}))}p()(t,e)}(u.a),function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListEventLine",{eventLineId:e}))}return p()(t,e),t}(u.a)),v=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListOrganisation",{organisationId:e}))}return p()(t,e),t}(u.a),y=function(e){function t(e,n){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","EnrichContext",{loginValues:e,formId:n}))}return p()(t,e),t}(u.a),g=n(427),b=n(5);Object(b.createAction)("Application.Fetching"),Object(b.createAction)("Application.Resolve"),Object(b.createAction)("Application.Error"),Object(b.createAction)("Auth.SetBlockId",function(e){return e});n.d(t,"d",function(){return O}),n.d(t,"e",function(){return E}),n.d(t,"f",function(){return j}),n.d(t,"a",function(){return C}),n.d(t,"b",function(){return I}),n.d(t,"c",function(){return k});var O=function(e){return function(t){return t(Object(g.e)()),r.a.send(new m(e),Object(i.g)()).then(function(e){return t(Object(g.f)(e.list)),e}).catch(function(e){throw t(Object(g.d)(e)),e})}},E=function(e){return function(t){return t(Object(g.e)()),r.a.send(new v(e),Object(i.g)()).then(function(e){return t(Object(g.f)(e.list)),e}).catch(function(e){throw t(Object(g.d)(e)),e})}},j=function(e,t,n,o,a){return r.a.send(new f(e,t,n,o,a),Object(i.f)())},C=function(e,t,n,o,a,s){return r.a.send(new d(e,t,n,o,a,s),Object(i.f)())},I=function(e){return r.a.send(new h(e),Object(i.f)())},k=function(e,t){return r.a.send(new y(e,t),function(e){return e})}},1487:function(e,t,n){"use strict";var r=n(6),i=n.n(r),o=n(10),a=n.n(o),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(4),d=n.n(u),f=n(2),h=n(24),m=n.n(h),v=n(38),y=n.n(v),g=n(1),b=n(46),O=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};function E(e){var t=e.selected?d()({},function(e){if(!e.tabsPosition)return"borderRight";switch(e.tabsPosition.tpe.value){case g.TabsPositionLeft.$Type.value:return"borderRight";case g.TabsPositionRight.$Type.value:return"borderLeft";default:return"borderRight"}}(e),"2px solid"):{};return{root:Object.assign({},t)}}var j=function(e){function t(){i()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleClick=function(t){t.preventDefault(),t.stopPropagation(),e.props.onClick&&e.props.onClick(e.props.value,t,e)},e.getColorByMuiTheme=function(e){var t=e.flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),n=e.flatMap(function(e){return e.palette}),r=e.flatMap(function(e){return e.selectable});switch(t){case"secondary":return[{color:n.map(function(e){return e.secondaryColor}).getOrElse(function(){return b.c})},{color:b.b}];case"custom":return[{color:r.map(function(e){return e.afterSelect}).getOrElse(function(){return b.a})},{color:r.map(function(e){return e.beforeSelect}).getOrElse(function(){return b.c})}];case"primary":default:return[{color:n.map(function(e){return e.primaryColor}).getOrElse(function(){return b.a})},{color:b.b}]}},e}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.icon,n=(e.index,e.onActive,e.onClick,e.selected),r=e.label,i=e.buttonStyle,o=e.style,a=(e.value,e.width,e.classes),s=(e.tabsPosition,e.elementMuiTheme),l=O(e,["icon","index","onActive","onClick","selected","label","buttonStyle","style","value","width","classes","tabsPosition","elementMuiTheme"]),c=E(this.props),p=void 0;if(t&&f.isValidElement(t)&&(p=f.cloneElement(t,{style:{fontSize:24,color:t.props&&t.props.style&&t.props.style.color?t.props.style.color:"#fff",marginBottom:r?5:0}})),s){var u=this.getColorByMuiTheme(s),d=n?u[0]:u[1];return f.createElement(m.a,Object.assign({},l,{style:Object.assign(c.root,o,d),onClick:this.handleClick}),f.createElement("div",{style:Object.assign({},i,d)},p,r))}return f.createElement(m.a,Object.assign({},l,{style:Object.assign(c.root,o),onClick:this.handleClick}),f.createElement("div",{style:i,className:n?a.root:a.default},p,r))}}]),t}(f.Component);j.muiName="Tab",j.propTypes={},j.contextTypes={},t.a=y()(function(e){return{default:{color:e.palette.text.secondary},root:{color:e.palette.primary.main}}})(j)},1488:function(e,t,n){"use strict";var r=n(6),i=n.n(r),o=n(10),a=n.n(o),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(4),d=n.n(u),f=n(2),h=n(62),m=n.n(h),v=n(1),y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};function g(e){if(!e.tabsPosition)return"borderRight";switch(e.tabsPosition.tpe.value){case v.TabsPositionLeft.$Type.value:return"borderRight";case v.TabsPositionRight.$Type.value:return"borderLeft";default:return"borderRight"}}var b=function(e){function t(){i()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={selectedIndex:0},e.handleTabClick=function(t,n,r){n.preventDefault();var i=e.getValueLink(e.props),o=r.props.index;(i.value&&i.value!==t||e.state.selectedIndex!==o)&&i.requestChange(t,n,r),e.setState({selectedIndex:o}),r.props.onActive&&r.props.onActive(r)},e}return p()(t,e),a()(t,[{key:"componentWillMount",value:function(){var e=this.getValueLink(this.props),t=this.props.initialSelectedIndex||0;this.setState({selectedIndex:void 0!==e.value?this.getSelectedIndex(this.props):t<this.getTabCount()?t:0})}},{key:"componentWillReceiveProps",value:function(e,t){}},{key:"getTabs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=[];return f.Children.forEach(e.children,function(e){f.isValidElement(e)&&t.push(e)}),t}},{key:"getTabCount",value:function(){return this.getTabs().length}},{key:"getValueLink",value:function(e){return e.valueLink||{value:e.value,requestChange:e.onChange}}},{key:"getSelectedIndex",value:function(e){var t=this.getValueLink(e),n=-1;return this.getTabs(e).forEach(function(e,r){t.value===e.props.value&&(n=r)}),n}},{key:"getSelected",value:function(e,t){var n=this.getValueLink(this.props);return n.value?n.value===e.props.value:this.state.selectedIndex===t}},{key:"getTabContent",value:function(e,t,n,r){return t.push(e.props.children?f.createElement(n||O,{key:r,selected:this.getSelected(e,r)},e.props.children):void 0)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.contentContainerClassName,i=n.contentContainerStyle,o=(n.initialSelectedIndex,n.onChange,n.style),a=n.tabItemContainerStyle,s=n.tabTemplate,l=n.prerenderTabContainers,c=n.menuTopChildren,p=n.menuBottomChildren,u=(n.tabsPosition,y(n,["contentContainerClassName","contentContainerStyle","initialSelectedIndex","onChange","style","tabItemContainerStyle","tabTemplate","prerenderTabContainers","menuTopChildren","menuBottomChildren","tabsPosition"])),h=(e=this.props,{wrapper:{display:"flex",height:"100%",width:"100%"},tabItemContainer:d()({display:"flex",flexDirection:"column",flex:"0 0 150px",margin:"4px 4px 4px 0"},g(e),"1px solid ".concat(m.a[300])),tabMenuItemContainer:{display:"flex",flexDirection:"column",flex:"0 0 150px",margin:"4px 4px 4px 0"},tabContentContainer:{flex:1,margin:"4px 0 4px 4px"}}),v=(this.getValueLink(this.props).value,[]),b=100/this.getTabCount(),O=this.getTabs().map(function(e,n){return l?t.getTabContent(e,v,s,n):t.getSelected(e,n)&&t.getTabContent(e,v,s,n),f.cloneElement(e,{key:n,index:n,selected:t.getSelected(e,n),width:b+"%",onClick:t.handleTabClick})});return f.createElement("div",Object.assign({style:Object.assign(h.wrapper,o)},u),!this.props.tabItemContainerOnRight&&f.createElement("div",{style:Object.assign(h.tabItemContainer,a)},f.createElement("div",null,c),O,f.createElement("div",null,p)),f.createElement("div",{style:Object.assign(h.tabContentContainer,i),className:r},v),this.props.tabItemContainerOnRight&&f.createElement("div",{style:Object.assign(h.tabItemContainer,a)},f.createElement("div",null,c),O,f.createElement("div",null,p)))}}]),t}(f.Component);b.defaultProps={initialSelectedIndex:0,onChange:function(){}},b.contextTypes={};var O=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.selected,r=e.style,i=Object.assign({},r,{display:"flex",height:"100%"});return n||(i.height=0,i.overflow="hidden"),f.createElement("div",{style:i},t)}}]),t}(f.PureComponent);t.a=b},1546:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s});var r=n(130),i=n(1469),o=n(425),a=function(){return function(e,t){t().organisation.infoFetching||t().organisation.infoFetched||(e(Object(r.t)()),i.f().then(function(t){e(Object(r.q)(t))}).catch(function(t){e(Object(r.s)(t))}))}},s=function(e){return function(t){return t(Object(r.m)()),o.e(e).then(function(e){return t(Object(r.n)(e.list)),e}).catch(function(e){throw t(Object(r.l)(e)),e})}}},1590:function(e,t,n){"use strict";var r=n(21),i=n(6),o=n.n(i),a=n(7),s=n.n(a),l=n(8),c=n.n(l),p=n(18),u=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","ListByEventLine",{eventLineId:e}))}return c()(t,e),t}(p.a),d=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","Create",{generator:e}))}return c()(t,e),t}(p.a),f=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","Update",{generator:e}))}return c()(t,e),t}(p.a),h=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","Delete",{generatorId:e}))}return c()(t,e),t}(p.a),m=n(17),v=n(440);n.d(t,"a",function(){return y}),n.d(t,"d",function(){return g}),n.d(t,"b",function(){return b}),n.d(t,"c",function(){return O});var y=function(e){return m.a.send(new d(e),Object(r.c)())},g=function(e){return m.a.send(new f(e),Object(r.f)())},b=function(e){return m.a.send(new h(e),Object(r.d)())},O=function(e){return function(t){return t(Object(v.e)()),m.a.send(new u(e),Object(r.g)()).then(function(e){return t(Object(v.f)(e.list)),e}).catch(function(e){throw t(Object(v.d)(e)),e})}}},1833:function(e,t,n){"use strict";var r=n(6),i=n.n(r),o=n(10),a=n.n(o),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(11),d=n.n(u),f=n(2),h=n(14),m=n(95),v=n(13),y=n(26),g=n.n(y),b=n(0),O=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},E=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"onKeyDown",value:function(e){"Enter"===e.key&&!1===e.shiftKey&&(e.preventDefault(),this.props.handleSubmit(this.props.submitHandler)(e))}},{key:"render",value:function(){var e=this.props.fields.removeConfirmationStr;return f.createElement("form",null,f.createElement(g.a,{fullWidth:!0,label:this.props.i18n.t("Подтверждение удаление проекта"),value:e.value,onKeyDown:this.onKeyDown,onChange:e.onChange,error:e.touched&&e.error,helperText:e.touched&&Object(b.toOption)(e.error).map(function(e){return e}).getOrNull()}))}}]),t}(f.Component);E=O([v.autobind],E),t.a=Object(h.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:"deleteConfirmationForm",fields:["removeConfirmationStr","id"],validate:function(e,t){var n={};return e.removeConfirmationStr!=="DELETE "+e.id&&(n.removeConfirmationStr=t.i18n.t("Необходимо подтверждение")),n}})(E))},2365:function(e,t,n){var r=n(2366);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,i);r.locals&&(e.exports=r.locals)},2366:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".EventLinePage {\n  display: flex;\n  height: 100%; }\n\n.EventLinePage__menu {\n  width: 256px;\n  margin: 4px 4px 4px 0;\n  height: fit-content; }\n\n.EventLinePage__content {\n  flex: 1;\n  margin: 4px 0 4px 4px; }\n",""])},2725:function(e,t,n){"use strict";n.r(t);var r=n(6),i=n.n(r),o=n(10),a=n.n(o),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(11),d=n.n(u),f=n(2),h=n(13),m=n(14),v=n(856),y=n.n(v),g=n(857),b=n.n(g),O=n(93),E=n.n(O),j=n(1),C=n(627),I=n(1467),k=n(442),w=n(25),T=n.n(w),R=n(19),x=n.n(R),D=n(86),F=n.n(D),S=n(414),L=n.n(S),P=n(543),_=n.n(P),A=n(650),V=n(415),q=n(95),N=n(26),M=n.n(N),$=n(156),G=n.n($),W=n(0),B=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Z=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=(e.i18n,e.fields.name),n=e.handleSubmit,r=e.onSubmit;return f.createElement("form",{onSubmit:function(e){e.preventDefault(),n(r)}},f.createElement(M.a,{fullWidth:!0,autoFocus:!0,autoComplete:"off",value:t.value,onChange:t.onChange,label:this.props.i18n.t("Название"),error:t.touched&&t.error,helperText:t.touched&&Object(W.toOption)(t.error).map(function(e){return f.createElement(G.a,null,e)}).getOrNull()}))}}]),t}(f.Component);Z=B([h.autobind],Z);var J=Object(m.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"formsEditForm",fields:["name","formType"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(Z)),U=n(649),z=n(216),H=n(79),K=n(176),Y=n(323),X=n(678),Q=n(84),ee=n(71),te=n(660),ne=n(96),re=n(50),ie=n(201),oe=n(46),ae=n(1833),se=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},le=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"openEditForm",value:function(e,t,n){var r=this,i=void 0;this.props.openDialog(e,f.createElement(J,{ref:function(e){return i=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(e){return t(e)},initialValues:n}),[f.createElement(x.a,{variant:"raised",onClick:function(){return r.props.handleDialogClose(!1)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return i.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onFormRequested",value:function(e){this.props.params.formTypeId!==j.FormType.SIMPLE_DICTIONARY&&this.props.dispatch(Object(H.J)(new j.Id(this.props.params.eventLineId),e.entity.formType.getFormTypeId(),e.id))}},{key:"isEventOpened",value:function(e){return Object(k.a)(this.props.sidebar.minimizedEvents,e)}},{key:"onCreateRequested",value:function(){var e=this,t=-1!==location.href.indexOf("/dictionaries")?Object(W.toOption)(new j.FormTypeDictionary):j.FormType.getFormType(new j.Id(this.props.params.formTypeId));t.matchWith(function(t){return function(t){return e.openEditForm(e.props.i18n.t("Новая форма"),function(n){return new Promise(function(r,i){return Object(K.b)(new j.Form(n.name,t,new j.Id(e.props.params.eventLineId)),new j.Id(e.props.params.eventLineId)).then(function(n){r(n),e.props.dispatch(Object(ee.h)(e.props.i18n.t("Новая форма успешно создана!"))),e.props.handleDialogClose(!1),e.props.dispatch(Object(K.e)()),e.props.dispatch(Object(U.d)()),e.isEventOpened(new j.Id(e.props.params.eventLineId))&&e.props.dispatch(Object(ne.o)(new j.Id(e.props.params.eventLineId))),e.props.user.userRole.foreach(function(t){return e.props.dispatch(Object(X.d)(t.entity.organisationId))}),j.FormType.isDictionary(t)&&Object(Q.a)(n.id,new j.FormField(n.id,"name",e.props.i18n.t("Название"),new j.ValueTypeStr)).then(function(t){Object(Y.g)(n.id),Object(Q.a)(n.id,new j.FormField(n.id,"ID",e.props.i18n.t("ID"),new j.ValueTypeFormDataAttribute(new j.AttributeGeneratorTypeInternalId("",""))))})}).catch(function(e){i(e)})}).catch(function(t){return e.props.dispatch(Object(ie.a)(t))})},{})}(t)},function(){e.props.dispatch(Object(ee.h)(e.props.i18n.t("Тип формы не найден")))})}},{key:"onSettingsRequested",value:function(e){this.props.dispatch(Object(H.F)(new j.Id(this.props.params.eventLineId),e.entity.formType.getFormTypeId(),e.id))}},{key:"onEdit",value:function(e){var t=this;j.FormType.isSimpleDictionary(e.entity.formType)?this.props.openDialog(this.props.i18n.t("Редактирование"),f.createElement(te.a,{form:e,openDialog:this.props.openDialog,handleDialogClose:this.props.handleDialogClose}),[]):this.openEditForm(this.props.i18n.t("Редактирование формы"),function(n){return new Promise(function(r,i){return Object(K.n)(e.id,e.entity.formType,n.name,e.entity.eventLineId,e.entity.editBlock,e.entity.createBlock,e.entity.viewBlock,e.entity.groupEditBlock,e.entity.groupTableConfig,e.entity.dataListView.currentConfigId,e.entity.dataListView.dataListMode).then(function(e){r(e),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Форма успешно изменена!"))),t.props.handleDialogClose(!1),t.props.dispatch(Object(K.e)()),t.props.user.userRole.foreach(function(e){return t.props.dispatch(Object(X.d)(e.entity.organisationId))})}).catch(function(e){i(e)})}).catch(function(e){return t.props.dispatch(Object(ie.a)(e))})},e.entity)}},{key:"onCopy",value:function(e){var t=this;return Object(K.a)(e.id,new j.Id(this.props.params.eventLineId)).then(function(e){t.props.dispatch(Object(ee.h)(t.props.i18n.t("Форма успешно скопирована!"))),t.props.handleDialogClose(!1),t.props.dispatch(Object(K.e)()),t.props.user.userRole.foreach(function(e){return t.props.dispatch(Object(X.d)(e.entity.organisationId))})}).catch(function(e){t.props.dispatch(Object(ee.h)(t.props.i18n.t("Ошибка во время копирования формы!")))})}},{key:"onDelete",value:function(e){var t=this;this.openDeleteForm(this.props.i18n.t("Удаление формы"),function(n){return n.removeConfirmationStr==="DELETE "+e.id.value?Object(K.c)(e.id).then(function(e){t.props.dispatch(Object(ee.h)(t.props.i18n.t("Форма успешно удалена!"))),t.props.handleDialogClose(!1),t.props.dispatch(Object(K.e)()),t.props.user.userRole.foreach(function(e){return t.props.dispatch(Object(X.d)(e.entity.organisationId))})}).catch(function(e){return t.props.dispatch(Object(ie.a)(e))}):new Promise(function(e,t){})},e,{id:e.id.value})}},{key:"openDeleteForm",value:function(e,t,n,r){var i=this,o=this.props.i18n,a=void 0;this.props.openDialog(e,f.createElement("div",null,f.createElement("p",null,this.props.i18n.t("Данное действие невозможно отменить"),"."),f.createElement("p",null,o.t("ИД формы")," - ",n.id.value),f.createElement("p",null,o.t("Название формы")," - ",n.entity.name),f.createElement("p",null,o.t("Введите")," ",f.createElement("strong",null,"DELETE ",n.id.value)," ",o.t('если действительно хотите удалить форму и нажмите "ОК"')),f.createElement(ae.a,{ref:function(e){return a=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},initialValues:r,submitHandler:function(e){return t(e)},onSubmit:t})),[f.createElement(x.a,{variant:"raised",onClick:function(){return i.props.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),f.createElement(x.a,{variant:"raised",onClick:function(){return a.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("ОК"))])}},{key:"canEdit",value:function(e){return this.props.user.userRole.map(function(t){return t.entity.canAdminEvent(e)}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=[];return this.props.params.formTypeId?t=this.props.forms.list.filter(function(t){return t.entity.formType.getFormTypeId().value===e.props.params.formTypeId}):-1!==location.href.indexOf("/serviceForms")?t=this.props.forms.list.filter(function(e){return j.FormType.isService(e.entity.formType)}):-1!==location.href.indexOf("/dictionaries")&&(t=this.props.forms.list.filter(function(e){return j.FormType.isAnyDictionary(e.entity.formType)})),f.createElement("div",{className:"FormsPage__paper",style:{display:"flex",flex:1,margin:"0 0 4px 4px",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(z.b,null,Object(W.toOption)(this.props.eventLines.list.find(function(t){return t.id.value===e.props.params.eventLineId})).map(function(t){return e.canEdit(t.id)&&f.createElement(x.a,{variant:"raised",onClick:e.onCreateRequested,disabled:-1!==location.href.indexOf("/serviceForms"),color:"primary"},e.props.i18n.t("Создать"))}).getOrNull()),f.createElement(V.a,{showId:!0,error:this.props.forms.error,onRecordSelected:this.onFormRequested,fetching:this.props.forms.fetching,empty:!this.props.forms.fetching&&0==t.length,withActions:!0,headers:[{id:"formName",title:this.props.i18n.t("table|Название")},{id:"formType",title:this.props.i18n.t("table|Тип формы")}],rows:Object(W.toOption)(this.props.eventLines.list.find(function(t){return t.id.value===e.props.params.eventLineId})).map(function(n){var r=e.canEdit(n.id);return t.filter(function(e){return e.entity.eventLineId.value===n.id.value}).map(function(t){return{id:t.id.value,payload:t,fields:[t.entity.name,Object(re.G)(t.entity.formType,e.props.i18n.t)],buttons:r?[f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEdit(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"settings",style:oe.f,onClick:function(n){n.stopPropagation(),e.onSettingsRequested(t)}},f.createElement(_.a,{style:oe.g})),f.createElement(T.a,{key:"copy",style:oe.f,onClick:function(n){n.stopPropagation(),e.onCopy(t)}},f.createElement(A.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDelete(t)}},f.createElement(L.a,{style:oe.g}))]:[f.createElement(T.a,null)]}})}).getOrElse(function(){return[]})}))}}]),t}(f.Component);le=se([h.autobind],le);var ce=Object(m.connect)(function(e){return{fields:e.fields,forms:e.forms,eventLines:e.eventLines,user:e.user,i18n:e.i18n,sidebar:e.userUi.sidebar}})(le),pe=n(59),ue=n(160),de=n.n(ue),fe=n(45),he=n.n(fe),me=n(24),ve=n.n(me),ye=n(54),ge=n.n(ye),be=n(376),Oe=n.n(be),Ee=n(30),je=n.n(Ee),Ce=n(34),Ie=n.n(Ce),ke=n(32),we=n.n(ke),Te=n(33),Re=n.n(Te),xe=n(868),De=n.n(xe),Fe=n(104),Se=n(68),Le=n(161),Pe=n(418),_e=n(209),Ae=n(818),Ve=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qe=new j.Id(pe.v4()),Ne={position:"absolute",right:"-15px",bottom:"14px",width:"15px",height:"15px",padding:0,zIndex:5e3},Me=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"componentDidMount",value:function(){""!==this.props.fields.dataSourceId.value&&this.props.dispatch(Object(K.d)(new j.Id(this.props.fields.dataSourceId.value)))}},{key:"componentWillReceiveProps",value:function(e){!e.forms.fetching&&this.props.forms.fetching&&""!==e.fields.dataSourceId.value&&this.props.dispatch(Object(K.d)(new j.Id(e.fields.dataSourceId.value)))}},{key:"render",value:function(){var e=this;return f.createElement("form",null,f.createElement(M.a,{value:this.props.fields.name.value,onChange:this.props.fields.name.onChange,fullWidth:!0,label:this.props.i18n.t("Название"),autoFocus:!0}),f.createElement("div",{style:{position:"relative"}},f.createElement(we.a,{fullWidth:!0},f.createElement(Ie.a,{htmlFor:"value-generator-type"},this.props.i18n.t("Тип")),f.createElement(je.a,{fullWidth:!0,value:this.props.fields.config.value,error:this.props.fields.config.touched&&this.props.fields.config.error,onChange:function(t){return e.props.fields.config.onChange(t.target.value)}},f.createElement(ve.a,{key:"vs",value:j.ValuesGeneratorTypeValueSeries.$Type.value},f.createElement(ge.a,{primary:this.props.i18n.t("Счётчик")})),f.createElement(ve.a,{key:"rand",value:j.ValuesGeneratorTypeRandom.$Type.value},f.createElement(ge.a,{primary:this.props.i18n.t("Генератор случайных значений")})),f.createElement(ve.a,{key:"pool",value:j.ValuesGeneratorTypePool.$Type.value},f.createElement(ge.a,{primary:this.props.i18n.t("Пул")}))),this.props.fields.config.touched&&this.props.fields.config.error&&f.createElement(G.a,null,this.props.fields.config.error)),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Object.assign({},Ne,{right:"-10px",bottom:"18px"})},f.createElement(Pe.a,null)))),this.props.fields.config.value===j.ValuesGeneratorTypeValueSeries.$Type.value&&f.createElement("div",null,f.createElement("div",{style:{position:"relative"}},f.createElement(M.a,{value:this.props.fields.prefix.value,onChange:this.props.fields.prefix.onChange,fullWidth:!0,label:this.props.i18n.t("Префикс")}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),f.createElement("div",{style:{position:"relative"}},f.createElement(M.a,{value:this.props.fields.postfix.value,onChange:this.props.fields.postfix.onChange,fullWidth:!0,label:this.props.i18n.t("Постфикс")}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),f.createElement("div",{style:{position:"relative"}},f.createElement(M.a,{value:this.props.fields.stateValue.value,onChange:this.props.fields.stateValue.onChange,fullWidth:!0,label:this.props.i18n.t("Текущее значение")}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),f.createElement("div",{style:{position:"relative"}},f.createElement(M.a,{value:this.props.fields.step.value,onChange:this.props.fields.step.onChange,type:"number",fullWidth:!0,label:this.props.i18n.t("Шаг")}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),f.createElement("div",{style:{position:"relative"}},f.createElement(M.a,{value:this.props.fields.digitsCount.value,onChange:this.props.fields.digitsCount.onChange,type:"number",fullWidth:!0,label:this.props.i18n.t("Количество символов")}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null))))),this.props.fields.config.value===j.ValuesGeneratorTypeRandom.$Type.value&&f.createElement("div",null,f.createElement(De.a,null,f.createElement(Re.a,{label:this.props.i18n.t("Цифры"),control:f.createElement(he.a,{checked:this.props.fields.ciphers.value,onClick:this.props.fields.ciphers.onChange})}),f.createElement(Re.a,{label:this.props.i18n.t("Прописные буквы"),control:f.createElement(he.a,{checked:this.props.fields.upperCase.value,onClick:this.props.fields.upperCase.onChange})}),f.createElement(Re.a,{label:this.props.i18n.t("Строчные буквы"),control:f.createElement(he.a,{checked:this.props.fields.lowerCase.value,onClick:this.props.fields.lowerCase.onChange})}),f.createElement(Re.a,{label:this.props.i18n.t("Спецсимволы"),control:f.createElement(he.a,{checked:this.props.fields.special.value,onClick:this.props.fields.special.onChange})})),f.createElement(M.a,{value:this.props.fields.length.value,onChange:this.props.fields.length.onChange,type:"number",fullWidth:!0,label:this.props.i18n.t("Количество символов")}),f.createElement(Re.a,{label:this.props.i18n.t("Собственный алфавит"),control:f.createElement(he.a,{checked:this.props.fields.custom.value,onClick:this.props.fields.custom.onChange})}),f.createElement(M.a,{value:this.props.fields.alphabet.value,onChange:this.props.fields.alphabet.onChange,fullWidth:!0,label:this.props.i18n.t("Алфавит")})),this.props.fields.config.value===j.ValuesGeneratorTypePool.$Type.value&&(this.props.forms.fetching?f.createElement(de.a,null):f.createElement("div",null,f.createElement("div",{style:{position:"relative"}},this.props.eventLine.data.map(function(t){return f.createElement(we.a,{fullWidth:!0},f.createElement(Ie.a,null,e.props.i18n.t("Источник данных")),f.createElement(je.a,{native:!0,fullWidth:!0,value:e.props.fields.dataSourceId.value,error:e.props.fields.dataSourceId.touched&&e.props.fields.dataSourceId.error,onChange:function(t){e.props.dispatch(Object(K.d)(new j.Id(t.target.value))),e.props.fields.dataSourceId.onChange(t.target.value)}},f.createElement("option",{value:""},""),f.createElement("optgroup",{label:e.props.i18n.t("Формы")},Object(Fe.f)(e.props.forms,t.id).filter(function(e){return j.FormType.isForm(e.entity.formType)}).map(function(e){return f.createElement("option",{value:e.id.value},e.entity.name)})),f.createElement("optgroup",{label:e.props.i18n.t("Справочники")},Object(Fe.f)(e.props.forms,t.id).filter(function(e){return j.FormType.isAnyDictionary(e.entity.formType)}).map(function(e){return f.createElement("option",{value:e.id.value},e.entity.name)})),f.createElement("optgroup",{label:e.props.i18n.t("Служебные")},Object(Fe.f)(e.props.forms,t.id).filter(function(e){return j.FormType.isService(e.entity.formType)}).map(function(e){return f.createElement("option",{value:e.id.value},e.entity.name)}))),e.props.fields.dataSourceId.touched&&e.props.fields.dataSourceId.error&&f.createElement(G.a,null,e.props.fields.dataSourceId.error))}).getOrElse(function(){return f.createElement("div",null,e.props.i18n.t("Ошибка загрузки записи, редактирование или отображение невозможно"))}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),""!==this.props.fields.dataSourceId.value&&(Object(W.liftKey)(this.props.formFields.fetching,this.props.fields.dataSourceId.value).getOrNull()?f.createElement(de.a,null):f.createElement("div",null,f.createElement("div",{style:{position:"relative"}},f.createElement(Se.a,{errorText:new W.None,labelText:new W.Some(this.props.i18n.t("Поле со значением")),fullWidth:!0,fields:Object(W.liftKey)(this.props.formFields.list,this.props.fields.dataSourceId.value).getOrElse(function(){return[]}),onChanged:function(t){return e.props.fields.valueFieldId.onChange(t.map(function(e){return e.value}).getOrElse(function(){return""}))},value:new W.Some(new j.Id(this.props.fields.valueFieldId.value))}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),f.createElement("div",{style:{position:"relative"}},f.createElement(Se.a,{errorText:new W.None,labelText:new W.Some(this.props.i18n.t("Поле со Статусом")),fullWidth:!0,fields:Object(W.liftKey)(this.props.formFields.list,this.props.fields.dataSourceId.value).getOrElse(function(){return[]}),onChanged:function(t){return e.props.fields.statusFieldId.onChange(t.map(function(e){return e.value}).getOrElse(function(){return""}))},value:new W.Some(new j.Id(this.props.fields.statusFieldId.value))}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),f.createElement("div",{style:{position:"relative"}},f.createElement(Se.a,{errorText:new W.None,labelText:new W.Some(this.props.i18n.t("Поля с датой использования")),fullWidth:!0,fields:Object(W.liftKey)(this.props.formFields.list,this.props.fields.dataSourceId.value).getOrElse(function(){return[]}),onChanged:function(t){return e.props.fields.dateFieldId.onChange(t.map(function(e){return e.value}).getOrElse(function(){return""}))},value:new W.Some(new j.Id(this.props.fields.dateFieldId.value))}),f.createElement(_e.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:Ne},f.createElement(Pe.a,null)))),f.createElement(Oe.a,null,this.props.i18n.t("Фильтрация по данным анкеты")),f.createElement(Le.a,{formId:new j.Id(this.props.fields.dataSourceId.value),filterId:qe,initialValue:""===this.props.fields.poolFilter.value?new W.None:new W.Some(this.props.fields.poolFilter.value)}),f.createElement(Ae.a,{formId:new j.Id(this.props.fields.dataSourceId.value),sortings:this.props.fields.sorting.value||[],onChange:this.props.fields.sorting.onChange}))))))}}]),t}(f.Component);Me=Ve([h.autobind],Me);var $e=Object(m.connect)(function(e){return{i18n:e.i18n,forms:e.forms,formFields:e.fields,eventLine:e.eventLine}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"valuesGeneratorForm",fields:["name","eventLineId","config","prefix","postfix","stateValue","step","digitsCount","ciphers","upperCase","lowerCase","special","length","custom","alphabet","dataSourceId","valueFieldId","statusFieldId","dateFieldId","poolFilter","sorting"]})(Me)),Ge=n(137),We=n(3),Be=n(1590),Ze=n(136),Je=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ue=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"getConfig",value:function(e){var t=void 0;switch(e.config){case j.ValuesGeneratorTypeValueSeries.$Type.value:t=new j.ValuesGeneratorTypeValueSeries(e.prefix,e.postfix,e.stateValue,e.step,e.digitsCount);break;case j.ValuesGeneratorTypeRandom.$Type.value:t=new j.ValuesGeneratorTypeRandom(e.ciphers,e.upperCase,e.lowerCase,e.special,e.length,e.custom,""!=e.alphabet?new W.Some(e.alphabet):new W.None);break;case j.ValuesGeneratorTypePool.$Type.value:t=new j.ValuesGeneratorTypePool(new j.Id(e.dataSourceId),new j.Id(e.valueFieldId),new j.Id(e.statusFieldId),new j.Id(e.dateFieldId),Object(Ge.b)(this.props.filtersForm,qe),e.sorting)}return t}},{key:"onCreateRequested",value:function(){var e=this,t=void 0;this.props.openDialog(this.props.i18n.t("Редактирование генератора"),f.createElement($e,{ref:function(e){return t=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return new Promise(function(n,r){return Object(Be.a)(new j.ValuesGenerator(t.name,new j.Id(e.props.params.eventLineId),e.getConfig(t))).then(function(t){n(t),e.props.dispatch(Object(Be.c)(new j.Id(e.props.params.eventLineId))),e.props.dispatch(Object(ee.h)(e.props.i18n.t("Создание успешно завершено"))),e.props.handleDialogClose(!1)}).catch(function(e){r(e)})}).catch(function(t){return e.props.dispatch(Object(ie.a)(t))})}(t)},initialValues:{name:"",eventLineId:"",config:"",prefix:"",postfix:"",stateValue:"1",step:1,digitsCount:!1,ciphers:!1,upperCase:!1,lowerCase:!1,special:!1,length:1,custom:!1,alphabet:"",poolFilter:"",sorting:[]}}),[f.createElement(x.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditRequest",value:function(e){var t=this,n=void 0;this.props.openDialog(this.props.i18n.t("Создание генератора"),f.createElement($e,{ref:function(e){return n=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(n){return function(n){return new Promise(function(r,i){return Object(Be.d)(We(e,{entity:{$set:new j.ValuesGenerator(n.name,new j.Id(t.props.params.eventLineId),t.getConfig(n))}})).then(function(e){r(e),t.props.dispatch(Object(Be.c)(new j.Id(t.props.params.eventLineId))),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Сохранение успешно завершено"))),t.props.handleDialogClose(!1)}).catch(function(e){i(e)})}).catch(function(e){return t.props.dispatch(Object(ie.a)(e))})}(n)},initialValues:function(){var t=e.entity,n={name:t.name,eventLineId:t.eventLineId,config:t.config.tpe.value};switch(t.config.tpe.value){case j.ValuesGeneratorTypeValueSeries.$Type.value:var r=t.config;n=We(n,{$merge:{prefix:r.prefix,postfix:r.postfix,stateValue:r.stateValue,step:r.step,digitsCount:r.digitsCount}});break;case j.ValuesGeneratorTypeRandom.$Type.value:var i=t.config;n=We(n,{$merge:{ciphers:i.ciphers,upperCase:i.upperCase,lowerCase:i.lowerCase,special:i.special,length:i.length,custom:i.custom,alphabet:i.alphabet.map(function(e){return e}).getOrElse(function(){return""})}});break;case j.ValuesGeneratorTypePool.$Type.value:var o=t.config;n=We(n,{$merge:{dataSourceId:o.dataSourceId.value,valueFieldId:o.valueFieldId.value,statusFieldId:o.statusFieldId.value,dateFieldId:o.dateFieldId.value,poolFilter:o.filter.getOrNull(),sorting:o.sorting}})}return n}()}),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return n.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteRequest",value:function(e){var t=this;this.props.openDialog(this.props.i18n.t("Удалить генератор"),f.createElement("p",null,this.props.i18n.t("Вы уверены? Это действие нельзя будет отменить")),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return Object(Be.b)(e).then(function(e){t.props.dispatch(Object(Be.c)(new j.Id(t.props.params.eventLineId))),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Удаление успешно завершено"))),t.props.handleDialogClose(!1)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})},color:"primary"},this.props.i18n.t("Удалить"))])}},{key:"handleTypeCaption",value:function(e){switch(e.value){case j.ValuesGeneratorTypeValueSeries.$Type.value:return this.props.i18n.t("Счётчик");case j.ValuesGeneratorTypeRandom.$Type.value:return this.props.i18n.t("Генератор случайных значений");case j.ValuesGeneratorTypePool.$Type.value:return this.props.i18n.t("Пул");default:return""}}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(z.b,null,f.createElement(x.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(V.a,{showId:!0,fetching:this.props.valuesGenerators.fetching,error:this.props.valuesGenerators.error,empty:!this.props.valuesGenerators.fetching&&0===this.props.valuesGenerators.list.length,onRecordSelected:this.onEditRequest,headers:[{id:"valuesGeneratorName",title:this.props.i18n.t("Название")},{id:"valuesGeneratorType",title:this.props.i18n.t("Тип")}],withActions:!0,rows:this.props.valuesGenerators.fetching?[]:this.props.valuesGenerators.list.map(function(t){return{payload:t,id:t.id.value,fields:[t.entity.name,e.handleTypeCaption(t.entity.config.tpe)],buttons:[f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEditRequest(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequest(t.id)}},f.createElement(L.a,{style:oe.g}))]}})}))}}]),t}(f.Component);Ue=Je([h.autobind],Ue);var ze=Object(m.connect)(function(e){return{valuesGenerators:e.valuesGenerators,i18n:e.i18n,filtersForm:e.filtersForm}})(Object(Ze.a)(function(e){e.isTokenChecked&&e.dispatch(Object(Be.c)(new j.Id(e.params.eventLineId)))},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.dispatch(Object(Be.c)(new j.Id(e.params.eventLineId)))})(Ue)),He=n(773),Ke=n(500),Ye=n(405),Xe=n(83),Qe=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},et=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"openEditForm",value:function(e,t,n){var r=this,i=void 0,o=this.props.openDialog(e,f.createElement(He.a,{ref:function(e){return i=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:t,initialValues:n}),[f.createElement(x.a,{variant:"raised",onClick:function(){return r.props.handleDialogClose(o)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return i.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))]);return o}},{key:"onCreateRequested",value:function(){var e=this,t=j.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong event line id"}),n=this.openEditForm(this.props.i18n.t("Новый идентификатор события"),function(r){return Object(Ke.a)(new j.JourneyEventId(t,r.name)).then(function(r){e.props.dispatch(Object(Ye.a)(t)),e.props.dispatch(Object(ee.h)(e.props.i18n.t("Идентификатор события успешно создан!"))),e.props.handleDialogClose(n)}).catch(function(t){e.props.dispatch(Object(ie.a)(t))})},{timeZone:(new Date).getTimezoneOffset()})}},{key:"onSettingsRequested",value:function(e){this.onEdit(e)}},{key:"onEdit",value:function(e){var t=this,n=this.openEditForm(this.props.i18n.t("Редактирование идентификатора события"),function(r){return Object(Ke.d)(update(e,{entity:{name:{$set:r.name}}})).then(function(e){t.props.dispatch(Object(Ye.a)(j.Id.createId(t.props.params.eventLineId).getOrElse(function(){throw"wrong event line id"}))),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Идентификатор события сохранен!"))),t.props.handleDialogClose(n)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})},{name:e.entity.name})}},{key:"onDelete",value:function(e){var t=this,n=this.props.openDialog(this.props.i18n.t("Удаление"),f.createElement("p",null,this.props.i18n.t("Вы действительно хотите удалить? Это действие нельзя будет отменить")),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),f.createElement(x.a,{variant:"raised",color:"primary",onClick:function(){return Object(Ke.b)(e.id).then(function(e){t.props.dispatch(Object(Ye.a)(j.Id.createId(t.props.params.eventLineId).getOrElse(function(){throw"wrong event line id"}))),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Идентификатор события успешно удален!"))),t.props.handleDialogClose(n)}).catch(function(e){return t.props.dispatch(Object(ie.a)(e))})}},this.props.i18n.t("Удалить"))])}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(z.b,null,f.createElement(x.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(V.a,{showId:!0,error:this.props.journeyEventIds.error,fetching:this.props.journeyEventIds.fetching,onRecordSelected:this.onSettingsRequested,empty:!this.props.journeyEventIds.fetching&&0==this.props.journeyEventIds.list.length,withActions:!0,headers:[{id:"journeyEventIdName",title:this.props.i18n.t("table|Название")}],rows:this.props.journeyEventIds.list.map(function(t){return{id:t.id.value,payload:t,fields:[t.entity.name],buttons:[f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEdit(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"settings",style:oe.f,onClick:function(n){n.stopPropagation(),e.onSettingsRequested(t)}},f.createElement(_.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDelete(t)}},f.createElement(L.a,{style:oe.g}))]}})}))}}]),t}(f.Component);et=Qe([h.autobind],et);var tt=Object(m.connect)(function(e){return{journeyEventIds:e.journeyEventIds,eventLines:e.eventLines,terminals:e.terminals,i18n:e.i18n}})(Object(Ze.a)(function(e){e.isTokenChecked&&e.dispatch(Object(Ye.c)(j.Id.createId(e.params.eventLineId).getOrElse(function(){throw"wrong event line id"})))},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.dispatch(Object(Ye.c)(j.Id.createId(e.params.eventLineId).getOrElse(function(){throw"wrong event line id"})))})(Object(Xe.a)(et))),nt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},rt=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.fields,t=e.name,n=e.timeZone,r=e.logEnabled;return f.createElement("form",null,f.createElement(M.a,{fullWidth:!0,autoFocus:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Имя")}),f.createElement("div",{style:{position:"relative"}},f.createElement(we.a,{fullWidth:!0},f.createElement(Ie.a,null,this.props.i18n.t("Часовой пояс")),f.createElement(je.a,{value:n.value,onChange:function(e){return n.onChange(e.target.value)}},j.TimeZones.map(function(e,t){return f.createElement(ve.a,{key:t,value:e.offset},e.name)}))),f.createElement(_e.b,{toolTipContent:f.createElement("div",{style:{position:"absolute",top:"500px"}},this.props.i18n.t("текст подсказки"))},f.createElement(T.a,{style:{position:"absolute",right:"-10px",bottom:"10px",width:"15px",height:"15px",padding:0,zIndex:5e3}},f.createElement(Pe.a,null)))),f.createElement(Re.a,{label:this.props.i18n.t("Включить логирование"),control:f.createElement(he.a,{checked:r.value,onChange:r.onChange})}))}}]),t}(f.Component);rt=nt([h.autobind],rt);var it=Object(m.connect)(function(e){return{i18n:e.i18n,eventLine:e.eventLine,forms:e.forms,currentForm:e.currentForm,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"accessZoneEditForm",fields:["name","timeZone","logEnabled"]})(rt)),ot=n(255),at=n(633),st=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lt=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"openEditForm",value:function(e,t,n){var r=this,i=void 0,o=this.props.openDialog(e,f.createElement(it,{ref:function(e){return i=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(e){return t(e,o)},initialValues:n,params:this.props.params}),[f.createElement(x.a,{key:"close",variant:"raised",onClick:function(){return r.props.handleDialogClose(o)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(at.a,{key:"save",type:"submit",variant:"raised",color:"primary",formName:"accessZoneEditForm",onClick:function(){return i.map(function(e){return e.submit()})}},this.props.i18n.t("Сохранить"))])}},{key:"findTimeZone",value:function(e){return Object(W.head)(j.TimeZones.filter(function(t){return t.offset===e}))}},{key:"onCreateRequested",value:function(){var e=this;this.openEditForm(this.props.i18n.t("Новое взаимодействие"),function(t,n){return Object(ot.b)(new j.AccessZone(t.name,new j.Id(e.props.params.eventLineId),e.findTimeZone(t.timeZone),[],[],t.logEnabled)).then(function(t){e.props.handleDialogClose(n),e.props.dispatch(Object(ot.d)(new j.Id(e.props.params.eventLineId))),e.props.dispatch(Object(ee.h)(e.props.i18n.t("Новая зона успешно создана!")))}).catch(function(t){e.props.dispatch(Object(ie.a)(t))})},{timeZone:(new Date).getTimezoneOffset()})}},{key:"onSettingsRequested",value:function(e){this.props.dispatch(Object(H.d)(new j.Id(this.props.params.eventLineId),e.id))}},{key:"onEdit",value:function(e){var t=this;this.openEditForm(this.props.i18n.t("Редактирование взаимодействия"),function(n,r){return e.entity=new j.AccessZone(n.name,e.entity.eventLineId,t.findTimeZone(n.timeZone),e.entity.rules,[],n.logEnabled),Object(ot.e)(e).then(function(e){t.props.dispatch(Object(ot.d)(new j.Id(t.props.params.eventLineId))),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Взаимодействие сохранено!"))),t.props.handleDialogClose(r)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})},{name:e.entity.name,timeZone:e.entity.timeZone.offset,logEnabled:e.entity.logEnabled})}},{key:"onDelete",value:function(e){var t=this,n=this.props.openDialog(this.props.i18n.t("Удаление"),f.createElement("p",null,this.props.i18n.t("Вы действительно хотите удалить зону? Это действие нельзя будет отменить")),[f.createElement(x.a,{key:"cancel",variant:"raised",onClick:function(){return t.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),f.createElement(x.a,{key:"delete",variant:"raised",color:"primary",onClick:function(){return function(n){return Object(ot.c)(e.id).then(function(e){t.props.dispatch(Object(ot.d)(new j.Id(t.props.params.eventLineId))),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Зона успешно удалена!"))),t.props.handleDialogClose(n)}).catch(function(e){return t.props.dispatch(Object(ie.a)(e))})}(n)}},this.props.i18n.t("Удалить"))])}},{key:"getTerminalsNames",value:function(e){return this.props.terminals.fetching?this.props.i18n.t("Загрузка"):this.props.terminals.list.filter(function(t){return t.entity.zoneId.map(function(t){return t.value===e.value}).getOrElse(function(){return!1})}).map(function(e){return e.entity.name}).join(", ")}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(z.b,null,f.createElement(x.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(V.a,{showId:!0,error:this.props.accessZones.error,fetching:this.props.accessZones.fetching,onRecordSelected:this.onSettingsRequested,empty:!this.props.accessZones.fetching&&0==this.props.accessZones.list.length,withActions:!0,headers:[{id:"zoneName",title:this.props.i18n.t("table|Название")},{id:"zoneTerminals",title:this.props.i18n.t("table|Терминалы")}],rows:this.props.accessZones.list.map(function(t){return{id:t.id.value,payload:t,fields:[t.entity.name,e.getTerminalsNames(t.id)],buttons:[f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEdit(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"settings",style:oe.f,onClick:function(n){n.stopPropagation(),e.onSettingsRequested(t)}},f.createElement(_.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDelete(t)}},f.createElement(L.a,{style:oe.g}))]}})}))}}]),t}(f.Component);lt=st([h.autobind],lt);var ct=Object(m.connect)(function(e){return{accessZones:e.accessZones,eventLines:e.eventLines,terminals:e.terminals,i18n:e.i18n}})(Object(Ze.a)(function(e){e.isTokenChecked&&e.dispatch(Object(ot.d)(new j.Id(e.params.eventLineId)))},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.dispatch(Object(ot.d)(new j.Id(e.params.eventLineId)))})(Object(Xe.a)(lt))),pt=n(94),ut=n.n(pt),dt=function(e){return f.createElement(ut.a,Object.assign({},e),f.createElement("path",{d:"M17 7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h10c2.76 0 5-2.24 5-5s-2.24-5-5-5zM7 15c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"}),f.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}))},ft=function(e){return f.createElement(ut.a,Object.assign({},e),f.createElement("path",{d:"M17 7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h10c2.76 0 5-2.24 5-5s-2.24-5-5-5zm0 8c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"}),f.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}))},ht=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},mt=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.fields,n=t.name,r=t.defaultFormId,i=t.type;return this.props.eventLine.data.map(function(t){return f.createElement("form",null,f.createElement(M.a,{fullWidth:!0,autoFocus:!0,value:n.value,onChange:n.onChange,label:e.props.i18n.t("Название"),error:n.touched&&n.error,helperText:n.touched&&Object(W.toOption)(n.error).map(function(e){return e}).getOrNull()}),f.createElement(we.a,{fullWidth:!0},f.createElement(Ie.a,null,e.props.i18n.t("Форма по умолчанию")),f.createElement(je.a,{native:!0,value:r.value,onChange:r.onChange,error:r.touched&&r.error},f.createElement("option",{value:""},""),f.createElement("optgroup",{label:e.props.i18n.t("Формы")},Object(Fe.f)(e.props.forms,t.id).filter(function(e){return j.FormType.isForm(e.entity.formType)}).map(function(e){return f.createElement("option",{value:e.id.value},e.entity.name)})),f.createElement("optgroup",{label:e.props.i18n.t("Справочники")},Object(Fe.f)(e.props.forms,t.id).filter(function(e){return j.FormType.isAnyDictionary(e.entity.formType)}).map(function(e){return f.createElement("option",{value:e.id.value},e.entity.name)})),f.createElement("optgroup",{label:e.props.i18n.t("Служебные")},Object(Fe.f)(e.props.forms,t.id).filter(function(e){return j.FormType.isService(e.entity.formType)}).map(function(e){return f.createElement("option",{value:e.id.value},e.entity.name)}))),r.touched&&r.error&&f.createElement(G.a,null,r.error)),f.createElement(we.a,{fullWidth:!0},f.createElement(Ie.a,null,e.props.i18n.t("Тип")),f.createElement(je.a,{value:i.value,onChange:i.onChange,error:i.touched&&i.error},f.createElement(ve.a,{value:j.JourneyTypeStandard.$Type.value},e.props.i18n.t("Стандартный")),f.createElement(ve.a,{value:j.JourneyTypeSingleRun.$Type.value},e.props.i18n.t("Вопрос-ответ"))),i.touched&&i.error&&f.createElement(G.a,null,i.error)))}).getOrNull()}}]),t}(f.Component);mt=ht([h.autobind],mt);var vt=Object(m.connect)(function(e){return{i18n:e.i18n,currentForm:e.currentForm,formFields:e.fields,forms:e.forms,eventLine:e.eventLine}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"newJourneyForm",fields:["name","defaultFormId","type"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.defaultFormId&&0!==e.defaultFormId.trim().length||(n.defaultFormId=t.i18n.t("Обязательное значение")),n}})(mt)),yt=n(562),gt=n(564),bt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ot=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Et=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return p()(t,e),a()(t,[{key:"getJourneyConfig",value:function(e){return this.props.eventLineId.map(function(t){return new j.JourneyConfig(e.name,!0,t,new j.JourneyDefinition(e.name,pe.v4(),[],[],[],[]),Object(W.toOption)(new j.JourneyUIConfig(j.Id.createId(e.defaultFormId).getOrElse(function(){throw"wrong form id"}))),e.type!==j.JourneyTypeStandard.$Type.value)})}},{key:"onCreateRequested",value:function(){var e=this,t=void 0,n=this.props.openDialog(this.props.i18n.t("Создание цепочки"),f.createElement(vt,{ref:function(e){return t=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t,n){return e.getJourneyConfig(t).map(function(t){return Object(yt.a)(t).then(function(t){e.props.eventLineId.foreach(function(t){return e.props.dispatch(Object(gt.a)(t))}),e.props.dispatch(Object(ee.h)(e.props.i18n.t("Цепочка успешно создана!"))),e.props.handleDialogClose(n)}).catch(function(t){e.props.dispatch(Object(ie.a)(t))})}).getOrElse(function(){return new Promise(function(e,t){return t()})})}(t,n)},initialValues:{name:"",type:j.JourneyTypeStandard.$Type.value}}),[f.createElement(x.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(n)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditClick",value:function(e){var t=this;this.props.dispatch(Object(yt.f)(new j.Id(e.id.toString()))).then(function(e){t.onEditRequest(e.record)})}},{key:"onEditRequest",value:function(e){var t=this,n=void 0,r=this.props.openDialog(this.props.i18n.t("Редактирование цепочки"),f.createElement(vt,{ref:function(e){return n=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(n){return function(n,r){return Object(yt.i)(We(e,{entity:{name:{$set:n.name},uiConfig:{$set:Object(W.toOption)(new j.JourneyUIConfig(new j.Id(n.defaultFormId)))}}})).then(function(n){t.props.eventLineId.foreach(function(e){return t.props.dispatch(Object(gt.a)(e))}),t.props.dispatch(Object(yt.f)(e.id)),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Изменения в цепочке успешно сохранены!"))),t.props.handleDialogClose(r)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})}(n,r)},initialValues:{name:e.entity.name,defaultFormId:e.entity.uiConfig.map(function(e){return e.defaultFormId.value}).getOrElse(function(){return""}),type:e.entity.singleRun?j.JourneyTypeSingleRun.$Type.value:j.JourneyTypeStandard.$Type.value}}),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(r)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return n.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteRequest",value:function(e){var t=this,n=this.props.openDialog(this.props.i18n.t("Удаление цепочки"),f.createElement("p",null,this.props.i18n.t("Вы уверены? Это действие нельзя будет отменить")),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(n)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){Object(yt.b)(e).then(function(e){t.props.eventLineId.foreach(function(e){return t.props.dispatch(Object(gt.a)(e))}),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Цепочка успешно удалёна!"))),t.props.handleDialogClose(n)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})},color:"primary"},this.props.i18n.t("Удалить"))])}},{key:"onToggleRequest",value:function(e){var t=this;(e.isActive?yt.h:yt.g)(new j.Id(e.id.toString())).then(function(n){t.props.eventLineId.foreach(function(e){return t.props.dispatch(Object(gt.a)(e))}),t.props.dispatch(Object(ee.h)(t.props.i18n.t(e.isActive?"Цепочка остановлена!":"Цепочка запущена!")))}).catch(function(e){t.props.dispatch(Object(ee.h)(t.props.i18n.t("Ошибка!")))})}},{key:"onSettingsRequest",value:function(e){var t=this;this.props.eventLineId.foreach(function(n){return t.props.dispatch(Object(H.S)(n,j.Id.createId(e.id.toString()).getOrElse(function(){throw"wrong journeyconfig id"})))})}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(z.b,{leftButtonGroup:[]},f.createElement(x.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(V.a,{showId:!0,fetching:this.props.journeys.descriptionsFetching,error:this.props.journeys.descriptionsError,empty:!this.props.journeys.descriptionsFetching&&0===this.props.journeys.descriptionsList.length,onRecordSelected:this.onSettingsRequest,headers:[{id:"journeyName",title:this.props.i18n.t("Название")},{id:"journeyType",title:this.props.i18n.t("Тип")}],withActions:!0,rows:this.props.journeys.descriptionsFetched?this.props.journeys.descriptionsList.map(function(t){return{payload:t,id:t.id.toString(),fields:[t.name,e.props.i18n.t(t.singleRun?"Вопрос-ответ":"Стандартный")],buttons:[f.createElement(T.a,{key:"toggle",style:oe.f,color:t.isActive?"primary":"default",onClick:function(n){n.stopPropagation(),e.onToggleRequest(t)}},t.isActive?f.createElement(ft,{style:oe.g}):f.createElement(dt,{style:oe.g})),f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEditClick(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"settings",style:oe.f,onClick:function(n){n.stopPropagation(),e.onSettingsRequest(t)}},f.createElement(_.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequest(new j.Id(t.id.toString()))}},f.createElement(L.a,{style:oe.g}))]}}):[]}))}}]),t}(f.Component);Et=bt([h.autobind,Ot("design:paramtypes",[Object])],Et);var jt=Object(m.connect)(function(e){return{journeys:e.journeys,eventLineId:e.eventLine.eventLineId,i18n:e.i18n,filtersForm:e.filtersForm}})(Object(Ze.a)(function(e){e.isTokenChecked&&e.eventLineId.foreach(function(t){return e.dispatch(Object(gt.a)(t))})},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&e.eventLineId.foreach(function(t){return e.dispatch(Object(gt.c)(t))})})(Object(Xe.a)(Et))),Ct=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},It=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.fields,n=t.name;t.defaultFormId;return this.props.eventLine.data.map(function(t){return f.createElement("form",null,f.createElement(M.a,{fullWidth:!0,autoFocus:!0,value:n.value,onChange:n.onChange,label:e.props.i18n.t("Название"),error:n.touched&&n.error,helperText:n.touched&&Object(W.toOption)(n.error).map(function(e){return e}).getOrNull()}))}).getOrNull()}}]),t}(f.Component);It=Ct([h.autobind],It);var kt=Object(m.connect)(function(e){return{i18n:e.i18n,currentForm:e.currentForm,formFields:e.fields,forms:e.forms,eventLine:e.eventLine}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"metricsDashboardForm",fields:["name"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(It)),wt=n(1887),Tt=n(1907),Rt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},xt=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"onCreateRequested",value:function(){var e=this,t=void 0,n=this.props.openDialog(this.props.i18n.t("Создание списка метрик"),f.createElement(kt,{ref:function(e){return t=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(t){return Object(wt.a)(new j.MetricsDashboard(t.name,e.props.eventLineId,[])).then(function(t){e.props.dispatch(Object(Tt.b)(e.props.eventLineId)),e.props.dispatch(Object(ee.h)(e.props.i18n.t("Список метрик успешно создан!"))),e.props.handleDialogClose(n)}).catch(function(t){e.props.dispatch(Object(ie.a)(t))})}(t)},initialValues:{name:""}}),[f.createElement(x.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(n)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditRequest",value:function(e){var t=this,n=void 0,r=this.props.openDialog(this.props.i18n.t("Редактирование списка метрик"),f.createElement(kt,{ref:function(e){return n=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(n){return function(n){return Object(wt.e)(We(e,{entity:{name:{$set:n.name}}})).then(function(e){t.props.dispatch(Object(Tt.b)(t.props.eventLineId)),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Изменения в списке метрик успешно сохранены!"))),t.props.handleDialogClose(r)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})}(n)},initialValues:{name:e.entity.name}}),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(r)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return n.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteRequest",value:function(e){var t=this,n=this.props.openDialog(this.props.i18n.t("Удаление списка метрик"),f.createElement("p",null,this.props.i18n.t("Вы уверены? Это действие нельзя будет отменить")),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(n)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){Object(wt.b)(e).then(function(e){t.props.dispatch(Object(Tt.b)(t.props.eventLineId)),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Список метрик успешно удалён!"))),t.props.handleDialogClose(n)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})},color:"primary"},this.props.i18n.t("Удалить"))])}},{key:"onSettingsRequest",value:function(e){this.props.dispatch(Object(H.Y)(this.props.eventLineId,e.id))}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(z.b,{leftButtonGroup:[]},f.createElement(x.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(V.a,{showId:!0,fetching:this.props.metricsDashboards.fetching,error:this.props.metricsDashboards.error,empty:!this.props.metricsDashboards.fetching&&0===this.props.metricsDashboards.list.length,onRecordSelected:this.onSettingsRequest,headers:[{id:"journeyName",title:this.props.i18n.t("Название")}],withActions:!0,rows:this.props.metricsDashboards.fetching?[]:this.props.metricsDashboards.list.map(function(t){return{payload:t,id:t.id.value,fields:[t.entity.name],buttons:[f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEditRequest(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"settings",style:oe.f,onClick:function(n){n.stopPropagation(),e.onSettingsRequest(t)}},f.createElement(_.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequest(t.id)}},f.createElement(L.a,{style:oe.g}))]}})}))}}]),t}(f.Component);xt=Rt([h.autobind],xt);var Dt=Object(m.connect)(function(e){return{metricsDashboards:e.metricsDashboards,i18n:e.i18n}})(Object(Ze.a)(function(e){e.isTokenChecked&&e.dispatch(Object(Tt.b)(e.eventLineId))},function(){},function(e,t){})(Object(Xe.a)(xt))),Ft=n(2054),St=n(1483),Lt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Pt=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;Object(W.headOption)(this.props.roles.descriptionsList).foreach(function(t){return e.props.fields.roleId.onChange(t.id)})}},{key:"render",value:function(){var e=this.props,t=e.fields,n=t.name,r=t.roleId,i=e.handleSubmit;return f.createElement("form",{onSubmit:i},f.createElement(M.a,{fullWidth:!0,autoFocus:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Название"),error:n.touched&&n.error,helperText:n.touched&&Object(W.toOption)(n.error).map(function(e){return e}).getOrNull()}),f.createElement(we.a,{fullWidth:!0},f.createElement(Ie.a,{shrink:!0},this.props.i18n.t("Роль")),f.createElement(je.a,{fullWidth:!0,native:!0,value:this.props.fields.roleId.value,onChange:r.onChange},this.props.roles.descriptionsList.map(function(e){return f.createElement("option",{key:e.id,value:e.id},e.name)}))))}}]),t}(f.Component);Pt=Lt([h.autobind],Pt);var _t=Object(m.connect)(function(e){return{i18n:e.i18n,roles:e.roles}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"ApplicationCreateForm",fields:["name","roleId"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(Pt)),At=n(1595),Vt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qt=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"onCreateRequested",value:function(){var e=this,t=!1,n=void 0;this.props.openDialog(this.props.i18n.t("Создание приложения"),f.createElement(_t,{ref:function(e){return n=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},onSubmit:function(n){return function(n){return new Promise(function(r,i){return e.props.organisation.organisationId.map(function(o){return Object(St.a)(n.name,o,new j.Id(n.roleId),new j.Id(e.props.params.eventLineId),new j.ApplicationTypeApiKeys,!0).then(function(n){r(n),e.props.dispatch(Object(St.d)(new j.Id(e.props.params.eventLineId))).then(function(r){t?(Object(W.headOption)(r.list.filter(function(e){return e.id.value===n.id.value})).foreach(function(t){return e.onEditRequest(t)}),e.props.handleDialogClose(!1)):e.props.handleDialogClose(!1)}),e.props.dispatch(Object(ee.h)(e.props.i18n.t("Приложение успешно создано!")))}).catch(function(e){i(e)})}).getOrElse(function(){throw console.error("organisationId isn't specified"),new Error})}).catch(function(t){return e.props.dispatch(Object(ie.a)(t))})}(n)},initialValues:{active:!0,registrationAllowed:!0,authAllowed:!0}}),[f.createElement(x.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){return n.map(function(e){t=!1,e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditRequest",value:function(e){this.props.dispatch(Object(H.i)(new j.Id(this.props.params.eventLineId),e.id))}},{key:"onDeleteRequest",value:function(e){var t=this;this.props.openDialog(this.props.i18n.t("Удаление приложения"),f.createElement("p",null,this.props.i18n.t("Вы уверены? Это действие нельзя будет отменить")),[f.createElement(x.a,{variant:"raised",onClick:function(){return t.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{variant:"raised",onClick:function(){Object(St.b)(e).then(function(e){t.props.dispatch(Object(St.d)(new j.Id(t.props.params.eventLineId))),t.props.dispatch(Object(ee.h)(t.props.i18n.t("Приложение успешно удалено!"))),t.props.handleDialogClose(!1)}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})},color:"primary"},this.props.i18n.t("Удалить"))])}},{key:"onActiveToggle",value:function(e){var t=this;Object(St.f)(e.id,e.entity.name,e.entity.roleId,e.entity.appType,!e.entity.active).then(function(e){t.props.dispatch(Object(St.d)(new j.Id(t.props.params.eventLineId)))}).catch(function(e){t.props.dispatch(Object(ie.a)(e))})}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(z.b,{leftButtonGroup:[]},f.createElement(x.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(V.a,{showId:!0,fetching:this.props.applications.fetching,error:this.props.applications.error,empty:!this.props.applications.fetching&&0===this.props.applications.list.length,onRecordSelected:this.onEditRequest,headers:[{id:"applicationName",title:this.props.i18n.t("Название")}],withActions:!0,rows:this.props.applications.fetching?[]:this.props.applications.list.map(function(t){return{payload:t,id:t.id.value,fields:[t.entity.name],buttons:[f.createElement(T.a,{key:"active",color:t.entity.active?"primary":"default",style:oe.f,onClick:function(n){n.stopPropagation(),e.onActiveToggle(t)}},t.entity.active?f.createElement(ft,{style:oe.g}):f.createElement(dt,{style:oe.g})),f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEditRequest(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequest(t.id)}},f.createElement(L.a,{style:oe.g}))]}})}))}}]),t}(f.Component);qt=Vt([h.autobind],qt);var Nt=Object(m.connect)(function(e){return{applications:e.applications,i18n:e.i18n,filtersForm:e.filtersForm,organisation:e.organisation}})(Object(Ze.a)(function(e){e.isTokenChecked&&(e.dispatch(Object(U.d)()),e.dispatch(Object(St.d)(new j.Id(e.params.eventLineId))),e.organisation.data.foreach(function(t){return e.dispatch(Object(At.a)(t.id))}))},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&(e.dispatch(Object(U.d)()),e.dispatch(Object(St.d)(new j.Id(e.params.eventLineId))),e.organisation.data.foreach(function(t){return e.dispatch(Object(At.a)(t.id))}))})(qt)),Mt=n(1461),$t=(n(2365),n(1488)),Gt=n(1487),Wt=n(82),Bt=n(43),Zt=n.n(Bt),Jt=n(1472),Ut=n.n(Jt),zt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ht=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"handleEmailDelete",value:function(e){var t=this.props.fields.emails;this.props.fields.emails.onChange([].concat(Zt()(t.value.slice(0,e)),Zt()(t.value.slice(e+1))))}},{key:"handleEmailAdd",value:function(){var e=this.props.fields,t=e.emails,n=e.email;this.props.fields.emails.onChange([].concat(Zt()(t.value),[n.value])),this.props.fields.email.onChange("")}},{key:"render",value:function(){var e=this;return f.createElement("form",null,f.createElement("h4",null,this.props.i18n.t("Часто используемые почтовые ящики")),f.createElement("div",{style:{marginTop:15}},this.props.fields.emails.value.map(function(t,n){return f.createElement(Ut.a,{key:n,style:{marginRight:5},label:t,color:"primary",variant:"outlined",onDelete:function(){return e.handleEmailDelete(n)}})}),f.createElement(M.a,{fullWidth:!0,label:this.props.i18n.t("Почтовый адрес"),value:this.props.fields.email.value,onChange:this.props.fields.email.onChange}),f.createElement(x.a,{variant:"raised",onClick:this.handleEmailAdd,color:"primary"},this.props.i18n.t("Добавить"))))}}]),t}(f.Component);Ht=zt([h.autobind],Ht);var Kt=Object(m.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"notifyForm",fields:["photoBaseUpdating","emails","email"]})(Ht)),Yt=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Xt=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"getInitialValues",value:function(){return{photoBaseUpdating:!1,email:"",emails:this.props.eventLine.data.map(function(e){return e.entity.emailTemplates.emails}).getOrElse(function(){return[]})}}},{key:"refHandler",value:function(e){this.formInstance=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})}},{key:"onSave",value:function(e){var t=this;this.props.eventLine.data.foreach(function(n){return Object(X.e)(We(n,{entity:{$set:new j.EventLine(n.entity.name,n.entity.description,n.entity.organisationId,n.entity.uid,n.entity.domainId,new j.EventLineEmailTemplates(e.emails))}})).then(function(){t.props.dispatch(Object(ee.h)(t.props.i18n.t("Успешно сохранено"))),t.props.dispatch(Object(X.d)(n.entity.organisationId))})})}},{key:"onSaveClick",value:function(){this.formInstance.map(function(e){return e.submit()})}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{flex:1,padding:15}},f.createElement(Kt,{ref:this.refHandler,onSubmit:function(t){return e.onSave(t)},initialValues:this.getInitialValues()}),f.createElement(x.a,{variant:"raised",onClick:this.onSaveClick,style:{marginTop:"1em"}},this.props.i18n.t("Сохранить")))}}]),t}(f.Component);Xt=Yt([h.autobind],Xt);var Qt=Object(m.connect)(function(e){return{eventLine:e.eventLine,i18n:e.i18n}})(Xt),en=n(637),tn=n(656),nn=n.n(tn),rn=n(560),on=n.n(rn),an=n(561),sn=n.n(an),ln=n(793),cn=n.n(ln),pn=n(794),un=n.n(pn),dn=n(1546),fn=n(98),hn=n.n(fn),mn=n(29),vn=n(384),yn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},gn=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;j.Id.createId(this.props.fields.formId.value).foreach(function(t){e.props.dispatch(Object(K.h)(t))})}},{key:"onFormChanged",value:function(e){var t=this;e.foreach(function(e){t.props.fields.formId.onChange(e.value),t.props.dispatch(Object(K.h)(e))})}},{key:"onFormFieldChanged",value:function(e){var t=this;e.foreach(function(e){t.props.fields.identityField.onChange(e.value)})}},{key:"render",value:function(){var e=this,t=this.props.fields,n=t.formId,r=t.identityField;return f.createElement("form",null,f.createElement(vn.a,{value:j.Id.createId(n.value),onChange:this.onFormChanged,errorText:new W.None}),f.createElement(Se.a,{fullWidth:!0,errorText:new W.None,fields:j.Id.createId(n.value).flatMap(function(t){return Object(mn.e)(e.props.formFields,t)}).getOrElse(function(){return[]}),labelText:Object(W.toOption)(this.props.i18n.t("Поле с email")),value:j.Id.createId(r.value),onChanged:this.onFormFieldChanged,emptyDisabled:!1}))}}]),t}(f.Component);gn=yn([h.autobind],gn);var bn=Object(m.connect)(function(e){return{i18n:e.i18n,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"EmailFormRelationForm",fields:["formId","identityField"],validate:function(e,t){return{}}})(gn)),On=n(107),En=n.n(On),jn=n(219),Cn=n.n(jn),In=n(72),kn=n.n(In),wn=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this;return f.createElement(En.a,null,f.createElement(ge.a,{primary:Object(Fe.e)(this.props.forms,this.props.relation.formId).map(function(e){return e.entity.name}).getOrElse(function(){return""}),secondary:Object(mn.b)(this.props.fields,this.props.relation.formId,this.props.relation.identityField).map(function(e){return e.entity.name}).getOrElse(function(){return""})}),f.createElement(Cn.a,null,f.createElement(T.a,{onClick:function(){return e.props.onEdit(e.props.relation,e.props.idx)}},f.createElement(F.a,null)),f.createElement(T.a,{onClick:function(){return e.props.onRemove(e.props.idx)}},f.createElement(kn.a,null))))}}]),t}(f.Component),Tn=Object(m.connect)(function(e,t){return{i18n:e.i18n,fields:e.fields,forms:e.forms}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fields===t.fields&&e.forms===t.forms},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.fields===t.fields&&e.forms===t.forms}})(Object(Ze.a)(function(){},function(e){e.dispatch(Object(K.h)(e.relation.formId))})(wn)),Rn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},xn=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"openEditForm",value:function(e,t,n){var r=this,i=new W.None,o=this.props.openDialog(e,f.createElement(bn,{ref:function(e){return i=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},initialValues:n,onSubmit:t}),[f.createElement(x.a,{key:"close",variant:"raised",onClick:function(){return r.props.handleDialogClose(o)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{key:"save",variant:"raised",onClick:function(){i.foreach(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))]);return o}},{key:"getEmailFormRelation",value:function(e){return j.Id.createId(e.formId).flatMap(function(t){return j.Id.createId(e.identityField).map(function(e){return new j.EmailFormRelation(t,e)})})}},{key:"onAddRelationButtonClick",value:function(){var e=this,t=this.openEditForm("Добавление отношения",function(n){return new Promise(function(r,i){e.props.handleDialogClose(t),e.getEmailFormRelation(n).foreach(function(t){e.props.onChange(We(e.props.relations,{$push:[t]}))}),r()})})}},{key:"onEdit",value:function(e,t){var n=this,r=this.openEditForm("Редактирование отношения",function(e){return new Promise(function(i,o){n.props.handleDialogClose(r),n.getEmailFormRelation(e).foreach(function(e){n.props.onChange(We(n.props.relations,{$splice:[[t,1,e]]}))}),i()})},{formId:e.formId.value,identityField:e.identityField})}},{key:"onRemove",value:function(e){this.props.onChange(We(this.props.relations,{$splice:[[e,1]]}))}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{maxWidth:"400px"}},f.createElement("h4",null,this.props.i18n.t("Список отношений")),f.createElement(hn.a,null,this.props.relations.map(function(t,n){return f.createElement(Tn,{key:n,idx:n,relation:t,onEdit:e.onEdit,onRemove:e.onRemove})})),f.createElement("div",null,f.createElement(x.a,{variant:"raised",onClick:this.onAddRelationButtonClick,style:{marginRight:"10px"}},this.props.i18n.t("Добавить отношение"))))}}]),t}(f.Component);xn=Rn([h.autobind],xn);var Dn=Object(m.connect)(function(e){return{i18n:e.i18n}})(Object(Xe.a)(xn)),Fn=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Sn=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"onTimeValueChange",value:function(e){this.props.fields.lastUpdated.onChange(e.getTime())}},{key:"render",value:function(){var e=this.props,t=e.fields,n=t.name,r=t.address,i=t.addressName,o=t.transportId,a=t.fetchEnabled,s=t.fetchInterval,l=t.lastUpdated,c=t.relations,p=t.loadAttachments,u=e.handleSubmit;return f.createElement("form",{onSubmit:u},f.createElement(M.a,{value:n.value,onChange:n.onChange,fullWidth:!0,label:this.props.i18n.t("Название конфигурации"),autoComplete:"off",autoFocus:!0}),f.createElement(M.a,{value:i.value,onChange:i.onChange,fullWidth:!0,label:this.props.i18n.t("Имя владельца email")}),f.createElement(M.a,{value:r.value,onChange:r.onChange,fullWidth:!0,label:this.props.i18n.t("Адрес")}),f.createElement(we.a,{fullWidth:!0},f.createElement(Ie.a,null,this.props.i18n.t("Конфигурация сервиса отправления")),f.createElement(je.a,{fullWidth:!0,native:!0,value:o.value,onChange:o.onChange},f.createElement("option",{value:""}),this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof j.EmailTransport}).map(function(e){return f.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)}))),f.createElement(Dn,{relations:c.value||[],onChange:c.onChange}),f.createElement(Re.a,{label:this.props.i18n.t("Импорт"),control:f.createElement(he.a,{checked:a.value,onChange:a.onChange})}),a.value&&f.createElement("div",null,f.createElement(M.a,{type:"number",value:s.value,onChange:s.onChange,fullWidth:!0,label:this.props.i18n.t("Интервал импорта (мин.)")}),f.createElement(nn.a,{label:this.props.i18n.t("Дата и время"),fullWidth:!0,value:Object(W.toOption)(l.value).filter(function(e){return""!==e}).map(function(e){return new Date(e)}).getOrNull(),onChange:this.onTimeValueChange,leftArrowIcon:f.createElement(on.a,null),rightArrowIcon:f.createElement(sn.a,null),dateRangeIcon:f.createElement(cn.a,null),timeIcon:f.createElement(un.a,null)}),f.createElement(Re.a,{label:this.props.i18n.t("Загружать вложения на сервер"),control:f.createElement(he.a,{checked:p.value,onChange:p.onChange})})))}}]),t}(f.Component);Sn=Fn([h.autobind],Sn);var Ln=Object(m.connect)(function(e){return{i18n:e.i18n,user:e.user,organisation:e.organisation}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(q.reduxForm)({form:"MailBoxConfigForm",fields:["name","transportId","address","addressName","fetchEnabled","fetchInterval","lastUpdated","relations","loadAttachments"]})(Object(Ze.a)(function(e){e.isTokenChecked&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(dn.a)(t))})})(Sn))),Pn=n(626),_n=n(648),An=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Vn=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"openEditForm",value:function(e,t,n){var r=this,i=new W.None,o=this.props.openDialog(e,f.createElement(Ln,{ref:function(e){return i=Object(W.toOption)(e).flatMap(function(e){return Object(W.toOption)(e.wrappedInstance)})},initialValues:n,onSubmit:t}),[f.createElement(x.a,{key:"close",variant:"raised",onClick:function(){return r.props.handleDialogClose(o)}},this.props.i18n.t("Закрыть")),f.createElement(x.a,{key:"save",variant:"raised",color:"primary",onClick:function(){i.foreach(function(e){return e.submit()})}},this.props.i18n.t("Сохранить"))]);return o}},{key:"onCreateRequested",value:function(){var e=this,t=this.openEditForm(this.props.i18n.t("Создание"),function(n){return Object(en.b)(new j.MailBoxConfig(n.name,new j.MessageAddress(n.addressName||"",n.address),e.props.eventLineId,j.Id.createId(n.transportId).getOrElse(function(){throw"wrong message transport config"}),new j.FetchParams(!!n.fetchEnabled,Object(W.toOption)(n.lastUpdated),Object(W.toOption)(n.fetchInterval).filter(function(e){return""!==e}).map(function(e){return new j.Duration(e,j.TimeUnitType.Minutes).duration}),n.loadAttachments||!1),new j.RelationParams(n.relations||[]))).then(function(n){e.props.handleDialogClose(t),e.props.openSnackbar(f.createElement("span",null,e.props.i18n.t("Конфигурация импорта писем успешно создана")),new W.None),e.props.dispatch(Object(_n.a)(e.props.eventLineId))}).catch(function(e){})})}},{key:"onEditClick",value:function(e){var t=this,n=this.openEditForm(this.props.i18n.t("Редактирование"),function(r){return Object(en.l)(We(e,{entity:{$set:new j.MailBoxConfig(r.name,new j.MessageAddress(r.addressName||"",r.address),t.props.eventLineId,j.Id.createId(r.transportId).getOrElse(function(){throw"wrong message transport config"}),new j.FetchParams(!!r.fetchEnabled,Object(W.toOption)(r.lastUpdated),Object(W.toOption)(r.fetchInterval).filter(function(e){return""!==e}).map(function(e){return new j.Duration(e,j.TimeUnitType.Minutes).duration}),r.loadAttachments||!1),new j.RelationParams(r.relations||[]))}})).then(function(e){t.props.handleDialogClose(n),t.props.openSnackbar(f.createElement("span",null,t.props.i18n.t("Конфигурация импорта писем успешно сохранена")),new W.None),t.props.dispatch(Object(_n.a)(t.props.eventLineId))}).catch(function(e){})},{name:e.entity.name,transportId:e.entity.transportId.value,addressName:e.entity.address.name,address:e.entity.address.email,fetchEnabled:e.entity.fetchParams.enabled,fetchInterval:e.entity.fetchParams.repeatInterval.map(function(e){return e.getMinutes()}).getOrElse(function(){return 30}),lastUpdated:e.entity.fetchParams.lastUpdated.getOrNull(),relations:e.entity.relationParams.forms,loadAttachments:e.entity.fetchParams.loadAttachments})}},{key:"onDeleteRequested",value:function(e){var t=this,n=this.props.openDialog(this.props.i18n.t("Удаление"),f.createElement("p",null,this.props.i18n.t("Вы действительно хотите удалить? Это действие нельзя будет отменить")),[f.createElement(x.a,{key:"close",variant:"raised",onClick:function(){return t.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),f.createElement(x.a,{key:"delete",variant:"raised",color:"primary",onClick:function(){Object(en.c)(e.id).then(function(){t.props.handleDialogClose(n),t.props.dispatch(Object(_n.a)(t.props.eventLineId)),t.props.openSnackbar(f.createElement("span",null,t.props.i18n.t("Успешно удалено")),new W.None)}).catch(function(e){t.props.openSnackbar(f.createElement("span",null,t.props.i18n.t("При удалении произошла ошибка")),new W.None)})}},this.props.i18n.t("Удалить"))])}},{key:"render",value:function(){var e=this;return f.createElement("div",null,f.createElement(z.b,null,f.createElement(x.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(V.a,{showId:!1,error:this.props.mailBoxConfigs.error,fetching:this.props.mailBoxConfigs.fetching,onRecordSelected:this.onEditClick,empty:!this.props.mailBoxConfigs.fetching&&0===this.props.mailBoxConfigs.list.length,withActions:!0,headers:[{id:"name",title:this.props.i18n.t("Название")}],rows:this.props.mailBoxConfigs.list.map(function(t,n){return{id:t.id.toString(),payload:t,fields:[t.entity.name],buttons:[f.createElement(T.a,{key:"edit",style:oe.f,onClick:function(n){n.stopPropagation(),e.onEditClick(t)}},f.createElement(F.a,{style:oe.g})),f.createElement(T.a,{key:"delete",style:oe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},f.createElement(L.a,{style:oe.g}))]}})}))}}]),t}(f.Component);Vn=An([h.autobind],Vn);var qn,Nn=Object(m.connect)(function(e,t){return{i18n:e.i18n,mailBoxConfigs:e.mailBoxConfigs}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.mailBoxConfigs===t.mailBoxConfigs},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.mailBoxConfigs===t.mailBoxConfigs}})(Object(Ze.a)(function(e){e.isTokenChecked&&e.dispatch(Object(_n.a)(e.eventLineId))})(Object(Xe.a)(Object(Pn.a)(Vn)))),Mn=n(2058),$n=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Gn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Wn=qn=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(I.a.screenInitialState(),{selectedIndex:qn.selectedIndex(),nestedSelectedIndex:qn.nestedSelectedIndex()})))}return p()(t,e),a()(t,[{key:"onSelected",value:function(e){switch(e){case 0:this.props.dispatch(Object(H.L)(new j.Id(this.props.params.eventLineId),new j.Id(j.FormType.FORM)));break;case 1:this.props.dispatch(Object(H.q)(new j.Id(this.props.params.eventLineId)));break;case 8:this.props.dispatch(Object(H.Db)(new j.Id(this.props.params.eventLineId)));break;case 5:this.props.dispatch(Object(H.Nb)(new j.Id(this.props.params.eventLineId)));break;case 6:this.props.dispatch(Object(H.w)(new j.Id(this.props.params.eventLineId)));break;case 7:this.props.dispatch(Object(H.a)(new j.Id(this.props.params.eventLineId)));break;case 9:this.props.dispatch(Object(H.T)(new j.Id(this.props.params.eventLineId)));break;case 15:this.props.dispatch(Object(H.R)(new j.Id(this.props.params.eventLineId)));break;case 10:this.props.dispatch(Object(H.j)(new j.Id(this.props.params.eventLineId)));break;case 13:this.props.dispatch(Object(H.Z)(new j.Id(this.props.params.eventLineId)));break;case 14:case 12:this.props.dispatch(Object(H.ab)(j.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong eventLine id"})));break;case 11:this.props.dispatch(Object(H.L)(new j.Id(this.props.params.eventLineId),new j.Id(j.FormType.FORM)));break;case 16:this.props.dispatch(Object(H.X)(j.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong eventLine id"})));break;case 17:this.props.dispatch(Object(H.u)(j.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong eventLine id"})))}this.setState(Object.assign(this.state,{selectedIndex:qn.nestedSelectedIndexToSelectedIndex(e),nestedSelectedIndex:qn.selectedIndexToNestedSelectedIndex(e)}))}},{key:"renderNavigation",value:function(){return f.createElement(C.a,null)}},{key:"onFormTabActive",value:function(e){j.FormType.isAnyDictionary(e)?this.onSelected(1):this.onSelected(0)}},{key:"getFormTabValue",value:function(e){return j.FormType.isAnyDictionary(e)?1:j.FormType.isAccessZonePasses(e)?2:j.FormType.isDocument(e)?4:0}},{key:"renderEventLineFormsList",value:function(){return f.createElement(ce,{handleDialogClose:this.handleDialogClose,openDialog:this.openDialog,params:this.props.params})}},{key:"renderMetricsTab",value:function(){return 13===this.state.nestedSelectedIndex?f.createElement(Dt,{eventLineId:j.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong eventLine id"})}):f.createElement(Ft.a,{eventLineId:j.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong eventLine id"})})}},{key:"render",value:function(){var e=this,t=j.Id.createId(this.props.params.eventLineId).getOrElse(function(){throw"wrong event line id"});return this.renderScreenBody({className:""},this.props.role.map(function(n){return f.createElement(E.a,{style:{display:"flex",flex:1}},f.createElement($t.a,{value:e.state.selectedIndex,onChange:e.onSelected},n.entity.isEventLineServicePermitted(t,j.AdminEventLineServiceForms.$Type.value)&&f.createElement(Gt.a,{value:11,label:e.props.i18n.t("Формы")},j.FormType.getAllFormTypes().filter(function(e){return!j.FormType.isService(e)&&!j.FormType.isAnyDictionary(e)}).map(function(t,n){return f.createElement("div",{key:n,style:{display:"flex",flexDirection:"column",flex:1}},f.createElement(b.a,{indicatorColor:"primary",textColor:"primary",value:e.state.nestedSelectedIndex,onChange:function(t,n){return e.onSelected(n)},fullWidth:!0,scrollable:!0,scrollButtons:"on"},f.createElement(y.a,{value:e.getFormTabValue(t),label:e.props.i18n.t("Основные")}),f.createElement(y.a,{value:1,label:e.props.i18n.t("Словари")}),f.createElement(y.a,{value:8,label:e.props.i18n.t("Служебные")})),e.renderEventLineFormsList())})),n.entity.isEventLineServicePermitted(t,j.AdminEventLineServiceGenerators.$Type.value)&&f.createElement(Gt.a,{value:5,label:e.props.i18n.t("Генераторы")},f.createElement(ze,{handleDialogClose:e.handleDialogClose,openDialog:e.openDialog,params:e.props.params})),f.createElement(Gt.a,{value:6,label:e.props.i18n.t("Настройки")},f.createElement(Qt,{handleDialogClose:e.handleDialogClose,openDialog:e.openDialog,params:e.props.params})),n.entity.isEventLineServicePermitted(t,j.AdminEventLineServiceInteractions.$Type.value)&&f.createElement(Gt.a,{value:7,label:e.props.i18n.t("Взаимодействия")},f.createElement(ct,{params:e.props.params})),n.entity.isEventLineServicePermitted(t,j.AdminEventLineServiceJourneys.$Type.value)&&f.createElement(Gt.a,{value:9,label:e.props.i18n.t("Цепочки")},f.createElement(jt,null)),f.createElement(Gt.a,{value:15,label:e.props.i18n.t("События")},f.createElement(tt,{params:e.props.params})),f.createElement(Gt.a,{value:16,label:e.props.i18n.t("Импорт писем")},f.createElement(Nn,{eventLineId:t})),f.createElement(Gt.a,{value:17,label:e.props.i18n.t("Письма")},f.createElement(Mn.a,{eventLineId:t})),n.entity.isEventLineServicePermitted(t,j.AdminEventLineServiceApplications.$Type.value)&&f.createElement(Gt.a,{value:10,label:e.props.i18n.t("eventLine|Приложения")},f.createElement(Nt,{handleDialogClose:e.handleDialogClose,openDialog:e.openDialog,params:e.props.params})),n.entity.isEventLineServicePermitted(t,j.AdminEventLineServiceMetrics.$Type.value)&&!Wt.default.isA5000&&f.createElement(Gt.a,{value:12,label:e.props.i18n.t("Метрики")},f.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},f.createElement(b.a,{indicatorColor:"primary",textColor:"primary",value:e.state.nestedSelectedIndex,onChange:function(t,n){return e.onSelected(n)},fullWidth:!0,scrollable:!0,scrollButtons:"on"},f.createElement(y.a,{value:14,label:e.props.i18n.t("Метрики")}),f.createElement(y.a,{value:13,label:e.props.i18n.t("Списки метрик")})),e.renderMetricsTab()))))}).getOrNull())}}],[{key:"selectedIndex",value:function(){return-1!==location.href.indexOf("/valuesGenerators")?5:-1!==location.href.indexOf("/settings")?6:-1!==location.href.indexOf("/ac")?7:-1!==location.href.indexOf("/journeys")?9:-1!==location.href.indexOf("/journeyEventIds")?15:-1!==location.href.indexOf("/applications")?10:-1===location.href.indexOf("/metrics")||Wt.default.isA5000?-1!==location.href.indexOf("/mailBoxes")?16:-1!==location.href.indexOf("/emails")?17:11:12}},{key:"nestedSelectedIndex",value:function(){return-1!==location.href.indexOf("/formTypes/"+j.FormType.FORM)?0:-1!==location.href.indexOf("/serviceForms")?8:-1!==location.href.indexOf("/dictionaries")?1:-1!==location.href.indexOf("/dashboards")?13:-1!==location.href.indexOf("/metrics")?14:0}},{key:"nestedSelectedIndexToSelectedIndex",value:function(e){switch(e){case 0:case 1:case 8:return 11;case 13:case 14:return 12;default:return e}}},{key:"selectedIndexToNestedSelectedIndex",value:function(e){switch(e){case 11:return 0;case 12:return 14;default:return e}}}]),t}(I.a);Wn=qn=$n([h.autobind,Gn("design:paramtypes",[Object])],Wn);t.default=Object(m.connect)(function(e){return{eventLines:e.eventLines,role:e.user.userRole,i18n:e.i18n}})(Object(Mt.a)(Object(Ze.a)(function(e){})(Wn)))}}]);