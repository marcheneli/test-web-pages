(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[46],{1459:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return c});var i=n(79),r=n(104),o=n(82),a=function(){return function(t,e){return t(o.default.isA5000?Object(i.Mb)():Object(i.h)())}},c=function(t,e){return function(n,o){return o().eventLine.data.foreach(function(a){Object(r.e)(o().forms,t).foreach(function(r){n(Object(i.H)(a.id,r.entity.formType.getFormTypeId(),t,e))})})}}},1461:function(t,e,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),c=n(7),u=n.n(c),s=n(8),l=n.n(s),p=n(2),d=n(14),f=n(1469),h=n(1459),g=n(320),b=n(69),m=n(0),v=n(624);e.a=function(t){return Object(d.connect)(function(t){return{auth:t.auth,websocket:t.websocket,routing:t.routing}})(function(t){return function(e){function n(){return r()(this,n),u()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return l()(n,e),a()(n,[{key:"componentWillMount",value:function(){var t=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(m.toOption)(this.props.routing.location).map(function(e){Object(m.liftKey)(Object(v.a)(e.search),"token").map(function(e){e.map(function(e){t.props.dispatch(Object(f.d)(e)).catch(function(e){t.signOut()})})}).getOrElse(function(){t.props.auth.token.map(function(e){t.props.dispatch(Object(f.d)(e)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(t){var e=this;t.auth.signedOut||t.websocket.active&&(t.auth.checking||(t.auth.checked&&t.auth.signedIn||t.auth.signingIn||t.auth.signedIn)&&(!t.websocket.active||this.props.websocket.active)||t.auth.token.map(function(n){t.dispatch(Object(f.d)(n)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(b.r)()),this.props.dispatch(Object(g.c)()),this.props.dispatch(Object(h.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?p.createElement(t,this.props):p.createElement("div",null)}}]),n}(p.Component)}(t))}},1462:function(t,e,n){"use strict";var i=n(855);Object.defineProperty(e,"__esModule",{value:!0});var r={};Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o.default}});var o=i(n(1464));Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(r,t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))})},1463:function(t,e,n){"use strict";var i=n(855),r=n(12);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(36)),a=r(n(2)),c=(r(n(31)),i(n(1462))),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e){var n=t.breakpoint,i=void 0===n?"sm":n;return(0,c.default)()(function(t){return a.default.createElement(e,(0,o.default)({fullScreen:(0,c.isWidthDown)(i,t.width)},t))})}};e.default=u},1464:function(t,e,n){"use strict";var i=n(12);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isWidthDown=e.isWidthUp=void 0;var r=i(n(36)),o=i(n(39)),a=i(n(73)),c=i(n(74)),u=i(n(76)),s=i(n(77)),l=i(n(78)),p=i(n(2)),d=(i(n(31)),i(n(217))),f=i(n(373)),h=(n(61),i(n(539))),g=i(n(263)),b=n(859),m=i(n(860));e.isWidthUp=function(t,e){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?b.keys.indexOf(t)<b.keys.indexOf(e):b.keys.indexOf(t)<=b.keys.indexOf(e)};e.isWidthDown=function(t,e){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?b.keys.indexOf(e)<b.keys.indexOf(t):b.keys.indexOf(e)<=b.keys.indexOf(t)};var v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e){var n=t.withTheme,i=void 0!==n&&n,v=t.noSSR,O=void 0!==v&&v,y=t.initialWidth,j=t.resizeInterval,w=void 0===j?166:j,_=function(t){function n(t){var e;return(0,a.default)(this,n),(e=(0,u.default)(this,(0,s.default)(n).call(this,t))).state={width:O?e.getWidth():void 0},"undefined"!=typeof window&&(e.handleResize=(0,f.default)(function(){var t=e.getWidth();t!==e.state.width&&e.setState({width:t})},w)),e}return(0,l.default)(n,t),(0,c.default)(n,[{key:"componentDidMount",value:function(){var t=this.getWidth();t!==this.state.width&&this.setState({width:t})}},{key:"componentWillUnmount",value:function(){this.handleResize.clear()}},{key:"getWidth",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,e=this.props.theme.breakpoints,n=null,i=1;null===n&&i<b.keys.length;){var r=b.keys[i];if(t<e.values[r]){n=b.keys[i-1];break}i+=1}return n=n||"xl"}},{key:"render",value:function(){var t=(0,m.default)({theme:this.props.theme,name:"MuiWithWidth",props:(0,r.default)({},this.props)}),n=t.initialWidth,a=t.theme,c=t.width,u=(0,o.default)(t,["initialWidth","theme","width"]),s=(0,r.default)({width:c||this.state.width||n||y},u);return void 0===s.width?null:(i&&(s.theme=a),p.default.createElement(p.default.Fragment,null,p.default.createElement(e,s),p.default.createElement(d.default,{target:"window",onResize:this.handleResize})))}}]),n}(p.default.Component);return(0,h.default)(_,e),(0,g.default)()(_)}};e.default=v},1465:function(t,e,n){"use strict";var i=n(12);Object.defineProperty(e,"__esModule",{value:!0}),e.isHorizontal=j,e.getAnchor=w,e.default=e.styles=void 0;var r=i(n(36)),o=i(n(55)),a=i(n(39)),c=i(n(73)),u=i(n(74)),s=i(n(76)),l=i(n(77)),p=i(n(78)),d=i(n(2)),f=(i(n(31)),i(n(47))),h=i(n(625)),g=i(n(38)),b=i(n(858)),m=i(n(93)),v=n(110),O=n(321),y={left:"right",right:"left",top:"down",bottom:"up"};function j(t){return-1!==["left","right"].indexOf(t.anchor)}function w(t){return"rtl"===t.theme.direction&&j(t)?y[t.anchor]:t.anchor}var _=function(t){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:t.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:"none"},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(t.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(t.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(t.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(t.palette.divider)},modal:{}}};e.styles=_;var P=function(t){function e(){var t,n;(0,c.default)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(n=(0,s.default)(this,(t=(0,l.default)(e)).call.apply(t,[this].concat(r)))).mounted=!1,n}return(0,p.default)(e,t),(0,u.default)(e,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){var t=this.props,e=(t.anchor,t.BackdropProps),n=t.children,i=t.classes,c=t.className,u=t.elevation,s=t.ModalProps,l=(s=void 0===s?{}:s).BackdropProps,p=(0,a.default)(s,["BackdropProps"]),g=t.onClose,O=t.open,j=t.PaperProps,_=t.SlideProps,P=(t.theme,t.transitionDuration),k=t.variant,E=(0,a.default)(t,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","theme","transitionDuration","variant"]),I=w(this.props),C=d.default.createElement(m.default,(0,r.default)({elevation:"temporary"===k?u:0,square:!0,className:(0,f.default)(i.paper,i["paperAnchor".concat((0,v.capitalize)(I))],(0,o.default)({},i["paperAnchorDocked".concat((0,v.capitalize)(I))],"temporary"!==k))},j),n);if("permanent"===k)return d.default.createElement("div",(0,r.default)({className:(0,f.default)(i.root,i.docked,c)},E),C);var D=d.default.createElement(b.default,(0,r.default)({in:O,direction:y[I],timeout:P,appear:this.mounted},_),C);return"persistent"===k?d.default.createElement("div",(0,r.default)({className:(0,f.default)(i.root,i.docked,c)},E),D):d.default.createElement(h.default,(0,r.default)({BackdropProps:(0,r.default)({},e,l,{transitionDuration:P}),className:(0,f.default)(i.root,i.modal,c),open:O,onClose:g},E,p),D)}}]),e}(d.default.Component);P.defaultProps={anchor:"left",elevation:16,open:!1,transitionDuration:{enter:O.duration.enteringScreen,exit:O.duration.leavingScreen},variant:"temporary"};var k=(0,g.default)(_,{name:"MuiDrawer",flip:!1,withTheme:!0})(P);e.default=k},1473:function(t,e,n){"use strict";var i=n(12);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r.default}});var r=i(n(1463))},1474:function(t,e,n){"use strict";var i=n(12);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r.default}});var r=i(n(1465))},1483:function(t,e,n){"use strict";var i=n(17),r=n(21),o=n(6),a=n.n(o),c=n(7),u=n.n(c),s=n(8),l=n.n(s),p=n(18),d=function(t){function e(t,n,i,r,o,c){return a()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Permissions.Apps","Create",{name:t,organisationId:n,roleId:i,eventLineId:r,appType:o,active:c}))}return l()(e,t),e}(p.a),f=function(t){function e(t,n,i,r,o){return a()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Permissions.Apps","Update",{id:t,name:n,roleId:i,appType:r,active:o}))}return l()(e,t),e}(p.a),h=function(t){function e(t){return a()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Permissions.Apps","Delete",{appId:t}))}return l()(e,t),e}(p.a),g=(function(t){function e(t){return a()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Permissions.Apps","Request",{appId:t}))}l()(e,t)}(p.a),function(t){function e(t){return a()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Permissions.Apps","ListEventLine",{eventLineId:t}))}return l()(e,t),e}(p.a)),b=function(t){function e(t){return a()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Permissions.Apps","ListOrganisation",{organisationId:t}))}return l()(e,t),e}(p.a),m=function(t){function e(t,n){return a()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"Permissions.Apps","EnrichContext",{loginValues:t,formId:n}))}return l()(e,t),e}(p.a),v=n(427),O=n(5);Object(O.createAction)("Application.Fetching"),Object(O.createAction)("Application.Resolve"),Object(O.createAction)("Application.Error"),Object(O.createAction)("Auth.SetBlockId",function(t){return t});n.d(e,"d",function(){return y}),n.d(e,"e",function(){return j}),n.d(e,"f",function(){return w}),n.d(e,"a",function(){return _}),n.d(e,"b",function(){return P}),n.d(e,"c",function(){return k});var y=function(t){return function(e){return e(Object(v.e)()),i.a.send(new g(t),Object(r.g)()).then(function(t){return e(Object(v.f)(t.list)),t}).catch(function(t){throw e(Object(v.d)(t)),t})}},j=function(t){return function(e){return e(Object(v.e)()),i.a.send(new b(t),Object(r.g)()).then(function(t){return e(Object(v.f)(t.list)),t}).catch(function(t){throw e(Object(v.d)(t)),t})}},w=function(t,e,n,o,a){return i.a.send(new f(t,e,n,o,a),Object(r.f)())},_=function(t,e,n,o,a,c){return i.a.send(new d(t,e,n,o,a,c),Object(r.f)())},P=function(t){return i.a.send(new h(t),Object(r.f)())},k=function(t,e){return i.a.send(new m(t,e),function(t){return t})}},1548:function(t,e,n){"use strict";var i=n(17),r=n(6),o=n.n(r),a=n(7),c=n.n(a),u=n(8),s=n.n(u),l=n(18),p=(function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"InternetDomains","Request",{id:t}))}s()(e,t)}(l.a),function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"InternetDomains","List",{orgId:t}))}return s()(e,t),e}(l.a)),d=function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"InternetDomains","Update",{page:t}))}return s()(e,t),e}(l.a),f=function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"InternetDomains","Create",{page:t}))}return s()(e,t),e}(l.a),h=function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"InternetDomains","Delete",{id:t}))}return s()(e,t),e}(l.a),g=n(21);n.d(e,"c",function(){return b}),n.d(e,"d",function(){return m}),n.d(e,"a",function(){return v}),n.d(e,"b",function(){return O});var b=function(t){return i.a.send(new p(t),Object(g.g)())},m=function(t){return i.a.send(new d(t),Object(g.f)())},v=function(t){return i.a.send(new f(t),Object(g.c)())},O=function(t){return i.a.send(new h(t),Object(g.d)())}},1591:function(t,e,n){"use strict";var i=n(17),r=n(6),o=n.n(r),a=n(7),c=n.n(a),u=n(8),s=n.n(u),l=n(18),p=function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"WebPages","Request",{id:t}))}return s()(e,t),e}(l.a),d=(function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"WebPages","List",{orgId:t}))}s()(e,t)}(l.a),function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"WebPages","ListDescriptions",{orgId:t}))}return s()(e,t),e}(l.a)),f=function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"WebPages","Create",{page:t}))}return s()(e,t),e}(l.a),h=function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"WebPages","Update",{page:t}))}return s()(e,t),e}(l.a),g=function(t){function e(t){return o()(this,e),c()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"WebPages","Delete",{id:t}))}return s()(e,t),e}(l.a),b=(n(296),n(449)),m=n(21);n.d(e,"a",function(){return v}),n.d(e,"e",function(){return O}),n.d(e,"b",function(){return y}),n.d(e,"d",function(){return j}),n.d(e,"c",function(){return w});var v=function(t){return i.a.send(new f(t),Object(m.f)())},O=function(t){return i.a.send(new h(t),Object(m.f)())},y=function(t){return i.a.send(new g(t),Object(m.f)())},j=function(t){return function(e){return e(Object(b.e)()),i.a.send(new p(t),Object(m.e)()).then(function(t){return e(Object(b.f)(t.record)),t}).catch(function(t){throw e(Object(b.d)(t)),t})}},w=function(t){return i.a.send(new d(t),function(t){return t})}},1595:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return c});var i=n(296),r=n(1591),o=n(87),a=function(t){return function(e,n){return e(Object(i.h)()),r.c(t).then(function(t){return e(Object(i.i)(t)),t}).catch(function(t){throw e(Object(i.g)(t)),t})}},c=function(t){return function(e){return e(Object(o.b)(function(t){return!t.webPages.descriptionsFetching&&t.webPages.descriptionsFetching},a(t)))}}},1596:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return c});var i=n(445),r=n(1548),o=n(87),a=function(t){return function(e,n){return e(Object(i.e)()),r.c(t).then(function(t){return e(Object(i.f)(t.list)),t.list}).catch(function(t){throw e(Object(i.d)(t)),t})}},c=function(t){return function(e){return e(Object(o.b)(function(t){return!t.internetDomains.fetching&&t.internetDomains.fetched},a(t)))}}},1930:function(t,e,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),c=n(7),u=n.n(c),s=n(8),l=n.n(s),p=n(11),d=n.n(p),f=n(2),h=n(14),g=n(95),b=n(13),m=n(26),v=n.n(m),O=n(32),y=n.n(O),j=n(34),w=n.n(j),_=n(30),P=n.n(_),k=n(24),E=n.n(k),I=n(1),C=n(0),D=n(1596),R=n(1483),W=n(620),x=n(83),A=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},T=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},S=function(t){function e(t){r()(this,e);var n=u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={htmlBodyParseError:!1},n}return l()(e,t),a()(e,[{key:"getPathValue",value:function(){var t=this;return"https://"+Object(C.headOption)(this.props.internetDomains.list.filter(function(e){return e.id.value===t.props.fields.domainId.value}).map(function(t){return t.entity.domain})).getOrElse(function(){return""})+(this.props.fields.path.value||"/")}},{key:"onPathChange",value:function(t){var e=new URL(t.target.value);this.props.fields.path.onChange(e.pathname)}},{key:"render",value:function(){var t=this,e=this.props.fields,n=e.name,i=e.path,r=e.domainId,o=e.appId,a=e.title,c=e.editorType,u=e.formId;return f.createElement("form",null,f.createElement(v.a,{fullWidth:!0,autoFocus:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Название"),error:n.touched&&n.error,helperText:n.touched&&Object(C.toOption)(n.error).map(function(t){return t}).getOrNull()}),f.createElement(y.a,{fullWidth:!0},f.createElement(w.a,null,this.props.i18n.t("Тип редактора")),f.createElement(P.a,{value:c.value,onChange:c.onChange},f.createElement(E.a,{value:I.WebPageEditorTypeSimple.$Type.value},this.props.i18n.t("Простой")),f.createElement(E.a,{value:I.WebPageEditorTypeAdvanced.$Type.value},this.props.i18n.t("Шаблонизатор")))),f.createElement(y.a,{fullWidth:!0},f.createElement(w.a,null,this.props.i18n.t("Домен")),f.createElement(P.a,{value:r.value,onChange:r.onChange},f.createElement("option",null),this.props.internetDomains.list.filter(function(t){return t.entity.target.tpe.value===I.DomainTargetWebPage.$Type.value}).map(function(t){return f.createElement("option",{value:t.id.value,key:t.id.value},t.entity.name)}))),r.value&&f.createElement(v.a,{fullWidth:!0,value:this.getPathValue(),onChange:this.onPathChange,label:this.props.i18n.t("Путь"),error:i.touched&&i.error,helperText:i.touched&&Object(C.toOption)(i.error).map(function(t){return t}).getOrNull()}),f.createElement(y.a,{fullWidth:!0},f.createElement(w.a,null,this.props.i18n.t("application|Приложение")),f.createElement(P.a,{value:o.value,onChange:o.onChange},f.createElement("option",null),this.props.applications.list.filter(function(t){return t.entity.appType.tpe.value===I.ApplicationTypeApiKeys.$Type.value}).map(function(t){return f.createElement("option",{value:t.id.value,key:t.id.value},t.entity.name)}))),f.createElement(y.a,{fullWidth:!0},f.createElement(w.a,null,this.props.i18n.t("Форма")),f.createElement(P.a,{value:u.value,native:!0,onChange:u.onChange},f.createElement("option",{value:""}),this.props.eventLines.list.map(function(e){return f.createElement("optgroup",{key:e.id.value,label:e.entity.name},t.props.forms.list.filter(function(t){return t.entity.eventLineId.value===e.id.value}).map(function(t){return f.createElement("option",{key:t.id.value,value:t.id.value},t.entity.name)}))}))),f.createElement(v.a,{fullWidth:!0,value:a.value,onChange:a.onChange,label:this.props.i18n.t("Заголовок"),error:a.touched&&a.error,helperText:a.touched&&Object(C.toOption)(a.error).map(function(t){return t}).getOrNull()}))}}]),e}(f.Component);S=A([b.autobind,T("design:paramtypes",[Object])],S),e.a=Object(h.connect)(function(t){return{i18n:t.i18n,internetDomains:t.internetDomains,applications:t.applications,forms:t.forms,eventLines:t.eventLines,organisation:t.organisation}},function(t){return{dispatch:t}},function(t,e,n){return Object.assign({},t,n)},{withRef:!0})(Object(g.reduxForm)({form:"newWebPageCreateForm",fields:["name","path","domainId","title","editorType","appId","formId"],validate:function(t,e){var n={};return t.name&&0!==t.name.trim().length||(n.name=e.i18n.t("Обязательное значение")),t.domainId&&0!==t.domainId.trim().length||(n.domainId=e.i18n.t("Обязательное значение")),t.path&&0!==t.path.trim().length||(n.path=e.i18n.t("Пожалуйста, добавьте путь страницы к домену")),n}})(Object(W.a)([function(t){t.organisation.organisationId.foreach(function(e){t.dispatch(Object(D.b)(e)),t.dispatch(Object(R.e)(e))})}])(Object(x.a)(S))))},1931:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(1),r=function(t){switch(t){case i.WebPageEditorTypeSimple.$Type.value:return new i.WebPageEditorTypeSimple;case i.WebPageEditorTypeAdvanced.$Type.value:return new i.WebPageEditorTypeAdvanced(Object(i.getDefaultEditorState)());default:throw"unknown web page editor type"}}},2747:function(t,e,n){"use strict";n.r(e);var i=n(6),r=n.n(i),o=n(10),a=n.n(o),c=n(7),u=n.n(c),s=n(8),l=n.n(s),p=n(11),d=n.n(p),f=n(2),h=n(13),g=n(14),b=n(627),m=n(1467),v=n(136),O=n(1461),y=n(1595),j=n(19),w=n.n(j),_=n(25),P=n.n(_),k=n(93),E=n.n(k),I=n(1),C=n(0),D=n(414),R=n.n(D),W=n(86),x=n.n(W),A=n(216),T=n(415),S=n(71),L=n(1930),M=n(1591),N=n(201),B=n(46),q=n(79),z=n(1931),F=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},U=function(t){function e(){return r()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return l()(e,t),a()(e,[{key:"onCreateRequested",value:function(){var t=this,e=void 0;this.props.openDialog(this.props.i18n.t("Создание веб-страницы"),f.createElement(L.a,{ref:function(t){return e=Object(C.toOption)(t).flatMap(function(t){return Object(C.toOption)(t.wrappedInstance)})},onSubmit:function(e){return function(e){var n="<html><head><title>"+e.title+"</title></head><body></body></html>";return new Promise(function(i,r){return t.props.organisation.data.map(function(o){Object(M.a)(new I.WebPage(o.id,e.name,e.path||"",n,new I.Id(e.domainId),Object(z.a)(e.editorType),I.Id.createId(e.appId),I.Id.createId(e.formId))).then(function(e){i(e),t.props.dispatch(Object(y.a)(o.id)),t.props.dispatch(Object(S.h)(t.props.i18n.t("Веб-страница успешно создана"))),t.props.handleDialogClose(!1)}).catch(function(t){r(t)})}).getOrElse(function(){r("Organisation has not been provided")})}).catch(function(e){return t.props.dispatch(Object(N.a)(e))})}(e)}}),[f.createElement(w.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return t.props.handleDialogClose(!1)}},this.props.i18n.t("Закрыть")),f.createElement(w.a,{variant:"raised",onClick:function(){return e.map(function(t){return t.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditClick",value:function(t){var e=this;this.props.dispatch(Object(M.d)(new I.Id(t.id.toString()))).then(function(t){e.onEditRequest(t.record)})}},{key:"onEditRequest",value:function(t){this.props.dispatch(Object(q.Pb)(t.id))}},{key:"onDeleteRequested",value:function(t){var e=this,n=new I.Id(t.id.toString());this.props.openDialog(this.props.i18n.t("Удаление веб-страницы"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить веб-страницу, это действие нельзя будет отменить?")),[f.createElement(w.a,{variant:"raised",onClick:function(){e.props.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Нет")),f.createElement(w.a,{variant:"raised",onClick:function(){Object(M.b)(n).then(function(t){e.props.dispatch(Object(y.a)(n)),e.props.handleDialogClose(!0),e.props.dispatch(Object(S.h)(e.props.i18n.t("Веб-страница успешно удалёна")))}).catch(function(t){e.props.dispatch(Object(N.a)(t))})},color:"primary"},this.props.i18n.t("Да"))])}},{key:"render",value:function(){var t=this;return f.createElement(E.a,{style:{display:"flex",flexDirection:"column",minHeight:"0",overflowY:"auto",flex:1,padding:15}},f.createElement(A.b,null,f.createElement(w.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(T.a,{showId:!1,error:this.props.webPages.descriptionsError,fetching:this.props.webPages.descriptionsFetching,onRecordSelected:this.onEditClick,empty:!this.props.webPages.descriptionsFetching&&0===this.props.webPages.descriptionsList.length,withActions:!0,headers:[{id:"webPageName",title:this.props.i18n.t("Название")},{id:"webPagePath",title:this.props.i18n.t("Путь")}],rows:this.props.webPages.descriptionsList.map(function(e,n){return{id:e.id.toString(),payload:e,fields:[e.name,e.path],buttons:[f.createElement(P.a,{key:"edit",style:B.f,onClick:function(n){n.stopPropagation(),t.onEditClick(e)}},f.createElement(x.a,{style:B.g})),f.createElement(P.a,{key:"delete",style:B.f,onClick:function(n){n.stopPropagation(),t.onDeleteRequested(e)}},f.createElement(R.a,{style:B.g}))]}})}))}}]),e}(f.Component);U=F([h.autobind],U);var $=Object(g.connect)(function(t){return{i18n:t.i18n,organisation:t.organisation,webPages:t.webPages}})(U),H=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},V=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},J=function(t){function e(t){return r()(this,e),u()(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,Object.assign(m.a.screenInitialState(),{})))}return l()(e,t),a()(e,[{key:"renderNavigation",value:function(){return f.createElement(b.a,null)}},{key:"render",value:function(){return this.renderScreenBody({className:"WebPage"},f.createElement($,{openDialog:this.openDialog,handleDialogClose:this.handleDialogClose}))}}]),e}(m.a);J=H([h.autobind,V("design:paramtypes",[Object])],J);e.default=Object(g.connect)(function(t){return{i18n:t.i18n,organisation:t.organisation}})(Object(O.a)(Object(v.a)(function(t){t.isTokenChecked&&t.dispatch(Object(y.b)(t.organisation.organisationId.getOrElse(function(){throw new Error("Unknown organisation")})))},function(){},function(t,e){t.isTokenChecked&&!e.isTokenChecked&&t.dispatch(Object(y.b)(t.organisation.organisationId.getOrElse(function(){throw new Error("Unknown organisation")})))})(J)))}}]);