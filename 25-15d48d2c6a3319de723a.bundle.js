(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[25,0],{1452:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(1),d=n(0),h=n(50),m=n(1456),g=n(173),y=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return e.display!==this.props.display||e.style!==this.props.style||!Object(d.isEqual)(e.blockStyle,this.props.blockStyle)||e.children!==this.props.children}},{key:"render",value:function(){var e=this.props.display,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.fonts}).getOrElse(function(){return new f.ElementFonts}),r=t.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),o=t.map(function(e){return e.enableStyles.map(function(e){return e.titleStyleChecked})}).flatMap(function(e){return e}),i=Object(m.c)(n.textFont,r,new d.None),a=Object(m.c)(n.titleFont,o,new d.None),l=e.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new f.ElementTitle}),u="FormRecordDisplay__row-title-"+l.position.toString(),c=this.props.blockStyle.flatMap(function(e){return e.fonts}).flatMap(function(e){return e.titleFont}).map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){}),s=this.props.blockStyle.flatMap(function(e){return e.fonts}).flatMap(function(e){return e.textFont}).map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){});return p.createElement("div",{className:u,key:e.id.value,style:this.props.style},l.show&&p.createElement("div",{className:"FormRecordDisplay__label-row "+Object(h.B)(this.props.display,"FormRecordDisplay__label-row")+"\n            "},p.createElement("div",{className:"FormRecordDisplay__label "+Object(h.B)(this.props.display,"FormRecordDisplay__label"),style:o.getOrElse(function(){return!1})?a:c},Object(g.c)(e.label.text))),p.createElement("div",{className:"FormRecordDisplay__input "+Object(h.B)(this.props.display,"FormRecordDisplay__input"),style:r.getOrElse(function(){return!1})?i:s},this.props.children))}}]),t}(p.Component);t.a=y},1453:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(1),d=n(1498),h=n(11),m=n.n(h),g=n(14),y=n(13),b=n(416),v=n.n(b),O=n(33),E=n.n(O),k=n(319),j=n.n(k),C=n(0),R=n(658),w=n(1535),I=(n(1551),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),S=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return s()(t,e),a()(t,[{key:"onChange",value:function(){var e=this;this.props.output.foreach(function(t){e.props.dispatch(Object(w.a)(t,e.props.blockRendererId,e.props.display.id))})}},{key:"render",value:function(){return p.createElement("div",{style:{display:"flex"}},p.createElement("div",{style:{flex:1}},this.props.children),p.createElement("div",{style:{flexShrink:0,margin:"5px"}},p.createElement(v.a,{name:"fetchType",onChange:this.onChange,value:this.props.mergingDataOutputBlockRendererId.getOrElse(function(){return""})},p.createElement(E.a,{control:p.createElement(j.a,null),label:"",value:this.props.blockRendererId}))))}}]),t}(p.Component);P=I([y.autobind,S("design:paramtypes",[Object])],P);var T=Object(g.connect)(function(e,t){return{mergingDataOutputBlockRendererId:t.output.flatMap(function(t){return Object(R.b)(e.duplicateMerging,t.formField)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.duplicateMerging.dataOutputMap===t.duplicateMerging.dataOutputMap},areStatePropsEqual:function(e,t){return Object(C.isEqual)(e.mergingDataOutputBlockRendererId,t.mergingDataOutputBlockRendererId)}})(P),x=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderMergingControl",value:function(){return p.createElement(T,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.display.dataOutput},this.renderDisplayControl())}},{key:"renderDisplayControlByBlockSchemaType",value:function(){switch(this.props.blockType.tpe.value){case f.WebRegistrationBlockTypeDisplay.$Type.value:return this.renderDisplayControl();case f.WebRegistrationBlockTypeEdit.$Type.value:return this.renderEditControl();case f.WebRegistrationBlockTypeMerging.$Type.value:return this.renderMergingControl();default:throw"Unknown block type"}}},{key:"renderEditConditional",value:function(){var e=this;return function(t){switch(t){case f.DisplayTypeByBlockSchemaType.$Type.value:return e.renderDisplayControlByBlockSchemaType();case f.DisplayTypeDisplay.$Type.value:return e.renderDisplayControl();case f.DisplayTypeEdit.$Type.value:return e.renderEditControl();case f.DisplayTypeEditByClick.$Type.value:return e.renderEditByClickControl();default:return e.renderDisplayControlByBlockSchemaType()}}(this.props.dispatch(Object(d.b)(this.props.display.conditionalValues,this.props.blockRendererId)))}},{key:"render",value:function(){switch(this.props.control.displayType.tpe.value){case f.DisplayTypeByBlockSchemaType.$Type.value:return this.renderDisplayControlByBlockSchemaType();case f.DisplayTypeDisplay.$Type.value:return this.renderDisplayControl();case f.DisplayTypeEdit.$Type.value:return this.renderEditControl();case f.DisplayTypeEditByClick.$Type.value:return this.renderEditByClickControl();case f.DisplayTypeConditional.$Type.value:return this.renderEditConditional();default:throw"Unknown element control display type"}}}]),t}(p.Component);t.a=x},1454:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(156),d=n.n(f),h=n(1),m=n(1456),g=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new h.ElementFonts}),t=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.errorStyleChecked})}).flatMap(function(e){return e}),n=Object(m.c)(e.errorFont,t,this.props.error),r=this.props.blockStyle.flatMap(function(e){return e.fonts}).flatMap(function(e){return e.errorFont}).map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment,textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){return{color:"red"}});return this.props.formHelper?this.props.error.map(function(e){return p.createElement(d.a,{style:t.getOrElse(function(){return!1})?n:r},e)}).getOrNull():this.props.error.map(function(e){return p.createElement("p",{style:t.getOrElse(function(){return!1})?n:r},e)}).getOrNull()}}]),t}(p.Component);t.a=g},1455:function(e,t,n){"use strict";var r,o=n(6),i=n.n(o),a=n(10),l=n.n(a),u=n(7),c=n.n(u),s=n(8),p=n.n(s),f=n(11),d=n.n(f),h=n(2),m=n(14),g=n(13),y=n(3),b=n(25),v=n.n(b),O=n(72),E=n.n(O),k=n(554),j=n.n(k),C=n(100),R=n(1),w=n(1508),I=(n(1553),n(375)),S=n.n(I),P=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},T=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e[e.Display=0]="Display",e[e.Edit=1]="Edit"}(r||(r={}));var x=function(e){function t(e){i()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={wrapperState:r.Display},n}return p()(t,e),l()(t,[{key:"onChange",value:function(e,t){this.props.dispatch(Object(C.L)({blockRendererId:this.props.blockRendererId,output:t,value:e,displayId:this.props.display.id})),this.isClickAwayAllowed()&&this.onDoneClick()}},{key:"onDoneClick",value:function(){var e=this;this.props.dispatch(Object(w.b)(this.props.display,this.props.blockRendererId)).foreach(function(t){t.then(function(t){e.wrapperStateToggle()})})}},{key:"isClickAwayAllowed",value:function(){return this.props.display.control.map(function(e){switch(e.tpe.value){case R.ElementControlSelect.$Type.value:return!0;default:return!1}}).getOrElse(function(){return!1})}},{key:"onCancelClick",value:function(){var e=this;this.wrapperStateToggle(function(){e.props.dispatch(Object(C.K)({blockRendererId:e.props.blockRendererId,output:e.props.output,displayId:e.props.display.id}))})}},{key:"onEditClick",value:function(){var e=this;this.setState(y(this.state,{wrapperState:{$set:this.state.wrapperState===r.Display?r.Edit:r.Display}}),function(){e.props.dispatch(Object(C.N)({blockRendererId:e.props.blockRendererId,output:e.props.output,displayId:e.props.display.id}))})}},{key:"wrapperStateToggle",value:function(e){this.setState(y(this.state,{wrapperState:{$set:this.state.wrapperState===r.Display?r.Edit:r.Display}}),e)}},{key:"renderEditModeControlButtons",value:function(){switch(this.props.display.control.map(function(e){return e.tpe.value}).getOrElse(function(){return R.ElementControlTextField.$Type.value})){case R.ElementControlSelect.$Type.value:return h.createElement(h.Fragment,null);default:return h.createElement(h.Fragment,null,h.createElement(v.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onDoneClick},h.createElement(j.a,null)),h.createElement(v.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onCancelClick},h.createElement(E.a,null)))}}},{key:"handleClickAway",value:function(){this.isClickAwayAllowed()&&this.onDoneClick()}},{key:"render",value:function(){return this.state.wrapperState===r.Display?h.createElement("div",{className:"ControlEditByClickWrapper__container",onClick:this.onEditClick},h.createElement("div",{className:"ControlEditByClickWrapper__cover"},this.props.displayComponent)):h.createElement("div",{style:{display:"flex",alignItems:"center"}},h.createElement("div",{style:{flex:1,alignSelf:"center"}},h.createElement(S.a,{onClickAway:this.handleClickAway},h.cloneElement(this.props.editComponent,{onChange:this.onChange}))),this.renderEditModeControlButtons())}}]),t}(h.Component);x=P([g.autobind,T("design:paramtypes",[Object])],x),t.a=Object(m.connect)(function(){return{}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)})(x)},1456:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u});var r=n(1),o=n(0),i=n(56),a=function(e,t,n){return t.getOrElse(function(){return!1})?e.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){return{}}):{}},l=function(e){return Object(i.a)(a(e,Object(o.toOption)(!0),new o.None))},u=function(e,t){var n=e.flatMap(function(e){return e.fonts}).getOrElse(function(){return new r.ElementFonts}).textFont,o=e.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1});return t.nonEmpty()?"red":o?n.map(function(e){return e.color}).getOrElse(function(){return"inherit"}):"inherit"}},1457:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return l});var r=n(1),o=function(e,t){switch((e.tpe.value===r.ElementThemeInherit.$Type.value?t:e).tpe.value){case r.ElementThemeMaterial.$Type.value:return"standard";case r.ElementThemeMaterialOutlined.$Type.value:return"outlined";case r.ElementThemeMaterialFilled.$Type.value:return"filled";default:return"standard"}},i=function(e,t){switch((e.tpe.value===r.ElementThemeInherit.$Type.value?t:e).tpe.value){case r.ElementThemeMaterial.$Type.value:return"contained";case r.ElementThemeMaterialOutlined.$Type.value:return"outlined";default:return"contained"}},a=function e(t,n){switch(t.tpe.value){case r.ElementThemeMaterial.$Type.value:case r.ElementThemeMaterialOutlined.$Type.value:case r.ElementThemeMaterialFilled.$Type.value:return!0;case r.ElementThemeInherit.$Type.value:return e(n,n);default:return!1}},l=function(e){return e.map(function(e){return e.elementTheme}).getOrElse(function(){return new r.ElementThemeMaterial})}},1458:function(e,t,n){"use strict";n.d(t,"d",function(){return O}),n.d(t,"i",function(){return E}),n.d(t,"g",function(){return k}),n.d(t,"f",function(){return j}),n.d(t,"e",function(){return C}),n.d(t,"j",function(){return R}),n.d(t,"b",function(){return w}),n.d(t,"h",function(){return I}),n.d(t,"a",function(){return S}),n.d(t,"c",function(){return P}),n.d(t,"k",function(){return T});var r=n(421),o=n(1),i=n(84),a=n(99),l=n(1533),u=n(323),c=n(264),s=n(1504),p=n(100),f=n(29),d=n(215),h=n(148),m=n(372),g=n(0),y=n(174),b=function(e,t){return Object(g.toOption)(t).flatMap(function(t){return Object(g.toOption)(t[e.value])}).map(function(e){return e.value})},v=function(e){return e.control.filter(function(e){return e.tpe.value===o.ElementControlCheckBoxes.$Type.value||e.tpe.value===o.ElementControlAdvancedCheckBoxes.$Type.value||e.tpe.value===o.ElementControlRadioBoxes.$Type.value||e.tpe.value===o.ElementControlSelect.$Type.value||e.tpe.value===o.ElementControlCalendar.$Type.value||e.tpe.value===o.ElementControlSelect.$Type.value}).map(function(e){return e.filter}).getOrElse(function(){return new g.None})},O=function(e,t,n,r,i){return function(a,l){r.dataOutput.flatMap(function(e){return Object(f.b)(l().fields,t,e.formField)}).foreach(function(u){x(r,u,l(),a).then(function(l){return a(Object(s.a)(new o.DataPageRequest(0,20,u.entity.valueType.family,new g.None),new o.ParentFormData(t,i,u.id),n,r.id,e))})})}},E=function(e,t,n){return function(r,i){r(Object(y.b)(t.parentsForm)).then(function(){r(Object(s.b)(new o.RelationsPagedListRequest(0,20,n,t.parentsForm,t.parentsField,new g.None,[],new g.None,new o.RelsTypeSearchParents),t,e))})}},k=function(e,t){return function(n,r){return e.dataInput.foreach(function(i){Object(f.b)(r().fields,t,i.formField).foreach(function(a){x(e,a,r(),n).then(function(u){return Object(c.d)(new o.DataPageRequest(0,20,a.entity.valueType.family,v(e))).then(function(o){n(Object(l.a)(e,i,t,a,o.page.records,o.page.total,r().i18n.t))}).catch(function(e){return console.error("Failed to resolve input data",e)})})})})}},j=function(e,t,n,r){return function(o,i){var a=v(n),u=Object(m.f)(i().blockRendererContext,e).flatMap(function(e){return Object(g.toOption)(e[t.entity.valueType.family.value])}),c=function(e){return o(Object(l.a)(n,r,t.entity.formId,t,e||[],e.length,i().i18n.t))};u.matchWith(function(e){return Object(g.toOption)(e)},function(){return Object(h.b)(i().dictionaries,t.entity.valueType.family)}).foreach(function(e){a.matchWith(function(t){c(e.filter(function(e){return t.check(function(t){return e.entity.getFormFieldValue(t).map(function(e){return e.value})})}))},function(){c(e)})})}},C=function(e,t,n){return function(r,i,a){t.dataInput.foreach(function(a){Object(f.b)(i().fields,n,a.formField).foreach(function(n){switch(n.entity.valueType.tpe.value){case o.ValueTypeBool.$Type.value:return r(Object(l.a)(t,a,n.entity.formId,n,[],0,i().i18n.t));case o.ValueTypeObjectRefs.$Type.value:return Object(g.headOption)(i().forms.list.filter(function(e){return e.id.value===n.entity.valueType.family.value})).foreach(function(i){o.FormType.isAnyDictionary(i.entity.formType)?r(j(e,n,t,a)):r(function(e,t,n,r){return function(i,a){return i(Object(c.b)(t.entity.valueType.family,b(t.id,Object(m.h)(a().blockRendererContext,e).getOrElse(function(){return{}})).filter(function(e){return e.tpe.value===o.ValueObjectRefs.$Type.value}).map(function(e){return e.id}).getOrElse(function(){return[]}),v(n))).then(function(e){i(Object(l.a)(n,r,t.entity.formId,t,e.list,e.list.length,a().i18n.t))}).catch(function(e){return console.error("Failed to resolve input data",e)})}}(e,n,t,a))})}})})}},R=function(e,t){return function(n,r){Object(m.d)(r().blockRendererContext,e).isEmpty()&&r().user.id.foreach(function(r){n(Object(p.G)({output:t,value:new o.ValueUserRefs([new o.EntityRef(r,o.User.$Type.value)]),blockRendererId:e}))})}},w=function(e,t,n){return function(r,i){b(t.formField,Object(m.h)(i().blockRendererContext,e).getOrElse(function(){return{}})).isEmpty()&&r(Object(p.G)({output:t,value:new o.ValueStr(n.color),blockRendererId:e}))}},I=function(e,t,n){return function(r,i){return Object(g.toOption)(t).filter(function(e){return!(e.control instanceof o.ElementControlColor||e.control instanceof o.ElementControlUsersField)}).flatMap(function(e){return e.dataOutput}).foreach(function(t){Object(f.b)(i().fields,n,t.formField).foreach(function(n){r(Object(p.G)({output:t,value:b(t.formField,Object(m.h)(i().blockRendererContext,e).getOrElse(function(){return{}})).matchWith(function(e){return e},function(){return n.entity.valueType.getDefaultValue()}),blockRendererId:e}))})})}},S=function(e,t){return function(n,r){return t.dataOutput.foreach(function(o){!t.displayRule.map(function(t){return t.isVisible(function(t){return Object(d.e)(r().dataOutput,e,t).matchWith(function(e){return Object(g.toOption)(e.value)},function(){return Object(m.g)(r().blockRendererContext,e,t)})})}).getOrElse(function(){return!0})&&n(Object(p.E)({blockRendererId:e,output:o,displayId:t.id}))})}},P=function(e,t){return function(n,r){Object(m.d)(r().blockRendererContext,e).foreach(function(e){t.dataOutput.foreach(function(t){n(Object(a.g)(e.entity.formId,e.id,t.formField))})})}},T=function(e,t,n){return function(n,r){return r().currentFormRecord.data.matchWith(function(n){return Object(u.i)(e,t.eventId,n.id,t.linkEnabled?t.linkedField:new g.None)},function(){throw"FormData Id hasn't been provided"})}},x=function(e,t,n,a){var l=Object(r.a)(e.control.map(function(e){return e.displayFields}).getOrElse(function(){return[]}).concat(e.control.map(function(e){return e.displayFieldsForAdding}).getOrElse(function(){return[]})).filter(function(e){return e.tpe.value===o.DisplayFieldByField.$Type.value}).map(function(e){return e.objRefDisplayFieldId.nonEmpty()?Object(f.b)(n.fields,t.entity.valueType.family,e.fieldId).map(function(e){return e.entity.valueType.family.value}).getOrElse(function(){return""}):""}),function(e){return e}).filter(function(e){return""!==e});return Promise.all(l.map(function(e){return a(Object(c.c)(new o.Id(e),new g.None)).then(function(t){return a(Object(i.c)(new o.Id(e)))})}))}},1459:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return l});var r=n(79),o=n(104),i=n(82),a=function(){return function(e,t){return e(i.default.isA5000?Object(r.Mb)():Object(r.h)())}},l=function(e,t){return function(n,i){return i().eventLine.data.foreach(function(a){Object(o.e)(i().forms,e).foreach(function(o){n(Object(r.H)(a.id,o.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(14),d=n(1469),h=n(1459),m=n(320),g=n(69),y=n(0),b=n(624);t.a=function(e){return Object(f.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return o()(this,n),u()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s()(n,t),a()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(y.toOption)(this.props.routing.location).map(function(t){Object(y.liftKey)(Object(b.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(d.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(d.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(d.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(g.r)()),this.props.dispatch(Object(m.c)()),this.props.dispatch(Object(h.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?p.createElement(e,this.props):p.createElement("div",null)}}]),n}(p.Component)}(e))}},1466:function(e,t,n){"use strict";var r=n(4),o=n.n(r),i=n(5),a=Object(i.createAction)("Registration.Begin"),l=Object(i.createAction)("Registration.Complete"),u=Object(i.createAction)("Registration.Failed"),c=n(17),s=n(210),p=n(142),f=n(1471),d=n(634),h=n(143),m=n(1807),g=n(1),y=n(111),b=n(0),v=n(21),O=n(100),E=n(222),k=n(147),j=n(323),C=n(29),R=n(215),w=n(372),I=n(3);n.d(t,"b",function(){return P}),n.d(t,"i",function(){return T}),n.d(t,"f",function(){return x}),n.d(t,"e",function(){return _}),n.d(t,"g",function(){return D}),n.d(t,"h",function(){return F}),n.d(t,"a",function(){return M}),n.d(t,"c",function(){return B}),n.d(t,"d",function(){return L});var S=function(e,t,n){return Object(b.headOption)(Object(C.e)(n().fields,t).map(function(t){return t.filter(function(t){return t.id.value===e.formField.value})}).getOrElse(function(){return[]})).flatMap(function(e){return Object(b.toOption)(e.entity.valueType.getDefaultValue())})},P=function(e,t){return function(n,r){return Object(R.f)(r().dataOutput,t).getOrElse(function(){return[]}).filter(function(e){var t=e.value;return!!t&&t.tpe!==g.ValueGenerated.$Type}).map(function(t){return S(t.output,e,r).filter(function(e){return Object(p.a)(e,t.value)}).nonEmpty()?function(e){return I(e,{value:{$set:new g.ValueEmpty}})}(t):t})}},T=function(e,t,n){return c.a.send(new s.d(e,t,n),Object(v.i)())},x=function(e,t,n,r,o){return function(n,i){n(a());var f=Object(R.f)(i().dataOutput,r).getOrElse(function(){return[]}).filter(function(e){var t=e.value;return!!t&&t.tpe!==g.ValueGenerated.$Type}).map(function(e){return S(e.output,t,i).filter(function(t){return Object(p.a)(t,e.value)}).nonEmpty()?function(e){return I(e,{value:{$set:new g.ValueEmpty}})}(e):e});return c.a.send(new s.d(e,[o],f),Object(v.i)()).then(function(e){return Object(b.headOption)(e.updated).matchWith(function(e){return n(l(e)),e},function(){throw"empty result"})}).catch(function(e){throw n(u(e)),e})}},_=function(e,t,n,r,o){return function(n,i){n(a());var f=Object(R.f)(i().dataOutput,r).getOrElse(function(){return[]}).filter(function(e){return!!e.value&&e.value.tpe.value!==g.ValueGenerated.$Type.value}).filter(function(e){return S(e.output,t,i).filter(function(t){return!Object(p.a)(t,e.value)}).nonEmpty()}).filter(function(e){return e.value.tpe.value!==g.ValueEmpty.$Type.value});return c.a.send(new s.d(e,o,f),Object(v.f)()).then(function(e){return n(l(e.id)),e}).catch(function(e){throw n(u(e)),e})}},D=function(e,t,n){return function(r,i){return new Promise(function(a,l){var u=i();Object(b.liftKey)(u.block.record,e.value).flatMap(function(e){return e}).foreach(function(e){var c=function(e){return Object(R.j)(i().dataOutput,t,e).matchWith(function(e){return Object(b.toOption)(e.value)},function(){return Object(R.e)(i().dataOutput,t,e).matchWith(function(e){return Object(b.toOption)(e.value)},function(){return Object(w.g)(i().blockRendererContext,t,e)})})},s=n.matchWith(function(t){return Object(E.i)(e.entity.display,c).filter(function(e){return e.id.value===t.value})},function(){return Object(E.i)(e.entity.display,c)}),p=Object(E.g)(e.entity.display);Object(b.toOption)(p).filter(function(e){return e.length>0}).foreach(function(e){return e.map(function(e){return e.validationRules.map(function(n){Object(R.p)(u.dataOutput,t,e.id)||(r(Object(O.F)({blockRendererId:t,displayId:e.id,error:n.message})),l())})})});var f=Object(d.default)(s.map(function(e){return e.validationRules.map(function(e){return e.validate(c)}).map(function(t){return t.map(function(t){return new y.b(e,t)})})})).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),h=f.reduce(function(e,t){if(e.hasOwnProperty(t.display.id.value)){var n=Object(b.liftKey)(e,t.display.id.value).getOrElse(function(){return""});return Object.assign({},e,o()({},t.display.id.value,n+"; "+t.message))}return Object.assign({},e,o()({},t.display.id.value,t.message))},{});Object.keys(h).map(function(e){return n.matchWith(function(n){if(n.value===new g.DisplayElementId(e).value)return r(Object(O.F)({blockRendererId:t,displayId:new g.DisplayElementId(e),error:Object(b.liftKey)(h,e).getOrElse(function(){return""})}))},function(){return r(Object(O.F)({blockRendererId:t,displayId:new g.DisplayElementId(e),error:Object(b.liftKey)(h,e).getOrElse(function(){return""})}))})}),0===f.length?a():l(new y.c(f)),r(function(e,t){return function(n,r){var o=r().blockRendererContext,i=Object(E.b)(e.entity.display),a=Object.keys(o);return i.map(function(e){var r=Object(b.headOption)(a.filter(function(t){return Object(b.liftKey)(o,t).map(function(t){return t.blockId.value===e.blockId.value}).getOrElse(function(){return!1})})).getOrElse(function(){return t});return n(D(e.blockId,r,new b.None))})}}(e,t))})})}},F=function(e,t,n,r){return function(o,i){return new Promise(function(a,l){var u=i();Object(b.liftKey)(u.block.record,e.value).flatMap(function(e){return e}).foreach(function(e){var u=function(e){return Object(R.e)(i().dataOutput,t,e).matchWith(function(e){return Object(b.toOption)(e.value)},function(){return Object(w.g)(i().blockRendererContext,t,e)})},c=Object(E.i)(e.entity.display,u);Object(b.headOption)(c.filter(function(e){return n.children[r].children.filter(function(t){return t.id.value===e.id.value}).length>0}).map(function(e){return Object(b.headOption)(e.validationRules.map(function(e){return e.validate(u)}).filter(function(e){return e.nonEmpty()})).flatMap(function(n){return n.map(function(n){return o(Object(O.F)({blockRendererId:t,displayId:e.id,error:n}))})})}).filter(function(e){return e.nonEmpty()})).map(function(){return l("validation error")}).getOrElse(function(){return a()})}),a()})}},M=function(e,t,n){return function(r,o){return new Promise(function(i,a){var l=o();Object(b.liftKey)(l.block.record,e.value).flatMap(function(e){return e}).foreach(function(e){var o=e.entity.duplicateCheckValues;if(o.isEmpty())return i();var u=Object(E.d)(e.entity.display),c=Object(E.c)(e.entity.display),s=Object(E.i)(e.entity.display,function(e){return Object(E.k)(u,t,e,l.dataOutput)}),p=o.map(function(e){return e.filter.predicate}).getOrElse(function(){return new g.FilterPredicateAnd}),f=o.map(function(e){return e.count}).getOrElse(function(){return 0}),d=o.map(function(e){return e.filter.conditions.map(function(e){return e.field.value})}).getOrElse(function(){return[]});Object(b.headOption)(Object(b.liftKey)(l.blockRendererContext,t).map(function(e){return s.map(function(e){return e.dataOutput.map(function(e){return Object(R.d)(l.dataOutput,t,e)}).flatMap(function(e){return e})}).filter(function(e){return e.map(function(e){return Object(h.a)(d,e.output.formField.value)}).getOrElse(function(){return!1})}).map(function(t){return t.map(function(t){return t.value.toString()===e.initialValues.flatMap(function(e){return Object(b.liftKey)(e,t.output.formField.value).map(function(e){return e.value.toString()})}).getOrElse(function(){return""})}).getOrElse(function(){return!1})})}).getOrElse(function(){return[]})).getOrElse(function(){return!1})&&i();var v=s.map(function(e){return e.dataOutput.map(function(e){return Object(R.d)(l.dataOutput,t,e)}).flatMap(function(e){return e})}).filter(function(e){return e.map(function(e){return Object(h.a)(d,e.output.formField.value)}).getOrElse(function(){return!1})}).map(function(e){return Object(m.a)(e,function(e){return[e.output.formField,e.value]})}).map(function(e){return new g.FilterCondition(e[0],new g.FilterExpressionEq,e[1])});0===v.length&&i(),Object(k.e)(n,Object(b.toOption)(new g.FilterGroupCondition(v,p))).then(function(e){var n=Object(b.headOption)(c).map(function(e){return e.errorTypes.map(function(e){return e.duplicateError.map(function(e){return e.enabled})})}).flatMap(function(e){return e}).flatMap(function(e){return e}).getOrElse(function(){return!1});e.value>=f&&(n&&r(Object(O.x)({blockRendererId:t,displayErrorElement:!0})),a(new y.d)),i()})})})}},W=function(e,t){return function(n,r){return Object(R.f)(r().dataOutput,t).getOrElse(function(){return[]}).filter(function(e){return!!e.value&&e.value.tpe.value!==g.ValueGenerated.$Type.value}).filter(function(t){return S(t.output,e,r).filter(function(e){return!Object(p.a)(e,t.value)}).nonEmpty()}).map(function(e){return e.value instanceof g.ValueStr?I(e,{value:{$set:new g.ValueStr(Object(f.a)(e.value.toString()))}}):e}).filter(function(e){return e.value.tpe.value!==g.ValueEmpty.$Type.value})}},B=function(e,t,n){return function(r,o){r(a());var i=o(),p=Object(b.liftKey)(i.block.record,e.value).getOrElse(function(){return new b.None}),f=Object(E.j)(p.map(function(e){return e.entity.display}).getOrElse(function(){return[]})).filter(function(e){return e instanceof g.EmbeddedBlockElement});return Promise.all(f.map(function(e){return Object(R.l)(o().dataOutput,n,e.id).map(function(t){return Promise.all(t.map(function(t){return r(D(e.blockId,t,new b.None))}))}).getOrElse(function(){return new Promise(function(e,t){return t()})})})).then(function(){var i=new g.BlockValues(e,r(W(t,n))),a=f.map(function(e){return Object(R.l)(o().dataOutput,n,e.id).map(function(t){return t.map(function(t){return new g.BlockValues(e.blockId,r(W(e.formId,t)))})})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]);return c.a.send(new s.g([i].concat(a)),function(e){return new v.b(e)}).then(function(e){return Object(b.headOption)(e.updated).matchWith(function(e){return new v.a(e)},function(){throw new Error})}).then(function(e){return r(l(e.id)),e})}).catch(function(e){throw r(u(e)),e})}},L=function(e,t,n,r,o,i){return function(i,l){i(a());var u=function(e,t,n,r){var o=r();Object(b.liftKey)(o.block.record,e.value).getOrElse(function(){return new b.None});return Object(R.f)(r().dataOutput,n).getOrElse(function(){return[]}).filter(function(e){return!!e.value&&e.value.tpe.value!==g.ValueGenerated.$Type.value}).filter(function(e){return S(e.output,t,r).filter(function(t){return!Object(p.a)(t,e.value)}).nonEmpty()}).filter(function(e){return e.value.tpe.value!==g.ValueEmpty.$Type.value})}(e,r,o,l);return Object(j.h)(e,u,t,n,r)}}},1467:function(e,t,n){"use strict";var r=n(10),o=n.n(r),i=n(7),a=n.n(i),l=n(8),u=n.n(l),c=n(6),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=(n(1601),function(e){function t(){return s()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.navigation,r=e.styles,o=e.className;return d.createElement("div",{ref:"content",className:"FullScreen"+(o?" "+o:""),style:r},d.createElement("div",{className:"FullScreen__top"},n),d.createElement("div",{className:"FullScreen__content"},t))}}]),t}(d.Component)),m=n(1474),g=n.n(m),y=n(190),b=n.n(y),v=n(24),O=n.n(v),E=n(863),k=n.n(E),j=n(13),C=n(0),R=(n(1603),n(3)),w=n(71),I=n(1592),S=n(14),P=n(325),T=n.n(P),x=n(19),_=n.n(x),D=n(386),F=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},M=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},W=function(e){function t(e){s()(this,t);var n=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={remainingReconnectionTime:new C.None,intervalId:new C.None},n}return u()(t,e),o()(t,[{key:"updateRemainingReconnectionTime",value:function(e){this.setState(R(this.state,{remainingReconnectionTime:{$set:this.getRemainingReconnectionTime(e)}}))}},{key:"startInterval",value:function(e){var t=this,n=setInterval(function(){t.updateRemainingReconnectionTime(e)},1e3);this.setState(R(this.state,{remainingReconnectionTime:{$set:this.getRemainingReconnectionTime(e)},intervalId:{$set:Object(C.toOption)(n)}}))}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=this;this.state.intervalId.foreach(function(t){clearInterval(t),e.setState(R(e.state,{remainingReconnectionTime:{$set:new C.None},intervalId:{$set:new C.None}}))})})},{key:"componentDidMount",value:function(){this.props.websocket.lastReconnectingTime.nonEmpty()&&this.startInterval(this.props),this.props.websocket.lastReconnectingTime.isEmpty()&&this.clearInterval()}},{key:"componentWillReceiveProps",value:function(e){this.props.websocket.lastReconnectingTime.isEmpty()&&e.websocket.lastReconnectingTime.nonEmpty()&&this.startInterval(e),this.props.websocket.lastReconnectingTime.nonEmpty()&&e.websocket.lastReconnectingTime.isEmpty()&&this.clearInterval()}},{key:"getRemainingReconnectionTime",value:function(e){return e.websocket.lastReconnectingTime.flatMap(function(t){return e.websocket.reconnectionTimeout.map(function(e){return(e-((new Date).getTime()-t))/1e3})})}},{key:"render",value:function(){var e=this;return d.createElement("div",null,this.props.websocket.reconnecting||this.state.remainingReconnectionTime.filter(function(e){return e<0}).nonEmpty()?this.props.i18n.t("Связь с сервером потеряна, идет восстановление соединения..."):this.props.i18n.t("Связь с сервером потеряна, до следующей попытки соединения")+this.state.remainingReconnectionTime.map(function(t){return" "+Math.round(t)+" "+e.props.i18n.t("сек.")}).getOrElse(function(){return""}))}}]),t}(d.Component);W=F([j.autobind,M("design:paramtypes",[Object])],W);var B=Object(S.connect)(function(e){return{websocket:e.websocket,i18n:e.i18n}})(W),L=function(e){function t(){return s()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"hideNotification",value:function(){this.props.dispatch(Object(w.f)())}},{key:"handleReconnect",value:function(){D.a.reconnect()}},{key:"render",value:function(){return d.createElement("div",null,d.createElement(T.a,{open:!this.props.active&&(this.props.websocketError.nonEmpty()||this.props.closed)&&!this.props.screenSnackbaropen,message:d.createElement(B,null),autoHideDuration:0,action:this.props.reconnecting?[]:[d.createElement(_.a,{key:"undo",color:"secondary",size:"small",onClick:this.handleReconnect},this.props.i18n.t("Подключиться"))]}))}}]),t}(d.Component);L=F([j.autobind],L);var A=Object(S.connect)(function(e){return{active:e.websocket.active,closed:e.websocket.closed,websocketError:e.websocket.error,reconnecting:e.websocket.reconnecting,screenSnackbaropen:e.screen.snackbar.open,i18n:e.i18n}})(L),$=n(1473),V=n.n($),q=n(241),N=n.n(q),z=n(243),H=n.n(z),U=n(242),K=n.n(U),G=n(261),Y=n.n(G),J=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Q=function(e){function t(){return s()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"handleDialogClose",value:function(e){this.props.dispatch(Object(w.e)(e))}},{key:"render",value:function(){var e=this;this.props.screen.dialog;return d.createElement(N.a,{fullScreen:this.props.fullScreen,fullWidth:!0,maxWidth:"md",open:this.props.screen.dialog.open,onClose:function(){return e.handleDialogClose(!1)},className:"Screen__dialog"},d.createElement(Y.a,{style:{borderBottom:"none"}},this.props.screen.dialog.title.getOrElse(function(){return""})),d.createElement(K.a,null,this.props.screen.dialog.body.getOrElse(function(){return d.createElement("div",null)})),d.createElement(H.a,{style:{borderTop:"none"}},this.props.screen.dialog.actions))}}]),t}(d.Component);Q=J([j.autobind],Q);var X=Object(S.connect)(function(e){return{screen:e.screen}})(V()()(Q)),Z=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ee=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},te=function e(t,n){s()(this,e),this.disabled=!1,this.disabled=n,this.label=t},ne=(function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s()(this,t);var o=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return o.actionType=-1,o.actionType=n,o}u()(t,e)}(te),function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s()(this,t);var o=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return o.execute=function(){},o.execute=n,o}u()(t,e)}(te),function(e){function t(e,n){s()(this,t);var r=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state=n,r}return u()(t,e),o()(t,[{key:"handleDialogClose",value:function(e){this.props.dispatch(Object(w.e)(e))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4];this.props.dispatch(Object(w.g)({title:new C.Some(e),body:new C.Some(t),actions:n,onlyManualClose:r,options:o||new C.None}))}},{key:"scrollBottom",value:function(){window.document.body.scrollTop=window.document.body.scrollHeight}},{key:"scrollTop",value:function(){window.document.body.scrollTop=0}},{key:"renderNavigation",value:function(){throw"renderNavigation() should be defined in Screen implementation"}},{key:"closePopover",value:function(){this.setState(R(this.state,{popover:{$set:R(this.state.popover,{open:{$set:!1}})}}))}},{key:"openPopover",value:function(e,t){this.setState(R(this.state,{popover:{$set:{open:!0,actions:t,anchorElement:e}}}))}},{key:"onPopoverAction",value:function(e){this.closePopover(),e.execute()}},{key:"renderPopover",value:function(){var e=this;return this.state.popover.anchorElement.map(function(t){return d.createElement(b.a,{open:e.state.popover.open,anchorEl:t,anchorOrigin:{horizontal:"left",vertical:"bottom"},transformOrigin:{horizontal:"left",vertical:"top"},onClose:e.closePopover},d.createElement(k.a,null,e.state.popover.actions))})}},{key:"renderDrawer",value:function(){var e=this;return d.createElement(g.a,{open:this.state.drawer.open,onClose:function(t){return e.setState(R(e.state,{drawer:{open:{$set:t}}}))}},this.state.drawer.actions.map(function(e){return d.createElement(O.a,{onClick:e.execute},e.label)}))}},{key:"renderScreenBody",value:function(e,t){return d.createElement(h,Object.assign({},e,{navigation:d.createElement("div",null)}),d.createElement("div",{className:"Screen__container"},d.createElement(X,null),this.renderPopover().getOrNull(),t,d.createElement(I.a,null),d.createElement(A,null)))}}],[{key:"screenInitialState",value:function(){return{popover:{anchorElement:new C.None,open:!1,actions:[]},drawer:{open:!1,actions:[]}}}}]),t}(d.PureComponent));ne=Z([j.autobind,ee("design:paramtypes",[Object,Object])],ne);t.a=ne},1468:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(1),g=(n(1555),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),y=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getRootStyle",value:function(){return{display:this.props.titlePosition instanceof m.ElementPlacementLeft?"flex":"block"}}},{key:"getLabelContainerStyle",value:function(){return this.props.titlePosition instanceof m.ElementPlacementLeft?{flex:0,paddingRight:"5px",flexShrink:0}:{}}},{key:"getInputContainerStyle",value:function(){return this.props.titlePosition instanceof m.ElementPlacementLeft?{flex:1,paddingLeft:"5px"}:{}}},{key:"render",value:function(){return d.createElement("div",{className:"form-group",style:this.getRootStyle()},d.createElement("div",{style:this.getLabelContainerStyle()},d.createElement("label",null,this.props.label)),d.createElement("div",{style:this.getInputContainerStyle()},d.createElement("div",null,d.createElement("input",{type:this.props.type||"text",className:"form-control",style:this.props.error?{borderColor:"#dc3545"}:this.props.style,placeholder:this.props.placeholder||"",value:this.props.value,onChange:this.props.onChange})),d.createElement("div",{style:this.props.error?{color:"#dc3545"}:{display:"none"}},this.props.error)))}}]),t}(d.Component);y=g([h.autobind],y),t.a=y},1469:function(e,t,n){"use strict";var r=n(17),o=n(1),i=n(6),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(18),f=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","GetOrganisationInfo",{}))}return s()(t,e),t}(p.a),d=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","Check",{token:e}))}return s()(t,e),t}(p.a),h=(function(e){function t(e,n){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AppLogin",{apiKey:e,captcha:n}))}s()(t,e)}(p.a),function(e){function t(e,n){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","HashLinkLogin",{hash:e,captcha:n}))}s()(t,e)}(p.a),function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","TwoFactorVerificationCode",{code:e}))}return s()(t,e),t}(p.a)),m=function(e){function t(e,n,r,o,i){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","UserLogin",{username:e,password:n,terminal:r,organisationId:o,captcha:i}))}return s()(t,e),t}(p.a),g=function(e){function t(e,n,r,o){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AccountRegister",{name:e,email:n,password:r,captcha:o}))}return s()(t,e),t}(p.a),y=function(e){function t(e,n,r){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AccountLogin",{email:e,password:n,captcha:r}))}return s()(t,e),t}(p.a),b=function(e){function t(e,n,r){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","EnrichedAccountLogin",{email:e,password:n,captcha:r}))}return s()(t,e),t}(p.a),v=n(257),O=n(69),E=n(79),k=n(547),j=(n(320),n(0),n(201),n(1511));n(111);n.d(t,"d",function(){return R}),n.d(t,"g",function(){return w}),n.d(t,"h",function(){return I}),n.d(t,"b",function(){return S}),n.d(t,"a",function(){return P}),n.d(t,"e",function(){return T}),n.d(t,"c",function(){return x}),n.d(t,"f",function(){return _});var C=function(e,t){switch(e.tpe.value){case o.UserInfo.$Type.value:t(Object(O.v)(e));break;case o.AccountInfo.$Type.value:t(Object(k.a)()).then(function(){t(Object(O.m)(e))});break;case o.AppInfo.$Type.value:t(Object(O.o)(e)),t(Object(j.b)(e));break;case o.TwoFactorCodeRequired.$Type.value:t(Object(O.t)()),t(Object(E.Lb)())}},R=function(e){return function(t){return new Promise(function(n,o){e||o(),t(Object(O.p)()),r.a.send(new d(e),function(e){return e}).then(function(e){C(e,t),n(e)}).catch(function(e){o(e)})})}},w=function(e){return function(t){return new Promise(function(n,o){e||o(),t(Object(O.p)()),r.a.send(new h(e),function(e){return e}).then(function(e){C(e,t),n(e)}).catch(function(e){o(e)})})}},I=function(e,t,n,o,i){return function(a){return a(Object(O.s)()),r.a.send(new m(e,t,n,o,i),function(e){return e}).then(function(e){return a(Object(O.u)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},S=function(e,t,n,o){return function(i){return i(Object(O.s)()),r.a.send(new g(e,t,n,o),function(e){return e}).then(function(e){return i(Object(O.l)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},P=function(e,t,n){return function(i){return i(Object(O.s)()),r.a.send(new y(e,t,n),function(e){return e}).then(function(e){return function(e,t){switch(e.tpe.value){case o.AccountInfo.$Type.value:t(Object(k.a)()).then(function(){t(Object(O.m)(e))});break;case o.TwoFactorCodeRequired.$Type.value:t(Object(O.t)()),t(Object(E.Lb)())}}(e,i),e}).catch(function(e){throw console.error(e.message,e),e})}},T=function(e,t,n){return function(o){return o(Object(O.s)()),r.a.send(new b(e,t,n),function(e){return e}).then(function(e){return o(Object(O.l)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},x=function(e,t){return function(n){return r.a.send(new v.b(e,t),function(e){return e}).then(function(e){return n(Object(O.u)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},_=function(){return r.a.send(new f,function(e){return e})}},1470:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l});var r=n(623),o=n(109),i=function(e){return function(t,n){return n().auth.token.foreach(function(t){Object(r.b)(e,t,n().config.cdnAddress)})}},a=function(e){return function(t,n){return Object(o.a)(n().auth,e,n().config.cdnAddress)}},l=function(e){return function(t){return e.settings.ui.defaultImg.map(function(e){return t(a(e)).getOrElse(function(){return n(622)})})}}},1475:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return f});var r=n(106),o=n(62),i=n.n(o),a=n(50),l=n(0),u=function(e){var t=Object(r.q)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+o)},c=function(e){var t=Object(r.h)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+o)},s=function(e){var t=Object(r.d)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+o)},p=function(e){var t=Object(r.f)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+o)},f=function(e){return"\n    "+Object(r.l)(e).map(function(e){return e?"inset":""}).getOrElse(function(){return""})+" \n    "+Object(r.k)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.n)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.i)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.m)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.j)(e).getOrElse(function(){return i.a[600]})+"\n"}},1477:function(e,t,n){"use strict";var r=n(17),o=n(21),i=n(6),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(18),f=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Create",{document:e}))}return s()(t,e),t}(p.a),d=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Update",{document:e}))}return s()(t,e),t}(p.a),h=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Delete",{id:e}))}return s()(t,e),t}(p.a),m=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","List",{form:e}))}return s()(t,e),t}(p.a),g=function(e){function t(e,n){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListFormData",{formId:e,formDataId:n}))}return s()(t,e),t}(p.a),y=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListIds",{ids:e}))}return s()(t,e),t}(p.a),b=n(193);n.d(t,"c",function(){return v}),n.d(t,"d",function(){return O}),n.d(t,"e",function(){return E}),n.d(t,"f",function(){return k}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return C});var v=function(e){return function(t){return t(Object(b.q)(e)),r.a.send(new m(e),Object(o.g)()).then(function(n){return t(Object(b.r)({formId:e,documents:n.list})),n}).catch(function(n){throw t(Object(b.p)({formId:e,error:n})),n})}},O=function(e){return function(t){return t(Object(b.k)()),r.a.send(new y(e),Object(o.g)()).then(function(e){return t(Object(b.l)(e.list)),e}).catch(function(e){throw t(Object(b.j)(e)),e})}},E=function(e,t){return function(n){return n(Object(b.n)(t)),r.a.send(new g(e,t),Object(o.g)()).then(function(e){return n(Object(b.o)({formDataId:t,documents:e.list})),e}).catch(function(e){throw n(Object(b.m)({formDataId:t,error:e})),e})}},k=function(e){return r.a.send(new d(e),Object(o.f)())},j=function(e){return r.a.send(new f(e),Object(o.f)())},C=function(e){return r.a.send(new h(e),Object(o.f)())}},1478:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(218),d=n.n(f),h=n(25),m=n.n(h),g=n(1476),y=n.n(g),b=(n(1481),n(52)),v=n.n(b),O=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return p.createElement(d.a,{className:"PageHeader__main"},this.props.onGoBackRequested?p.createElement(m.a,{onClick:this.props.onGoBackRequested,style:{flexShrink:0}},p.createElement(y.a,null)):p.createElement("div",{style:{display:"inline-block"}}),p.createElement(v.a,{variant:"title",align:"center",style:{flex:1}},this.props.title),p.createElement("div",{style:{flexShrink:0}},this.props.rightButtonGroup))}}]),t}(p.Component);t.a=O},1479:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(52),d=n.n(f),h=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return p.createElement(d.a,{component:"div",style:Object.assign({overflowY:"auto"},this.props.style)},this.props.children)}}]),t}(p.PureComponent);t.a=h},1480:function(e,t,n){e.exports=n(97)(3)},1481:function(e,t,n){var r=n(1482);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1482:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".PageHeader__main {\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  margin-bottom: 10px;\n  background-color: #fff !important;\n  height: 48px !important;\n  width: 100% !important;\n  flex-shrink: 0;\n  padding: 0; }\n",""])},1483:function(e,t,n){"use strict";var r=n(17),o=n(21),i=n(6),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(18),f=function(e){function t(e,n,r,o,i,l){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Create",{name:e,organisationId:n,roleId:r,eventLineId:o,appType:i,active:l}))}return s()(t,e),t}(p.a),d=function(e){function t(e,n,r,o,i){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Update",{id:e,name:n,roleId:r,appType:o,active:i}))}return s()(t,e),t}(p.a),h=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Delete",{appId:e}))}return s()(t,e),t}(p.a),m=(function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Request",{appId:e}))}s()(t,e)}(p.a),function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListEventLine",{eventLineId:e}))}return s()(t,e),t}(p.a)),g=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListOrganisation",{organisationId:e}))}return s()(t,e),t}(p.a),y=function(e){function t(e,n){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","EnrichContext",{loginValues:e,formId:n}))}return s()(t,e),t}(p.a),b=n(427),v=n(5);Object(v.createAction)("Application.Fetching"),Object(v.createAction)("Application.Resolve"),Object(v.createAction)("Application.Error"),Object(v.createAction)("Auth.SetBlockId",function(e){return e});n.d(t,"d",function(){return O}),n.d(t,"e",function(){return E}),n.d(t,"f",function(){return k}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return C}),n.d(t,"c",function(){return R});var O=function(e){return function(t){return t(Object(b.e)()),r.a.send(new m(e),Object(o.g)()).then(function(e){return t(Object(b.f)(e.list)),e}).catch(function(e){throw t(Object(b.d)(e)),e})}},E=function(e){return function(t){return t(Object(b.e)()),r.a.send(new g(e),Object(o.g)()).then(function(e){return t(Object(b.f)(e.list)),e}).catch(function(e){throw t(Object(b.d)(e)),e})}},k=function(e,t,n,i,a){return r.a.send(new d(e,t,n,i,a),Object(o.f)())},j=function(e,t,n,i,a,l){return r.a.send(new f(e,t,n,i,a,l),Object(o.f)())},C=function(e){return r.a.send(new h(e),Object(o.f)())},R=function(e,t){return r.a.send(new y(e,t),function(e){return e})}},1486:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s});var r=n(1),o=n(29),i=n(148),a=n(0),l=n(291),u=function(e,t){return function(n){return Object(a.toOption)(e.match(/\$id\d+/gi)).map(function(r){return r.reduce(function(e,r){var o=Object(a.toOption)(t.entity.values[r.slice("$id".length)]).map(function(e){return e.value.toString()}).getOrElse(function(){return n.i18n.t("")});return e.replace(r,o)},e)})}},c=function(e,t){return function(n){return t.flatMap(function(t){return Object(a.liftKey)(e.entity.values,t.value).flatMap(function(u){return Object(o.b)(n.fields,e.entity.formId,t).map(function(e){return(t=e,o=u.value,function(e){switch(o.tpe){case r.ValueStr.$Type:return o.value.toString();case r.ValueDate.$Type:switch(t.entity.valueType.dateType.tpe.value){case r.DateTypeDate.$Type.value:return o.value.toLocaleDateString();case r.DateTypeTime.$Type.value:return o.value.getHours()>9?(""+o.value.toLocaleTimeString()).slice(0,5):(""+o.value.toLocaleTimeString()).slice(0,4);case r.DateTypeDateTime.$Type.value:return o.value.toLocaleString();default:return e.i18n.t("Неизвестный тип значения")}case r.ValueObjectRefs.$Type:var n=t.entity.valueType;return o.id.map(function(t){return Object(i.d)(e.dictionaries,n.family,t).matchWith(function(t){return n.displayFields.map(function(n){return Object(a.toOption)(t.entity.values[n.value]).map(function(t){switch(t.value.tpe){case r.ValueStr.$Type:return t.value.value;case r.ValueObjectRefs.$Type:return"Ref#"+t.value.id.join(", ");default:return e.i18n.t("-- Не поддерживаемое значение --")}}).getOrElse(function(){return""})}).join("-")},function(){return Object(l.b)(e.formRecords,n.family,t).map(function(t){return n.displayFields.map(function(n){return Object(a.toOption)(t.entity.values[n.value]).map(function(t){switch(t.value.tpe){case r.ValueStr.$Type:return t.value.value;case r.ValueObjectRefs.$Type:return"Ref#"+t.value.id.join(", ");default:return e.i18n.t("-- Не поддерживаемое значение --")}}).getOrElse(function(){return""})}).join("-")}).getOrElse(function(){return""})})}).join(", ");default:return o.toString()}})(n);var t,o})})})}},s=function(e,t,n){return function(r){return n.matchWith(function(t){return function(e,t){return function(n){return u(t,e)(n)}}(e,t)(r)},function(){return c(e,t)(r)})}}},1487:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(4),f=n.n(p),d=n(2),h=n(24),m=n.n(h),g=n(38),y=n.n(g),b=n(1),v=n(46),O=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};function E(e){var t=e.selected?f()({},function(e){if(!e.tabsPosition)return"borderRight";switch(e.tabsPosition.tpe.value){case b.TabsPositionLeft.$Type.value:return"borderRight";case b.TabsPositionRight.$Type.value:return"borderLeft";default:return"borderRight"}}(e),"2px solid"):{};return{root:Object.assign({},t)}}var k=function(e){function t(){o()(this,t);var e=u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleClick=function(t){t.preventDefault(),t.stopPropagation(),e.props.onClick&&e.props.onClick(e.props.value,t,e)},e.getColorByMuiTheme=function(e){var t=e.flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),n=e.flatMap(function(e){return e.palette}),r=e.flatMap(function(e){return e.selectable});switch(t){case"secondary":return[{color:n.map(function(e){return e.secondaryColor}).getOrElse(function(){return v.c})},{color:v.b}];case"custom":return[{color:r.map(function(e){return e.afterSelect}).getOrElse(function(){return v.a})},{color:r.map(function(e){return e.beforeSelect}).getOrElse(function(){return v.c})}];case"primary":default:return[{color:n.map(function(e){return e.primaryColor}).getOrElse(function(){return v.a})},{color:v.b}]}},e}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.icon,n=(e.index,e.onActive,e.onClick,e.selected),r=e.label,o=e.buttonStyle,i=e.style,a=(e.value,e.width,e.classes),l=(e.tabsPosition,e.elementMuiTheme),u=O(e,["icon","index","onActive","onClick","selected","label","buttonStyle","style","value","width","classes","tabsPosition","elementMuiTheme"]),c=E(this.props),s=void 0;if(t&&d.isValidElement(t)&&(s=d.cloneElement(t,{style:{fontSize:24,color:t.props&&t.props.style&&t.props.style.color?t.props.style.color:"#fff",marginBottom:r?5:0}})),l){var p=this.getColorByMuiTheme(l),f=n?p[0]:p[1];return d.createElement(m.a,Object.assign({},u,{style:Object.assign(c.root,i,f),onClick:this.handleClick}),d.createElement("div",{style:Object.assign({},o,f)},s,r))}return d.createElement(m.a,Object.assign({},u,{style:Object.assign(c.root,i),onClick:this.handleClick}),d.createElement("div",{style:o,className:n?a.root:a.default},s,r))}}]),t}(d.Component);k.muiName="Tab",k.propTypes={},k.contextTypes={},t.a=y()(function(e){return{default:{color:e.palette.text.secondary},root:{color:e.palette.primary.main}}})(k)},1488:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(4),f=n.n(p),d=n(2),h=n(62),m=n.n(h),g=n(1),y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};function b(e){if(!e.tabsPosition)return"borderRight";switch(e.tabsPosition.tpe.value){case g.TabsPositionLeft.$Type.value:return"borderRight";case g.TabsPositionRight.$Type.value:return"borderLeft";default:return"borderRight"}}var v=function(e){function t(){o()(this,t);var e=u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={selectedIndex:0},e.handleTabClick=function(t,n,r){n.preventDefault();var o=e.getValueLink(e.props),i=r.props.index;(o.value&&o.value!==t||e.state.selectedIndex!==i)&&o.requestChange(t,n,r),e.setState({selectedIndex:i}),r.props.onActive&&r.props.onActive(r)},e}return s()(t,e),a()(t,[{key:"componentWillMount",value:function(){var e=this.getValueLink(this.props),t=this.props.initialSelectedIndex||0;this.setState({selectedIndex:void 0!==e.value?this.getSelectedIndex(this.props):t<this.getTabCount()?t:0})}},{key:"componentWillReceiveProps",value:function(e,t){}},{key:"getTabs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=[];return d.Children.forEach(e.children,function(e){d.isValidElement(e)&&t.push(e)}),t}},{key:"getTabCount",value:function(){return this.getTabs().length}},{key:"getValueLink",value:function(e){return e.valueLink||{value:e.value,requestChange:e.onChange}}},{key:"getSelectedIndex",value:function(e){var t=this.getValueLink(e),n=-1;return this.getTabs(e).forEach(function(e,r){t.value===e.props.value&&(n=r)}),n}},{key:"getSelected",value:function(e,t){var n=this.getValueLink(this.props);return n.value?n.value===e.props.value:this.state.selectedIndex===t}},{key:"getTabContent",value:function(e,t,n,r){return t.push(e.props.children?d.createElement(n||O,{key:r,selected:this.getSelected(e,r)},e.props.children):void 0)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.contentContainerClassName,o=n.contentContainerStyle,i=(n.initialSelectedIndex,n.onChange,n.style),a=n.tabItemContainerStyle,l=n.tabTemplate,u=n.prerenderTabContainers,c=n.menuTopChildren,s=n.menuBottomChildren,p=(n.tabsPosition,y(n,["contentContainerClassName","contentContainerStyle","initialSelectedIndex","onChange","style","tabItemContainerStyle","tabTemplate","prerenderTabContainers","menuTopChildren","menuBottomChildren","tabsPosition"])),h=(e=this.props,{wrapper:{display:"flex",height:"100%",width:"100%"},tabItemContainer:f()({display:"flex",flexDirection:"column",flex:"0 0 150px",margin:"4px 4px 4px 0"},b(e),"1px solid ".concat(m.a[300])),tabMenuItemContainer:{display:"flex",flexDirection:"column",flex:"0 0 150px",margin:"4px 4px 4px 0"},tabContentContainer:{flex:1,margin:"4px 0 4px 4px"}}),g=(this.getValueLink(this.props).value,[]),v=100/this.getTabCount(),O=this.getTabs().map(function(e,n){return u?t.getTabContent(e,g,l,n):t.getSelected(e,n)&&t.getTabContent(e,g,l,n),d.cloneElement(e,{key:n,index:n,selected:t.getSelected(e,n),width:v+"%",onClick:t.handleTabClick})});return d.createElement("div",Object.assign({style:Object.assign(h.wrapper,i)},p),!this.props.tabItemContainerOnRight&&d.createElement("div",{style:Object.assign(h.tabItemContainer,a)},d.createElement("div",null,c),O,d.createElement("div",null,s)),d.createElement("div",{style:Object.assign(h.tabContentContainer,o),className:r},g),this.props.tabItemContainerOnRight&&d.createElement("div",{style:Object.assign(h.tabItemContainer,a)},d.createElement("div",null,c),O,d.createElement("div",null,s)))}}]),t}(d.Component);v.defaultProps={initialSelectedIndex:0,onChange:function(){}},v.contextTypes={};var O=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.selected,r=e.style,o=Object.assign({},r,{display:"flex",height:"100%"});return n||(o.height=0,o.overflow="hidden"),d.createElement("div",{style:o},t)}}]),t}(d.PureComponent);t.a=v},1491:function(e,t,n){"use strict";var r=n(21),o=(n(221),n(6)),i=n.n(o),a=n(7),l=n.n(a),u=n(8),c=n.n(u),s=n(18),p=(function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","List",{form:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","ListDescriptions",{form:e}))}return c()(t,e),t}(s.a)),f=(function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","ListEventLineDescriptions",{id:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","ListEventLine",{id:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Create",{pipeline:e}))}return c()(t,e),t}(s.a)),d=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Update",{pipeline:e}))}return c()(t,e),t}(s.a),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Request",{id:e}))}return c()(t,e),t}(s.a),m=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Delete",{id:e}))}return c()(t,e),t}(s.a),g=n(17),y=n(644),b=n(82),v=n(428);n.d(t,"a",function(){return O}),n.d(t,"h",function(){return E}),n.d(t,"b",function(){return k}),n.d(t,"e",function(){return j}),n.d(t,"c",function(){return C}),n.d(t,"d",function(){return R}),n.d(t,"g",function(){return w}),n.d(t,"f",function(){return I});var O=function(e){return g.a.send(new f(e),Object(r.f)())},E=function(e){return g.a.send(new d(e),Object(r.f)())},k=function(e){return g.a.send(new m(e),Object(r.f)())},j=function(e){return g.a.send(new h(e),Object(r.e)())},C=function(e){return function(t){return t(Object(v.e)()),g.a.send(new h(e),Object(r.e)()).then(function(e){return t(Object(v.f)(e.record)),e}).catch(function(e){throw t(Object(v.d)(e)),e})}},R=function(e){return g.a.send(new p(e),function(e){return e})},w=function(e,t,n){var r=new FormData;return r.append("file",e),r.append("config",n),y.b(r,b.default.server_address+"/api/app/files/import",t,function(e){return e})},I=function(e,t,n){var r=new FormData;return r.append("file",e),y.b(r,b.default.server_address+"/api/app/files/import/"+n.value,t,function(e){return e})}},1492:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return g}),n.d(t,"a",function(){return y}),n.d(t,"d",function(){return b});var r,o=n(1),i=n(142),a=n(143),l=n(0),u=function(e,t){return t.map(function(t){return t instanceof o.FilterCondition?c(e,t):s(e,t)}).getOrElse(function(){return!0})},c=function(e,t){return Object(l.toOption)(e.entity.values[t.field.value]).map(function(e){return e.value}).map(function(e){return d(e,t.value,t.expression)}).getOrElse(function(){return!0})},s=function e(t,n){return 0===n.conditions.length||n.conditions.map(function(n){return n instanceof o.FilterCondition?c(t,n):e(t,n)}).reduce(function(e,t){return p(e,t,n.predicate)})},p=function(e,t,n){return n.tpe.value===o.FilterPredicateAnd.$Type.value?e&&t:e||t},f=function(e){switch(e.tpe){case o.ValueStr.$Type:var t=e.value;return""!==t&&void 0!==t;case o.ValueObjectRefs.$Type:return e.id.length>0;case o.ValueList.$Type:return e.values.length>0;case o.ValueFileList.$Type:return e.files.length>0;case o.ValueNumber.$Type:case o.ValueBool.$Type:return void 0!==e.value;default:return!0}},d=function(e,t,n){var r=e.tpe.value===o.ValueObjectRefs.$Type.value,l=!isNaN(parseInt(t.toString(),10));switch(n.tpe.value){case o.FilterExpressionEq.$Type.value:return r?h(e,t,i.a):e.toString()===t.toString();case o.FilterExpressionNotEq.$Type.value:return r?!h(e,t,i.a):e.toString()!==t.toString();case o.FilterExpressionContains.$Type.value:return r?h(e,t,a.a,!0):e.toString().includes(t.toString());case o.FilterExpressionGt.$Type.value:return e.toString().length>(l?parseInt(t.toString(),10):t.toString().length);case o.FilterExpressionLt.$Type.value:return e.toString().length<(l?parseInt(t.toString(),10):t.toString().length);case o.FilterExpressionMissing.$Type.value:case o.FilterExpressionPresent.$Type.value:return f(e);default:return!0}},h=function(e,t,n,r){var o=e.id.map(function(e){return e.value});return Object(l.headOption)(t.id.map(function(e){return e.value})).map(function(e){return n(o,r?e:[e])}).getOrElse(function(){return!0})};!function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(r||(r={}));var m=function(e,t,n,i){var u=i.flatMap(function(e){return Object(l.headOption)(e.entity.permissions.filter(function(e){return e.operation instanceof o.PermissionOperationFormProperties&&e.operation.formId.value===t.map(function(e){return e.value}).getOrElse(function(){return""})}))}).map(function(e){var t=e.operation.restricted.fields;switch(n){case r.view:return t.view;case r.edit:return t.edit;default:return[]}}).getOrElse(function(){return[]}).map(function(e){return e.value});return e.filter(function(e){return!Object(a.a)(u,e.value)})},g=function(e,t,n){return e.map(function(e){return m([e],t,r.view,n).length>0})},y=function(e,t,n){return e.map(function(e){return m([e],t,r.edit,n).length>0})},b=function(e,t,n){return m(e,t,r.view,n)}},1493:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(3),g=n(1620),y=n.n(g),b=n(1621),v=n.n(b),O=n(1622),E=n.n(O),k=n(93),j=n.n(k),C=n(24),R=n.n(C),w=n(38),I=n.n(w),S=n(163),P=n.n(S),T=n(548),x=n.n(T),_=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},D=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},F=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},M=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={suggestions:[]},n}return s()(t,e),a()(t,[{key:"escapeRegexCharacters",value:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},{key:"getSuggestionsOnFocus",value:function(e){var t=this.escapeRegexCharacters(e.trim()),n=new RegExp("^"+t,"i");return this.props.suggestions.filter(function(e){return n.test(e)})}},{key:"getSuggestions",value:function(e){var t=e.trim().toLowerCase(),n=t.length,r=0;return 0===n?[]:this.props.suggestions.filter(function(e){var o=r<5&&e.toLowerCase().slice(0,n)===t;return o&&(r+=1),o})}},{key:"handleSuggestionsFetchRequested",value:function(e){var t=e.value;this.setState(m(this.state,{suggestions:{$set:this.props.showSuggestionsOnFocus?this.getSuggestionsOnFocus(t):this.getSuggestions(t)}}))}},{key:"handleSuggestionsClearRequested",value:function(){this.setState(m(this.state,{suggestions:{$set:[]}}))}},{key:"renderInput",value:function(e){e.classes,e.ref;var t=F(e,["classes","ref"]);return d.Children.map(this.props.children,function(e){return d.cloneElement(e,Object.assign({},t,{inputProps:Object.assign({},t)}))})}},{key:"shouldRenderSuggestions",value:function(){return!0}},{key:"renderSuggestion",value:function(e,t){var n=t.query,r=t.isHighlighted,o=v()(e,n),i=E()(e,o);return d.createElement(R.a,{selected:r,component:"div"},d.createElement("div",null,i.map(function(e,t){return e.highlight?d.createElement("span",{key:String(t),style:{fontWeight:500}},e.text):d.createElement("strong",{key:String(t),style:{fontWeight:300}},e.text)})))}},{key:"getSuggestionValue",value:function(e){return e}},{key:"render",value:function(){var e=this,t=this.props.classes,n={suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.handleSuggestionsFetchRequested,onSuggestionsClearRequested:this.handleSuggestionsClearRequested,getSuggestionValue:this.getSuggestionValue,renderSuggestion:this.renderSuggestion};return d.createElement(y.a,Object.assign({},n,{inputProps:{classes:t,placeholder:"",value:this.props.value,onChange:function(t,n){var r=n.newValue;return e.props.onChange(r)},onBlur:this.props.onBlur,inputRef:function(t){return e.popperNode=t},InputLabelProps:{shrink:!0}},shouldRenderSuggestions:this.shouldRenderSuggestions,renderInputComponent:this.renderInput,theme:{suggestionsList:t.suggestionsList,suggestion:t.suggestion},renderSuggestionsContainer:function(t){return d.createElement(x.a,{anchorEl:e.popperNode,open:Boolean(t.children),style:{zIndex:5e3}},d.createElement(j.a,Object.assign({square:!0},t.containerProps,{style:{width:e.popperNode?e.popperNode.clientWidth:null}}),t.children))}}))}}]),t}(d.Component);M=_([h.autobind,D("design:paramtypes",[Object])],M),t.a=I()(function(e){return P()({root:{height:250,flexGrow:1},container:{position:"relative"},suggestionsContainerOpen:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:2*e.spacing.unit}})})(M)},1494:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return u});var r=n(221),o=n(1491),i=n(87),a=function(e){return function(t,n){return t(Object(r.k)(e)),o.d(e).then(function(n){return t(Object(r.l)({form:e,result:n})),n}).catch(function(n){throw t(Object(r.j)({form:e,error:n})),n})}},l=function(e){return function(t,n){return t(Object(i.b)(function(e){return!e.importPipelines.descriptionsFetching&&e.importPipelines.descriptionsFetching},a(e)))}},u=function(e){return function(t,n){return t(Object(i.b)(function(e){return!e.importPipelines.eventLineDescriptionsFetching&&e.importPipelines.eventLineDescriptionsFetching},function(e){return function(t,n){return t(Object(r.n)(e)),o.d(e).then(function(n){return t(Object(r.o)({eventLineId:e,result:n})),n}).catch(function(n){throw t(Object(r.m)({eventLineId:e,error:n})),n})}}(e)))}}},1495:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(542),g=n.n(m),y=n(38),b=n.n(y),v=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},O=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement(g.a,{style:{margin:0},classes:this.props.classes,variant:this.props.variant,color:this.props.color,disabled:this.props.disabled,onClick:this.props.onClick,type:this.props.type,size:this.props.size},this.props.children)}}]),t}(d.Component);O=v([h.autobind],O),t.a=b()(function(e){return{sizeSmall:{minWidth:32,minHeight:16,fontSize:e.typography.pxToRem(8)}}})(O)},1496:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),g=n(1523),y=n(104),b=n(240),v=n(188),O=n(1497),E=n(1),k=n(0),j=(n(1549),n(133)),C=n(50),R=n(215),w=n(372),I=n(1453),S=n(1452),P=n(1455),T=n(621),x=function(e,t,n,r){var o=t.id,i=e.displayValues.map(function(e){return e.id.value});return 0===o.length?[]:o.sort(function(e,t){return i.indexOf(e.value)-i.indexOf(t.value)}).reduce(function(t,o,i){return t.concat(n(Object(k.headOption)(e.displayValues.filter(function(e){return e.id.value===o.value})).map(function(e){return e.value.toString()}).getOrElse(function(){return r("Значения не найдены")}),i))},[])},_=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",null,this.props.dataInput.flatMap(function(t){return t.valueType.tpe===E.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(k.toOption)([]):e.props.value.map(function(n){switch(n.tpe.value){case E.ValueObjectRefs.$Type.value:return x(t,n,function(e,t){return d.createElement("div",{key:t},e)},e.props.i18n.t);case E.ValueList.$Type.value:return[d.createElement("div",{key:E.ValueList.$Type.value},n.values.map(function(e){return e.toString()}).join(", "))];case E.ValueBool.$Type.value:return[d.createElement("div",{key:E.ValueBool.$Type.value},n.toString())];default:return[d.createElement("div",{key:"unknown"},e.props.i18n.t("Неизвестный тип значения"))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]}))}}]),t}(d.Component),D=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueList||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(_),F=n(43),M=n.n(F),W=n(26),B=n.n(W),L=n(19),A=n.n(L),$=n(30),V=n.n($),q=n(1485),N=n.n(q),z=n(1538),H=n(29),U=n(100),K=n(3),G=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Y=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"focusNameInputField",value:function(e){this.inputRef=Object(k.toOption)(e)}},{key:"render",value:function(){return d.createElement("div",{style:{padding:"0px 0px 10px",boxSizing:"border-box"}},d.createElement(B.a,{placeholder:this.props.label,fullWidth:!0,inputRef:this.focusNameInputField,value:this.props.value,onChange:this.props.onChange}))}}]),t}(d.Component),J=Y=G([m.autobind],Y),Q=n(1454),X=n(83),Z=n(174),ee=n(147),te=n(1501),ne=n(1524),re=n(1457),oe=n(173),ie=n(322),ae=n(201),le=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ue=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ce={flex:"1"},se=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={search:new k.None,open:!1},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.selectInput=document.getElementById("selectInput - "+this.props.display.id.value),this.selectInput.style.overflow="visible"}},{key:"onSearchChange",value:function(e){var t=this;this.setState(K(this.state,{search:{$set:""!==e.target.value?Object(k.toOption)(e.target.value):new k.None}}),function(){t.selectInput.size=t.selectInput.options.length})}},{key:"displayValue",value:function(e){switch(e.tpe.value){case E.ValueStr.$Type.value:return e.value.toString();case E.ValueBool.$Type.value:return e.toString();default:throw"Unknown value type "+e.tpe.value}}},{key:"getField",value:function(){return this.props.field}},{key:"getValueType",value:function(){return this.getField().map(function(e){return e.entity.valueType})}},{key:"isValueTypeBool",value:function(){return this.getValueType().filter(function(e){return e.tpe.value===E.ValueTypeBool.$Type.value}).nonEmpty()}},{key:"onSelectChange",value:function(e){this.selectInput.size=0;var t=this.isValueTypeBool(),n=e.target.value;if(!n&&t)return this.props.onChange(new E.ValueEmpty,this.props.output);t?this.onBoolSelected("true"===n):this.onObjectRefSelected(n)}},{key:"onBoolSelected",value:function(e){this.props.onChange(new E.ValueBool(e),this.props.output)}},{key:"onObjectRefSelected",value:function(e){var t=this;this.props.dataInput.map(function(n){switch(n.valueType.tpe.value){case E.ValueTypeValuesList.$Type.value:t.props.onChange(new E.ValueStr(e),t.props.output);break;case E.ValueTypeBool.$Type.value:t.props.onChange(new E.ValueBool("true"===e),t.props.output);break;case E.ValueTypeObjectRefs.$Type.value:t.props.onChange(new E.ValueObjectRefs(""===e?[]:[new E.Id(e)]),t.props.output);break;default:throw"Unknown value type"}})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getMenuItem",value:function(e,t,n){return d.createElement("option",{key:(t+1).toString(),value:Object(k.headOption)(e.id).map(function(e){return e.value}).getOrElse(function(){return""})},this.getDisplayString(n,e))}},{key:"getOption",value:function(e,t){return{value:Object(k.headOption)(e.id).map(function(e){return e.value}).getOrElse(function(){return""}),label:this.getDisplayString(t,e)}}},{key:"getDisplayObjRefsValues",value:function(e){return this.props.control.valuesLimitEnabled?this.props.control.values:e.displayValues.map(function(e){return new E.ValueObjectRefs([e.id])})}},{key:"filterDisplayValues",value:function(e){var t=this;return this.props.control.searchSettings.flatMap(function(n){return t.state.search.map(function(r){return t.getDisplayObjRefsValues(e).filter(function(o){return n.strongSearch?t.getDisplayString(e,o).toLowerCase().trim()===r.toLowerCase():0===t.getDisplayString(e,o).toLowerCase().trim().indexOf(r.toLowerCase())})})}).getOrElse(function(){return t.getDisplayObjRefsValues(e)})}},{key:"getDisplayString",value:function(e,t){return Object(k.headOption)(t.id).flatMap(function(t){return e.getDisplayValue(t)}).map(function(e){return e.toString()}).getOrElse(function(){return"Значение отсутствует"})}},{key:"renderBoolMenuItems",value:function(){var e=[new E.ValueBool(!0),new E.ValueBool(!1)].map(function(e,t){return d.createElement("option",{key:t+1,value:e.toString()},e.toString())});return[d.createElement("option",{value:"",key:0}," ")].concat(e)}},{key:"renderListMenuItems",value:function(e){var t=this;this.props.dataInput.map(function(e){return e.displayValues}).getOrElse(function(){return[]});return[d.createElement("option",{value:"",key:0}," ")].concat(this.filterDisplayValues(e).map(function(n,r){return t.getMenuItem(n,r,e)}))}},{key:"getOptions",value:function(e){var t=this;return this.filterDisplayValues(e).map(function(n,r){return t.getOption(n,e)})}},{key:"getValue",value:function(){return this.isValueTypeBool()?this.props.value.filter(function(e){return e.tpe.value===E.ValueBool.$Type.value}).map(function(e){return e.toString()}).getOrElse(function(){return""}):this.props.value.filter(function(e){return e.tpe.value===E.ValueObjectRefs.$Type.value}).flatMap(function(e){return Object(k.headOption)(e.id)}).map(function(e){return e.value}).getOrElse(function(){return""})}},{key:"renderMenuItems",value:function(){var e=this;return this.props.dataInput.matchWith(function(t){return e.isValueTypeBool()?e.renderBoolMenuItems():e.renderListMenuItems(t)},function(){return[d.createElement("option",{value:"",key:0},e.props.i18n.t("Идет загрузка значений"))]})}},{key:"getSelectOptions",value:function(){var e=this;return this.props.dataInput.matchWith(function(t){return e.getOptions(t)},function(){return[{value:"",label:e.props.i18n.t("Идет загрузка значений")}]})}},{key:"renderWithFloatingTitle",value:function(){var e=this;return d.createElement("div",null,this.props.control.searchSettings.map(function(t){return d.createElement(J,{label:e.props.i18n.t("Поиск"),value:e.state.search.getOrElse(function(){return""}),onChange:e.onSearchChange})}).getOrElse(function(){return d.createElement("div",null)}),d.createElement(B.a,{fullWidth:!0,select:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),id:"selectInput - "+this.props.display.id.value,label:Object(oe.e)(this.props.display.label.text),SelectProps:{native:!0,open:this.state.open},disabled:this.props.control.disabled,value:this.getValue(),onChange:this.onSelectChange,error:this.props.error.nonEmpty(),onBlur:this.onBlur},this.renderMenuItems()),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}),this.props.control.searchSettings.map(function(t){return d.createElement(J,{label:e.props.i18n.t("Поиск"),value:e.state.search.getOrElse(function(){return""}),onChange:e.onSearchChange})}).getOrElse(function(){return d.createElement("div",null)}))}},{key:"renderWithFixTitle",value:function(){var e=this;return d.createElement(S.a,{display:this.props.display,style:ce,blockStyle:this.props.blockStyle},this.props.control.searchSettings.map(function(t){return d.createElement(J,{label:e.props.i18n.t("Поиск"),value:e.state.search.getOrElse(function(){return""}),onChange:e.onSearchChange})}).getOrElse(function(){return d.createElement("div",null)}),d.createElement(B.a,{fullWidth:!0,select:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),id:"selectInput - "+this.props.display.id.value,SelectProps:{native:!0},disabled:this.props.control.disabled,value:this.getValue(),onChange:this.onSelectChange,error:this.props.error.nonEmpty(),onBlur:this.onBlur},this.renderMenuItems()),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderClassicSelect",value:function(e){return d.createElement(z.a,{id:"selectInput - "+this.props.display.id.value,titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),options:this.getSelectOptions(),onChange:this.onObjectRefSelected,value:this.getValue(),error:this.props.error.getOrElse(function(){return""})})}},{key:"renderMaterialSelect",value:function(e){return e.floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}},{key:"onAddClick",value:function(){var e=this;this.props.formId.foreach(function(t){return e.props.dispatch(Object(Z.c)(t,e.props.output.formField)).foreach(function(r){var o=e.props.openDialog(e.props.i18n.t("Добавление записи"),d.createElement(ie.a,{params:{},componentProps:{childFormId:r.entity.valueType.family,parentFormId:t,objRefsField:r,displayFields:[].concat(M()(e.props.dataInput.map(function(e){return e.valueType.displayFields}).getOrElse(function(){return[]}).map(function(t){return e.props.dispatch(Object(Z.c)(r.entity.valueType.family,t)).map(function(e){return new E.DisplayFieldByField(e.id,e.entity.caption)}).getOrElse(function(){return new E.DisplayFieldByField(t,"")})}))),displayFieldsForAdding:[],blockRendererId:e.props.blockRendererId,display:e.props.display,output:e.props.output,value:e.props.value.getOrElse(function(){return new E.ValueObjectRefs([])}),input:e.props.input,onlyOneChoice:!0,onObjRefAdd:function(t){return e.onAddValue(t,o)},onObjRefsAdd:e.onAddValues,onObjRefDelete:e.onDeleteValue},load:function(){return n.e(8).then(n.bind(null,2753))}}),[d.createElement(A.a,{variant:"raised",key:"close",onClick:function(t){return e.props.handleDialogClose(o)},style:{marginRight:"10px"}},e.props.i18n.t("Закрыть"))])})})}},{key:"onAddValue",value:function(e,t){return this.props.handleDialogClose(t),this.onAddValues([e])}},{key:"onDeleteValue",value:function(e){return this.deleteObjRef(e)}},{key:"deleteObjRef",value:function(e){var t=this;return this.props.formId.map(function(n){return t.props.dispatch(Object(Z.c)(n,t.props.output.formField)).map(function(r){return t.props.parentRecordId.matchWith(function(o){return Object(ee.p)([o],n,t.props.output.formField,r.entity.valueType.family,[e.id])},function(){return new Promise(function(e,t){return e()})}).then(function(){t.props.onChange(new E.ValueEmpty,t.props.output);t.props.dataInput.map(function(e){return e.formRecords}).getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.id.value});t.props.dispatch(Object(ne.a)(t.props.blockRendererId,t.props.display.id)).foreach(function(n){t.props.dispatch(Object(U.w)({id:t.props.display.id,blockRendererId:t.props.blockRendererId,display:n.filter(function(t){return t.id.value!==e.id.value})}))}),t.fetchFormRecordLimits()})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}},{key:"onAddValues",value:function(e){var t=this;return this.props.formId.map(function(n){return t.props.dispatch(Object(Z.c)(n,t.props.output.formField)).map(function(r){return t.props.parentRecordId.matchWith(function(o){return Object(ee.a)([o],n,t.props.output.formField,r.entity.valueType.family,e.map(function(e){return e.id}))},function(){return new Promise(function(e,t){return e()})}).then(function(){Object(k.headOption)(e).map(function(e){return e.id}).foreach(function(e){return t.props.onChange(new E.ValueObjectRefs([e]),t.props.output)}),t.props.dispatch(Object(ne.a)(t.props.blockRendererId,t.props.display.id)).foreach(function(n){t.props.dispatch(Object(U.w)({id:t.props.display.id,blockRendererId:t.props.blockRendererId,display:n.concat(e)}))}),t.fetchFormRecordLimits()}).catch(function(e){t.props.dispatch(Object(ae.a)(e))})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}},{key:"fetchFormRecordLimits",value:function(){var e=this;return this.props.formId.map(function(t){return e.props.parentRecordId.map(function(n){return e.props.dispatch(Object(te.b)(t,n,e.props.blockRendererId))})})}},{key:"renderOneChoiceSelect",value:function(){return d.createElement(S.a,{display:this.props.display,style:ce,blockStyle:this.props.blockStyle},d.createElement(V.a,{id:"selectInput - "+this.props.display.id.value,fullWidth:!0,IconComponent:N.a,open:!1,onOpen:function(){},onClick:this.onAddClick,value:this.getValue()},this.renderMenuItems()))}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return this.props.display.control.map(function(e){return e.openSelectDialog}).getOrElse(function(){return!1})?this.renderOneChoiceSelect():Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialSelect(e):this.renderClassicSelect(e)}}]),t}(d.Component);se=le([m.autobind,ue("design:paramtypes",[Object])],se);var pe=Object(h.connect)(function(e,t){return{field:t.formId.flatMap(function(n){return Object(H.d)(e,n,t.input.formField)}),value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataInputs.input===t.dataInputs.input&&e.dataOutput===t.dataOutput&&e.fields.list===t.fields.list},areOwnPropsEqual:function(e,t){return Object(k.isEqual)(e.formId,t.formId)&&e.display===t.display&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.input===t.input&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.field,t.field)&&Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&Object(k.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Object(X.a)(se)),fe=n(620),de=n(1458),he=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(D,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(pe,{display:e.props.display,blockRendererId:e.props.blockRendererId,blockId:e.props.blockId,parentRecordId:e.props.parentRecordId,control:e.props.control,input:t,output:e.props.output,formId:e.props.formId,onControlBlur:e.props.onControlBlur,onChange:e.props.onChange,blockStyle:e.props.blockStyle})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),me=function(e){e.formId.foreach(function(t){e.dispatch(Object(de.e)(e.blockRendererId,e.display,t))})},ge=function(e,t){return Object(k.isEqual)(e.formId,t.formId)&&Object(k.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur},ye=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(w.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:function(t){return e(t)}}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areOwnPropsEqual:ge})(Object(fe.a)([me],[function(e,t){Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)||me(e),Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)&&e.isTokenChecked&&!t.isTokenChecked&&me(e)}],[],[],function(e,t){return!ge(e,t)&&e.i18n!==t.i18n})(he)),be=n(1539),ve=n(142),Oe=n(1471),Ee=n(862),ke=n.n(Ee),je=n(32),Ce=n.n(je),Re=n(549),we=n.n(Re),Ie=n(1468),Se=n(374),Pe=n(1456),Te=n(546),xe=n.n(Te),_e=n(1493),De=n(1498),Fe=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Me=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},We=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},Be={flex:"1"},Le=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.areValuesEqual=function(e,t){return e.flatMap(function(e){return t.map(function(t){return Object(ve.a)(e,t)})}).getOrElse(function(){return!1})},n.state={textFieldTouched:!1,suggestions:[],value:new k.None},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.dispatch(Object(De.a)(this.props.display.elementAttributes)).then(function(t){return e.setState(K(e.state,{suggestions:{$set:t}}))}),this.setState(K(this.state,{value:{$set:Object(k.toOption)(this.props.value.map(function(e){return e.value}).getOrElse(function(){return""}))}}))}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});!this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})&&n.checked&&(this.state.textFieldTouched||(this.props.onChange(new E.ValueStr(n.value.getOrElse(function(){return""})),this.props.output),this.setState(K(this.state,{$set:{textFieldTouched:!0}})))),this.props.control.t13n.filter(function(e){return e.enabled}).foreach(function(n){if(t.areValuesEqual(t.props.value,e.value)){var r=e.sourceValue;if(!t.areValuesEqual(t.props.value,r)){var o=t.props.sourceValue;t.areValuesEqual(r,o)||r.foreach(function(r){t.setState(K(t.state,{value:{$set:Object(k.toOption)(Object(Se.d)(r.toString(),n.direction))}}),function(){e.onChange(new E.ValueStr(Object(Se.d)(r.toString(),n.direction)),t.props.output)})})}}})}},{key:"onChange",value:function(e){var t=this;this.setState(K(this.state,{value:{$set:Object(k.toOption)(e)}}),function(){return t.props.onChange(new E.ValueStr(e),t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0,style:{marginTop:0}},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"getElementFormattedInput",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new E.ElementFormattedInput})}},{key:"renderWithFloatingTitle",value:function(e,t){return this.getElementFormattedInput().checked?this.renderTextFieldWithFormattedInput():this.renderTextField(t)}},{key:"renderTextFieldWithFormattedInput",value:function(){return d.createElement(Ce.a,{fullWidth:!0},d.createElement(xe.a,null,Object(oe.e)(this.props.display.label.text)),this.renderFormattedInput())}},{key:"renderTextField",value:function(e){var t=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(this.wrapToAutoSuggest(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),label:Object(oe.e)(this.props.display.label.text),helperText:e.checked&&e.value,disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),inputProps:{style:{color:t}}})),this.props.error)}},{key:"renderWithFixTitle",value:function(e,t){var n=Object(Pe.b)(this.props.display.elementCss,this.props.error);return d.createElement(S.a,{display:this.props.display,style:Be,blockStyle:this.props.blockStyle},this.getElementFormattedInput().checked?this.wrapControl(this.renderFormattedInput(),this.props.error):this.wrapControl(this.wrapToAutoSuggest(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),helperText:t.checked&&t.value,disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),style:{marginTop:0},InputProps:{style:{color:n}}})),this.props.error))}},{key:"renderClassicTheme",value:function(e){var t=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(Ie.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,style:{color:t},value:this.state.value.getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}),this.props.error)}},{key:"onTextMaskChange",value:function(e){this.onChange(e.target.value)}},{key:"textMaskPipe",value:function(e,t){return Object(k.toOption)(t).filter(function(t){return e===t.placeholder&&t.previousConformedValue}).matchWith(function(){return""},function(){return e})}},{key:"textMaskCustom",value:function(e){var t=this,n=e,r=n.inputRef,o=n.style,i=We(n,["inputRef","style"]),a=this.getElementFormattedInput(),l=a.mask.getOrElse(function(){return""}),u=a.placeholderChar.getOrElse(function(){return" "}),c=Object(Pe.b)(this.props.display.elementCss,this.props.error),s=l.split(",").map(function(e){var t=Object(Oe.a)(e),n=Object(k.headOption)(t).getOrElse(function(){return""}),r=Object(k.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return d.createElement(ke.a,Object.assign({},i,{style:o,ref:r,mask:s,showMask:!0,placeholderChar:u,pipe:this.textMaskPipe,value:this.state.value.getOrElse(function(){return""}),onChange:this.onTextMaskChange,render:function(e,n){n.value;var r=We(n,["value"]);return d.createElement(B.a,Object.assign({fullWidth:!0,inputRef:e,variant:Object(re.c)(t.props.display.elementTheme,Object(re.a)(t.props.blockStyle)),disabled:t.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||t.props.control.disabled,error:t.props.error.nonEmpty(),InputProps:{style:{color:c}}},r))}}))}},{key:"wrapToAutoSuggest",value:function(e){return d.createElement(_e.a,{value:this.state.value.getOrElse(function(){return""}),onChange:this.onChange,suggestions:this.state.suggestions,onBlur:this.onBlur},e)}},{key:"renderFormattedInput",value:function(){return d.createElement(we.a,{fullWidth:!0,inputComponent:this.textMaskCustom})}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new E.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);Le=Fe([m.autobind,Me("design:paramtypes",[Object])],Le);var Ae=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueStr}),sourceValue:t.control.t13n.filter(function(e){return e.enabled}).flatMap(function(n){return Object(R.e)(e.dataOutput,t.blockRendererId,n.sourceElementId).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueStr})}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.sourceValue,t.sourceValue)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(Le),$e=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(be.a,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(Ae,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),Ve=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})($e),qe=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return this.props.control.inputMode.map(function(e){return e.tpe.value===E.ValueListInputModeBySeparator.$Type.value}).getOrElse(function(){return!1})?d.createElement("span",null,this.props.value.map(function(t){return t.toStringBySeparator(e.props.control.inputMode.map(function(e){return e.separator}).getOrElse(function(){return","})).replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull()):d.createElement("span",null,this.props.value.map(function(e){return e.toString().replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull())}}]),t}(d.Component),Ne=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof E.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(qe),ze=n(542),He=n.n(ze),Ue=n(72),Ke=n.n(Ue),Ge=n(866),Ye=n.n(Ge),Je=n(140),Qe=n.n(Je),Xe=n(46),Ze=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},et=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},nt={flex:"1"},rt=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.areValuesEqual=function(e,t){return e.flatMap(function(e){return t.map(function(t){return Object(ve.a)(e,t)})}).getOrElse(function(){return!1})},n.state={textFieldTouched:!1,valuesList:e.control.inputMode.map(function(e){return e.tpe.value===E.ValueListInputModeSeparate.$Type.value?n.props.value.map(function(e){return e.values}).getOrElse(function(){return[]}):[]}).getOrElse(function(){return[]}),valueList:e.control.inputMode.map(function(t){return t.tpe.value===E.ValueListInputModeBySeparator.$Type.value?new E.ValueStr(e.value.map(function(e){return e.values.map(function(e){return e.toString()}).join(t.separator+" ")}).getOrElse(function(){return""})):new E.ValueStr("")}).getOrElse(function(){return new E.ValueStr("")})},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});!this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})&&n.checked&&(this.state.textFieldTouched||this.props.control.inputMode.foreach(function(e){var r=e.separator;t.props.onChange(new E.ValueList(n.value.getOrElse(function(){return""}).split(r).map(function(e){return new E.ValueStr(e)})),t.props.output),t.setState(K(t.state,{$set:{textFieldTouched:!0}}))}))}},{key:"onChange",value:function(e){var t=this;this.setState(K(this.state,{valueList:{$set:new E.ValueStr(e.target.value)}}),function(){return t.props.control.inputMode.foreach(function(e){var n=e.separator;t.props.onChange(new E.ValueList(t.state.valueList.toString().split(n).map(function(e){return new E.ValueStr(e.trim())}).filter(function(e){return""!==e.value})),t.props.output)})})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0,style:{marginTop:0}},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){return this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new E.ElementFormattedInput}).checked?this.renderTextFieldWithFormattedInput():this.renderTextField(t)}},{key:"renderTextFieldWithFormattedInput",value:function(){return d.createElement(Ce.a,{fullWidth:!0},d.createElement(xe.a,null,Object(oe.e)(this.props.display.label.text)),this.renderFormattedInput())}},{key:"renderTextField",value:function(e){var t=this,n=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.props.control.inputMode.map(function(r){return d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(t.props.display.elementTheme,Object(re.a)(t.props.blockStyle)),onChange:t.onChange,label:Object(oe.e)(t.props.display.label.text),helperText:e.checked&&e.value,value:t.state.valueList.toString(),disabled:t.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||t.props.control.disabled,error:t.props.error.nonEmpty(),onBlur:t.onBlur,inputProps:{style:{color:n}}})}).getOrElse(function(){return d.createElement("div",null)})}},{key:"renderWithFixTitle",value:function(e,t){var n=this,r=Object(Pe.b)(this.props.display.elementCss,this.props.error),o=this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new E.ElementFormattedInput});return this.props.control.inputMode.map(function(e){return d.createElement(S.a,{display:n.props.display,style:nt,blockStyle:n.props.blockStyle},o.checked?n.wrapControl(n.renderFormattedInput(),n.props.error):n.wrapControl(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(n.props.display.elementTheme,Object(re.a)(n.props.blockStyle)),onChange:n.onChange,helperText:t.checked&&t.value,value:n.state.valueList.toString(),disabled:n.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||n.props.control.disabled,error:n.props.error.nonEmpty(),onBlur:n.onBlur,style:{marginTop:0},InputProps:{style:{color:r}}}),n.props.error))}).getOrElse(function(){return d.createElement("div",null)})}},{key:"renderClassicTheme",value:function(e){var t=this,n=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.props.control.inputMode.map(function(r){return t.wrapControl(d.createElement(Ie.a,{titlePosition:e.position,label:Object(oe.e)(t.props.display.label.text),onChange:t.onChange,style:{color:n},value:t.state.valueList.toString(),error:t.props.error.getOrElse(function(){return""})}),t.props.error)}).getOrElse(function(){return d.createElement("div",null)})}},{key:"textMaskCustom",value:function(e){var t=e.inputRef,n=tt(e,["inputRef"]),r=this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new E.ElementFormattedInput}),o=r.mask.getOrElse(function(){return""}),i=r.placeholderChar.getOrElse(function(){return" "}),a=o.split(",").map(function(e){var t=Object(Oe.a)(e),n=Object(k.headOption)(t).getOrElse(function(){return""}),r=Object(k.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return d.createElement(ke.a,Object.assign({},n,{ref:t,mask:a,placeholderChar:i,showMask:!0}))}},{key:"renderFormattedInput",value:function(){var e=this,t=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.props.control.inputMode.map(function(n){n.separator;return d.createElement(Ye.a,{id:"formatted-text-mask-input",value:e.state.valueList.toString(),onChange:e.onChange,inputComponent:e.textMaskCustom,disabled:e.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||e.props.control.disabled,error:e.props.error.nonEmpty(),onBlur:e.onBlur,inputProps:{style:{color:t}}})}).getOrElse(function(){return d.createElement("div",null)})}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new E.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new E.ElementFormattedInput});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"handleValueAdd",value:function(){var e=this;""!==this.state.valueList.value&&(this.setState(K(this.state,{valuesList:{$set:[].concat(M()(this.state.valuesList),[this.state.valueList])},valueList:{$set:new E.ValueStr("")}}),function(){return e.props.onChange(new E.ValueList(e.state.valuesList),e.props.output)}),this.inputRef.foreach(function(e){return e.focus()}))}},{key:"handleValueListChange",value:function(e){this.setState(K(this.state,{valueList:{$set:new E.ValueStr(e.target.value.trim())}}))}},{key:"onSeparateValueRemove",value:function(e){var t=this;this.setState(K(this.state,{valuesList:{$set:[].concat(M()(this.state.valuesList.slice(0,e)),M()(this.state.valuesList.slice(e+1)))}}),function(){return t.props.onChange(new E.ValueList(t.state.valuesList),t.props.output)}),this.inputRef.foreach(function(e){return e.focus()})}},{key:"renderSeparateAddingItem",value:function(e,t){var n=this;return d.createElement("div",{key:t},e.value,d.createElement(Qe.a,{style:Xe.f,onClick:function(){return n.onSeparateValueRemove(t)}},d.createElement(Ke.a,{style:Xe.g})))}},{key:"handleInputRef",value:function(e){this.inputRef=Object(k.toOption)(e)}},{key:"renderSeparateAdding",value:function(){var e=this;return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},this.state.valuesList.map(function(t,n){return e.renderSeparateAddingItem(t,n)}),d.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",marginTop:"15px",marginBottom:"15px"}},this.wrapControl(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),style:{marginTop:0},label:this.props.i18n.t("Новое значение"),value:this.state.valueList.value,onChange:this.handleValueListChange,inputRef:this.handleInputRef,error:this.props.error.nonEmpty()}),this.props.error),d.createElement(He.a,{color:"primary",onClick:this.handleValueAdd},this.props.i18n.t("Добавить"))))}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return this.props.control.inputMode.map(function(e){return e.tpe.value}).getOrElse(function(){return E.ValueListInputModeBySeparator.$Type.value})===E.ValueListInputModeSeparate.$Type.value?this.renderSeparateAdding():Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);rt=Ze([m.autobind,et("design:paramtypes",[Object])],rt);var ot=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueList}).map(function(e){return e}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(rt),it=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Ne,{output:this.props.output,blockRendererId:this.props.blockRendererId,control:this.props.control}))}},{key:"renderEditControl",value:function(){return d.createElement(ot,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),at=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(it),lt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("span",null,this.props.value.map(function(e){return e.toString().replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull())}}]),t}(d.Component),ut=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof E.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(lt),ct=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},st=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pt={flex:1},ft=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:new k.None},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.setState(K(this.state,{value:{$set:this.props.value}}))}},{key:"onChange",value:function(e){var t=this;""!==e.target.value?this.props.organisation.map(function(e){return e.entity.currency}).foreach(function(n){var r=new E.ValueMoney(parseFloat(e.target.value).toString(),n);t.setState(K(t.state,{value:{$set:Object(k.toOption)(r)}}),function(){return t.props.onChange(r,t.props.output)})}):this.setState(K(this.state,{value:{$set:Object(k.toOption)(new E.ValueEmpty)}}),function(){return t.props.onChange(new E.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){var n=Object(Pe.b)(this.props.display.elementCss,this.props.error);return d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),helperText:t.checked&&t.value,value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:n}}})}},{key:"renderWithFixTitle",value:function(e,t){var n=Object(Pe.b)(this.props.display.elementCss,this.props.error);return d.createElement(S.a,{display:this.props.display,style:pt,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,helperText:t.checked&&t.value,value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:n}}})))}},{key:"renderClassicTheme",value:function(e){var t=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(Ie.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,style:{color:t},value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}))}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new E.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);ft=ct([m.autobind,st("design:paramtypes",[Object])],ft);var dt=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueMoney}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),organisation:e.organisation.data}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)&&Object(k.isEqual)(e.organisation,t.organisation)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(ft),ht=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(ut,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(dt,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),mt=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(ht),gt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("span",null,this.props.value.map(function(e){return e.toString()}).getOrNull())}}]),t}(d.Component),yt=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueNumber})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(gt),bt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},vt=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ot={flex:"1"},Et=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={sign:"",value:new k.None},n}return s()(t,e),a()(t,[{key:"changeValue",value:function(e){var t=this;if(""!==e){var n=this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""});Object(C.b)(e,n,!0,function(e){return t.setState(K(t.state,{value:{$set:Object(k.toOption)(new E.ValueNumber(e))}}),function(){t.props.onChange(new E.ValueNumber(e),t.props.output)})})}else this.setState(K(this.state,{value:{$set:Object(k.toOption)(new E.ValueEmpty)}}),function(){t.props.onChange(new E.ValueEmpty,t.props.output)})}},{key:"onChange",value:function(e){var t=this,n=e.target.value;"-"===n?this.setState(K(this.state,{sign:{$set:"-"}}),function(){return t.changeValue(n)}):this.setState(K(this.state,{sign:{$set:""}}),function(){return t.changeValue(n)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){var n=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),helperText:t.checked&&t.value,value:this.state.sign+this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,style:{marginTop:0},inputProps:{style:{color:n}}}))}},{key:"renderWithFixTitle",value:function(e,t){var n=Object(Pe.b)(this.props.display.elementCss,this.props.error);return d.createElement(S.a,{display:this.props.display,style:Ot,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,helperText:t.checked&&t.value,value:this.state.sign+this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,style:{marginTop:0},inputProps:{style:{color:n}}})))}},{key:"renderClassicTheme",value:function(e){var t=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(Ie.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,style:{color:t},value:this.state.sign+this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}))}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new E.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);Et=bt([m.autobind,vt("design:paramtypes",[Object])],Et);var kt=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueNumber}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(Et),jt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(yt,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(kt,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),Ct=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(jt),Rt={whiteSpace:"pre-wrap"},wt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return!Object(k.isEqual)(e.value,this.props.value)}},{key:"render",value:function(){return d.createElement("div",{style:Rt},this.props.value.map(function(e){return e.toString()}).getOrNull())}}]),t}(d.Component),It=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof E.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(wt),St=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Pt=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tt={flex:"1"},xt=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:new k.None},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.setState(K(this.state,{value:{$set:this.props.value}}))}},{key:"onChange",value:function(e){var t=this,n=new E.ValueStr(e.target.value);this.setState(K(this.state,{value:{$set:Object(k.toOption)(n)}}),function(){return t.props.onChange(n,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(){var e=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(B.a,{fullWidth:!0,multiline:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),rows:this.props.control.displayRows,rowsMax:this.props.control.rowsMax,onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:e}}}),this.props.error)}},{key:"renderWithFixTitle",value:function(){var e=Object(Pe.b)(this.props.display.elementCss,this.props.error);return d.createElement(S.a,{display:this.props.display,style:Tt,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(B.a,{fullWidth:!0,multiline:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),rows:this.props.control.displayRows,rowsMax:this.props.control.rowsMax,onChange:this.onChange,value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:e}}}),this.props.error))}},{key:"renderMaterialTheme",value:function(e){return e.floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return this.renderMaterialTheme(e)}}]),t}(d.Component);xt=St([m.autobind,Pt("design:paramtypes",[Object])],xt);var _t=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueStr}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(xt),Dt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(It,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(_t,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),Ft=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(Dt),Mt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",null,this.props.dataInput.flatMap(function(t){return t.valueType.tpe===E.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(k.toOption)([]):e.props.value.map(function(n){switch(n.tpe.value){case E.ValueObjectRefs.$Type.value:return x(t,n,function(e,t){return d.createElement("div",{key:t},e)},e.props.i18n.t);case E.ValueList.$Type.value:return[d.createElement("div",{key:E.ValueList.$Type.value},n.values.map(function(e){return e.toString()}).join(", "))];case E.ValueBool.$Type.value:return[d.createElement("div",{key:E.ValueBool.$Type.value},n.toString())];default:return[d.createElement("div",{key:"unknown"},e.props.i18n.t("Неизвестный тип значения"))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]}))}}]),t}(d.Component),Wt=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueList||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(Mt),Bt=n(319),Lt=n.n(Bt),At=n(33),$t=n.n(At),Vt=n(416),qt=n.n(Vt),Nt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},zt={flex:"1"},Ht=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"onChange",value:function(e,t){var n=this;this.props.dataInput.map(function(e){switch(e.valueType.tpe.value){case E.ValueTypeValuesList.$Type.value:n.props.onChange(new E.ValueStr(t),n.props.output);break;case E.ValueTypeBool.$Type.value:n.props.onChange(new E.ValueBool("true"===t),n.props.output);break;case E.ValueTypeObjectRefs.$Type.value:n.props.onChange(new E.ValueObjectRefs([new E.Id(t)]),n.props.output);break;default:throw"Unknown value type"}})}},{key:"getMuiColorType",value:function(e){switch(e){case"primary":return"primary";case"secondary":return"secondary";case"custom":default:return"primary"}}},{key:"getSpaceBetweenRadioBoxes",value:function(){return this.props.display.control.flatMap(function(e){return e.spaceBetween}).getOrElse(function(){return 12})}},{key:"renderRadioBoxes",value:function(){var e=this,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.fonts}).getOrElse(function(){return new E.ElementFonts}),r=t.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),o=t.map(function(e){return e.enableStyles.map(function(e){return e.titleStyleChecked})}).flatMap(function(e){return e}),i=Object(Pe.c)(n.textFont,r,this.props.error),a=Object(Pe.c)(n.titleFont,o,this.props.error),l=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.muiThemeChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),u=this.props.display.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}).flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),c={paddingBottom:this.getSpaceBetweenRadioBoxes(),paddingTop:this.getSpaceBetweenRadioBoxes()};return this.props.dataInput.map(function(t){switch(t.valueType.tpe.value){case E.ValueTypeValuesList.$Type.value:return t.value.values.map(function(t,n){return d.createElement($t.a,{key:n,control:d.createElement(Lt.a,Object.assign({style:Object.assign({},i,c)},l?{color:e.getMuiColorType(u)}:{color:"primary"})),value:t.toString(),label:d.createElement("span",{style:a},t.toString())})});case E.ValueTypeBool.$Type.value:return[new E.ValueBool(!0),new E.ValueBool(!1)].map(function(t,n){return d.createElement($t.a,{key:n,control:d.createElement(Lt.a,Object.assign({style:Object.assign({},i,c)},l?{color:e.getMuiColorType(u)}:{color:"primary"})),label:d.createElement("span",{style:a},t.toString()),value:t.toString(),style:i})});case E.ValueTypeObjectRefs.$Type.value:return t.displayValues.map(function(t,n){return d.createElement($t.a,{key:n,label:d.createElement("span",{style:a},t.value.value.toString()),control:d.createElement(Lt.a,Object.assign({style:Object.assign({},i,c)},l?{color:e.getMuiColorType(u)}:{color:"primary"})),value:t.id.value,style:i})});default:throw"Unknown value type"}}).getOrElse(function(){return[]})}},{key:"getSelectedValue",value:function(){var e=this;return this.props.dataInput.map(function(t){switch(t.valueType.tpe.value){case E.ValueTypeValuesList.$Type.value:return e.props.value.flatMap(function(e){return Object(k.headOption)(e.values).map(function(e){return e.toString()})}).getOrElse(function(){return"empty"});case E.ValueTypeBool.$Type.value:return e.props.value.map(function(e){return e.toString()}).getOrElse(function(){return"empty"});case E.ValueTypeObjectRefs.$Type.value:return e.props.value.flatMap(function(e){return Object(k.headOption)(t.displayValues.filter(function(t){return Object(k.headOption)(e.id).map(function(e){return t.id.value===e.value}).getOrElse(function(){return!1})}))}).map(function(e){return e.id.value}).getOrElse(function(){return""});default:throw"Unknown value type"}}).getOrElse(function(){return""})}},{key:"render",value:function(){var e=this.props.display,t=this.props.display.control.map(function(e){return e.placementRow}).getOrElse(function(){return!1});return d.createElement("div",null,d.createElement(S.a,{display:this.props.display,style:zt,blockStyle:this.props.blockStyle},d.createElement(Ce.a,{error:this.props.error.nonEmpty()},d.createElement(qt.a,{name:Object(oe.e)(e.label.text),onChange:this.onChange,value:this.getSelectedValue(),style:{flexDirection:t?"row":"column"}},this.renderRadioBoxes()),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))))}}]),t}(d.Component);Ht=Nt([m.autobind],Ht);var Ut=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataInputs.input===t.dataInputs.input&&e.dataOutput===t.dataOutput&&e.fields.list===t.fields.list},areOwnPropsEqual:function(e,t){return e.display===t.display&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.input===t.input&&e.onChange===t.onChange},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&Object(k.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Ht),Kt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Wt,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(Ut,{display:e.props.display,blockRendererId:e.props.blockRendererId,control:e.props.control,input:t,output:e.props.output,blockStyle:e.props.blockStyle,onChange:e.props.onChange})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),Gt=function(e){e.formId.foreach(function(t){e.dispatch(Object(de.e)(e.blockRendererId,e.display,t))})},Yt=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(w.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([Gt],[function(e,t){Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)||Gt(e),Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)&&e.isTokenChecked&&!t.isTokenChecked&&Gt(e)}],[],[],function(e,t){return!function(e,t){return Object(k.isEqual)(e.formId,t.formId)&&Object(k.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur}(e,t)&&e.i18n!==t.i18n})(Kt)),Jt=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",null,this.props.dataInput.flatMap(function(t){return t.valueType.tpe===E.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(k.toOption)([]):e.props.value.map(function(n){switch(n.tpe.value){case E.ValueObjectRefs.$Type.value:return x(t,n,function(e,t){return d.createElement("div",{key:t},e)},e.props.i18n.t);case E.ValueList.$Type.value:return[d.createElement("div",{key:E.ValueList.$Type.value},n.values.map(function(e){return e.toString()}).join(", "))];case E.ValueBool.$Type.value:return[d.createElement("div",{key:E.ValueBool.$Type.value},n.toString())];default:return[d.createElement("div",{key:"unknown"},e.props.i18n.t("Неизвестный тип значения"))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]}))}}]),t}(d.Component),Qt=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueList||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(Jt),Xt=n(45),Zt=n.n(Xt),en=n(98),tn=n.n(en),nn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},rn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},on=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={search:new k.None},n}return s()(t,e),a()(t,[{key:"onChange",value:function(e,t){var n=this;this.props.dataInput.map(function(e){switch(e.value.tpe.value){case E.ValueList.$Type.value:n.props.onChange(new E.ValueStr(t),n.props.output);break;case E.ValueObjectRefs.$Type.value:n.props.onChange(new E.ValueObjectRefs([new E.Id(t)]),n.props.output);break;default:throw"Unknown value type"}})}},{key:"onValueObjectRefCheckBoxChange",value:function(e){var t=this.props.value.map(function(e){return e.id}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.value===e.value}).length>0;return new E.ValueObjectRefs(n?[].concat(M()(t.filter(function(t){return t.value!==e.value}))):[].concat(M()(t),[e]))}},{key:"onValueListChange",value:function(e){var t=this.props.value.map(function(e){return e.values}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.toString()===e.toString()}).length>0;return new E.ValueList(n?[].concat(M()(t.filter(function(t){return t!==e}))):[].concat(M()(t),[e]))}},{key:"onValueBoolChange",value:function(){return this.props.value.map(function(e){return e.value}).getOrElse(function(){return!1})?new E.ValueEmpty:new E.ValueBool(!0)}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getMuiColorType",value:function(e){switch(e){case"primary":return"primary";case"secondary":return"secondary";case"custom":default:return"primary"}}},{key:"getSpaceBetweenCheckBoxes",value:function(){return this.props.display.control.flatMap(function(e){return e.spaceBetween}).getOrElse(function(){return 12})}},{key:"renderCheckBoxes",value:function(){var e=this,t=Object(Pe.b)(this.props.display.elementCss,this.props.error),n=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.muiThemeChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),r=this.props.display.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}).flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),o={paddingBottom:this.getSpaceBetweenCheckBoxes(),paddingTop:this.getSpaceBetweenCheckBoxes()};return this.props.dataInput.map(function(i){switch(i.valueType.tpe.value){case E.ValueTypeValuesList.$Type.value:return i.value.values.map(function(i){return d.createElement($t.a,{label:d.createElement("span",{style:{color:t}},i.toString()),control:d.createElement(Zt.a,Object.assign({},n?{color:e.getMuiColorType(r)}:{color:"primary"},{style:o,onChange:function(){return e.props.onChange(e.onValueListChange(i),e.props.output)},checked:Object(k.headOption)(e.props.value.map(function(e){return e instanceof E.ValueList?e.values:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof E.ValueStr&&e.value===i.value})).nonEmpty(),onBlur:e.onBlur}))})});case E.ValueTypeObjectRefs.$Type.value:return i.displayValues.map(function(i){return d.createElement($t.a,{label:d.createElement("span",{style:{color:t}},i.value.toString()),control:d.createElement(Zt.a,Object.assign({},n?{color:e.getMuiColorType(r)}:{color:"primary"},{style:o,onChange:function(){return e.props.onChange(e.onValueObjectRefCheckBoxChange(i.id),e.props.output)},checked:Object(k.headOption)(e.props.value.map(function(e){return e instanceof E.ValueObjectRefs?e.id:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof E.Id&&e.value===i.id.value})).nonEmpty(),onBlur:e.onBlur}))})});case E.ValueTypeBool.$Type.value:return[d.createElement($t.a,{label:d.createElement("span",{style:{color:t}},e.props.i18n.t("Значение")),control:d.createElement(Zt.a,Object.assign({},n?{color:e.getMuiColorType(r)}:{color:"primary"},{style:o,onChange:function(){return e.props.onChange(e.onValueBoolChange(),e.props.output)},checked:e.props.value.map(function(e){return e instanceof E.ValueBool&&e.value}).getOrElse(function(){return!1}),onBlur:e.onBlur}))})];default:throw"Unknown value type"}}).getOrElse(function(){return[d.createElement("div",null,e.props.i18n.t("Значения отсутствуют"))]})}},{key:"render",value:function(){var e=this.props.display.control.map(function(e){return e.placementRow}).getOrElse(function(){return!1});return d.createElement("div",null,d.createElement(tn.a,null,d.createElement(S.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{error:this.props.error.nonEmpty()},d.createElement("div",{style:{display:"flex",flexDirection:e?"row":"column"}},this.renderCheckBoxes()),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))))}}]),t}(d.Component);on=nn([m.autobind,rn("design:paramtypes",[Object])],on);var an=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueList||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&Object(k.isEqual)(e.error,t.error)&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(on),ln=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Qt,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(an,{display:e.props.display,blockRendererId:e.props.blockRendererId,control:e.props.control,input:t,output:e.props.output,onControlBlur:e.props.onControlBlur,blockStyle:e.props.blockStyle,onChange:e.props.onChange})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),un=function(e){e.formId.foreach(function(t){e.dispatch(Object(de.e)(e.blockRendererId,e.display,t))})},cn=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(w.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([un],[function(e,t){Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)||un(e),Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)&&e.isTokenChecked&&!t.isTokenChecked&&un(e)}],[],[],function(e,t){return!function(e,t){return Object(k.isEqual)(e.formId,t.formId)&&Object(k.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur}(e,t)&&e.i18n!==t.i18n})(ln)),sn=n(160),pn=n.n(sn),fn=n(623),dn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},hn=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"onSaveFile",value:function(e){var t=this;this.props.authToken.map(function(n){return Object(fn.b)(e,n,t.props.cdnAddress)})}},{key:"render",value:function(){var e=this;return d.createElement(tn.a,null,this.props.fileMetas.fetching||this.props.fileMetas.error.nonEmpty()?d.createElement(pn.a,null):this.props.value.map(function(t){return t.files.map(function(t,n){return Object(k.toOption)(e.props.fileMetas.list.find(function(e){return e.id.value===t.value})).map(function(n){return d.createElement("div",{key:t.value,onClick:function(){return e.onSaveFile(n.id)},style:{cursor:"pointer"}},n.entity.originalName)}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Описание файла не было загружено"))})})}).getOrElse(function(){return[]}))}}]),t}(d.Component);hn=dn([m.autobind],hn);var mn=Object(h.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueFileList}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.fileMetas===t.fileMetas&&Object(k.isEqual)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.authToken,t.authToken)&&e.i18n===t.i18n&&e.fileMetas===t.fileMetas}})(hn),gn=n(189),yn=n.n(gn),bn=n(54),vn=n.n(bn),On=n(107),En=n.n(On),kn=n(25),jn=n.n(kn),Cn=n(99),Rn=(n(1557),n(417)),wn=n(71),In=n(139),Sn=n(419),Pn=n(385),Tn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},xn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_n=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.props.value;return n.updateMetas(r),n.state={value:r},n}return s()(t,e),a()(t,[{key:"getValue",value:function(){return this.state.value.map(function(e){return e.tpe===E.ValueFileList.$Type?e:new E.ValueFileList([])}).getOrElse(function(){return new E.ValueFileList([])})}},{key:"componentWillReceiveProps",value:function(e){if(!Object(k.isEqual)(this.state.value,e.value)){var t=e.value;this.updateMetas(t),this.setState(K(this.state,{value:{$set:t}}))}}},{key:"updateMetas",value:function(e){this.props.dispatch(Object(de.c)(this.props.blockRendererId,this.props.display))}},{key:"onFilesDrop",value:function(e){var t=this;if(Object(Pn.b)(Object(k.toOption)(this.props.control))){if(0===e.length)throw"There are not files to process";var n=e[e.length-1];Object(Cn.h)(n,this.props.cdnAddress,this.props.authToken,this.props.organisation.organisationId,this.props.eventLine.eventLineId,this.props.formRecordId,new k.None,"false",!0,Object(k.toOption)(this.props.output.formField),Object(k.toOption)(this.props.formId)).then(function(e){t.props.formRecordId.matchWith(function(e){Object(Cn.f)(t.props.formId,e,t.props.output.formField).then(function(e){t.props.onChange(new E.ValueFileList(e.list.map(function(e){return e.id})),t.props.output)})},function(){Object(Cn.b)(e).then(function(n){t.props.dispatch(Object(In.h)([n.record])),t.props.onChange(K(t.getValue(),{files:{$push:[e]}}),t.props.output)})})}).catch(function(e){t.showNotification("Во время загрузки файла произошла ошибка")})}}},{key:"onFileDelete",value:function(e){var t=this;if(Object(Pn.a)(Object(k.toOption)(this.props.control)).getOrElse(function(){return!1})){var n=this.getValue();Object(Cn.a)(e).then(function(r){t.showNotification("Файл успешно удален"),t.props.onChange(K(n,{files:{$set:n.files.filter(function(t){return t.value!==e.value})}}),t.props.output)}).catch(function(e){return t.showNotification("Во время удаления файла произошла ошибка")})}}},{key:"showNotification",value:function(e){this.props.dispatch(Object(wn.h)(this.props.i18n.t(e)))}},{key:"onSaveFile",value:function(e){var t=this;this.props.authToken.map(function(n){return Object(fn.b)(e,n,t.props.cdnAddress)})}},{key:"render",value:function(){var e=this,t=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new E.ElementFonts}),n=t.textFont.map(function(e){return{borderColor:e.color}}).getOrElse(function(){return{}}),r=t.textFont.map(function(e){return{borderColor:e.color}}).getOrElse(function(){return{}}),o=Object(Pn.a)(Object(k.toOption)(this.props.control)).getOrElse(function(){return!1})?t.textFont.map(function(e){return e.color}).getOrElse(function(){return""}):"#ccc",i=this.props.display.control.getOrElse(function(){return new E.ElementControlFileList});return d.createElement("div",null,d.createElement("p",null,this.props.i18n.t("Файлов загружено")+": "+this.getValue().files.length),d.createElement(tn.a,null,this.props.fileMetas.fetching&&this.props.fileMetas.error.isEmpty()&&d.createElement(pn.a,null),!this.props.fileMetas.fetching&&this.props.fileMetas.error.nonEmpty()&&d.createElement("p",null,this.props.i18n.t("При запросе списка файлов произошла ошибка")),!this.props.fileMetas.fetching&&this.props.fileMetas.error.isEmpty()&&this.getValue().files.map(function(t){return Object(k.headOption)(e.props.fileMetas.list.filter(function(e){return e.id.value===t.value})).map(function(n){return d.createElement(En.a,{style:r,key:t.value},d.createElement(yn.a,null,d.createElement(jn.a,{disabled:!Object(Pn.a)(Object(k.toOption)(e.props.control)).getOrElse(function(){return!1}),onClick:function(){return e.onFileDelete(t)},style:{alignSelf:"center",flexShrink:0}},d.createElement(Ke.a,{style:{fill:o}}))),d.createElement(vn.a,{primary:n.entity.originalName,onClick:function(){return e.onSaveFile(t)},style:{cursor:"pointer"}}))}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Описание файла не было загружено"))})})),Object(Pn.b)(Object(k.toOption)(this.props.control)).getOrElse(function(){return!1})&&d.createElement(Rn,{onDrop:this.onFilesDrop,disableClick:i.disabled,className:"FileListControlEditor__dropzone",style:n,accept:Object(Sn.a)(Object(k.toOption)(this.props.control)).getOrElse(function(){return""})},function(t){var n=t.isDragActive;return d.createElement("div",{className:n?"FileListControlEditor__dropzone-wrapper":""},d.createElement("div",{className:"FileListControlEditor__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),d.createElement(Q.a,{display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}}]),t}(d.Component);_n=Tn([m.autobind,xn("design:paramtypes",[Object])],_n);var Dn=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueFileList}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,fileMetas:e.fileMetas,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.fileMetas===t.fileMetas},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)&&Object(k.isEqual)(e.authToken,t.authToken)&&e.fileMetas===t.fileMetas&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.formRecordId,t.formRecordId)}})(_n),Fn=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(mn,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Dn,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,formId:this.props.formId,output:this.props.output,control:this.props.control,onChange:this.props.onChange,blockStyle:this.props.blockStyle}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(I.a),Mn=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)&&Object(k.isEqual)(e.formRecordId,e.formRecordId)}})(Object(fe.a)([function(e){e.dispatch(Object(de.c)(e.blockRendererId,e.display))}],[],[],[])(Fn)),Wn=n(4),Bn=n.n(Wn),Ln=n(1605),An=n.n(Ln),$n=n(1606),Vn=n.n($n),qn=n(1766),Nn=n.n(qn),zn=n(1765),Hn=n.n(zn),Un=n(109),Kn=n(379),Gn=(n(1559),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Yn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Jn=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r={};return e.value.getOrElse(function(){return new E.ValueFileList([])}).files.forEach(function(e){return r[e.value]=!1}),n.state={imageFetching:r,currentImageIdx:0},n}return s()(t,e),a()(t,[{key:"getImageSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Un.b)(n,e,t.props.cdnAddress)}).getOrElse(function(){return n(622)})}},{key:"onImageLoad",value:function(e){this.setState(K(this.state,{imageFetching:Bn()({},e.value,{$set:!1})}))}},{key:"getValue",value:function(){return this.props.value.getOrElse(function(){return new E.ValueFileList([])})}},{key:"openFullScreenMode",value:function(e){var t=this,n=this.props.openDialog("",d.createElement("div",{className:"ImageControlEditor__imageDialog-wrapper",onClick:function(){return t.props.handleDialogClose(n)}},d.createElement("div",{className:"ImageControlEditor__imageDialog-container"},d.createElement("img",{className:"ImageControlEditor__imageDialog-image",src:this.getImageSrc(e)}))),[],{fullScreen:!0})}},{key:"renderGrid",value:function(){var e=this,t=this.props.display.control.map(function(e){return e}),n=Object(Kn.a)(t),r=Object(Kn.b)(n),o=Object(Kn.c)(n);return d.createElement("div",{className:"ImageListControlDisplay__root"},d.createElement(An.a,{cellHeight:o.getOrElse(function(){return 160}),cols:r.getOrElse(function(){return 3})},this.getValue().files.map(function(t,n){return d.createElement(Vn.a,{key:n,cols:1},e.state.imageFetching[t.value]?d.createElement(pn.a,null):d.createElement("img",{style:{display:e.state.imageFetching[t.value]?"none":""},src:e.getImageSrc(t),onLoad:function(){return e.onImageLoad(t)},onClick:function(){return e.openFullScreenMode(t)}}))})))}},{key:"getCurrentSliderImage",value:function(){return Object(k.lift)(this.getValue().files,this.state.currentImageIdx)}},{key:"onNextImage",value:function(){this.setState(K(this.state,{currentImageIdx:{$set:this.state.currentImageIdx+1}}))}},{key:"onPreviousImage",value:function(){this.setState(K(this.state,{currentImageIdx:{$set:this.state.currentImageIdx-1}}))}},{key:"renderSlider",value:function(){var e=this,t=this.props.display.elementCss.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}).getOrElse(function(){return"inherit"});return d.createElement("div",{className:"ImageListControlDisplay__silder-root"},d.createElement("div",{className:"ImageListControlDisplay__silder-button"},d.createElement(jn.a,{onClick:this.onPreviousImage,disabled:0===this.state.currentImageIdx},d.createElement(Hn.a,null))),d.createElement(An.a,{className:"ImageListControlDisplay__slider-gridList",cols:1},d.createElement(Vn.a,{key:0,cols:1,style:{height:t}},this.getCurrentSliderImage().map(function(t){return e.state.imageFetching[t.value]?d.createElement(pn.a,null):d.createElement("img",{style:{display:e.state.imageFetching[t.value]?"none":""},src:e.getImageSrc(t),onLoad:function(){return e.onImageLoad(t)},onClick:function(){return e.openFullScreenMode(t)}})}).getOrNull())),d.createElement("div",{className:"ImageListControlDisplay__silder-button"},d.createElement(jn.a,{onClick:this.onNextImage,disabled:this.state.currentImageIdx>=this.getValue().files.length-1},d.createElement(Nn.a,null))))}},{key:"render",value:function(){var e=this.props.display.control.map(function(e){return e});return Object(Kn.d)(e).getOrElse(function(){return!1})?this.renderGrid():this.renderSlider()}}]),t}(d.Component);Jn=Gn([m.autobind,Yn("design:paramtypes",[Object])],Jn);var Qn=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueFileList}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(k.isEqual)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.authToken,t.authToken)}})(Object(X.a)(Jn)),Xn=n(1516),Zn=n(241),er=n.n(Zn),tr=n(243),nr=n.n(tr),rr=n(242),or=n.n(rr),ir=n(261),ar=n.n(ir),lr=n(324),ur=n.n(lr),cr=n(420),sr=(n(1561),n(1808)),pr=n.n(sr),fr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hr={color:ur.a[500]},mr=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r={};return n.props.value.getOrElse(function(){return new E.ValueFileList([])}).files.forEach(function(e){return r[e.value]=!1}),n.state={imageFetching:r,dialog:{open:!1,actions:[],title:new k.None,body:new k.None}},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.value,n=Object(Xn.a)(t.getOrElse(function(){return new E.ValueFileList([])}).files.map(function(e){return[e.value,!1]}));this.setState(K(this.state,{imageFetching:{$set:n}}))}},{key:"handleDialogClose",value:function(){this.setState(K(this.state,{dialog:{$set:K(this.state.dialog,{open:{$set:!1}})}}))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.setState(K(this.state,{dialog:{$set:{open:!0,title:new k.Some(e),body:new k.Some(t),actions:n||[]}}}))}},{key:"getImageSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Un.b)(n,e,t.props.cdnAddress)}).getOrElse(function(){throw"token has not been provided"})}},{key:"onImageLoad",value:function(e){var t=this.state.imageFetching;t[e.value]=!1,this.setState(K(this.state,{imageFetching:{$set:t}}))}},{key:"uploadImage",value:function(e,t){var n=this;Object(Cn.h)(e,this.props.cdnAddress,this.props.authToken,this.props.organisation.organisationId,this.props.eventLine.eventLineId,this.props.formRecordId,new k.None,"false",!0,Object(k.toOption)(this.props.output.formField),Object(k.toOption)(this.props.formId),t).then(function(e){n.props.formRecordId.matchWith(function(e){Object(Cn.f)(n.props.formId,e,n.props.output.formField).then(function(e){n.props.onChange(new E.ValueFileList(e.list.map(function(e){return e.id})),n.props.output),n.handleDialogClose()})},function(){var r=n.props.value.getOrElse(function(){return new E.ValueFileList([])}),o=r;t.map(function(t){var n=r.files.indexOf(t);o=K(r,{files:{$splice:[[n,1],[n,0,e]]}})}).getOrElse(function(){o.files.push(e)}),n.props.onChange(o,n.props.output),n.handleDialogClose()})}).catch(function(e){n.props.dispatch(Object(wn.h)(n.props.i18n.t("Во время загрузки файла произошла ошибка")))})}},{key:"onPhotoEditRequested",value:function(e){var t=this,n=this.props.value.getOrElse(function(){return new E.ValueFileList([])});this.openDialog(this.props.i18n.t("Редактирование фотографии"),d.createElement(cr.b,{src:e.flatMap(function(e){return Object(k.toOption)(t.getImageSrc(e))}),onClose:this.handleDialogClose,onFileChange:function(e){},onFileCreate:function(e){},onSave:function(n){t.uploadImage(n,e)},onDelete:function(){e.foreach(function(e){Object(Cn.a)(e).then(function(r){t.showNotification("Файл успешно удален"),t.props.onChange(K(n,{files:{$set:n.files.filter(function(t){return t.value!==e.value})}}),t.props.output)}).catch(function(e){return t.showNotification("Во время удаления файла произошла ошибка")}),t.handleDialogClose()})},defaultSrc:new k.None,recommendedAspectRatios:[],recommendedSizes:[],allowedFormats:Object(Sn.a)(this.props.display.control).getOrElse(function(){return"image/*"})}),[])}},{key:"showNotification",value:function(e){this.props.dispatch(Object(wn.h)(this.props.i18n.t(e)))}},{key:"render",value:function(){var e=this,t=this.props.value.getOrElse(function(){return new E.ValueFileList([])}),n=this.props.display.control.map(function(e){return e.disabled}).getOrElse(function(){return!1});return d.createElement("div",{className:"ImageListControlEditor__container"},t.files.map(function(t){return d.createElement("div",{key:t.value},e.state.imageFetching[t.value]&&d.createElement("div",{className:"ImageListControlEditor__image-loader"},d.createElement(pn.a,{style:{position:"absolute",top:"50%",left:"50%"}})),d.createElement("div",{className:"ImageListControlEditor__imageContainer"},d.createElement("img",{className:"ImageListControlEditor__image",style:{display:e.state.imageFetching[t.value]?"none":""},src:e.getImageSrc(t),onLoad:function(){return e.onImageLoad(t)},onClick:function(){return e.onPhotoEditRequested(Object(k.toOption)(t))}})))}),0===t.files.length&&d.createElement("p",null,this.props.i18n.t("Галерея пуста")),d.createElement("div",{className:"ImageListControlEditor__imageContainer",key:"new",onClick:function(){return e.onPhotoEditRequested(new k.None)}},d.createElement(jn.a,{disabled:n},d.createElement(pr.a,{className:"ImageListControlEditor__image-addButton"}))),this.props.error.map(function(e){return d.createElement("p",{style:hr},e)}).getOrNull(),d.createElement(er.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose},d.createElement(ar.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),d.createElement(nr.a,{style:{borderTop:"none"}},this.state.dialog.actions),d.createElement(or.a,null,this.state.dialog.body.getOrElse(function(){return d.createElement("div",null)}))))}}]),t}(d.Component);mr=fr([m.autobind,dr("design:paramtypes",[Object])],mr);var gr=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueFileList}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.fileMetas===t.fileMetas},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)&&Object(k.isEqual)(e.authToken,t.authToken)&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&Object(k.isEqual)(e.formRecordId,t.formRecordId)}})(mr),yr=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Qn,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(gr,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,formId:this.props.formId,output:this.props.output,onChange:this.props.onChange}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(I.a),br=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)&&Object(k.isEqual)(e.formRecordId,e.formRecordId)}})(yr),vr=n(52),Or=n.n(vr),Er=(n(1563),n(1470)),kr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},jr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Cr=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={imageFetching:!0,photoHeight:0,photoWidth:0},n}return s()(t,e),a()(t,[{key:"getImageSrc",value:function(){var e=this;return this.props.value.flatMap(function(e){return Object(k.headOption)(e.files)}).flatMap(function(t){return e.props.authToken.map(function(n){return Object(Un.b)(n,t,e.props.cdnAddress)})}).getOrElse(function(){return e.isPhotoDisplayElement()?e.props.display.control.map(function(t){return e.props.dispatch(Object(Er.b)(t))}).getOrElse(function(){return n(622)}):n(854)})}},{key:"isValueEmpty",value:function(){return this.props.value.flatMap(function(e){return Object(k.headOption)(e.files)}).isEmpty()}},{key:"onImageLoad",value:function(e){this.setState(K(this.state,{imageFetching:{$set:!1},photoHeight:{$set:e.target.naturalHeight},photoWidth:{$set:e.target.naturalWidth}}))}},{key:"isRightAspectRatio",value:function(){var e=this;return this.props.display.control.filter(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.enabled}).map(function(e){return e.settings.aspectRatio.width/e.settings.aspectRatio.height}).matchWith(function(t){var n=e.state.photoWidth/e.state.photoHeight-t;return n<=.01&&n>=-.01},function(){return!0})}},{key:"isHighlightError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.highlightError}).nonEmpty()}},{key:"isShowError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.showError}).nonEmpty()}},{key:"isPhotoDisplayElement",value:function(){return this.props.display.control.map(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this.props.display.elementCss,t=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),n=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),r=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxWidth})}),o=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minWidth})}),i=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxHeight})}),a=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minHeight})});return d.createElement("div",{className:"ImageControlDisplay__container"},this.state.imageFetching&&d.createElement("div",{className:"ImageControlDisplay__image-loader"},d.createElement(pn.a,{style:{position:"absolute",top:"50%",left:"50%"}})),d.createElement("div",{className:"ImageControlDisplay__imageWrapper"},d.createElement("img",{className:"ImageControlDisplay__image",style:{display:this.state.imageFetching?"none":"inline-block",width:t.getOrElse(function(){return"auto"}),height:n.getOrElse(function(){return"auto"}),maxWidth:r.getOrElse(function(){return"none"}),minWidth:o.getOrElse(function(){return"none"}),maxHeight:i.getOrElse(function(){return"none"}),minHeight:a.getOrElse(function(){return"none"})},src:this.getImageSrc(),onLoad:this.onImageLoad}),!this.state.imageFetching&&!this.isValueEmpty()&&!this.isRightAspectRatio()&&this.isHighlightError()&&d.createElement("div",{className:"ImageControlDisplay__highlightError"})),!this.state.imageFetching&&!this.isValueEmpty()&&!this.isRightAspectRatio()&&this.isShowError()&&d.createElement(Or.a,{color:"error",align:"center"},this.props.i18n.t("Неверное соотношение")))}}]),t}(d.Component);Cr=kr([m.autobind,jr("design:paramtypes",[Object])],Cr);var Rr=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueFileList}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(k.isEqual)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.authToken,t.authToken)}})(Cr),wr=n(86),Ir=n.n(wr),Sr=n(631),Pr=n.n(Sr),Tr=n(414),xr=n.n(Tr),_r=n(1623),Dr=n.n(_r),Fr=(n(1565),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Mr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Wr=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={imageError:!1,imageFetching:n.getLoadingInitialState(e.value),value:e.value,src:n.getImageSrc(e.value),photoHeight:0,photoWidth:0,windowWidth:window.innerWidth,windowHeight:window.innerHeight},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onWindowResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"onWindowResize",value:function(){this.setState(K(this.state,{windowWidth:{$set:window.innerWidth},windowHeight:{$set:window.innerHeight}}))}},{key:"componentWillReceiveProps",value:function(e){if(!Object(k.isEqual)(this.state.value,e.value)){var t=e.value;this.state.value.flatMap(function(e){return Object(k.headOption)(e.files)}).flatMap(function(e){return t.flatMap(function(e){return Object(k.headOption)(e.files)}).map(function(t){return t.value!==e.value})}).getOrElse(function(){return!0})&&this.setState(K(this.state,{imageFetching:{$set:this.getLoadingInitialState(t)},imageError:{$set:!1},value:{$set:t},src:{$set:this.getImageSrc(t)}}))}}},{key:"getImageSrc",value:function(e){var t=this;return e.flatMap(function(e){switch(e.tpe){case E.ValueFileList.$Type:return Object(k.headOption)(e.files).flatMap(function(e){return t.props.authToken.map(function(n){return Object(Un.b)(n,e,t.props.cdnAddress)})});default:return new k.None}})}},{key:"getLoadingInitialState",value:function(e){return e.map(function(e){switch(e.tpe){case E.ValueFileList.$Type:return 0!==e.files.length;default:return!1}}).getOrElse(function(){return!1})}},{key:"onChange",value:function(e){var t=this;this.props.formRecordId.matchWith(function(e){Object(Cn.f)(t.props.formId,e,t.props.output.formField).then(function(e){return Object(k.headOption)(e.list).matchWith(function(e){var n=new E.ValueFileList([e.id]);t.props.onChange(n,t.props.output),t.props.dispatch(Object(U.I)({blockRendererId:t.props.blockRendererId,value:n}))},function(){t.props.onChange(new E.ValueFileList([]),t.props.output),t.props.dispatch(Object(U.I)({blockRendererId:t.props.blockRendererId,value:new E.ValueFileList([])}))})})},function(){t.props.onChange(e,t.props.output)})}},{key:"onImageLoad",value:function(e){this.setState(K(this.state,{imageFetching:{$set:!1},photoHeight:{$set:e.target.naturalHeight},photoWidth:{$set:e.target.naturalWidth}}))}},{key:"onImageError",value:function(){this.setState(K(this.state,{imageError:{$set:!0},imageFetching:{$set:!1}}))}},{key:"uploadImage",value:function(e,t){var n=this;Object(Cn.h)(e,this.props.cdnAddress,this.props.authToken,this.props.organisation.organisationId,this.props.eventLine.eventLineId,this.props.formRecordId,new k.None,"false",!1,Object(k.toOption)(this.props.output.formField),Object(k.toOption)(this.props.formId)).then(function(e){n.onChange(new E.ValueFileList([e])),n.props.handleDialogClose(t)}).catch(function(e){n.props.dispatch(Object(wn.h)(n.props.i18n.t("Во время загрузки файла произошла ошибка")))})}},{key:"onPhotoEditRequested",value:function(){var e=this;this.props.value;if(this.props.control.settings.operations.edtitng)var t=this.props.openDialog("",d.createElement(cr.b,{src:this.state.src.filter(function(t){return!e.state.imageError}),onClose:function(){return e.props.handleDialogClose(t)},onFileChange:function(e){},onFileCreate:function(e){},onSave:function(n){return function(t,n){e.uploadImage(t,n)}(n,t)},onDelete:function(){return function(t){e.handleDelete(),e.props.handleDialogClose(t)}(t)},aspectRatio:this.props.control.settings.aspectRatio.enabled?this.props.control.settings.aspectRatio.width/this.props.control.settings.aspectRatio.height:void 0,cropAndSave:this.props.control.settings.operations.cropAndSave,reduceSize:this.props.control.settings.reduceSize,defaultSrc:this.props.dispatch(Object(Er.b)(this.props.control)),recommendedAspectRatios:[],recommendedSizes:[],allowedFormats:Object(Sn.a)(Object(k.toOption)(this.props.control)).getOrElse(function(){return"image/*"})}),[],{fullScreen:this.state.windowWidth<cr.a,hideTitle:!0})}},{key:"onUploadFileRequested",value:function(){var e=this;if(this.props.control.settings.operations.edtitng)var t=this.props.openDialog(this.props.i18n.t("Загрузка фотографии"),d.createElement(Rn,{onDrop:function(n){return function(t,n){if(0===t.length)throw"There are not files to process";var r=t[t.length-1];Object(Cn.h)(r,e.props.cdnAddress,e.props.authToken,e.props.organisation.organisationId,e.props.eventLine.eventLineId,e.props.formRecordId,new k.None,"false",!1,Object(k.toOption)(e.props.output.formField),Object(k.toOption)(e.props.formId)).then(function(t){e.props.value.flatMap(function(e){return Object(k.headOption)(e.files)}).foreach(function(t){return e.deleteFile(t)}),e.onChange(new E.ValueFileList([t]))}).catch(function(t){e.props.dispatch(Object(wn.h)(e.props.i18n.t("Во время загрузки файла произошла ошибка")))}),e.props.handleDialogClose(n)}(n,t)},multiple:!0,accept:Object(Sn.a)(Object(k.toOption)(this.props.control)).getOrElse(function(){return"image/*"}),className:"FileListControlEditor__dropzone"},function(t){var n=t.isDragActive;return d.createElement("div",{className:n?"FileListControlEditor__dropzone-wrapper":""},d.createElement("div",{className:"FileListControlEditor__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),[])}},{key:"handleDelete",value:function(){var e=this;this.props.control.settings.operations.deleting&&this.props.value.flatMap(function(e){return Object(k.headOption)(e.files)}).foreach(function(t){return e.deleteFile(t).then(function(t){return e.onChange(new E.ValueFileList([]))})})}},{key:"handleImageModalClosed",value:function(){this.setState(K(this.state,{modalDialogOpen:{$set:!1}}))}},{key:"deleteFile",value:function(e){var t=this;return Object(Cn.a)(e).then(function(e){t.showNotification("Фото успешно удалено")}).catch(function(e){return t.showNotification("Во время удаления фото произошла ошибка")})}},{key:"showNotification",value:function(e){this.props.dispatch(Object(wn.h)(this.props.i18n.t(e)))}},{key:"openFullScreenDialog",value:function(){var e=this,t=this.props.openDialog("",d.createElement("div",{className:"ImageControlEditor__imageDialog-wrapper",onClick:function(){return e.props.handleDialogClose(t)}},d.createElement("div",{className:"ImageControlEditor__imageDialog-container"},d.createElement("img",{className:"ImageControlEditor__imageDialog-image",src:this.state.src.getOrElse(function(){return e.props.dispatch(Object(Er.b)(e.props.control)).getOrElse(function(){return n(622)})})}))),[],{fullScreen:!0})}},{key:"openFullScreenMode",value:function(){var e=this;this.props.display.control.filter(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).matchWith(function(t){return Object(k.toOption)(t.settings.ui.fullScreen).filter(function(e){return e}).foreach(function(){return e.openFullScreenDialog()})},function(){return e.openFullScreenDialog()})}},{key:"isRightAspectRatio",value:function(){var e=this;return this.props.display.control.filter(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.enabled}).map(function(e){return e.settings.aspectRatio.width/e.settings.aspectRatio.height}).matchWith(function(t){var n=e.state.photoWidth/e.state.photoHeight-t;return n<=.01&&n>=-.01},function(){return!0})}},{key:"isHighlightError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.highlightError}).nonEmpty()}},{key:"isShowError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===E.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.showError}).nonEmpty()}},{key:"render",value:function(){var e=this,t=this.props.control.settings.operations.edtitng,r=this.state.src.nonEmpty()&&this.props.control.settings.operations.deleting,o=this.props.display.elementCss,i=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),a=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),l=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxWidth})}),u=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minWidth})}),c=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxHeight})}),s=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minHeight})}),p=this.props.display.control.map(function(e){return e.disabled}).getOrElse(function(){return!1}),f=this.props.display.control.flatMap(function(e){return e.settings.ui.editButtonColor}).getOrElse(function(){return"#fff"});return d.createElement("div",{className:"ImageControlEditor__container"},d.createElement("div",{className:"ImageControlEditor__wrapper"},this.state.imageFetching&&d.createElement("div",{className:"ImageControlEditor__image-loader"},d.createElement(pn.a,{style:{position:"absolute",top:"50%",left:"50%"}})),this.state.imageError&&d.createElement("div",{className:"ImageControlEditor__imageWrapper"},d.createElement("div",{className:"ImageControlEditor__image-error"},d.createElement("div",{style:{position:"absolute",display:"inline-block",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"red",textAlign:"center"}},this.props.i18n.t("При загрузке произошла ошибка")))),(t||r)&&d.createElement("div",{className:"ImageControlEditor__image-buttonsBar"},t&&d.createElement(Dr.a,{style:{width:40,height:40,backgroundColor:f},disabled:p,onClick:this.props.control.settings.operations.simpleEditing?this.onUploadFileRequested:this.onPhotoEditRequested},this.state.src.isEmpty()?d.createElement(Pr.a,null):d.createElement(Ir.a,null)),r&&d.createElement(Dr.a,{style:{width:40,height:40,marginLeft:10,backgroundColor:f},disabled:p,onClick:this.handleDelete},d.createElement(xr.a,null))),!this.state.imageError&&d.createElement("div",{className:"ImageControlEditor__imageWrapper",onClick:this.openFullScreenMode},d.createElement("img",{className:"ImageControlEditor__image",style:{display:this.state.imageFetching?"none":"inline-block",width:i.getOrElse(function(){return"auto"}),height:a.getOrElse(function(){return"auto"}),maxWidth:l.getOrElse(function(){return"none"}),minWidth:u.getOrElse(function(){return"none"}),maxHeight:c.getOrElse(function(){return"none"}),minHeight:s.getOrElse(function(){return"none"})},src:this.state.src.getOrElse(function(){return e.props.dispatch(Object(Er.b)(e.props.control)).getOrElse(function(){return n(622)})}),onLoad:this.onImageLoad,onError:this.onImageError}),!this.state.imageFetching&&this.state.src.nonEmpty()&&!this.isRightAspectRatio()&&this.isHighlightError()&&d.createElement("div",{className:"ImageControlEditor__highlightError"})),(t||r)&&d.createElement("div",{className:"ImageControlEditor__image-buttonsBar"},t&&d.createElement(Dr.a,{style:{width:40,height:40,backgroundColor:f},disabled:p,onClick:this.props.control.settings.operations.simpleEditing?this.onUploadFileRequested:this.onPhotoEditRequested},this.state.src.isEmpty()?d.createElement(Pr.a,null):d.createElement(Ir.a,null)),r&&d.createElement(Dr.a,{style:{width:40,height:40,marginLeft:10,backgroundColor:f},disabled:p,onClick:this.handleDelete},d.createElement(xr.a,null))),!this.state.imageFetching&&this.state.src.nonEmpty()&&!this.isRightAspectRatio()&&this.isShowError()&&d.createElement(Or.a,{color:"error",align:"center"},this.props.i18n.t("Неверное соотношение"))),d.createElement(Q.a,{display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}}]),t}(d.Component);Wr=Fr([m.autobind,Mr("design:paramtypes",[Object])],Wr);var Br=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueFileList}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.fileMetas===t.fileMetas},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)&&Object(k.isEqual)(e.authToken,t.authToken)&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.formRecordId,t.formRecordId)}})(Object(X.a)(Wr)),Lr=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Rr,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Br,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,output:this.props.output,formId:this.props.formId,control:this.props.control,blockStyle:this.props.blockStyle,onChange:this.props.onChange}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(I.a),Ar=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)&&Object(k.isEqual)(e.formRecordId,e.formRecordId)}})(Lr),$r=n(1472),Vr=n.n($r),qr=n(538),Nr=n.n(qr),zr=n(545),Hr=n.n(zr),Ur=n(541),Kr=(n(1567),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Gr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Yr=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fetching:!0,result:{}},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.fetchUsers(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(ve.a)(this.props.value,e.value)||this.fetchUsers(e)}},{key:"fetchUsers",value:function(e){var t=this;e.value.map(function(n){t.setState(K(t.state,{fetching:{$set:!0}})),e.dispatch(Object(Ur.a)()).then(function(e){t.setState(K(t.state,{fetching:{$set:!1},result:{$set:Object(Xn.a)(e.map(function(e){return[e.id.toString(),e]}))}}))})}).getOrElse(function(){return t.setState(K(t.state,{fetching:{$set:!1}}))})}},{key:"render",value:function(){var e=this;if(this.state.fetching)return d.createElement(pn.a,null);var t=this.props.value.getOrElse(function(){return new E.ValueUserRefs([])});return d.createElement("div",{className:"UsersControlDisplay__container"},t.refs.map(function(t){return Object(k.toOption)(e.state.result[t.id.value]).map(function(n){return d.createElement(Vr.a,{key:t.id.value,label:n.name,className:"UsersControlDisplay__chip",avatar:n.avatarId.flatMap(function(t){return e.props.authToken.map(function(n){return d.createElement(Nr.a,{src:Object(Un.b)(n,new E.Id(t.toString()),e.props.cdnAddress)})})}).getOrElse(function(){return d.createElement(Nr.a,null,d.createElement(Hr.a,null))})})}).getOrNull()}))}}]),t}(d.Component);Yr=Kr([m.autobind,Gr("design:paramtypes",[Object])],Yr);var Jr=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueUserRefs}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(ve.a)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(ve.a)(e.value,t.value)&&Object(ve.a)(e.authToken,t.authToken)}})(Yr),Qr=n(34),Xr=n.n(Qr),Zr=n(24),eo=n.n(Zr),to=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},no=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ro={flex:"1"},oo={smallAvatar:{width:30,height:30}},io=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fetching:!1,error:new k.None,userDescriptions:[]},n}return s()(t,e),a()(t,[{key:"onChange",value:function(e){this.props.onChange(new E.ValueUserRefs("EMPTY"===e.target.value?[]:[new E.EntityRef(E.Id.createId(e.target.value).getOrElse(function(){throw"wrong user id"}),E.User.$Type.value)]),this.props.output)}},{key:"onMultipleChange",value:function(e){var t=this;Object(k.toOption)(e.target.value).filter(function(e){return e instanceof Array}).matchWith(function(e){t.props.onChange(new E.ValueUserRefs(e.map(function(e){return new E.EntityRef(E.Id.createId(e).getOrElse(function(){throw"wrong user id"}),E.User.$Type.value)})),t.props.output)},function(){throw"wrong user refs value type"})}},{key:"componentDidMount",value:function(){this.fetchUsers(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(k.isEqual)(this.props.value,e.value)||this.fetchUsers(e)}},{key:"fetchUsers",value:function(e){var t=this;this.setState(K(this.state,{fetching:{$set:!0},error:{$set:new k.None},userDescriptions:{$set:[]}}),function(){e.dispatch(Object(Ur.a)()).then(function(e){t.setState(K(t.state,{fetching:{$set:!1},error:{$set:new k.None},userDescriptions:{$set:e}}))}).catch(function(e){t.setState(K(t.state,{fetching:{$set:!1},error:{$set:Object(k.toOption)(e)},userDescriptions:{$set:[]}}))})})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(){Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(d.Fragment,null,d.createElement(Xr.a,null,Object(oe.e)(this.props.display.label.text)),this.renderSelect()),this.props.error)}},{key:"renderWithFixTitle",value:function(){Object(Pe.b)(this.props.display.elementCss,this.props.error);return d.createElement(S.a,{display:this.props.display,style:ro,blockStyle:this.props.blockStyle},this.wrapControl(this.renderSelect(),this.props.error))}},{key:"renderMaterialTheme",value:function(e){return e.floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}},{key:"renderSelect",value:function(){return this.props.control.multiple?this.renderMultipleSelect():this.renderSingleSelect()}},{key:"renderSingleSelect",value:function(){var e=this;return d.createElement(V.a,{fullWidth:!0,value:this.props.value.flatMap(function(e){return Object(k.headOption)(e.refs)}).map(function(e){return e.id.value}).getOrElse(function(){return""}),onChange:this.onChange,onBlur:this.onBlur,SelectDisplayProps:{style:{display:"flex",alignItems:"center"}}},d.createElement(eo.a,{value:"EMPTY",key:"empty"}),this.state.userDescriptions.map(function(t){return d.createElement(eo.a,{value:t.id,key:t.id},t.avatarId.flatMap(function(e){return E.Id.createId(e.toString())}).flatMap(function(t){return e.props.token.map(function(n){return Object(Un.b)(n,t,e.props.cdnAddress)})}).matchWith(function(e){return d.createElement(Nr.a,{style:oo.smallAvatar,alt:t.name,src:e})},function(){return d.createElement(Nr.a,{style:oo.smallAvatar},d.createElement(Hr.a,null))}),d.createElement(vn.a,{primary:t.name,secondary:null}))}))}},{key:"renderMultipleSelected",value:function(e){var t=this;return Object(k.toOption)(e).filter(function(e){return e instanceof Array}).matchWith(function(e){return d.createElement("div",null,t.state.userDescriptions.filter(function(t){return e.filter(function(e){return e===t.id}).length>0}).map(function(e){return d.createElement(Vr.a,{key:e.id,label:e.name,style:{marginRight:"5px"},avatar:e.avatarId.flatMap(function(e){return E.Id.createId(e.toString())}).flatMap(function(e){return t.props.token.map(function(n){return Object(Un.b)(n,e,t.props.cdnAddress)})}).matchWith(function(t){return d.createElement(Nr.a,{alt:e.name,src:t})},function(){return d.createElement(Nr.a,null,d.createElement(Hr.a,null))})})}))},function(){return d.createElement(d.Fragment,null)})}},{key:"renderMultipleSelect",value:function(){var e=this;return d.createElement(V.a,{fullWidth:!0,multiple:!0,value:this.props.value.map(function(e){return e.refs.map(function(e){return e.id.value})}).getOrElse(function(){return[]}),onChange:this.onMultipleChange,onBlur:this.onBlur,SelectDisplayProps:{style:{display:"flex",alignItems:"center"}},renderValue:this.renderMultipleSelected},this.state.userDescriptions.map(function(t){return d.createElement(eo.a,{value:t.id,key:t.id},t.avatarId.flatMap(function(e){return E.Id.createId(e.toString())}).flatMap(function(t){return e.props.token.map(function(n){return Object(Un.b)(n,t,e.props.cdnAddress)})}).matchWith(function(e){return d.createElement(Nr.a,{style:oo.smallAvatar,alt:t.name,src:e})},function(){return d.createElement(Nr.a,{style:oo.smallAvatar},d.createElement(Hr.a,null))}),d.createElement(vn.a,{primary:t.name,secondary:null}))}))}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return this.renderMaterialTheme(e)}}]),t}(d.Component);io=to([m.autobind,no("design:paramtypes",[Object])],io);var ao=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueUserRefs}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),token:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(k.isEqual)(e.auth.token,e.auth.token)},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)&&Object(k.isEqual)(e.token,t.token)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(io),lo=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Jr,{blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return this.props.control.usersSource instanceof E.UsersSourceTypeUserState?d.createElement("div",null):d.createElement(ao,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(I.a),uo=function(e){e.dispatch(Object(de.j)(e.blockRendererId,e.output))},co=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialValues:Object(w.h)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([uo],[function(e,t){Object(k.isEqual)(e.initialValues,t.initialValues)||uo(e)}])(lo)),so=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},po=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fo={flex:"1"},ho=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.areValuesEqual=function(e,t){return e.flatMap(function(e){return t.map(function(t){return Object(ve.a)(e,t)})}).getOrElse(function(){return!1})},n.state={textFieldTouched:!1},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});!this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})&&t.checked&&(this.state.textFieldTouched||(this.props.onChange(new E.ValueStr(t.value.getOrElse(function(){return""})),this.props.output),this.setState(K(this.state,{$set:{textFieldTouched:!0}}))))}},{key:"onChange",value:function(e){this.props.onChange(new E.ValueStr(e.target.value),this.props.output)}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0,style:{marginTop:0}},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){return d.createElement(B.a,{type:"password",fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),helperText:t.checked&&t.value,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,InputProps:{style:{color:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})===e.value.map(function(e){return e}).getOrElse(function(){return""})&&e.checked?"#757575":"black"}}})}},{key:"renderWithFixTitle",value:function(e,t){return d.createElement(S.a,{display:this.props.display,style:fo,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(B.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),type:"password",onChange:this.onChange,helperText:t.checked&&t.value,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,InputProps:{style:{color:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})===e.value.map(function(e){return e}).getOrElse(function(){return""})&&e.checked?"#757575":"black"}}}),this.props.error))}},{key:"renderClassicTheme",value:function(e){return this.wrapControl(d.createElement(Ie.a,{type:"password",titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}),this.props.error)}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new E.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);ho=so([m.autobind,po("design:paramtypes",[Object])],ho);var mo=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueStr}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(ho),go=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement("div",null)}},{key:"renderEditControl",value:function(){return d.createElement(mo,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),yo=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(go),bo=n(1514),vo=n.n(bo),Oo=n(1515),Eo=n.n(Oo),ko=n(1525),jo=n.n(ko),Co=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display,r=this.props.display.elementCss,o=r.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),i=r.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),a=t.control.getOrElse(function(){return new E.ElementControlTextField}),l=Object(Pe.b)(t.elementCss,new k.None);return d.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:"white"}},d.createElement(vo.a,{cellHeight:245,style:{width:o.getOrElse(function(){return"auto"}),height:i.getOrElse(function(){return"500px"})},cols:a.columns},this.props.dataInput.flatMap(function(t){return t.valueType.tpe===E.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(k.toOption)([]):e.props.value.map(function(r){var o=function(e,t,n){return t.id.map(function(t){return Object(k.headOption)(e.formRecords.filter(function(e){return e.id.value===t.value})).flatMap(function(e){return n.flatMap(function(t){return Object(k.liftKey)(e.entity.values,t.value).flatMap(function(e){return Object(k.headOption)(e.value.files)})})})})}(t,r,a.imageFieldId).map(function(t){return t.map(function(t){return e.props.dispatch(Object(Er.a)(t)).getOrElse(function(){return n(854)})}).getOrElse(function(){return n(854)})});switch(r.tpe.value){case E.ValueObjectRefs.$Type.value:return x(t,r,function(e,t){return d.createElement(Eo.a,{key:t},d.createElement("img",{src:Object(k.lift)(o,t).getOrElse(function(){return n(854)}),alt:e}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:l}},e)}))},e.props.i18n.t);case E.ValueList.$Type.value:return r.values.map(function(e,t){return d.createElement(Eo.a,{key:t},d.createElement("img",{src:Object(k.lift)(o,t).getOrElse(function(){return n(854)}),alt:e.toString()}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:l}},e.toString())}))});case E.ValueBool.$Type.value:return[d.createElement(Eo.a,null,d.createElement("img",{src:n(854)}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:l}},r.toString())}))];default:return[d.createElement(Eo.a,null,d.createElement("img",{src:n(854),alt:e.props.i18n.t("Неизвестный тип значения")}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:l}},e.props.i18n.t("Неизвестный тип значения"))}))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]})))}}]),t}(d.Component),Ro=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueList||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(Co),wo=n(1809),Io=n.n(wo),So=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Po=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},To=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={search:new k.None},n}return s()(t,e),a()(t,[{key:"onValueObjectRefCheckBoxChange",value:function(e){var t=this.props.value.map(function(e){return e.id}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.value===e.value}).length>0;return new E.ValueObjectRefs(n?[].concat(M()(t.filter(function(t){return t.value!==e.value}))):[].concat(M()(t),[e]))}},{key:"onValueListChange",value:function(e){var t=this.props.value.map(function(e){return e.values}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.toString()===e.toString()}).length>0;return new E.ValueList(n?[].concat(M()(t.filter(function(t){return t!==e}))):[].concat(M()(t),[e]))}},{key:"onValueBoolChange",value:function(){return this.props.value.map(function(e){return e.value}).getOrElse(function(){return!1})?new E.ValueEmpty:new E.ValueBool(!0)}},{key:"renderCheckBoxes",value:function(){var e=this,t=Object(Pe.b)(this.props.display.elementCss,this.props.error);return this.props.dataInput.map(function(r){var o=e.props.display.control.getOrElse(function(){return new E.ElementControlTextField}).imageFieldId.map(function(t){return r.formRecords.map(function(r){return Object(k.liftKey)(r.entity.values,t.value).filter(function(e){return e.value instanceof E.ValueFileList}).flatMap(function(t){return Object(k.headOption)(t.value.files).map(function(t){return e.props.dispatch(Object(Er.a)(t)).getOrElse(function(){return n(854)})})}).getOrElse(function(){return n(854)})})}).getOrElse(function(){return[]});switch(r.valueType.tpe.value){case E.ValueTypeValuesList.$Type.value:return r.value.values.map(function(r,i){return d.createElement(Eo.a,{key:i,style:{cursor:"pointer"},onClick:function(t){return e.props.onChange(e.onValueListChange(r),e.props.output)}},Object(k.headOption)(e.props.value.map(function(e){return e instanceof E.ValueList?e.values:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof E.ValueStr&&e.value===r.value})).nonEmpty()&&d.createElement(Io.a,{style:{fill:"#4285f4",position:"absolute",right:0}}),"}",d.createElement("img",{src:Object(k.lift)(o,i).getOrElse(function(){return n(854)}),alt:r.toString()}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:t}},r.toString())}))});case E.ValueTypeObjectRefs.$Type.value:return r.displayValues.map(function(r,i){return d.createElement(Eo.a,{key:i,style:{cursor:"pointer"},onClick:function(t){return e.props.onChange(e.onValueObjectRefCheckBoxChange(r.id),e.props.output)}},Object(k.headOption)(e.props.value.map(function(e){return e instanceof E.ValueObjectRefs?e.id:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof E.Id&&e.value===r.id.value})).nonEmpty()&&d.createElement(Io.a,{style:{fill:"#4285f4",position:"absolute",right:0,zIndex:10}}),d.createElement("img",{src:Object(k.lift)(o,i).getOrElse(function(){return n(854)}),alt:r.value.toString()}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:t}},r.value.toString())}))});case E.ValueTypeBool.$Type.value:return[d.createElement(Eo.a,{style:{cursor:"pointer"},onClick:function(t){return e.props.onChange(e.onValueBoolChange(),e.props.output)}},e.props.value.map(function(e){return e instanceof E.ValueBool&&e.value}).getOrElse(function(){return!1})&&d.createElement(Io.a,{style:{fill:"#4285f4",position:"absolute",right:0}}),d.createElement("img",{src:n(854),alt:e.props.i18n.t("Значение")}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:t}},e.props.i18n.t("Значение"))}))];default:throw"Unknown value type"}}).getOrElse(function(){return[d.createElement("div",null,e.props.i18n.t("Значения отсутствуют"))]})}},{key:"render",value:function(){var e=this.props.display,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),r=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),o=e.control.getOrElse(function(){return new E.ElementControlTextField});return d.createElement(S.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:"white"}},d.createElement(vo.a,{cellHeight:245,style:{width:n.getOrElse(function(){return"auto"}),height:r.getOrElse(function(){return"500px"})},cols:o.columns},this.renderCheckBoxes())),d.createElement(Q.a,{display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}}]),t}(d.Component);To=So([m.autobind,Po("design:paramtypes",[Object])],To);var xo=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueList||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&Object(k.isEqual)(e.error,t.error)&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(To),_o=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Ro,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(xo,{display:e.props.display,blockRendererId:e.props.blockRendererId,control:e.props.control,input:t,output:e.props.output,onControlBlur:e.props.onControlBlur,blockStyle:e.props.blockStyle,onChange:e.props.onChange})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),Do=function(e){e.dispatch(Object(de.e)(e.blockRendererId,e.display,e.formId))},Fo=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(w.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([Do],[function(e,t){Object(k.isEqual)(e.initialDictionaries,t.initialDictionaries)&&Do(e)}],[],[],function(e,t){return!function(e,t){return e.formId.value===t.formId.value&&Object(k.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur}(e,t)&&e.i18n!==t.i18n})(_o)),Mo=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.control.timeZoneOffset;return this.props.value.map(function(t){var n=new Date(t.value.getTime()-6e4*(e-t.value.getTimezoneOffset()));return d.createElement("span",null,n.toLocaleTimeString().slice(0,5))}).getOrElse(function(){return d.createElement("span",null)})}}]),t}(d.Component),Wo=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueDate})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(Mo),Bo=n(657),Lo=n.n(Bo),Ao=n(1810),$o=n.n(Ao),Vo=n(162),qo=n.n(Vo),No=n(23),zo=function(e){return d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement("div",{style:{flex:1}},d.cloneElement(e.children,{InputProps:{endAdornment:d.createElement(qo.a,{position:"end"},d.createElement(jn.a,{style:{flexShrink:0},onClick:function(t){t.stopPropagation(),Object(No.toOption)(e.displayType).filter(function(e){return e instanceof E.DisplayTypeEditByClick}).matchWith(function(){return e.dispatch(Object(U.L)({blockRendererId:e.blockRendererId,output:e.output,value:new E.ValueEmpty,displayId:e.displayId}))},function(){return e.dispatch(Object(U.D)({blockRendererId:e.blockRendererId,output:e.output,value:new E.ValueEmpty,displayId:e.displayId}))})}},d.createElement($o.a,null)))}})))},Ho=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Uo=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getControl",value:function(){return this.props.display.control.map(function(e){return e})}},{key:"onChange",value:function(e){this.props.onChange(new E.ValueDate(e.getTime()+6e4*(this.props.control.timeZoneOffset-e.getTimezoneOffset())),this.props.output)}},{key:"onInputChange",value:function(e){var t=this;Object(k.toOption)(e.target.value).filter(function(e){return""===e}).foreach(function(){return t.props.onChange(new E.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getDate",value:function(){var e=this;return this.props.value.map(function(t){return new Date(t.value.getTime()-6e4*(e.props.control.timeZoneOffset-t.value.getTimezoneOffset()))}).getOrNull()}},{key:"getViews",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.views}).getOrElse(function(){return[]})}},{key:"getViewsAttr",value:function(){return this.getViews().length>0?{views:this.getViews()}:{}}},{key:"getOpenTo",value:function(){return this.getViews().length>0?{openTo:Object(k.headOption)(this.getViews()).getOrElse(function(){return"year"})}:{}}},{key:"isMaskEnabled",value:function(){return this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.map(function(e){return e.checked})}).getOrElse(function(){return!1})}},{key:"getMask",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.mask})}).getOrElse(function(){return""}).split(",").map(function(e){var t=Object(Oe.a)(e),n=Object(k.headOption)(t).getOrElse(function(){return""}),r=Object(k.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return this.isMaskEnabled()?{mask:e}:{}}},{key:"getPlaceholder",value:function(){return this.isMaskEnabled()?{placeholder:this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.placeholderChar})}).getOrElse(function(){return""})}:{}}},{key:"getFormat",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.format});return e.isEmpty()?{}:{format:e.getOrElse(function(){return"HH:mm"})}}},{key:"getTimePicker",value:function(e){var t=this.getControl().map(function(e){return e.pickerAttributes.inline}).getOrElse(function(){return!1})?Bo.InlineTimePicker:Lo.a;return d.createElement(t,Object.assign({fullWidth:!0,error:this.props.error.nonEmpty(),variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),keyboard:this.getControl().map(function(e){return e.pickerAttributes.keyboard}).getOrElse(function(){return!1}),ampm:this.getControl().map(function(e){return e.pickerAttributes.ampm}).getOrElse(function(){return!1}),minutesStep:this.getControl().flatMap(function(e){return e.pickerAttributes.minutesStep}).getOrElse(function(){return 5}),value:this.getDate(),onChange:this.onChange,onInputChange:this.onInputChange,onBlur:this.onBlur},this.getMask(),this.getPlaceholder(),this.getFormat(),e?{label:Object(oe.e)(this.props.display.label.text)}:{},{invalidDateMessage:this.props.i18n.t("Неверный формат даты")}))}},{key:"getClearButtonStatus",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.hideClearButton}).getOrElse(function(){return!1})}},{key:"wrapByClearButton",value:function(e){return d.createElement(zo,{dispatch:this.props.dispatch,output:this.props.output,displayId:this.props.display.id,blockRendererId:this.props.blockRendererId,displayType:this.props.control.displayType},e)}},{key:"renderWithFloatingTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getTimePicker(!0);return d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFixTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getTimePicker(!1);return d.createElement(S.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))}},{key:"render",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle}).floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}}]),t}(d.Component);Uo=Ho([m.autobind],Uo);var Ko=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueDate}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(Uo),Go=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Wo,{control:this.props.control,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(Ko,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),Yo=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(Go),Jo=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.control.timeZoneOffset;return this.props.value.map(function(t){var n=new Date(t.value.getTime()-6e4*(e-t.value.getTimezoneOffset()));return d.createElement("span",null,n.toLocaleDateString())}).getOrElse(function(){return d.createElement("span",null)})}}]),t}(d.Component),Qo=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueDate})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(Jo),Xo=n(165),Zo=n(378),ei=n.n(Zo),ti=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ni=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getControl",value:function(){return this.props.display.control.map(function(e){return e})}},{key:"onChange",value:function(e){this.props.onChange(new E.ValueDate(e.getTime()+6e4*(this.props.control.timeZoneOffset-e.getTimezoneOffset())),this.props.output)}},{key:"onInputChange",value:function(e){var t=this;Object(k.toOption)(e.target.value).filter(function(e){return""===e}).foreach(function(){return t.props.onChange(new E.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getDate",value:function(){var e=this;return this.props.value.map(function(t){return new Date(t.value.getTime()-6e4*(e.props.control.timeZoneOffset-t.value.getTimezoneOffset()))}).getOrNull()}},{key:"getMinMaxDateValue",value:function(e){return e.map(function(e){return new Date(e.value.getTime())}).getOrNull()}},{key:"getMaxDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.maxDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{maxDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getMinDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.minDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{minDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getViews",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.views}).getOrElse(function(){return[]})}},{key:"getViewsAttr",value:function(){return this.getViews().length>0?{views:this.getViews()}:{}}},{key:"getOpenTo",value:function(){return this.getViews().length>0?{openTo:Object(k.headOption)(this.getViews()).getOrElse(function(){return"year"})}:{}}},{key:"isMaskEnabled",value:function(){return this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.map(function(e){return e.checked})}).getOrElse(function(){return!1})}},{key:"getMask",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.mask})}).getOrElse(function(){return""}).split(",").map(function(e){var t=Object(Oe.a)(e),n=Object(k.headOption)(t).getOrElse(function(){return""}),r=Object(k.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return this.isMaskEnabled()?{mask:e}:{}}},{key:"getPlaceholder",value:function(){return this.isMaskEnabled()?{placeholder:this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.placeholderChar})}).getOrElse(function(){return""})}:{}}},{key:"getFormat",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.format});return e.isEmpty()?{}:{format:e.getOrElse(function(){return"YYYY/MM/DD"})}}},{key:"getMaxDateForMessage",value:function(){return this.getDisableFuture()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.maxDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getMinDateForMessage",value:function(){return this.getDisablePast()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.minDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getDisableFuture",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disableFuture}).getOrElse(function(){return!1})}},{key:"getDisablePast",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disablePast}).getOrElse(function(){return!1})}},{key:"getDatePicker",value:function(e){var t=this.getControl().map(function(e){return e.pickerAttributes.inline}).getOrElse(function(){return!1})?Zo.InlineDatePicker:ei.a;return d.createElement(t,Object.assign({fullWidth:!0,error:this.props.error.nonEmpty(),variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),keyboard:this.getControl().map(function(e){return e.pickerAttributes.keyboard}).getOrElse(function(){return!1}),disableFuture:this.getDisableFuture(),disablePast:this.getDisablePast(),value:this.getDate(),onChange:this.onChange,onInputChange:this.onInputChange,onBlur:this.onBlur},this.getMaxDate(),this.getMinDate(),this.getViewsAttr(),this.getOpenTo(),this.getFormat(),this.getMask(),this.getPlaceholder(),e?{label:Object(oe.e)(this.props.display.label.text)}:{},{invalidDateMessage:this.props.i18n.t("Неверный формат даты"),maxDateMessage:this.props.i18n.t("Дата должна быть не более")+" "+this.getMaxDateForMessage(),minDateMessage:this.props.i18n.t("Дата должна быть не менее")+" "+this.getMinDateForMessage()}))}},{key:"getClearButtonStatus",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.hideClearButton}).getOrElse(function(){return!1})}},{key:"wrapByClearButton",value:function(e){return d.createElement(zo,{dispatch:this.props.dispatch,output:this.props.output,displayId:this.props.display.id,blockRendererId:this.props.blockRendererId,displayType:this.props.control.displayType},e)}},{key:"renderWithFloatingTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDatePicker(!0);return d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFixTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDatePicker(!1);return d.createElement(S.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))}},{key:"render",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle}).floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}}]),t}(d.Component);ni=ti([m.autobind],ni);var ri=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueDate}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(ni),oi=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Qo,{control:this.props.control,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(ri,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),ii=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(oi),ai=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.control.timeZoneOffset;return this.props.value.map(function(t){var n=new Date(t.value.getTime()-6e4*(e-t.value.getTimezoneOffset()));return d.createElement("span",null,n.toLocaleDateString()+" "+n.toLocaleTimeString())}).getOrElse(function(){return d.createElement("span",null)})}}]),t}(d.Component),li=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueDate})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(ai),ui=n(656),ci=n.n(ui),si=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},pi=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getControl",value:function(){return this.props.display.control.map(function(e){return e})}},{key:"onChange",value:function(e){this.props.onChange(new E.ValueDate(e.getTime()+6e4*(this.props.control.timeZoneOffset-e.getTimezoneOffset())),this.props.output)}},{key:"onInputChange",value:function(e){var t=this;Object(k.toOption)(e.target.value).filter(function(e){return""===e}).foreach(function(){return t.props.onChange(new E.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getDate",value:function(){var e=this;return this.props.value.map(function(t){return new Date(t.value.getTime()-6e4*(e.props.control.timeZoneOffset-t.value.getTimezoneOffset()))}).getOrNull()}},{key:"getMinMaxDateValue",value:function(e){return e.map(function(e){return new Date(e.value.getTime())}).getOrNull()}},{key:"getMaxDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.maxDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{maxDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getMinDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.minDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{minDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getViews",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.views}).getOrElse(function(){return[]})}},{key:"getViewsAttr",value:function(){return this.getViews().length>0?{views:this.getViews()}:{}}},{key:"getOpenTo",value:function(){return this.getViews().length>0?{openTo:Object(k.headOption)(this.getViews()).getOrElse(function(){return"year"})}:{}}},{key:"isMaskEnabled",value:function(){return this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.map(function(e){return e.checked})}).getOrElse(function(){return!1})}},{key:"getMask",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.mask})}).getOrElse(function(){return""}).split(",").map(function(e){var t=Object(Oe.a)(e),n=Object(k.headOption)(t).getOrElse(function(){return""}),r=Object(k.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return this.isMaskEnabled()?{mask:e}:{}}},{key:"getPlaceholder",value:function(){return this.isMaskEnabled()?{placeholder:this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.placeholderChar})}).getOrElse(function(){return""})}:{}}},{key:"getFormat",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.format});return e.isEmpty()?{}:{format:e.getOrElse(function(){return"YYYY/MM/DD HH:mm"})}}},{key:"getMaxDateForMessage",value:function(){return this.getDisableFuture()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.maxDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getMinDateForMessage",value:function(){return this.getDisablePast()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.minDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getDisableFuture",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disableFuture}).getOrElse(function(){return!1})}},{key:"getDisablePast",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disablePast}).getOrElse(function(){return!1})}},{key:"getDateTimePicker",value:function(e){var t=this.getControl().map(function(e){return e.pickerAttributes.inline}).getOrElse(function(){return!1})?ui.InlineDateTimePicker:ci.a;return d.createElement(t,Object.assign({fullWidth:!0,error:this.props.error.nonEmpty(),variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),keyboard:this.getControl().map(function(e){return e.pickerAttributes.keyboard}).getOrElse(function(){return!1}),disableFuture:this.getDisableFuture(),disablePast:this.getDisablePast(),ampm:this.getControl().map(function(e){return e.pickerAttributes.ampm}).getOrElse(function(){return!1}),minutesStep:this.getControl().flatMap(function(e){return e.pickerAttributes.minutesStep}).getOrElse(function(){return 5}),value:this.getDate(),onChange:this.onChange,onInputChange:this.onInputChange,onBlur:this.onBlur},this.getMaxDate(),this.getMinDate(),this.getViewsAttr(),this.getOpenTo(),this.getMask(),this.getPlaceholder(),this.getFormat(),e?{label:Object(oe.e)(this.props.display.label.text)}:{},{invalidDateMessage:this.props.i18n.t("Неверный формат даты"),maxDateMessage:this.props.i18n.t("Дата должна быть не более")+" "+this.getMaxDateForMessage(),minDateMessage:this.props.i18n.t("Дата должна быть не менее")+" "+this.getMinDateForMessage()}))}},{key:"getClearButtonStatus",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.hideClearButton}).getOrElse(function(){return!1})}},{key:"wrapByClearButton",value:function(e){return d.createElement(zo,{dispatch:this.props.dispatch,output:this.props.output,displayId:this.props.display.id,blockRendererId:this.props.blockRendererId,displayType:this.props.control.displayType},e)}},{key:"renderWithFloatingTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDateTimePicker(!0);return d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFixTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDateTimePicker(!1);return d.createElement(S.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))}},{key:"render",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle}).floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}}]),t}(d.Component);pi=si([m.autobind],pi);var fi=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueDate}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(pi),di=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(li,{control:this.props.control,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(fi,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),hi=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(di),mi=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getValue",value:function(e){var t=this.props.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new E.IntervalInputTypeUnitType(new E.TimeUnitMinutes)});switch(t.tpe.value){case E.IntervalInputTypeUnitType.$Type.value:var n=t.timeUnit;return d.createElement("span",null,e.map(function(e){return Object(C.V)(e,n)}).getOrNull());case E.IntervalInputTypeStringType.$Type.value:return d.createElement("span",null,e.map(function(e){return Object(C.R)(e.value.getMilliseconds())}).getOrNull())}}},{key:"render",value:function(){return this.getValue(this.props.value)}}]),t}(d.Component),gi=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueInterval})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)}})(mi),yi=n(1811),bi=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},vi=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Oi={flex:"1"},Ei=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:n.initiateStateValue(e)},n}return s()(t,e),a()(t,[{key:"initiateStateValue",value:function(e){var t=e.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new E.IntervalInputTypeUnitType(new E.TimeUnitMinutes)});switch(t.tpe.value){case E.IntervalInputTypeUnitType.$Type.value:var n=t.timeUnit;return e.value.map(function(e){return Object(C.V)(e,n)});case E.IntervalInputTypeStringType.$Type.value:return e.value.map(function(e){return Object(C.R)(e.value.getMilliseconds())})}}},{key:"onValueChange",value:function(e){var t=this;this.setState(K(this.state,{value:{$set:Object(k.toOption)(e.target.value)}}),function(){return t.onChange(t.state.value)})}},{key:"onChange",value:function(e){if(e.isEmpty()||e.map(function(e){return""===e}).getOrElse(function(){return!1}))return this.props.onChange(new E.ValueEmpty,this.props.output);var t=this.props.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new E.IntervalInputTypeUnitType(new E.TimeUnitMinutes)});switch(t.tpe.value){case E.IntervalInputTypeUnitType.$Type.value:var n=t.timeUnit;this.props.onChange(new E.ValueInterval(new E.Duration(parseInt(e.getOrElse(function(){return""})),Object(C.Z)(n)).duration),this.props.output);break;case E.IntervalInputTypeStringType.$Type.value:this.props.onChange(new E.ValueInterval(1e6*yi(e.getOrElse(function(){return"0ms"}))),this.props.output)}}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControlError",value:function(e){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Q.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"wrapControlTitle",value:function(e){return d.createElement(S.a,{display:this.props.display,style:Oi,blockStyle:this.props.blockStyle},e)}},{key:"getTextField",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new E.ElementOptionalValue}),t=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new E.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle}),r=this.props.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new E.IntervalInputTypeUnitType(new E.TimeUnitMinutes)});return d.createElement(B.a,Object.assign({fullWidth:!0,onChange:this.onValueChange},n.floating?{label:Object(oe.e)(this.props.display.label.text)}:{},{variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),helperText:e.checked&&e.value,value:this.state.value.getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===E.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,InputProps:{style:{color:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})===t.value.map(function(e){return e}).getOrElse(function(){return""})&&t.checked?"#757575":"black"},endAdornment:d.createElement(qo.a,{position:"end"},r instanceof E.IntervalInputTypeUnitType?Object(C.U)(r.timeUnit.tpe.value,this.props.i18n.t):"")}}))}},{key:"renderClassicTheme",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle});return this.wrapControlError(d.createElement(Ie.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}))}},{key:"renderMaterialTheme",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new E.ElementTitle}).floating?this.wrapControlError(this.getTextField()):this.wrapControlTitle(this.wrapControlError(this.getTextField()))}},{key:"render",value:function(){return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme():Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme()}}]),t}(d.Component);Ei=bi([m.autobind,vi("design:paramtypes",[Object])],Ei);var ki=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof E.ValueInterval}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(k.isEqual)(e.blockStyle,t.blockStyle)}})(Ei),ji=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(S.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(gi,{display:this.props.display,output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(ki,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(P.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(I.a),Ci=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(k.isEqual)(e.blockStyle,e.blockStyle)}})(ji),Ri=n(1492),wi=n(1508),Ii=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Si=function(e){function t(){o()(this,t);var e=u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.temp=new E.ValueEmpty,e}return s()(t,e),a()(t,[{key:"onChange",value:function(e,t){var n=this;this.temp=e,setTimeout(function(){e===n.temp&&n.props.onChange(e,t)},100)}},{key:"renderControlElement",value:function(e,t){this.props.isDisabled&&(e=Object.assign({},e,{disabled:!0}));var r=this.props.block.flatMap(function(e){return e.entity.ui.blockStyle});switch(e.tpe.value){case E.ElementControlTextField.$Type.value:return d.createElement(Ve,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlValueListField.$Type.value:return d.createElement(at,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlMoneyField.$Type.value:return d.createElement(mt,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlNumberField.$Type.value:return d.createElement(Ct,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlHtmlField.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onChange:this.onChange,onControlBlur:this.props.onControlBlur,blockStyle:r},load:function(){return n.e(69).then(n.bind(null,2736))}});case E.ElementControlIntervalField.$Type.value:return d.createElement(Ci,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlTextArea.$Type.value:return d.createElement(Ft,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlSelect.$Type.value:return d.createElement(ye,{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,parentRecordId:this.props.parentRecordId,blockRendererId:this.props.blockRendererId,control:e,output:t,formId:Object(k.toOption)(this.props.formId),onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlRadioBoxes.$Type.value:return d.createElement(Yt,{display:this.props.display,blockType:this.props.blockType,formId:Object(k.toOption)(this.props.formId),blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlCheckBoxes.$Type.value:return d.createElement(cn,{display:this.props.display,blockType:this.props.blockType,formId:Object(k.toOption)(this.props.formId),blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlTime.$Type.value:return d.createElement(Yo,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlDate.$Type.value:return d.createElement(ii,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlDateTime.$Type.value:return d.createElement(hi,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlGeoLocation.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onChange:this.onChange,onControlBlur:this.props.onControlBlur,blockStyle:r},load:function(){return Promise.all([n.e(38),n.e(65)]).then(n.bind(null,2730))}});case E.ElementControlPhoto.$Type.value:return d.createElement(Ar,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,control:e,output:t,formId:this.props.formId,onChange:this.onChange,blockStyle:r});case E.ElementControlImageList.$Type.value:return d.createElement(br,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,formId:this.props.formId,control:e,onChange:this.onChange,output:t,blockStyle:r});case E.ElementControlUsersField.$Type.value:return d.createElement(co,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,onControlBlur:this.props.onControlBlur,onChange:this.onChange,control:e,output:t,blockStyle:r});case E.ElementControlFileList.$Type.value:return d.createElement(Mn,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,formId:this.props.formId,onChange:this.onChange,control:e,output:t,blockStyle:r});case E.ElementControlObjRefsTable.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,formId:this.props.formId,parentRecordId:this.props.parentRecordId,getBlockComponent:this.props.getBlockComponent,blockStyle:r},load:function(){return n.e(49).then(n.bind(null,2729))}});case E.ElementControlColor.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onChange:this.onChange,onControlBlur:this.props.onControlBlur,blockStyle:r},load:function(){return n.e(67).then(n.bind(null,2749))}});case E.ElementControlTagsList.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,formId:this.props.formId,parentRecordId:this.props.parentRecordId,getBlockComponent:this.props.getBlockComponent,blockStyle:r},load:function(){return n.e(60).then(n.bind(null,2739))}});case E.ElementControlPasswordField.$Type.value:return d.createElement(yo,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlAdvancedCheckBoxes.$Type.value:return d.createElement(Fo,{display:this.props.display,blockType:this.props.blockType,formId:this.props.formId,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case E.ElementControlPdf.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,control:e,output:t,formId:this.props.formId,onChange:this.onChange,blockStyle:r},load:function(){return Promise.all([n.e(15),n.e(52)]).then(n.bind(null,2738))}});case E.ElementControlRatingField.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r},load:function(){return Promise.all([n.e(9),n.e(10)]).then(n.bind(null,2737))}});case E.ElementControlCalendar.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,parentRecordId:this.props.parentRecordId,blockRendererId:this.props.blockRendererId,control:e,output:t,formId:Object(k.toOption)(this.props.formId),onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r},load:function(){return Promise.all([n.e(9),n.e(10)]).then(n.bind(null,2737))}});default:throw"Unknown element control display type"}}},{key:"getStyleByControl",value:function(e){var t=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new E.ElementProportions});switch(e.map(function(e){return e.tpe.value}).getOrElse(function(){return""})){case E.ElementControlPhoto.$Type.value:case E.ElementControlPdf.$Type.value:return{flex:t.width.map(function(e){return"auto"===e?"0 0 auto":"0 0 "+e}).getOrElse(function(){return"0 0 auto"})};default:return{flex:t.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}}}},{key:"render",value:function(){var e=this;if(!this.props.isVisible)return null;var t=this.props.display.control,n=this.props.display.dataOutput;return d.createElement("div",{id:this.props.display.id.value,className:Object(C.B)(this.props.display,"container"),style:Object.assign({},this.props.style,this.getStyleByControl(t))},t.map(function(t){return n.map(function(n){return e.renderControlElement(t,n)}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Поле данных не указано"))})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Контрол не указан"))}))}}]),t}(d.Component);Si=Ii([m.autobind],Si);var Pi=Object(h.connect)(function(e,t){return{block:Object(b.b)(e.block,t.blockId),isVisible:!t.display.hidden&&t.display.control.filter(function(e){return e.displayType.tpe.value===E.DisplayTypeByBlockSchemaType.$Type.value&&t.blockType.tpe.value===E.WebRegistrationBlockTypeDisplay.$Type.value}).flatMap(function(n){return Object(b.b)(e.block,t.blockId).filter(function(e){return e.entity.hideEmpty}).flatMap(function(n){return t.display.dataOutput.flatMap(function(n){var r=Object(w.g)(e.blockRendererContext,t.blockRendererId,n.formField);return r.isEmpty()?Object(k.toOption)(new E.ValueStr("")):r})}).map(function(e){return Object(Ri.b)(e)})}).getOrElse(function(){return!0})&&Object(Ri.c)(t.fieldId,Object(k.toOption)(t.formId),e.user.userRole).getOrElse(function(){return!1}),isDisabled:!Object(Ri.a)(t.fieldId,Object(k.toOption)(t.formId),e.user.userRole).getOrElse(function(){return!0}),i18n:e.i18n,initialValues:Object(w.h)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{onControlBlur:function(){setTimeout(function(){e(Object(wi.a)(t.display,t.blockRendererId,t.blockId))},100)},onChange:function(n,r){e(Object(U.D)({output:r,value:n,blockRendererId:t.blockRendererId,displayId:t.display.id}))},dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.isVisible===t.isVisible&&e.isDisabled===t.isDisabled&&e.i18n===t.i18n&&Object(k.isEqual)(e.block,t.block)&&Object(k.isEqual)(e.initialValues,t.initialValues)}})(Object(fe.a)([function(e){return e.dispatch(Object(de.h)(e.blockRendererId,e.display,e.formId))}],[function(e,t){Object(k.isEqual)(e.initialValues,t.initialValues)||e.dispatch(Object(de.h)(e.blockRendererId,e.display,e.formId))}],[],[function(e){e.dispatch(Object(de.a)(e.blockRendererId,e.display))}])(Si)),Ti=n(856),xi=n.n(Ti),_i=n(857),Di=n.n(_i),Fi=n(1487),Mi=n(1488),Wi=n(1479),Bi=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={selectedIndex:0},n}return s()(t,e),a()(t,[{key:"onSelected",value:function(e){this.setState(K(this.state,{selectedIndex:{$set:e}}))}},{key:"getMuiColorType",value:function(e){switch(e){case"primary":return{indicatorColor:"primary",textColor:"primary"};case"secondary":return{indicatorColor:"secondary",textColor:"secondary"};case"custom":default:return{indicatorColor:"primary",textColor:"primary"}}}},{key:"render",value:function(){var e=this,t=Object(C.n)(this.props.display),n=this.props.display.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}),r=n.flatMap(function(e){return e.color}).getOrElse(function(){return"primary"});return this.props.display.tabsPosition.tpe.value===E.TabsPositionTop.$Type.value?d.createElement("div",{className:"TabsWidget__container "+t+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(Di.a,Object.assign({fullWidth:!0,onChange:function(t,n){return e.onSelected(n)},value:this.state.selectedIndex},this.getMuiColorType(r)),this.props.components.filter(function(e){return e.position>=0}).map(function(e,t){return d.createElement(xi.a,{key:e.id.value,value:t,label:e.label.text})})),d.createElement(Wi.a,null,Object(k.lift)(this.props.children,this.state.selectedIndex).getOrElse(function(){return[]}))):this.props.display.tabsPosition.tpe.value!==E.TabsPositionTop.$Type.value?d.createElement("div",{className:"TabsWidget__container "+t+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(Mi.a,Object.assign({tabsPosition:this.props.display.tabsPosition},this.props.display.tabsPosition.tpe.value===E.TabsPositionRight.$Type.value?{tabItemContainerOnRight:!0}:{},this.props.display.tabsPosition.tpe.value===E.TabsPositionRight.$Type.value||this.props.display.tabsPosition.tpe.value===E.TabsPositionLeft.$Type.value?{tabItemContainerStyle:{flex:"0 0 auto",width:this.props.display.tabsPosition.tabsWidth.getOrElse(function(){return"auto"})}}:{},{menuTopChildren:this.props.menuTopChildren,menuBottomChildren:this.props.menuBottomChildren}),this.props.components.map(function(t,r){return d.createElement(Fi.a,{key:t.id.value,value:r,label:t.label.text,tabsPosition:e.props.display.tabsPosition,elementMuiTheme:n},Object(k.lift)(e.props.children,r).getOrElse(function(){return[]}))}))):d.createElement("div",null,"Tabs loading error")}}]),t}(d.Component),Li=Object(h.connect)(function(e,t){return{}})(Bi),Ai=n(1607),$i=n.n(Ai),Vi=n(1608),qi=n.n(Vi),Ni=n(1609),zi=n.n(Ni),Hi=n(1466),Ui=n(143),Ki=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Gi=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Yi=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={stepIndex:0,completedSteps:[0]},n}return s()(t,e),a()(t,[{key:"onStepChange",value:function(e){if(this.props.display.validationRules.length>0&&!Object(Ui.a)(this.state.completedSteps,e)){var t=this.state.completedSteps.concat(e);this.props.components.length===t.length&&this.props.dispatch(Object(U.A)({displayId:this.props.display.id,blockRendererId:this.props.blockRendererId})),this.setState(K(this.state,{completedSteps:{$set:t}}))}this.setState(K(this.state,{stepIndex:{$set:e}}))}},{key:"onPrevStep",value:function(){this.state.stepIndex>0&&this.onStepChange(this.state.stepIndex-1)}},{key:"onNextStep",value:function(){var e=this,t=this.props.blockRendererId;this.props.dispatch(Object(U.F)({blockRendererId:t,displayId:this.props.display.id,error:""})),this.props.dispatch(Object(Hi.h)(this.props.blockId,t,this.props.display,this.state.stepIndex)).then(function(){e.state.stepIndex<e.props.components.length-1&&e.onStepChange(e.state.stepIndex+1)}).catch(function(n){e.props.dispatch(Object(U.F)({blockRendererId:t,displayId:e.props.display.id,error:Object(k.headOption)(e.props.display.validationRules).map(function(e){return e.message}).getOrElse(function(){return e.props.i18n.t("Ошибка валидации в одном из элементов")})}))})}},{key:"render",value:function(){var e=this,t=Object(j.a)(this.props.components,"position"),n=Object(k.toOption)(this.props.children[this.state.stepIndex]),r=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new E.ElementFonts}).titleFont.map(function(e){return e.color}).getOrElse(function(){return"#000"}),o=this.props.error,i=Object(C.n)(this.props.display);return d.createElement("div",{className:"StepperWidget__container "+i+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement($i.a,{activeStep:this.state.stepIndex},t.map(function(t,n){return d.createElement(qi.a,null,d.createElement(zi.a,{onClick:function(){return e.onStepChange(n)}},d.createElement("p",{style:{color:r}},t.label.text)))})),n.getOrNull(),d.createElement("div",{style:{marginTop:12}},d.createElement(A.a,{disabled:0===this.state.stepIndex,onClick:this.onPrevStep,style:{marginRight:12}},this.props.i18n.t("Назад")),d.createElement(A.a,{disabled:this.state.stepIndex===this.props.components.length-1,color:"primary",onClick:this.onNextStep},this.props.i18n.t("Далее")),o.nonEmpty()&&d.createElement("span",{style:{color:"red",padding:"5px"}},o.getOrElse(function(){return""}))))}}]),t}(d.Component);Yi=Ki([m.autobind,Gi("design:paramtypes",[Object])],Yi);var Ji=Object(h.connect)(function(e,t){return{i18n:e.i18n,error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Yi),Qi=n(640),Xi=n(639),Zi=n(1502),ea=n(1541),ta=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getBarcodeElements",value:function(e){return e.map(function(e){return e.pages.map(function(e){return e.elements.filter(function(e){return e.display instanceof E.DocumentElementDisplayBarcode})}).reduce(function(e,t){return e.concat(t)},[])}).getOrElse(function(){return[]})}},{key:"getAssignBarcodeElements",value:function(e){return this.getBarcodeElements(e).filter(function(e){return e.display.config.filter(function(e){return e.barcodeProviderType.tpe.value===E.BarcodeProviderTypeAssignment.$Type.value}).nonEmpty()})}},{key:"onDocumentPrintClick",value:function(e){var t=this;this.props.formRecord.map(function(n){return t.props.dispatch(Object(Zi.a)(t.props,n.id,e,!0))}).foreach(function(n){n.then(function(n){n.foreach(function(n){t.props.dispatch(function(e,t){return function(n,r){return Object(k.toOption)(e.entity.issueType).filter(function(e){return e.tpe.value===E.IssueTypePrint.$Type.value}).foreach(function(){r().user.terminal.foreach(function(e){return Object(k.headOption)(r().terminals.list.filter(function(t){return t.id.value===e.value})).filter(function(e){return"WEB"===e.entity.name||e.entity.printer.isEmpty()||!!e.entity.savePdf}).foreach(function(e){t.fileId.foreach(function(e){return r().auth.token.map(function(t){return Object(fn.b)(e,t,r().config.cdnAddress)})})})})})}}(e,n)),t.fetchFormDataDocumentRecords(n)})})})}},{key:"fetchFormDataDocumentRecords",value:function(e){var t=this;this.props.formRecord.foreach(function(n){t.props.documentLogFormField.foreach(function(r){t.props.dispatch(Object(ea.b)(r.entity.valueType.family,t.props.document.id,n.id,Object(k.liftKey)(n.entity.values,r.id.value).matchWith(function(t){return t.value.id.concat([e.docId])},function(){return[e.docId]})))})})}},{key:"getDocumentIssueStatus",value:function(e){switch(e.issueType.tpe){case E.IssueTypeEmail.$Type:return this.props.i18n.t("Уже отправлен");case E.IssueTypePrint.$Type:return this.props.i18n.t("Уже распечатан");case E.IssueTypeVirtual.$Type:return this.props.i18n.t("Уже выдан");default:return this.props.i18n.t("Статус выдачи неизвестен")}}},{key:"getDocumentActionName",value:function(e){switch(e.issueType.tpe){case E.IssueTypeEmail.$Type:return this.props.i18n.t("Выслать");case E.IssueTypePrint.$Type:return this.props.i18n.t("Распечатать");case E.IssueTypeVirtual.$Type:return this.props.i18n.t("Выдать");default:return this.props.i18n.t("Действие неизвестно")}}},{key:"getStatusElement",value:function(e){var t=this;return this.props.documentRecords.flatMap(function(n){return t.props.documentFormField.map(function(t){return n.filter(function(n){return Object(k.liftKey)(n.entity.values,t.id.value).filter(function(t){return t.value.toString()===e.id.value}).nonEmpty()}).length})}).filter(function(e){return e>0}).map(function(n){return d.createElement("div",{style:{padding:"5px 15px 5px 15px"}},d.createElement(A.a,{variant:"raised",fullWidth:!0,color:"secondary",style:{backgroundColor:"#f44336"}},t.getDocumentIssueStatus(e.entity)+" ("+n+")"))})}},{key:"render",value:function(){var e=this,t=this.props.document,n=this.getStatusElement(t);return d.createElement("div",{style:{padding:"5px"},key:t.id.value},d.createElement("div",{style:{backgroundColor:t.entity.color,padding:"5px"}},d.createElement("div",{style:{textAlign:"center",textTransform:"uppercase",color:t.entity.fontColor}},t.entity.name),n.getOrNull(),d.createElement("div",{style:{padding:"5px 15px 5px 15px"}},d.createElement(A.a,{variant:"raised",fullWidth:!0,disabled:this.props.secondPrintDisabled&&n.nonEmpty(),onClick:function(){return e.onDocumentPrintClick(t)}},this.getDocumentActionName(t.entity)))))}}]),t}(d.Component),na=function(e){e.formRecord.foreach(function(t){e.documentLogFormField.foreach(function(n){Object(k.liftKey)(t.entity.values,n.id.value).foreach(function(r){e.dispatch(Object(ea.a)(n.entity.valueType.family,e.document.id,t.id,r.value.id))})})})},ra=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(w.d)(e.blockRendererContext,t.blockRendererId),documentFormField:t.document.entity.logParams.refId.filter(function(e){return t.document.entity.logParams.enabled}).flatMap(function(n){return Object(H.d)(e,t.document.entity.form,n)}).filter(function(e){return e.entity.valueType.tpe.value===E.ValueTypeObjectRefs.$Type.value}).flatMap(function(t){return Object(H.g)(e,t.entity.valueType.family)}).flatMap(function(e){return Object(k.headOption)(e.filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===E.ValueTagDocumentId.$Type.value}).getOrElse(function(){return!1})}))}),documentLogFormField:t.document.entity.logParams.refId.filter(function(e){return t.document.entity.logParams.enabled}).flatMap(function(n){return Object(H.d)(e,t.document.entity.form,n)}).filter(function(e){return e.entity.valueType.tpe.value===E.ValueTypeObjectRefs.$Type.value}),documentRecords:Object(w.d)(e.blockRendererContext,t.blockRendererId).flatMap(function(n){return Object(Xi.b)(e.documentRecords,n.id,t.document.id)}),secondPrintDisabled:e.user.userRole.flatMap(function(n){return Object(w.d)(e.blockRendererContext,t.blockRendererId).map(function(e){return n.entity.getSecondDocumentPrintDisallow(e.entity.formId,t.document.id)})}).getOrElse(function(){return!1})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.user===t.user&&e.documentRecords===t.documentRecords&&e.fields===t.fields},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(k.isEqual)(e.documentFormField,t.documentFormField)&&Object(k.isEqual)(e.documentLogFormField,t.documentLogFormField)&&Object(k.isEqual)(e.documentRecords,t.documentRecords)&&e.secondPrintDisabled===t.secondPrintDisabled}})(Object(fe.a)([na],[function(e,t){Object(k.isEqual)(e.formRecord,t.formRecord)||na(e),Object(k.isEqual)(e.formRecord,t.formRecord)&&e.isTokenChecked&&!e.isTokenChecked&&na(e)}])(Object(X.a)(ta))),oa=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",{style:this.props.style},d.createElement(tn.a,null,this.props.documents.map(function(t){return d.createElement(ra,{key:t.id.value,blockRendererId:e.props.blockRendererId,document:t})})))}}]),t}(d.Component),ia=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(oa),aa=n(1477),la=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ua=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:{display:"flex",flex:"1"}},this.props.isDocumentsFetching?d.createElement(pn.a,null):d.createElement(ia,{blockRendererId:this.props.blockRendererId,style:this.props.style,documents:this.props.documents.getOrElse(function(){return[]})}))}}]),t}(d.Component);ua=la([m.autobind],ua);var ca=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(aa.e)(t.entity.formId,t.id))})},sa=Object(h.connect)(function(e,t){var n=Object(w.d)(e.blockRendererContext,t.blockRendererId);return{i18n:e.i18n,formRecord:n,documents:n.flatMap(function(t){return Object(Qi.b)(e.formDataDocuments,t.id).map(function(n){return n.filter(function(n){return e.user.userRole.map(function(e){return!e.entity.isDocumentRestricted(t.entity.formId,n.id)}).getOrElse(function(){return!1})})})}),isDocumentsFetching:n.map(function(t){return Object(Qi.e)(e.formDataDocuments,t.id)}).getOrElse(function(){return!1}),isDocumentsFetched:n.map(function(t){return Object(Qi.d)(e.formDataDocuments,t.id)}).getOrElse(function(){return!1}),dataOutput:e.dataOutput}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext&&e.formDataDocuments===t.formDataDocuments},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.documents,t.documents)&&e.isDocumentsFetching===t.isDocumentsFetching&&e.i18n===t.i18n&&e.isDocumentsFetched===t.isDocumentsFetched}})(Object(fe.a)([function(e){e.formRecord.foreach(function(t){e.dispatch(Object(Zi.b)(t.entity.formId,t.id))})}],[function(e,t){var n=Object(k.liftKey)(e.dataOutput,e.blockRendererId),r=Object(k.liftKey)(t.dataOutput,t.blockRendererId);Object(k.isEqual)(n.flatMap(function(e){return e.lastSilentSavedValue}),r.flatMap(function(e){return e.lastSilentSavedValue}))||ca(e),Object(k.isEqual)(e.formRecord,t.formRecord)||ca(e),Object(k.isEqual)(e.formRecord,t.formRecord)&&e.isTokenChecked&&!t.isTokenChecked&&ca(e)}])(ua)),pa=n(1475),fa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},da=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getStyle",value:function(){var e=this,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.background}).getOrElse(function(){return new E.ElementBackground}),r=n.file.enabled?n.file.fileId.flatMap(function(t){return e.props.authToken.map(function(n){return Object(Un.b)(n,t,e.props.cdnAddress)})}).map(function(e){return'url("'+e+'")'}).getOrElse(function(){return"none"}):"none";return Object.assign({},{backgroundColor:n.color,backgroundImage:r,backgroundSize:"cover",display:"flex",flexDirection:"column",borderTop:Object(pa.d)(t).getOrElse(function(){return"0"}),borderRight:Object(pa.c)(t).getOrElse(function(){return"0"}),borderBottom:Object(pa.a)(t).getOrElse(function(){return"0"}),borderLeft:Object(pa.b)(t).getOrElse(function(){return"0"}),boxShadow:Object(pa.e)(t)},this.props.style)}},{key:"render",value:function(){var e=Object(C.n)(this.props.display);return d.createElement("div",{className:e,style:this.getStyle()},this.props.components)}}]),t}(d.Component);da=fa([m.autobind],da);var ha=Object(h.connect)(function(e,t){return{authToken:e.auth.token,cdnAddress:e.config.cdnAddress}})(da),ma=(n(1569),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),ga=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getStyle",value:function(){var e=this,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.background}).getOrElse(function(){return new E.ElementBackground}),r=n.file.enabled?n.file.fileId.flatMap(function(t){return e.props.authToken.map(function(n){return Object(Un.b)(n,t,e.props.cdnAddress)})}).map(function(e){return'url("'+e+'")'}).getOrElse(function(){return"none"}):"none";return Object.assign({},this.props.style,{display:"flex",flexDirection:"row",backgroundColor:n.color,backgroundImage:r,backgroundSize:"cover",borderTop:Object(pa.d)(t).getOrElse(function(){return"0"}),borderRight:Object(pa.c)(t).getOrElse(function(){return"0"}),borderBottom:Object(pa.a)(t).getOrElse(function(){return"0"}),borderLeft:Object(pa.b)(t).getOrElse(function(){return"0"}),boxShadow:Object(pa.e)(t)})}},{key:"render",value:function(){return d.createElement("div",{style:this.getStyle(),className:"GroupDisplay__container "+Object(C.n)(this.props.display)},this.props.components)}}]),t}(d.Component);ga=ma([m.autobind],ga);var ya=Object(h.connect)(function(e){return{authToken:e.auth.token,cdnAddress:e.config.cdnAddress}})(ga),ba=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display.elementCss,r=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),o=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),i=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxWidth})}),a=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minWidth})}),l=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxHeight})}),u=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minHeight})});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("img",{style:{width:r.getOrElse(function(){return"auto"}),height:o.getOrElse(function(){return"auto"}),maxWidth:i.getOrElse(function(){return"none"}),minWidth:a.getOrElse(function(){return"none"}),maxHeight:l.getOrElse(function(){return"none"}),minHeight:u.getOrElse(function(){return"none"})},src:this.props.display.fileId.flatMap(function(t){return e.props.authToken.map(function(n){return Object(Un.b)(n,t,e.props.cdnAddress)})}).getOrElse(function(){return n(854)})}))}}]),t}(d.Component),va=Object(h.connect)(function(e,t){return{authToken:e.auth.token,cdnAddress:e.config.cdnAddress}})(ba),Oa=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=Object(C.cb)(this.props.formRecord,this.props.display.valueCaptionTemplate).getOrElse(function(){return""}),t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%",margin:0}}).getOrElse(function(){});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("p",{style:t},e||Object(oe.c)(this.props.display.label.text)||this.props.i18n.t("Надпись")))}}]),t}(d.Component),Ea=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(w.d)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.formRecord,t.formRecord)&&e.i18n===t.i18n}})(Oa),ka=n(540),ja=n.n(ka),Ca=n(629),Ra=n.n(Ca),wa=n(628),Ia=n.n(wa),Sa=n(175),Pa=n.n(Sa),Ta=n(318),xa=n.n(Ta),_a=n(148),Da=n(1486),Fa=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement(xa.a,null,d.createElement(Pa.a,{style:{width:"1px",whiteSpace:"nowrap"}},this.props.idx+1),d.createElement(Pa.a,{style:{width:"60%"}},this.props.categoryName.getOrElse(function(){return e.props.i18n.t("Значение не найдено")})),d.createElement(Pa.a,null,this.props.limitValues.limitPresent?this.props.limitValues.avail:"..."),d.createElement(Pa.a,null,this.props.limitValues.occupied),d.createElement(Pa.a,null,this.props.limitValues.limitPresent?this.props.limitValues.all:"..."))}}]),t}(d.Component),Ma=Object(h.connect)(function(e,t){return{i18n:e.i18n,categoryName:Object(_a.d)(e.dictionaries,t.limitFormId,t.dictId).flatMap(function(n){return t.displayField.filter(function(e){return e.tpe.value===E.DisplayFieldByTemplate.$Type.value}).map(function(e){return e.template}).matchWith(function(t){return Object(Da.b)(t,n)(e)},function(){return Object(k.liftKey)(n.entity.values,t.displayCategoryFieldId.value).map(function(e){return e.value.toString()})})})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.dictionaries.list===t.dictionaries.list&&e.fields.list===t.fields.list},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.categoryName,t.categoryName)}})(Fa),Wa=n(636),Ba=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement(d.Fragment,{key:this.props.rowsData.cfgId},this.props.linkedField.flatMap(function(t){var n=t.entity,r=n.valueType,o=(n.formId,n.caption);return Object(k.headOption)(r.displayFields).map(function(t){return[d.createElement(xa.a,null,d.createElement(Pa.a,{colSpan:5,style:{width:"100%",textAlign:"center"}},e.props.displayField.matchWith(function(e){return e.caption},function(){return o})))].concat([].concat(M()(e.props.rowsData.limitValuesMap.keys())).map(function(n,o){return Object(k.toOption)(e.props.rowsData.limitValuesMap.get(n)).filter(function(t){return t.limitPresent||!t.limitPresent&&e.props.showUnlimited}).matchWith(function(i){return d.createElement(Ma,{idx:o,dictId:new E.Id(n),blockRendererId:e.props.blockRendererId,limitValues:i,limitFormId:r.family,displayField:e.props.displayField,displayCategoryFieldId:e.props.displayField.flatMap(function(e){return e.objRefDisplayFieldId}).matchWith(function(e){return e},function(){return t})})},function(){return d.createElement("div",null)})}))})}).getOrElse(function(){return[]}))}}]),t}(d.Component),La=function(e){e.linkedField.foreach(function(t){e.dispatch(Object(Wa.a)(t.entity.valueType.family,new k.None)),e.dispatch(Object(Z.e)(t.entity.valueType.family))})},Aa=Object(h.connect)(function(e,t){return{i18n:e.i18n,linkedField:Object(H.d)(e,t.formId,t.rowsData.fieldId).filter(function(e){return e.entity.valueType instanceof E.ValueTypeObjectRefs}).flatMap(function(n){return Object(H.d)(e,n.entity.valueType.family,t.rowsData.linkedFieldId)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return!0}})(Object(fe.a)([La],[function(e,t){Object(k.isEqual)(e.linkedField,t.linkedField)||La(e),Object(k.isEqual)(e.linkedField,t.linkedField)&&e.isTokenChecked&&!t.isTokenChecked&&La(e)}])(Ba)),$a=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement(xa.a,null,d.createElement(Pa.a,{style:{width:"1px",whiteSpace:"nowrap"}},this.props.idx+1),d.createElement(Pa.a,{style:{width:"60%"}},this.props.i18n.t("Общий лимит")),d.createElement(Pa.a,null,this.props.rowData.limitValues.limitPresent?this.props.rowData.limitValues.avail:"..."),d.createElement(Pa.a,null,this.props.rowData.limitValues.occupied),d.createElement(Pa.a,null,this.props.rowData.limitValues.limitPresent?this.props.rowData.limitValues.all:"..."))}}]),t}(d.Component),Va=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})($a),qa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Na=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.font.getName(),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},!!this.props.display.label.text&&d.createElement("div",{className:"FormRecordDisplay__label-row"},d.createElement("div",{className:"FormRecordDisplay__label",style:t},Object(oe.c)(this.props.display.label.text))),d.createElement(ja.a,null,d.createElement(Ia.a,null,d.createElement(xa.a,null,d.createElement(Pa.a,{style:{width:"1px",whiteSpace:"nowrap"}},this.props.i18n.t("№")),d.createElement(Pa.a,{style:{width:"60%"}},this.props.i18n.t("Категория")),d.createElement(Pa.a,null,this.props.i18n.t("Свободно")),d.createElement(Pa.a,null,this.props.i18n.t("Занято")),d.createElement(Pa.a,null,this.props.i18n.t("Всего")))),d.createElement(Ra.a,null,this.props.linkedFieldLimitRowDatas.map(function(t){return d.createElement(Aa,{key:t.cfgId+" - "+t.fieldId,blockRendererId:e.props.blockRendererId,formId:e.props.formId,rowsData:t,showUnlimited:e.props.display.showUnlimited,displayField:Object(k.headOption)(e.props.display.displayFields.filter(function(e){return e.tpe.value===E.DisplayFieldByField.$Type.value}).filter(function(e){return e.fieldId.value===t.linkedFieldId.value}))})}),this.props.totalLimitRowDatas.filter(function(t,n){return t.limitValues.limitPresent||!t.limitValues.limitPresent&&e.props.display.showUnlimited}).map(function(t,n){return d.createElement(Va,{key:n,idx:e.props.linkedFieldLimitRowDatas.reduce(function(e,t){return t.limitValuesMap.size+e},0),blockRendererId:e.props.blockRendererId,rowData:t})}))))}}]),t}(d.Component);Na=qa([m.autobind],Na);var za=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(te.a)(e.formId,t.id,e.blockRendererId))})},Ha=Object(h.connect)(function(e,t){var n=Object(w.d)(e.blockRendererContext,t.blockRendererId),r=n.map(function(e){return e.entity.formId}).flatMap(function(t){return Object(y.e)(e.forms,t)}).map(function(e){return e.entity.limits.filter(function(e){return t.display.memberFormField.map(function(t){return t.value===e.memberFieldId.value}).getOrElse(function(){return!0})})}).getOrElse(function(){return[]}),o=Object(w.i)(e.blockRendererContext,t.blockRendererId).getOrElse(function(){return[]});return{i18n:e.i18n,formRecord:n,dictionaries:e.dictionaries,linkedFieldLimitRowDatas:o.filter(function(e){return e.data.tpe.value===E.LimitDataLinkedValues.$Type.value}).map(function(e){return Object(k.headOption)(r.filter(function(t){return t.limitType.id===e.cfgId})).map(function(t){return{cfgId:e.cfgId,limitValuesMap:new Map([].concat(M()(e.data.values))),fieldId:t.memberFieldId,linkedFieldId:t.limitType.memberTypeId}})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),totalLimitRowDatas:o.filter(function(e){return e.data.tpe.value===E.LimitDataTotal.$Type.value}).map(function(e){return Object(k.headOption)(r.filter(function(t){return t.limitType.id===e.cfgId})).map(function(t){return{limitValues:e.data.values}})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),linkFormFieldsMap:t.display.memberFormField.flatMap(function(n){return Object(H.d)(e,t.formId,n)}).flatMap(function(t){return Object(H.h)(e,t.entity.valueType.family)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.fields.map===t.fields.map},areStatePropsEqual:function(e,t){return(e.linkedFieldLimitRowDatas===t.linkedFieldLimitRowDatas||0===e.linkedFieldLimitRowDatas.length&&0===t.linkedFieldLimitRowDatas.length)&&(e.totalLimitRowDatas===t.totalLimitRowDatas||0===e.totalLimitRowDatas.length&&0===t.totalLimitRowDatas.length)&&Object(k.isEqual)(e.linkFormFieldsMap,t.linkFormFieldsMap)&&e.i18n===t.i18n}})(Object(fe.a)([za],[function(e,t){Object(k.isEqual)(e.formRecord,t.formRecord)||za(e),Object(k.isEqual)(e.formRecord,t.formRecord)&&e.isTokenChecked&&!t.isTokenChecked&&za(e)}])(Na)),Ua=n(106),Ka=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ga=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ya=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1},n}return s()(t,e),a()(t,[{key:"getButtonStyle",value:function(){var e=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new E.ElementProportions}),t=this.props.display.elementCss.flatMap(function(e){return e.background}).getOrElse(function(){return new E.ElementBackground}),n=this.props.display.elementCss.flatMap(function(e){return e.fonts.map(function(e){return e.textFont})}).flatMap(function(e){return e}),r=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),o=Object(Pe.c)(n,r,new k.None),i=Object(Ua.e)(this.props.display.elementCss).getOrElse(function(){return Ua.a}),a=i.borderRadius.getOrElse(function(){return i.getDefaultBorderRadius()}),l=e.width,u=e.height,c=t.color,s="#fff"===c,p=u.filter(function(e){return""!==e}).nonEmpty();return{buttonStyle:Object.assign({width:l.getOrElse(function(){return"auto"}),height:u.getOrElse(function(){return"auto"}),borderRadius:a},s?{transition:"none"}:{backgroundColor:c}),textStyle:Object.assign(o,p?{lineHeight:u.map(function(e){return e+"px"}).getOrElse(function(){return"auto"})}:{}),width:l}}},{key:"onClick",value:function(){var e=this;this.state.loading||this.setState({loading:!0},function(){e.props.handleButtonPress(e.props.display).then(function(){e.setState({loading:!1})}).catch(function(t){e.setState({loading:!1})})})}},{key:"componentWillMount",value:function(){document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function(e){e.key===this.props.display.activationKey.getOrElse(function(){return""})&&this.button.click()}},{key:"render",value:function(){var e=this,t=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new E.ElementProportions});return d.createElement("div",{style:Object.assign({flex:t.width.map(function(e){return"auto"===e?"0 0 1":"0 0 "+e}).getOrElse(function(){return"0 0 auto"})},this.props.style)},d.createElement(A.a,{className:"Button",variant:Object(re.b)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),disabled:this.state.loading,fullWidth:t.width.filter(function(e){return"auto"==e}).isEmpty(),color:Object(Ua.g)(this.props.display.elementCss),style:this.getButtonStyle().buttonStyle,onClick:this.onClick,buttonRef:function(t){return e.button=t}},d.createElement(d.Fragment,null,this.state.loading?d.createElement(pn.a,{style:{color:"white",marginRight:"10px"}}):null,d.createElement("div",{style:this.getButtonStyle().textStyle},Object(oe.c)(this.props.display.label.text)))))}}]),t}(d.Component);Ya=Ka([m.autobind,Ga("design:paramtypes",[Object])],Ya);var Ja=Object(h.connect)(function(e,t){return{i18n:e.i18n}})(Ya),Qa=n(1812),Xa=n(634),Za=n(421),el=n(415),tl=n(17),nl=n(18),rl=function(e){function t(e){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"EventStore","FormDataFilter",{request:e}))}return s()(t,e),t}(nl.a),ol=function(e){function t(e){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"EventStore","VisitedUrlsList",{request:e}))}return s()(t,e),t}(nl.a),il=n(21),al=n(326),ll=n(327),ul=n(216),cl=n(1495),sl=n(1494),pl=n(294),fl=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dl=function(e){function t(){o()(this,t);var e=u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.headers=["Дата","Пользователь/Событие","Подробнее"].map(function(t,n){return{id:n.toString(),title:e.props.i18n.t(t)}}),e}return s()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){var t=e.logPage.getOrElse(function(){return[]}),n=this.props.logPage.getOrElse(function(){return[]});t.length!==n.length&&this.fetchRequiredFormData()}},{key:"fetchRequiredFormData",value:function(){var e=this,t=Object(Xa.default)(this.props.logPage.getOrElse(function(){return[]}).filter(function(e){return e instanceof E.FormDataUpdated}).map(function(e){return[].concat(M()(e.newData),M()(e.oldData))})).filter(function(e){return e.value instanceof E.ValueObjectRefs}).reduce(function(t,n){return Object(k.headOption)(e.props.fields.getOrElse(function(){return[]}).filter(function(e){return e.id.value===n.formFieldId.value})).map(function(e){return e.entity.valueType}).map(function(e){return Object(k.liftKey)(t,e.family.value).matchWith(function(r){return Object.assign({},t,Bn()({},e.family.value,Object(Za.a)([].concat(M()(r),M()(n.value.id)),function(e){return e.value})))},function(){return Object.assign({},t,Bn()({},e.family.value,n.value.id))})}).getOrElse(function(){return{}})},{});Object.keys(t).forEach(function(n){return E.Id.createId(n).foreach(function(n){return Object(k.liftKey)(t,n.value).foreach(function(t){return e.props.dispatch(Object(pl.b)(n,t,new k.None,t.length))})})})}},{key:"getRows",value:function(){var e=this;return this.props.logPage.getOrElse(function(){return[]}).map(function(t,n){return{payload:"",id:n.toString(),fields:e.getFields(t)}})}},{key:"getEventUserType",value:function(e){var t=this;switch(e.src.tpe){case E.EventSourceSystem.$Type:return this.props.i18n.t("Система");case E.EventSourceOrganizer.$Type:return Object(k.headOption)(this.props.usersDescriptionsList.filter(function(t){return e.userId.map(function(e){return e.value===t.id}).getOrElse(function(){return!1})})).map(function(e){return e.name}).getOrElse(function(){return t.props.i18n.t("Значение не найдено")});case E.EventSourceSite.$Type:return this.props.i18n.t("Сайт");default:return""}}},{key:"getEventType",value:function(e){var t=this.props.i18n.t;switch(e.tpe){case E.FormDataCreated.$Type:return t("Создание");case E.FormDataUpdated.$Type:return t("Редактирование");case E.FormDataDeleted.$Type:return t("Удаление");default:return""}}},{key:"getBlockName",value:function(e){var t=this;return Object(k.liftKey)(this.props.blocksDescriptionsList,this.props.formId.value).flatMap(function(t){return Object(k.headOption)(t.filter(function(t){return t.id===e.blockId.value}))}).map(function(e){return e.name}).getOrElse(function(){return t.props.i18n.t("Значение не найдено")})}},{key:"getAttributes",value:function(e){var t=this.props.i18n.t;switch(e.tpe){case E.EventAttributesBlock.$Type:return t("Блок")+' "'+this.getBlockName(e)+'"';case E.EventAttributesImport.$Type:var n=Object(k.headOption)(this.props.importPipelines.descriptionsList.filter(function(t){return t.id.toString()===e.pipeline.value})).map(function(e){return e.name}).getOrElse(function(){return""});return t("Импорт")+' "'+n+'"';default:return""}}},{key:"getFieldName",value:function(e){return this.props.fields.flatMap(function(t){return Object(k.headOption)(t.filter(function(t){return t.id.value===e.value}))}).map(function(e){return e.entity.caption}).getOrElse(function(){return""})}},{key:"getEventStr",value:function(e,t){var n=this;return Object(k.headOption)(e.filter(function(e){return e.formFieldId.value===t.value})).map(function(e){return Object(k.toOption)(e.value instanceof E.ValueObjectRefs).filter(function(e){return e}).matchWith(function(){return Object(k.headOption)(n.props.fields.getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.formFieldId.value})).map(function(e){return e.entity.valueType}).flatMap(function(t){return Object(k.liftKey)(n.props.formRecords.result,t.family.value).flatMap(function(e){return e}).map(function(n){return Object(k.headOption)(t.displayFields).map(function(t){return n.records.filter(function(t){return e.value.id.filter(function(e){return t.id.value===e.value}).length>0}).map(function(e){return Object(k.liftKey)(e.entity.values,t.value).map(function(e){return e.value.toString()}).getOrElse(function(){return""})})}).getOrElse(function(){return[]}).join("; ")})}).getOrElse(function(){return""})},function(){return e.value.toString()})}).getOrElse(function(){return""})}},{key:"openDetailsDialog",value:function(e,t,n){var r=this,o=this.props.openDialog(this.props.i18n.t("Подробнее"),n.map(function(e){return e}).getOrElse(function(){return d.createElement(d.Fragment,null,t.map(function(t){var n=r.getEventStr(e.oldData,t)+" -> "+r.getEventStr(e.newData,t);return d.createElement("div",null,d.createElement("b",null,r.getFieldName(t)),": ",n)}))}),[d.createElement(A.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return r.props.handleDialogClose(o)}},this.props.i18n.t("Закрыть"))])}},{key:"getInfo",value:function(e){var t=this;if(!(e instanceof E.FormDataUpdated))return d.createElement("span",null);var n=Object(Qa.a)(e.oldData.map(function(e){return e.formFieldId}),e.newData.map(function(e){return e.formFieldId}),function(e,t){return e.value===t.value});return n.length>2?d.createElement(cl.a,{onClick:function(){return t.openDetailsDialog(e,n,new k.None)},variant:"outlined",color:"secondary",size:"small"},this.props.i18n.t("Подробнее")):n.map(function(r){var o=t.getEventStr(e.oldData,r)+" -> "+t.getEventStr(e.newData,r),i=d.createElement("div",null,d.createElement("b",null,t.getFieldName(r)),": ",o);return o.length>30?d.createElement(cl.a,{onClick:function(){return t.openDetailsDialog(e,n,Object(k.toOption)(i))},variant:"outlined",color:"secondary",size:"small"},t.props.i18n.t("Подробнее")):i})}},{key:"getFields",value:function(e){var t=new Date(e.meta.time),n=d.createElement("span",null,t.toLocaleDateString()," ",t.toLocaleTimeString()),r=this.getEventUserType(e.meta);return[n,d.createElement("span",null,r,"/",this.getEventType(e),", ",this.getAttributes(e.meta.attrs)),this.getInfo(e)]}},{key:"onNextPage",value:function(){this.props.dispatch(Object(al.h)(this.props.formRecordsLog.currentPage+1))}},{key:"onPrevPage",value:function(){this.props.dispatch(Object(al.h)(this.props.formRecordsLog.currentPage-1))}},{key:"onFirstPage",value:function(){this.props.dispatch(Object(al.h)(0))}},{key:"onLastPage",value:function(){this.props.dispatch(Object(al.h)(Math.floor(this.getTotalRecords()/this.props.formRecordsLog.pageSize)))}},{key:"onPageSizeChanged",value:function(e){this.props.dispatch(Object(al.i)(e)),this.onFirstPage()}},{key:"getTotalRecords",value:function(){var e=this;return this.props.currentFormRecord.flatMap(function(t){return Object(k.liftKey)(e.props.formRecordsLog.result,t.id.value).flatMap(function(e){return e.map(function(e){return e.total})})}).getOrElse(function(){return 0})}},{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(el.a,{fetching:this.props.logsFetching,showId:!1,error:this.props.logsFetchingError,headers:this.headers,rows:this.getRows(),columnStyles:[{flex:1},{flex:3},{flex:4}]}),d.createElement(ul.a,{pageSizes:[5,10,20,40,60],nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,changePageSize:this.onPageSizeChanged,currentPage:this.props.formRecordsLog.currentPage,rowPerPage:this.props.formRecordsLog.pageSize,totalRecords:this.getTotalRecords()}))}}]),t}(d.Component);dl=fl([m.autobind],dl);var hl=function(e){e.currentFormRecord.foreach(function(t){var n,r,o,i;e.dispatch((n=e.formId,r=t.id,o=e.formRecordsLog.currentPage,i=e.formRecordsLog.pageSize,function(e){e(Object(al.g)({formDataId:r}));var t=new E.FormDataLogRequest(n,r,o,i,Object(k.toOption)(new E.Interval));return tl.a.send(new rl(t),Object(il.h)()).then(function(t){return e(Object(al.j)({formDataId:r,resolved:t.page})),t}).catch(function(t){throw e(Object(al.f)({formDataId:r,error:t})),t})}))})},ml=Object(h.connect)(function(e,t){var n=Object(w.d)(e.blockRendererContext,t.blockRendererId);return{formRecords:e.formRecords,currentFormRecord:n,importPipelines:e.importPipelines,formRecordsLog:e.formRecordsLog,currentForm:Object(y.e)(e.forms,t.formId),block:Object(b.b)(e.block,t.blockId),fields:Object(H.e)(e.fields,t.formId),i18n:e.i18n,logPage:n.flatMap(function(t){return Object(k.liftKey)(e.formRecordsLog.result,t.id.value)}).flatMap(function(e){return e.map(function(e){return e.records})}),logsFetching:n.flatMap(function(t){return Object(k.liftKey)(e.formRecordsLog.fetching,t.id.value)}).getOrElse(function(){return!1}),logsFetchingError:n.flatMap(function(t){return Object(k.liftKey)(e.formRecordsLog.error,t.id.value)}).getOrElse(function(){return new k.None}),blocksDescriptionsList:e.blocks.descriptionsList,usersDescriptionsList:e.users.descriptionsList}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext&&e.fields.list===t.fields.list&&e.formRecordsLog===t.formRecordsLog&&e.blocks===t.blocks&&e.users===t.users&&e.importPipelines===t.importPipelines&&e.formRecords===t.formRecords},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.currentFormRecord,t.currentFormRecord)&&Object(k.isEqual)(e.currentForm,t.currentForm)&&Object(k.isEqual)(e.block,t.block)&&Object(k.isEqual)(e.logPage,t.logPage)&&Object(k.isEqual)(e.logsFetchingError,t.logsFetchingError)&&Object(k.isEqual)(e.fields,t.fields)&&e.logsFetching===t.logsFetching&&e.i18n===t.i18n&&e.formRecordsLog===t.formRecordsLog&&e.importPipelines===t.importPipelines&&e.blocksDescriptionsList===t.blocksDescriptionsList&&e.usersDescriptionsList===t.usersDescriptionsList&&e.formRecords===t.formRecords}})(Object(fe.a)([hl,function(e){e.dispatch(Object(v.b)(e.formId))},function(e){e.dispatch(Object(Ur.a)())},function(e){e.dispatch(Object(sl.b)(e.formId))}],[function(e,t){Object(k.isEqual)(e.currentFormRecord,t.currentFormRecord)||e.dispatch(Object(al.h)(0))},function(e,t){if(e.isTokenChecked)if(!e.isTokenChecked||t.isTokenChecked){var n=e.formRecordsLog,r=n.currentPage,o=n.pageSize,i=t.formRecordsLog,a=i.currentPage,l=i.pageSize;a===r&&l===o||hl(e)}else hl(e)}])(Object(X.a)(dl))),gl=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=Object(C.cb)(this.props.formRecord,Object(No.toOption)(this.props.display.htmlCode)).getOrElse(function(){return""});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("div",{dangerouslySetInnerHTML:{__html:e||this.props.display.htmlCode}}))}}]),t}(d.Component),yl=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(w.d)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(No.isEqual)(e.formRecord,t.formRecord)&&e.i18n===t.i18n}})(gl),bl=n(195),vl=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ol=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderLangs",value:function(e){return this.props.currentBlock.map(function(e){return e.entity.languageConfig.langs}).getOrElse(function(){return[]}).sort(function(e,t){return e.order-t.order}).map(function(t){return e(t.label,t.order)})}},{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(V.a,{value:this.props.currentLangIndex,onChange:this.props.handleLangChange},this.renderLangs(function(e,t){return d.createElement(eo.a,{value:t},e)})))}}]),t}(d.Component);Ol=vl([m.autobind],Ol);var El=Object(h.connect)(function(e,t){return{currentBlock:Object(b.b)(e.block,t.blockId),currentLangIndex:e.block.settings.selectedLangOrderIndex,i18n:e.i18n}},function(e){return{handleLangChange:function(t){return e(Object(bl.g)(t.target.value))}}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.block.settings.selectedLangOrderIndex===t.block.settings.selectedLangOrderIndex},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.currentBlock,t.currentBlock)&&e.i18n===t.i18n&&e.currentLangIndex===t.currentLangIndex}})(Ol),kl=n(1542),jl=n(59),Cl=n(1518),Rl=n.n(Cl),wl=n(1767),Il=n.n(wl),Sl=n(1504),Pl=n(1459),Tl=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={saveBlock:!1,markedFormRecords:[],processedFormRecords:[],currentPage:0,rowPerPage:20,searchValue:"",requestedCloseEnabled:!0,sorting:[]},n}return s()(t,e),a()(t,[{key:"fetchParentRecords",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new k.None;return this.props.formRecord.map(function(e){return e.id}).map(function(n){return e.props.dispatch(Object(Sl.b)(new E.RelationsPagedListRequest(e.state.currentPage,e.state.rowPerPage,n,e.props.display.parentsForm,e.props.display.parentsField,t,e.state.sorting.map(function(e){return e.sortType}),new k.None,new E.RelsTypeSearchParents),e.props.display,e.props.blockRendererId))})}},{key:"getFormSortType",value:function(e){return this.props.dispatch(Object(Z.d)(this.props.display.parentsForm,e))}},{key:"sortRecords",value:function(e,t,n){var r=this;this.setState(update(this.state,e.matchWith(function(e){var o=r.state.sorting.findIndex(function(e){return e.fieldId.value===t.value});return-1===o?{sorting:{$push:[{fieldId:t,asc:n,sortType:e}]}}:{sorting:{$splice:[[o,1,{fieldId:t,asc:n,sortType:e}]]}}},function(){return{sorting:{$set:r.state.sorting.filter(function(e){return e.fieldId.value!==t.value})}}})),function(){r.fetchParentRecords()})}},{key:"onSortRequest",value:function(e){var t=this;Object(k.toOption)(this.state.sorting.find(function(t){return t.fieldId.value===e.value})).map(function(n){n.asc?t.sortRecords(Object(k.toOption)(update(n.sortType,{asc:{$set:!1}})),e,!1):t.sortRecords(new k.None,e,!0)}).getOrElse(function(){t.sortRecords(t.getFormSortType(e),e,!0)})}},{key:"onSearchValueChanged",value:function(e){this.setState(update(this.state,{searchValue:{$set:e.target.value}}))}},{key:"onSearchRecords",value:function(){var e=this,t=this.props.display.searchSettings.filter(function(t){return!!e.state.searchValue&&t.enabled}).map(function(t){return new E.FilterCondition(t.field,new E.FilterExpressionContains,new E.ValueStr(e.state.searchValue))});this.setState(update(this.state,{currentPage:{$set:0},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords(t)})}},{key:"onRecordSelected",value:function(e){}},{key:"onSelectAll",value:function(){this.state.markedFormRecords.length===this.props.displayValues.getOrElse(function(){return[]}).length?this.setState(update(this.state,{markedFormRecords:{$set:[]}})):this.setState(update(this.state,{markedFormRecords:{$set:this.props.displayValues.getOrElse(function(){return[]}).map(function(e){return e.id})}}))}},{key:"onRecordMarked",value:function(e){var t=this.state.markedFormRecords.findIndex(function(t){return t.value===e});t>=0?this.setState(update(this.state,{markedFormRecords:{$splice:[[t,1]]}})):this.setState(update(this.state,{markedFormRecords:{$push:[new E.Id(e)]}}))}},{key:"onFirstPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:0},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onLastPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:Math.ceil(this.props.total/this.state.rowPerPage)-1},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onNextPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:this.state.currentPage+1},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onPrevPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:this.state.currentPage-1},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onPageSizeChanged",value:function(e){var t=this;this.setState(update(this.state,{rowPerPage:{$set:e},markedFormRecords:{$set:this.state.rowPerPage<=e?this.state.markedFormRecords:[]}}),function(){return t.fetchParentRecords()})}},{key:"onOpenClick",value:function(e,t){var n=this,r=jl.v4();t.block.map(function(t){return n.props.getBlockComponent&&n.props.getBlockComponent(n.props.display.parentsForm,Object(k.toOption)(e.formRecord),t,r,E.webRegistrationBlockTypeDisplay,n.props.rootBlockRendererId.matchWith(function(e){return Object(k.toOption)(e)},function(){return Object(k.toOption)(n.props.blockRendererId)}),function(e){var t=n.props.openDialog(n.props.i18n.t("Просмотр"),e,[d.createElement(A.a,{onClick:function(e){return n.props.handleDialogClose(t)},style:{marginRight:"10px"}},n.props.i18n.t("Закрыть"))])})}).getOrElse(function(){n.props.dispatch(Object(wn.h)(n.props.i18n.t("Ошибка - не выбран блок просмотра анкеты")))})}},{key:"onViewValue",value:function(e){this.props.dispatch(Object(Pl.a)(this.props.display.parentsForm,e.id))}},{key:"onDeleteValue",value:function(e){return this.deleteParentRef(e)}},{key:"deleteParentRef",value:function(e){var t=this;this.props.formRecord.foreach(function(n){return Object(ee.p)([e.id],t.props.display.parentsForm,t.props.display.parentsField,n.entity.formId,[n.id]).then(function(){t.fetchParentRecords()})})}},{key:"getActionButton",value:function(e,t){var n=this,r=e.display.enabled,o=e.display.value.getOrElse(function(){return""}),i=function(e){return d.createElement(Or.a,{className:"ObjRefsTableEditor__button",variant:"caption",align:"center",onClick:e},o)};switch(e.tpe.value){case E.ElementControlActionOpen.$Type.value:return r?i(function(){return n.onOpenClick(t,e)}):d.createElement(jn.a,{style:Xe.f,key:"open",onClick:function(){return n.onOpenClick(t,e)}},d.createElement(Il.a,{style:Xe.g}));case E.ElementControlActionView.$Type.value:return r?i(function(){return n.onViewValue(t)}):d.createElement(jn.a,{style:Xe.f,key:"view",onClick:function(){return n.onViewValue(t)}},d.createElement(Rl.a,{style:Xe.g}));case E.ElementControlActionDelete.$Type.value:return r?i(function(){return n.onDeleteValue(t)}):d.createElement(jn.a,{style:Xe.f,key:"delete",onClick:function(){return n.onDeleteValue(t)}},d.createElement(xr.a,{style:Xe.g}));default:throw"Unknown element control action type"}}},{key:"render",value:function(){var e=this,t=(this.props.objRefFormFields.getOrElse(function(){return[]}),this.props.display.displayFields.map(function(e,t){return{id:t.toString(),title:e.caption}}));return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(el.a,{showId:!1,error:new k.None,onSelectAll:this.onSelectAll,onRecordMarked:this.onRecordMarked,onRecordSelected:this.onRecordSelected,markedRecords:this.state.markedFormRecords.map(function(e){return e.value}),fetching:this.props.displayValuesFetching.getOrElse(function(){return!1}),empty:this.props.displayValues.isEmpty(),withActions:!0,headers:t,onSort:this.onSortRequest,sortedFieldIds:this.state.sorting,rows:this.props.displayValues.getOrElse(function(){return[]}).map(function(t,n){var r=t.formRecord.entity.attributes.status.tpe.value===E.FormDataStatusDeleted.$Type.value||t.formRecord.entity.attributes.status.tpe.value===E.FormDataStatusNominalDeleted.$Type.value;return{payload:t.id.value,id:t.id.value,deleted:r,fields:t.values,buttons:e.props.display.actions.map(function(n){return e.getActionButton(n,t)})}})}),d.createElement(ul.a,{blockTableSearch:!1,nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,changePageSize:this.onPageSizeChanged,currentPage:this.state.currentPage,rowPerPage:this.state.rowPerPage,totalRecords:this.props.total,shouldShowMassActions:!1,massActionsComponents:[],searchValue:this.state.searchValue,onSearchValueChange:this.onSearchValueChanged,onSearchRecords:this.onSearchRecords}))}}]),t}(d.PureComponent),xl=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(de.i)(e.blockRendererId,e.display,t.id))})},_l=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(w.d)(e.blockRendererContext,t.blockRendererId),total:Object(R.g)(e.dataOutput,t.blockRendererId,t.display.id).getOrElse(function(){return 0}),displayValues:Object(R.h)(e.dataOutput,t.blockRendererId,t.display.id),displayValuesFetching:Object(R.i)(e.dataOutput,t.blockRendererId,t.display.id),objRefFormFields:Object(H.e)(e.fields,t.display.parentsForm),rootBlockRendererId:Object(w.j)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.formRecord,t.formRecord)&&Object(k.isEqual)(e.rootBlockRendererId,t.rootBlockRendererId)&&Object(k.isEqual)(e.displayValues,t.displayValues)&&Object(k.isEqual)(e.displayValuesFetching,t.displayValuesFetching)&&e.i18n===t.i18n&&e.total===t.total}})(Object(fe.a)([xl],[function(e,t){Object(k.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))||xl(e),Object(k.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))&&e.isTokenChecked&&!t.isTokenChecked&&xl(e)}])(Object(X.a)(Tl))),Dl=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new E.ElementFonts}).textFont.map(function(e){return{color:e.color,fontFamily:e.font.getName(),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){}),t=this.props.display.errorTypes,n=t.map(function(e){return e.duplicateError.map(function(e){return e.enabled})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),r=t.map(function(e){return e.duplicateError.map(function(e){return e.text})}).flatMap(function(e){return e}).getOrElse(function(){return""}),o=t.map(function(e){return e.loginError.map(function(e){return e.enabled})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),i=t.map(function(e){return e.loginError.map(function(e){return e.text})}).flatMap(function(e){return e}).getOrElse(function(){return""});return this.props.displayErrorElement.getOrElse(function(){return!1})?d.createElement("div",{style:this.props.style},n?d.createElement("p",{style:e},r):d.createElement("p",null),o?d.createElement("p",{style:e},i):d.createElement("p",null)):null}}]),t}(d.Component),Fl=Object(h.connect)(function(e,t){return{i18n:e.i18n,displayErrorElement:Object(k.liftKey)(e.dataOutput,t.blockRendererId).map(function(e){return e.displayErrorElement})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.displayErrorElement,t.displayErrorElement)&&e.i18n===t.i18n}})(Dl),Ml=n(62),Wl=n.n(Ml),Bl=n(646),Ll=n.n(Bl),Al=n(1814),$l=n.n(Al),Vl=n(115),ql=n.n(Vl),Nl=n(1625),zl=n.n(Nl),Hl=n(1624),Ul=n.n(Hl),Kl=n(1813),Gl=n.n(Kl),Yl=n(1519),Jl=n.n(Yl),Ql=n(1626),Xl=n.n(Ql),Zl=n(1526),eu=n(637),tu=n(626),nu=n(262),ru=n(1532),ou=n(1500),iu=n(275),au=n(633),lu=n(1527),uu=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},cu=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},su=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={currentPage:0,rowPerPage:20,emailStatus:n.props.display.operations.statusFilter?Object(k.toOption)(E.EmailStatusInbox.$Type):new k.None,searchExpr:new k.None},n}return s()(t,e),a()(t,[{key:"fetchEmailDataObjects",value:function(){var e=this;this.props.formRecord.foreach(function(t){e.props.dispatch(Object(Zl.b)(t.id,e.state.currentPage,e.state.rowPerPage,Object(k.toOption)(new E.EmailFilterGroup([].concat(e.state.emailStatus.matchWith(function(e){return[new E.EmailFilterCondition(new E.EmailFilterExpressionStatus(Object(iu.a)(e)),new E.EmailFilterOperatorEq)]},function(){return[]})).concat(e.state.searchExpr.matchWith(function(e){return[new E.EmailFilterCondition(e,new E.EmailFilterOperatorContains)]},function(){return[]})),new E.EmailFilterPredicateAnd))))})}},{key:"onSearch",value:function(e){var t=this;this.setState(K(this.state,{searchExpr:{$set:e}}),function(){t.fetchEmailDataObjects()})}},{key:"onRenewClick",value:function(){this.onFirstPage()}},{key:"onFirstPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:0}}),function(){return e.fetchEmailDataObjects()})}},{key:"onLastPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:Math.ceil(this.props.emailService.total.getOrElse(function(){return 0})/this.state.rowPerPage)-1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onNextPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:this.state.currentPage+1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onPrevPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:this.state.currentPage-1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onPageSizeChanged",value:function(e){var t=this;this.setState(K(this.state,{rowPerPage:{$set:e}}),function(){return t.fetchEmailDataObjects()})}},{key:"getEmailDataObjectViewDialogButtons",value:function(e,t){var n=this,r=e.entity.msgBody;return[d.createElement(A.a,{key:"cancel",variant:"raised",onClick:t,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))].concat(e.entity.meta.emailStatus.tpe.value===E.EmailStatusDraft.$Type.value?[d.createElement(A.a,{key:"send",variant:"raised",onClick:function(o){return n.onSendClick(e,r,t)},color:"primary"},this.props.i18n.t("Отправить"))]:[d.createElement(A.a,{key:"reply",variant:"raised",onClick:function(t){return n.onReplyToClick(e)},color:"primary"},this.props.i18n.t("Ответить"))])}},{key:"openEmailDataObjectView",value:function(e){var t=this;e.entity.msgBody;Object(k.toOption)(e).filter(function(e){return!e.entity.meta.readStatus}).foreach(function(e){Object(eu.f)(e.id).then(function(){pu(t.props)})});var n=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),d.createElement(ru.a,{email:e}),this.getEmailDataObjectViewDialogButtons(e,function(){return t.props.handleDialogClose(n)}),{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onSendClick",value:function(e,t,n){var r=this;Object(k.toOption)(t).filter(function(t){return e.entity.msgBody!==t}).matchWith(function(t){return Object(eu.d)(e.id,t).then(function(){return Object(eu.k)(e.id)})},function(){return Object(eu.k)(e.id)}).then(function(){n(),r.fetchEmailDataObjects(),r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Сообщение отправлено")),new k.None)}).catch(function(e){r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Ошибка при отправке сообщения")),new k.None)})}},{key:"onReplyToSubmit",value:function(e,t,n){var r=this;return Object(eu.j)(t.id,this.props.display.mailBoxId,new E.MessageSubject(Object(k.toOption)(e.subject).filter(function(e){return""!==e})),new E.MessageBody(e.body||""),new E.MessageHtml(e.html||""),e.attachments||[],(e.replyTo||"").split(",").map(function(e){return new E.MessageAddress("",e.trim())}),t.entity.meta.msgUid,(e.cc||"").split(",").map(function(e){return new E.MessageAddress("",e.trim())}),(e.bcc||"").split(",").map(function(e){return new E.MessageAddress("",e.trim())})).then(function(e){n(),r.fetchEmailDataObjects(),r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Письмо отправлено")),new k.None)}).catch(function(e){r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Ошибка при отправлении письма")),new k.None)})}},{key:"onReplyToClick",value:function(e){var t=this,n=function(){return t.props.handleDialogClose(o)},r=void 0,o=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),d.createElement(ou.b,{ref:function(e){return r=Object(k.toOption)(e).flatMap(function(e){return Object(k.toOption)(e.wrappedInstance)})},initialValues:{replyTo:e.entity.msgBody.from.email,subject:e.entity.msgBody.subject.text.getOrElse(function(){return""}),cc:e.entity.msgBody.cc.map(function(e){return e.email}).join(", "),bcc:e.entity.msgBody.bcc.map(function(e){return e.email}).join(", ")},organisationId:this.props.organisation.organisationId,onSubmit:function(r){return t.onReplyToSubmit(r,e,n)}}),[d.createElement(A.a,{key:"cancel",variant:"raised",onClick:n,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(A.a,{key:"send",variant:"raised",onClick:function(){return r.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onDeleteRequested",value:function(e){throw"onDeleteRequested unimplemented"}},{key:"onSelectAll",value:function(){}},{key:"onRecordMarked",value:function(e){}},{key:"getReadStatusIcon",value:function(e){return e.entity.meta.readStatus?d.createElement(Ul.a,{style:Xe.g}):d.createElement(zl.a,{style:Xe.g})}},{key:"onReadStatusToggle",value:function(e){var t=this;(e.entity.meta.readStatus?Object(eu.e)(e.id):Object(eu.f)(e.id)).then(function(){pu(t.props)})}},{key:"getEmailDate",value:function(e){var t=new Date(e.entity.created),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?t.toLocaleTimeString():t.toLocaleDateString()}},{key:"wrapBySpan",value:function(e,t){return d.createElement("span",{style:e.entity.meta.readStatus?{}:{fontWeight:600}},t)}},{key:"createDraftFromValues",value:function(e){var t=this;return Object(k.headOption)(this.props.mailBoxConfigs.list.filter(function(e){return e.id.value===t.props.display.mailBoxId.value})).matchWith(function(n){return Object(eu.a)(n.id,new k.None,t.getEmailMessageBody(e,n),[]).then(function(e){return e.id})},function(){return new Promise(function(e,t){return t()})})}},{key:"onCreateDraftClick",value:function(e,t){var n=this;return this.createDraftFromValues(e).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо сохранено")),new k.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при сохранении письма")),new k.None)})}},{key:"onSendDraftClick",value:function(e,t){var n=this;return this.createDraftFromValues(e).then(function(e){return Object(eu.k)(e)}).then(function(){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо отправлено")),new k.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при отправке письма")),new k.None)})}},{key:"onCreateRequested",value:function(){this.openDraftEditForm(this.props.i18n.t("Новое сообщение"),!1,this.onCreateDraftClick,this.onSendDraftClick)}},{key:"openDraftEditForm",value:function(e,t,n,r,o){var i=this,a=function(){return i.props.handleDialogClose(s)},l=!1,u=!1,c=void 0,s=this.props.openDialog(e,d.createElement(ou.b,{ref:function(e){return c=Object(k.toOption)(e).flatMap(function(e){return Object(k.toOption)(e.wrappedInstance)})},showMailBoxSelector:t,initialValues:o,organisationId:this.props.organisation.organisationId,onSubmit:function(e){if(l)return n(e,a);if(u)return r(e,a);throw"unknown butoon clicked"}}),[d.createElement(A.a,{key:"cancel",variant:"raised",onClick:a,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(au.a,{key:"save",style:{marginRight:"10px"},formName:ou.a,variant:"raised",onClick:function(){return c.foreach(function(e){l=!0,e.submit()})}},this.props.i18n.t("Сохранить как черновик")),d.createElement(au.a,{key:"send",formName:ou.a,variant:"raised",onClick:function(){return c.foreach(function(e){u=!0,e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"getEmailMessageBody",value:function(e,t){return new E.EmailMessageBody(new E.MessageSubject(Object(k.toOption)(e.subject).filter(function(e){return""!==e})),new E.MessageBody(e.body||""),new E.MessageHtml(e.html),(e.replyTo||"").split(",").filter(function(e){return""!==e}).map(function(e){return new E.MessageAddress("",e.trim())}),t.entity.address,e.attachments||[],[],new k.None,(e.cc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new E.MessageAddress("",e.trim())}),(e.bcc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new E.MessageAddress("",e.trim())}))}},{key:"editDraftFromValues",value:function(e){var t=this;return Object(k.headOption)(this.props.mailBoxConfigs.list.filter(function(t){return t.id.value===e.mailBoxId})).matchWith(function(n){return Object(eu.d)(E.Id.createId(e.emailId).getOrElse(function(){throw"wrong email data object id"}),t.getEmailMessageBody(e,n)).then(function(e){return e.id})},function(){return new Promise(function(e,t){return t()})})}},{key:"onSaveDraftClick",value:function(e,t){var n=this;return this.editDraftFromValues(e).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо сохранено")),new k.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при сохранении письма")),new k.None)})}},{key:"onSendEditedDraftClick",value:function(e,t){var n=this;return this.editDraftFromValues(e).then(function(e){return Object(eu.k)(e)}).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо отправлено")),new k.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при отправлении письма")),new k.None)})}},{key:"onDraftEdit",value:function(e){var t=this;this.openDraftEditForm(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),!1,this.onSaveDraftClick,this.onSendEditedDraftClick,{emailId:e.id.value,replyTo:e.entity.msgBody.to.map(function(e){return e.email}).join(", "),subject:e.entity.msgBody.subject.text.getOrElse(function(){return""}),html:e.entity.msgBody.html.text,cc:e.entity.msgBody.cc.map(function(e){return e.email}).join(", "),bcc:e.entity.msgBody.bcc.map(function(e){return e.email}).join(", "),mailBoxId:e.entity.rels.mailBoxId.map(function(e){return e.value}).getOrUndefined()})}},{key:"onInboxOrSentView",value:function(e){var t=this;Object(k.toOption)(e).filter(function(e){return!e.entity.meta.readStatus}).foreach(function(e){Object(eu.f)(e.id).then(function(){t.fetchEmailDataObjects()})});var n=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),d.createElement(ru.a,{email:e}),[d.createElement(A.a,{key:"cancel",variant:"raised",onClick:function(){return t.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(A.a,{key:"reply",variant:"raised",onClick:function(n){return t.onReplyToClick(e)},color:"primary"},this.props.i18n.t("Ответить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onViewClick",value:function(e){e.entity.meta.emailStatus instanceof E.EmailStatusDraft?this.onDraftEdit(e):this.onInboxOrSentView(e)}},{key:"onEmailStatusChanged",value:function(e){var t=this;this.setState(K(this.state,{emailStatus:{$set:Object(k.toOption)(e)}}),function(){t.fetchEmailDataObjects(),t.props.closeMenu()})}},{key:"onEmailStatusMenuClick",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[d.createElement(eo.a,{key:E.EmailStatusInbox.$Type.value,value:E.EmailStatusInbox.$Type.value,onClick:function(){return t.onEmailStatusChanged(E.EmailStatusInbox.$Type)}},Object(iu.b)(E.EmailStatusInbox.$Type,this.props.i18n.t)),d.createElement(eo.a,{key:E.EmailStatusSent.$Type.value,value:E.EmailStatusSent.$Type.value,onClick:function(){return t.onEmailStatusChanged(E.EmailStatusSent.$Type)}},Object(iu.b)(E.EmailStatusSent.$Type,this.props.i18n.t)),d.createElement(eo.a,{key:E.EmailStatusDraft.$Type.value,value:E.EmailStatusDraft.$Type.value,onClick:function(){return t.onEmailStatusChanged(E.EmailStatusDraft.$Type)}},Object(iu.b)(E.EmailStatusDraft.$Type,this.props.i18n.t))])}},{key:"getEmailStatusIcon",value:function(e){switch(e.entity.meta.emailStatus.tpe.value){case E.EmailStatusInbox.$Type.value:return d.createElement(Gl.a,{style:{fill:Ll.a[500],transform:"rotate(180deg)"}});case E.EmailStatusDraft.$Type.value:return d.createElement(Gl.a,{style:{fill:Wl.a[500],transform:"rotate(180deg)"}});case E.EmailStatusSent.$Type.value:return d.createElement(Gl.a,{style:{fill:$l.a[500]}});default:return null}}},{key:"getEmailReadStatusIcon",value:function(e){var t=this;return e.entity.meta.opened.map(function(e){return d.createElement(ql.a,{title:t.props.i18n.t("Просмотрено получателем")},d.createElement(Xl.a,{style:{fill:Wl.a[500],fontSize:"10px"}}))}).getOrNull()}},{key:"render",value:function(){var e=this,t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%",margin:"0px"}}).getOrElse(function(){return{margin:"0px"}});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("h4",{style:t},this.props.display.label.text||this.props.i18n.t("Письма")),d.createElement(ul.b,null,this.props.display.operations.create&&d.createElement(A.a,{style:{marginTop:0,flexShrink:0,marginRight:"10px"},variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать")),d.createElement(jn.a,{style:{marginRight:"10px",flexShrink:0},onClick:this.onRenewClick},d.createElement(Jl.a,null)),d.createElement(lu.a,{onSearch:this.onSearch}),this.props.display.operations.statusFilter&&d.createElement(A.a,{style:{marginLeft:"10px",marginTop:0,flexShrink:0},onClick:this.onEmailStatusMenuClick},this.state.emailStatus.matchWith(function(t){return Object(iu.b)(t,e.props.i18n.t)},function(){return e.props.i18n.t("Статус не задан")}))),d.createElement(el.a,{showId:!1,error:this.props.emailService.error,fetching:this.props.emailService.fetching,onSelectAll:this.onSelectAll,onSort:function(){},onRecordMarked:this.onRecordMarked,onRecordSelected:this.openEmailDataObjectView,empty:!this.props.emailService.fetching&&0===this.props.emailService.list.length,withActions:!0,headers:[{id:"emailStatus",title:""},{id:"senderName",title:this.props.i18n.t("Отправитель")},{id:"emailSubject",title:this.props.i18n.t("Тема")},{id:"emailReadStatus",title:""},{id:"emailDate",title:this.props.i18n.t("Время отправки")}],columnStyles:[{flex:"0 0 24px"},{flex:1},{flex:8},{flex:"0 0 10px"},{flex:1}],rows:this.props.emailService.list.map(function(t,n){return{id:t.id.value,payload:t,fields:[d.createElement("div",{style:{display:"flex",alignItems:"center"}},e.getEmailStatusIcon(t)),e.wrapBySpan(t,t.entity.msgBody.from.name),e.wrapBySpan(t,t.entity.msgBody.subject.text.getOrElse(function(){return""})),d.createElement("div",{style:{display:"flex",alignItems:"center"}},e.getEmailReadStatusIcon(t)),e.wrapBySpan(t,e.getEmailDate(t))],buttons:[d.createElement(jn.a,{key:"readStatus",style:Xe.f,onClick:function(n){n.stopPropagation(),e.onReadStatusToggle(t)}},e.getReadStatusIcon(t)),d.createElement(jn.a,{key:"edit",style:Xe.f,onClick:function(n){n.stopPropagation(),e.openEmailDataObjectView(t)}},d.createElement(Ir.a,{style:Xe.g}))].concat(e.props.display.operations.remove?[d.createElement(jn.a,{key:"delete",style:Xe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},d.createElement(xr.a,{style:Xe.g}))]:[])}})}),d.createElement(ul.a,{nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,fromToEnd:!0,changePageSize:this.onPageSizeChanged,currentPage:this.state.currentPage,rowPerPage:this.state.rowPerPage,totalRecords:this.props.emailService.total.getOrElse(function(){return 0}),shouldShowMassActions:!1,formSearchEnabled:!1}))}}]),t}(d.Component);su=uu([m.autobind,cu("design:paramtypes",[Object])],su);var pu=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(Zl.b)(t.id,0,20,new k.None))})},fu=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(w.d)(e.blockRendererContext,t.blockRendererId),emailService:e.emailService,organisation:e.organisation,mailBoxConfigs:e.mailBoxConfigs}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.emailService===t.emailService&&e.mailBoxConfigs===t.mailBoxConfigs},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.formRecord,t.formRecord)&&e.i18n===t.i18n&&e.emailService===t.emailService&&e.mailBoxConfigs===t.mailBoxConfigs}})(Object(fe.a)([pu],[function(e,t){Object(k.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))||pu(e),Object(k.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))&&e.isTokenChecked&&!t.isTokenChecked&&pu(e)}])(Object(X.a)(Object(tu.a)(Object(nu.a)(su))))),du=n(551),hu=n.n(du),mu=n(293),gu=n.n(mu),yu=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e,t=this.props.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}),n=this.props.block.flatMap(function(e){return e.entity.ui.blockStyle}).map(function(e){return e.muiTheme}).flatMap(function(e){return e}),r=t,o=n.flatMap(function(e){return e.palette.map(function(e){return e.primaryColor})}).getOrElse(function(){return Xe.a}),i=n.flatMap(function(e){return e.palette.map(function(e){return e.secondaryColor})}).getOrElse(function(){return Xe.c}),a=r.flatMap(function(e){return e.input.map(function(e){return e.beforeColor})}).getOrElse(function(){return Wl.a[300]}),l=r.flatMap(function(e){return e.input.map(function(e){return e.hoverColor})}).getOrElse(function(){return Xe.a}),u=r.flatMap(function(e){return e.selectable.map(function(e){return e.beforeSelect})}).getOrElse(function(){return Wl.a[600]}),c=r.flatMap(function(e){return e.selectable.map(function(e){return e.afterSelect})}).getOrElse(function(){return Xe.a}),s=this.props.elementCss.flatMap(function(e){return e.fonts.map(function(e){return e.textFont.map(function(e){return e.fontSize})})}).flatMap(function(e){return e}).getOrElse(function(){return 16}),p=this.props.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),f=r.flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),h={primary:{main:o},secondary:{main:i}},m=gu()({palette:h,overrides:Object.assign({MuiButton:{root:{fontSize:p?s:"14px"},outlined:{color:u,border:"1px solid ".concat(u)}},MuiInput:{root:{fontSize:p?s:"16px"},underline:{"&:after":{borderBottom:"1px solid ".concat(l)},"&:before":{borderBottom:"1px solid ".concat(a)},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:"2px solid ".concat(l)}}},MuiOutlinedInput:{input:{padding:"12.5px 14px"}},MuiInputLabel:{outlined:{transform:"translate(14px, 16px) scale(1)"}}},"custom"===f?{MuiCheckbox:{root:{color:u},colorPrimary:{"&$checked":{color:c}}},MuiRadio:{root:{color:u},colorPrimary:{"&$checked":{color:c}}},MuiTab:{textColorPrimary:{color:u,"&$selected":{color:c}}},MuiTabs:{indicator:{backgroundColor:c}}}:{})});return d.createElement(hu.a,{theme:(e=this.props.organisationTheme,Object(k.toOption)(e.enabled).filter(function(e){return e}).matchWith(function(){return K(m,{palette:{$merge:e.value.map(function(e){return JSON.parse(e)}).map(function(e){return e.palette}).getOrElse(function(){return h})}})},function(){return m}))},this.props.children)}}]),t}(d.Component),bu=Object(h.connect)(function(e,t){return{organisationTheme:e.organisation.data.flatMap(function(e){return e.entity.uiConfig.map(function(e){return e.muiTheme})}).getOrElse(function(){return new E.OptionalValue(!1,new k.None)}),block:Object(k.liftKey)(e.block.record,t.blockId.value).flatMap(function(e){return e})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return Object(k.isEqual)(e.organisation.data,t.organisation.data)&&e.block===t.block},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.organisationTheme.value,t.organisationTheme.value)&&e.organisationTheme.enabled===t.organisationTheme.enabled&&Object(k.isEqual)(e.block,t.block)},areOwnPropsEqual:function(e,t){return e.blockId.value===t.blockId.value&&Object(k.isEqual)(e.elementCss,t.elementCss)}})(yu),vu=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.display.elementCss,t=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}).getOrElse(function(){return"100%"}),n=e.flatMap(function(e){return e.align}).getOrElse(function(){return new E.ElementAlign}).justifySelf.getOrElse(function(){return"0 0 0 0"});return d.createElement("p",{style:{padding:"10px",margin:n,width:t,borderBottom:"\n                    "+Object(Ua.d)(e).getOrElse(function(){return 1})+"px \n                    "+Object(C.g)(Object(Ua.c)(e)).getOrElse(function(){return"solid"})+" \n                    "+Object(Ua.b)(e).getOrElse(function(){return Wl.a[600]})+"\n                "}})}}]),t}(d.Component),Ou=Object(h.connect)(function(e,t){return{i18n:e.i18n}})(vu),Eu=n(1543),ku=n(223),ju=n.n(ku),Cu=n(224),Ru=n.n(Cu),wu=n(225),Iu=n.n(wu),Su=n(191),Pu=n.n(Su),Tu=n(96),xu=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_u=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"handleExpansionPanelClick",value:function(){var e=this.props.expanded.getOrElse(function(){return!1});this.props.dispatch(e?Object(Tu.i)(this.props.display.id):Object(Tu.k)(this.props.display.id))}},{key:"render",value:function(){var e=Object(C.n)(this.props.display);return d.createElement("div",{className:"TabsWidget__container "+e+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(ju.a,{expanded:this.props.expanded.getOrElse(function(){return!1})},d.createElement(Ru.a,{expandIcon:d.createElement(Pu.a,null),onClick:this.handleExpansionPanelClick},d.createElement(Or.a,null,Object(oe.c)(this.props.display.label.text))),d.createElement(Iu.a,null,this.props.children)))}}]),t}(d.Component);_u=xu([m.autobind],_u);var Du=Object(h.connect)(function(e,t){return{expanded:Object(No.liftKey)(e.userUi.expansionPanel.expanded,t.display.id.value)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatePropsEqual:function(e,t){return Object(No.isEqual)(e.expanded,t.expanded)}})(_u),Fu=n(204),Mu=n(632),Wu=function(e){function t(e,n,r,i){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Create",{ownerId:e,parentId:n,body:r,tags:i}))}return s()(t,e),t}(nl.a),Bu=function(e){function t(e,n){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Update",{commentId:e,body:n}))}return s()(t,e),t}(nl.a),Lu=function(e){function t(e){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Request",{commentId:e}))}return s()(t,e),t}(nl.a),Au=function(e){function t(e){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Delete",{commentId:e}))}return s()(t,e),t}(nl.a),$u=function(e){function t(e,n){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","ListFormData",{ownerId:e,fields:n}))}return s()(t,e),t}(nl.a),Vu=function(e){return tl.a.send(new Lu(e),Object(il.e)())},qu=function(e,t,n,r,o,i,a){return function(l,u){return function(e,t,n,r){return tl.a.send(new Wu(e,t,n,r),Object(il.c)())}(e,r,t,n).then(function(e){return Vu(e.id)}).then(function(t){var n=t.record;return l(Object(Fu.o)({formDataId:e,comment:new Fu.a(n.id,n.entity.created,n.entity.body,o,i,n.entity.eventLineId,n.entity.ownerId,n.entity.authorId,n.entity.parentId,[],n.entity.userId,n.entity.tags),sorting:a})),n})}},Nu=function(e,t,n,r){return function(o,i){return function(e,t){return tl.a.send(new Bu(e,t),Object(il.f)())}(t.commentId,n).then(function(e){return Vu(e.id)}).then(function(i){return o(Object(Fu.q)({formDataId:e,comment:K(t,{body:{$set:n},tags:{$set:r}})})),i.record})}},zu=function(e,t){return function(n,r){return function(e){return tl.a.send(new Au(e),il.d)}(t).then(function(r){return n(Object(Fu.p)({formDataId:e,commentId:t})),r})}},Hu=function(e,t,n){return function(r,o){return r(Object(Fu.s)({formDataId:e})),(i=e,a=t.reduce(function(e,t){return e.concat([t.nameFieldId]).concat(t.avatarFieldId.matchWith(function(e){return[e]},function(){return[]}))},[]),tl.a.send(new $u(i,a),function(e){return e})).then(function(o){var i=t.reduce(function(e,t){return e.concat(t.avatarFieldId.matchWith(function(e){return[e]},function(){return[]}))},[]),a=t.reduce(function(e,t){return e.concat([t.nameFieldId])},[]),l=Object(j.a)(o.comments,[function(e){return e.entity.created}],n.byCreatedDateAsc?"asc":"desc"),u=l.map(function(e){return function(e,t,n,r,o){var i=Object(k.liftKey)(t.authorsMap,e.entity.authorId.map(function(e){return e.value}).getOrElse(function(){return""})),a=Object(k.liftKey)(t.usersMap,e.entity.userId.map(function(e){return e.value}).getOrElse(function(){return""}));Object(k.headOption)(r.filter(function(e){return i.flatMap(function(t){return Object(k.liftKey)(t,e.value)}).nonEmpty()})).flatMap(function(e){return i.flatMap(function(t){return Object(k.liftKey)(t,e.value)})}).map(function(e){return e.toString()}).getOrElse(function(){return""}),Object(k.headOption)(o.filter(function(e){return i.flatMap(function(t){return Object(k.liftKey)(t,e.value)}).nonEmpty()})).flatMap(function(e){return i.flatMap(function(t){return Object(k.liftKey)(t,e.value)})}).flatMap(function(e){return Object(k.headOption)(e.files)}).matchWith(function(e){return Object(k.toOption)(e)},function(){return a.flatMap(function(e){return e.avatarId})});var l=i.flatMap(function(e){return Object(k.headOption)(r.filter(function(t){return Object(k.liftKey)(e,t.value).nonEmpty()})).flatMap(function(t){return Object(k.liftKey)(e,t.value)}).map(function(e){return e.toString()})}).matchWith(function(e){return Object(k.toOption)(e)},function(){return a.map(function(e){return e.name})}),u=i.flatMap(function(e){return Object(k.headOption)(o.filter(function(t){return Object(k.liftKey)(e,t.value).nonEmpty()})).flatMap(function(t){return Object(k.liftKey)(e,t.value)}).flatMap(function(e){return Object(k.headOption)(e.files)})}).matchWith(function(e){return Object(k.toOption)(e)},function(){return a.flatMap(function(e){return e.avatarId})});return new Fu.a(e.id,e.entity.created,e.entity.body,l,u,e.entity.eventLineId,e.entity.ownerId,e.entity.authorId,e.entity.parentId,n.filter(function(t){return t.entity.parentId.filter(function(t){return e.id.value===t.value}).nonEmpty()}).map(function(e){return e.id}),e.entity.userId,e.entity.tags)}(e,o,l,a,i)});r(Object(Fu.u)({formDataId:e,list:u}))}).catch(function(t){throw r(Object(Fu.r)({formDataId:e,error:t})),t});var i,a}},Uu=n(544),Ku=n.n(Uu),Gu=(n(1571),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Yu=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getAvatarSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Un.b)(n,e,t.props.cdnAddress)})}},{key:"getAvatar",value:function(){var e=this;return this.props.currentAuthorAvatar.flatMap(function(t){return e.getAvatarSrc(t)}).matchWith(function(e){return d.createElement(Nr.a,{src:e})},function(){return e.props.currentAuthorName.filter(function(e){return""!==e}).matchWith(function(e){return d.createElement(Nr.a,null,Object(k.head)(e.toUpperCase().split("")))},function(){return d.createElement(Nr.a,{src:n(622)})})})}},{key:"render",value:function(){return d.createElement(En.a,{style:{padding:0}},d.createElement(Ku.a,{style:{alignSelf:"flex-start"}},this.getAvatar()),this.props.children)}}]),t}(d.Component);Yu=Gu([m.autobind],Yu);var Ju=Object(h.connect)(function(e,t){return{i18n:e.i18n,cdnAddress:e.config.cdnAddress,authToken:e.auth.token}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Yu),Qu=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Xu=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Zu=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={editedBody:e.body,editedTags:e.tags},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.body!==e.body&&this.setState(K(this.state,{editedBody:{$set:e.body}}))}},{key:"onEditedBodyChanged",value:function(e){this.setState(K(this.state,{editedBody:{$set:e.target.value}}))}},{key:"onSendClick",value:function(){this.props.onSaveClick(this.state.editedBody,this.state.editedTags)}},{key:"renderEditorSection",value:function(){return d.createElement("div",{style:{flex:"1 1 auto",padding:"0 16px",display:"flex",flexDirection:"column"}},d.createElement(B.a,{fullWidth:!0,value:this.state.editedBody,onChange:this.onEditedBodyChanged}),d.createElement("div",{style:{marginTop:"5px",display:"flex",alignSelf:"flex-end"}},d.createElement(A.a,{size:"small",style:{marginRight:"5px"},onClick:this.props.onCancelClick},this.props.i18n.t("Отменить")),d.createElement(A.a,{size:"small",disabled:""===this.state.editedBody,variant:"raised",color:"primary",onClick:this.onSendClick},this.props.saveButtonLabel)))}},{key:"render",value:function(){return this.renderEditorSection()}}]),t}(d.Component);Zu=Qu([m.autobind,Xu("design:paramtypes",[Object])],Zu);var ec=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Zu),tc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},nc=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rc=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showNewCommentEditor:!1,showCommentEditor:!1},n}return s()(t,e),a()(t,[{key:"getCommentDate",value:function(e){var t=new Date(e.created),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?t.toLocaleTimeString():t.toLocaleDateString()}},{key:"getAvatarSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Un.b)(n,e,t.props.cdnAddress)})}},{key:"getAvatar",value:function(e){var t=this;return e.avatarFileId.flatMap(function(e){return t.getAvatarSrc(e)}).matchWith(function(e){return d.createElement(Nr.a,{src:e})},function(){return e.nickname.filter(function(e){return""!==e}).matchWith(function(e){return d.createElement(Nr.a,null,Object(k.head)(e.toUpperCase().split("")))},function(){return d.createElement(Nr.a,{src:n(622)})})})}},{key:"onReplyClick",value:function(){var e=this;this.setState(K(this.state,{showNewCommentEditor:{$set:!0}}),function(){e.props.dispatch(Object(Fu.m)({formDataId:e.props.ownerId,commentId:e.props.commentId}))})}},{key:"onSendClick",value:function(e,t,n){var r=this;this.setState(K(this.state,{showNewCommentEditor:{$set:!1}}),function(){r.props.dispatch(qu(r.props.ownerId,e,t,Object(k.toOption)(n.commentId),r.props.currentAuthorName,r.props.currentAuthorAvatar,r.props.sorting)).then(function(){r.props.dispatch(Object(Fu.m)({formDataId:r.props.ownerId,commentId:r.props.commentId}))})})}},{key:"onSaveClick",value:function(e,t,n){this.props.dispatch(Nu(this.props.ownerId,n,e,t))}},{key:"onNewCancelClick",value:function(){this.setState(K(this.state,{showNewCommentEditor:{$set:!1}}))}},{key:"onEditorCancelClick",value:function(){this.setState(K(this.state,{showCommentEditor:{$set:!1}}))}},{key:"onShowRepliesClick",value:function(){this.props.dispatch(Object(Fu.m)({formDataId:this.props.ownerId,commentId:this.props.commentId}))}},{key:"onHideRepliesClick",value:function(){this.props.dispatch(Object(Fu.l)({formDataId:this.props.ownerId,commentId:this.props.commentId}))}},{key:"renderReplySection",value:function(e){var t=this;return this.state.showNewCommentEditor&&d.createElement(Ju,{currentAuthorAvatar:this.props.currentAuthorAvatar,currentAuthorName:this.props.currentAuthorName},d.createElement(ec,{body:"",tags:[],saveButtonLabel:this.props.i18n.t("Отправить"),onSaveClick:function(n,r){return t.onSendClick(n,r,e)},onCancelClick:this.onNewCancelClick}))}},{key:"onEditClick",value:function(){this.props.closeMenu(),this.setState(K(this.state,{showCommentEditor:{$set:!0}}))}},{key:"onDeleteClick",value:function(){this.props.closeMenu(),this.props.dispatch(zu(this.props.ownerId,this.props.commentId))}},{key:"onMoreClick",value:function(e){this.props.openMenu(e.currentTarget,[d.createElement(eo.a,{key:"edit",onClick:this.onEditClick},d.createElement(yn.a,null,d.createElement(Ir.a,null)),d.createElement(vn.a,null,this.props.i18n.t("Редактировать"))),d.createElement(eo.a,{key:"delete",onClick:this.onDeleteClick},d.createElement(yn.a,null,d.createElement(xr.a,null)),d.createElement(vn.a,null,this.props.i18n.t("Удалить")))])}},{key:"renderButtonsSection",value:function(e){return d.createElement("div",null,e.children.length>0&&!this.props.isChildrenShow&&d.createElement(A.a,{size:"small",style:{marginRight:"5px"},onClick:this.onShowRepliesClick},this.props.i18n.t("Показать ответы")),e.children.length>0&&this.props.isChildrenShow&&d.createElement(A.a,{size:"small",style:{marginRight:"5px"},onClick:this.onHideRepliesClick},this.props.i18n.t("Скрыть ответы")),d.createElement(A.a,{size:"small",onClick:this.onReplyClick},this.props.i18n.t("Ответить")))}},{key:"renderChildrenSection",value:function(e){var t=this;return this.props.isChildrenShow&&d.createElement(tn.a,null,e.children.map(function(e){return d.createElement(oc,{key:e.value,commentId:e,ownerId:t.props.ownerId,currentAuthorFormData:t.props.currentAuthorFormData,currentAuthorAvatar:t.props.currentAuthorAvatar,currentAuthorName:t.props.currentAuthorName,viewSettings:t.props.viewSettings,sorting:t.props.sorting})}))}},{key:"renderCommentSection",value:function(e){var t=this;return this.state.showCommentEditor?d.createElement(Ju,{currentAuthorAvatar:e.avatarFileId,currentAuthorName:e.nickname},d.createElement(ec,{body:e.body,tags:e.tags,saveButtonLabel:this.props.i18n.t("Сохранить"),onSaveClick:function(n,r){return t.onSaveClick(n,r,e)},onCancelClick:this.onEditorCancelClick})):e.body}},{key:"canModify",value:function(e){return e.authorId.nonEmpty()&&Object(k.isEqual)(this.props.currentAuthorFormData.map(function(e){return e.id}).map(function(e){return e.value}),e.authorId.map(function(e){return e.value}))||e.authorId.isEmpty()&&Object(k.isEqual)(e.userId.map(function(e){return e.value}),this.props.user.id.map(function(e){return e.value}))}},{key:"renderPrimarySection",value:function(e){var t=this;return d.createElement(d.Fragment,null,d.createElement(Or.a,{inline:!0,component:"span",color:"textPrimary",style:{marginRight:"5px",fontWeight:"bold"}},e.nickname.getOrElse(function(){return t.props.i18n.t("Аноним")})),d.createElement(Or.a,{inline:!0,component:"span",color:"textSecondary"},this.getCommentDate(e)))}},{key:"render",value:function(){var e=this;return this.props.comment.map(function(t){return d.createElement(En.a,{style:{alignItems:"flex-start",padding:0},className:"CommentsListDisplayItem-root"},d.createElement(Ku.a,null,e.getAvatar(t)),d.createElement(vn.a,{style:{paddingRight:0},primary:e.renderPrimarySection(t),secondaryTypographyProps:{component:"div",color:"textPrimary"},secondary:d.createElement(d.Fragment,null,d.createElement("div",{style:{display:"flex"}},e.renderCommentSection(t)),e.renderButtonsSection(t),!e.props.sorting&&e.renderReplySection(t),e.renderChildrenSection(t),e.props.sorting&&e.renderReplySection(t))}),e.canModify(t)&&d.createElement(jn.a,{className:"CommentsListDisplayItem-more",onClick:e.onMoreClick},d.createElement(N.a,null)))}).getOrNull()}}]),t}(d.Component);rc=tc([m.autobind,nc("design:paramtypes",[Object])],rc);var oc=Object(h.connect)(function(e,t){return{i18n:e.i18n,cdnAddress:e.config.cdnAddress,authToken:e.auth.token,user:e.user,comment:Object(Mu.b)(e.comments,t.ownerId,t.commentId),isChildrenShow:Object(Mu.d)(e.comments,t.ownerId,t.commentId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.config.cdnAddress===t.config.cdnAddress&&Object(k.isEqual)(e.auth.token,t.auth.token)&&e.comments===t.comments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.cdnAddress===t.cdnAddress&&Object(k.isEqual)(e.authToken,t.authToken)&&Object(k.isEqual)(e.comment,t.comment)&&e.isChildrenShow===t.isChildrenShow}})(Object(nu.a)(rc)),ic=oc,ac=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},lc=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},uc=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={newCommentText:""},n}return s()(t,e),a()(t,[{key:"onSendClick",value:function(e,t){var n=this;this.props.dispatch(qu(this.props.formRecordId,e,t,new k.None,this.props.currentAuthorName,this.props.currentAuthorAvatar,this.props.sorting)).then(function(){n.setState(K(n.state,{newCommentText:{$set:""}}))}).catch(function(){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Произошла ошибка")),new k.None)})}},{key:"onCancelClick",value:function(){this.setState(K(this.state,{newCommentText:{$set:""}}))}},{key:"renderNewCommentSection",value:function(){return d.createElement(Ju,{currentAuthorAvatar:this.props.currentAuthorAvatar,currentAuthorName:this.props.currentAuthorName},d.createElement(ec,{body:this.state.newCommentText,tags:[],saveButtonLabel:this.props.i18n.t("Отправить"),onSaveClick:this.onSendClick,onCancelClick:this.onCancelClick}))}},{key:"renderCommentsList",value:function(e){var t=this;return d.createElement(tn.a,null,e.list.filter(function(e){return e.parentId.isEmpty()}).map(function(e){return d.createElement(ic,{key:e.commentId.value,commentId:e.commentId,ownerId:t.props.formRecordId,currentAuthorFormData:t.props.currentAuthorFormData,currentAuthorAvatar:t.props.currentAuthorAvatar,currentAuthorName:t.props.currentAuthorName,viewSettings:t.props.viewSettings,sorting:t.props.sorting})}))}},{key:"render",value:function(){var e=this;return d.createElement("div",null,!this.props.sorting.byCreatedDateAsc&&this.renderNewCommentSection(),this.props.comments.map(function(t){return e.renderCommentsList(t)}).getOrNull(),this.props.sorting.byCreatedDateAsc&&this.renderNewCommentSection())}}]),t}(d.Component);uc=ac([m.autobind,lc("design:paramtypes",[Object])],uc);var cc=Object(h.connect)(function(e,t){return{i18n:e.i18n,comments:Object(Mu.c)(e.comments,t.formRecordId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.comments===t.comments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(k.isEqual)(e.comments,t.comments)}})(Object(tu.a)(uc)),sc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},pc=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%",margin:"0px"}}).getOrElse(function(){return{margin:"0px"}});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("h4",{style:t},this.props.display.label.text||this.props.i18n.t("Комментарии")),this.props.formRecord.map(function(t){return d.createElement(cc,{formRecordId:t.id,currentAuthorFormData:e.props.currentAuthorFormData,currentAuthorAvatar:e.props.currentAuthorAvatar,currentAuthorName:e.props.currentAuthorName,viewSettings:e.props.display.viewSettings,sorting:e.props.display.sorting})}).getOrNull())}}]),t}(d.Component);pc=sc([m.autobind],pc);var fc=function(e){return e.formRecord.foreach(function(t){e.dispatch(Hu(t.id,e.display.viewSettings,e.display.sorting))})},dc=function(e){return Object(No.toOption)(e).filter(function(e){return e.isTokenChecked}).foreach(function(e){fc(e)})},hc=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(w.d)(e.blockRendererContext,t.blockRendererId),comments:Object(w.d)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(Mu.c)(e.comments,t.id)}),currentAuthorFormData:Object(w.j)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(w.b)(e.blockRendererContext,t)}).filter(function(e){return e.isPrivateCabinet}).flatMap(function(e){return e.formRecord}),currentAuthorName:Object(w.j)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(w.b)(e.blockRendererContext,t)}).flatMap(function(n){return n.isPrivateCabinet?Object(No.headOption)(t.display.viewSettings.filter(function(e){return e.formId.value===n.formId.value})).flatMap(function(e){return n.formRecord.flatMap(function(t){return t.entity.getFormFieldValue(e.nameFieldId)})}).map(function(e){return e.value.toString()}):e.user.name}),currentAuthorAvatar:Object(w.j)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(w.b)(e.blockRendererContext,t)}).flatMap(function(e){return e.isPrivateCabinet?Object(No.headOption)(t.display.viewSettings.filter(function(t){return t.formId.value===e.formId.value})).flatMap(function(t){return e.formRecord.flatMap(function(e){return t.avatarFieldId.flatMap(function(t){return e.entity.getFormFieldValue(t)})})}).filter(function(e){return e.value instanceof E.ValueFileList}).map(function(e){return e.value}).flatMap(function(e){return Object(No.headOption)(e.files)}):new No.None})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.comments===t.comments},areStatePropsEqual:function(e,t){return Object(No.isEqual)(e.comments,t.comments)&&Object(No.isEqual)(e.formRecord,t.formRecord)&&Object(No.isEqual)(e.currentAuthorFormData,t.currentAuthorFormData)&&Object(No.isEqual)(e.currentAuthorName,t.currentAuthorName)&&Object(No.isEqual)(e.currentAuthorAvatar,t.currentAuthorAvatar)&&e.i18n===t.i18n}})(Object(fe.a)([function(e){return e.formRecord.foreach(function(t){e.dispatch(Object(Fu.t)({formDataId:t.id})),dc(e)})}],[function(e,t){Object(No.isEqual)(e.formRecord.map(function(e){return e.id.value}),t.formRecord.map(function(e){return e.id.value}))||fc(e)}],[],[function(e){return e.formRecord.foreach(function(t){e.dispatch(Object(Fu.n)({formDataId:t.id}))})}])(pc)),mc=n(56),gc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},yc=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getFieldName",value:function(e){var t=this;return e.flatMap(function(e){return Object(k.headOption)(t.props.formFields.getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.value}))}).map(function(e){return e.entity.caption}).getOrElse(function(){return""})}},{key:"getSelectValue",value:function(e){return Object(k.headOption)(this.props.value.map(function(e){return e instanceof E.ValueObjectRefs?e.id:[]}).getOrElse(function(){return[]}).filter(function(t){return t instanceof E.Id&&t.value===e.value})).nonEmpty()}},{key:"onRadioChange",value:function(e,t){this.props.onChange(new E.ValueObjectRefs([e]),t)}},{key:"onCheckboxChange",value:function(e,t){var n=this.props.value.map(function(e){return e.id}).getOrElse(function(){return[]}),r=n.filter(function(t){return t.value===e.value}).length>0;this.props.onChange(new E.ValueObjectRefs(r?[].concat(M()(n.filter(function(t){return t.value!==e.value}))):[].concat(M()(n),[e])),t)}},{key:"renderChildElement",value:function(e,t){var n,r=this;return Object(mc.b)(this.props.display.variant.tpe.value)((n={},Bn()(n,E.SelectionMatrixVariantRadio.$Type.value,d.createElement(Lt.a,{disabled:this.props.blockType instanceof E.WebRegistrationBlockTypeDisplay,checked:this.getSelectValue(e.id),onChange:function(){return r.onRadioChange(e.id,t.dataOutput)}})),Bn()(n,E.SelectionMatrixVariantCheckbox.$Type.value,d.createElement(Zt.a,{disabled:this.props.blockType instanceof E.WebRegistrationBlockTypeDisplay,checked:this.getSelectValue(e.id),onChange:function(){return r.onCheckboxChange(e.id,t.dataOutput)}})),n)).getOrElse(function(){throw"unknow selection matrix type "+r.props.display.variant.tpe.value})}},{key:"render",value:function(){var e=this;return d.createElement(xa.a,null,d.createElement(Pa.a,null,this.getFieldName(this.props.element.dataOutput.map(function(e){return e.formField}))),this.props.dataInput.map(function(t){return t.displayValues.map(function(t,n){return d.createElement(Pa.a,{key:n,style:{textAlign:"center"}},e.renderChildElement(t,e.props.element))})}).getOrNull())}}]),t}(d.Component);yc=gc([m.autobind],yc);var bc=Object(h.connect)(function(e,t){return{i18n:e.i18n,formFields:e.currentForm.data.flatMap(function(t){return Object(H.e)(e.fields,t.id)}),value:t.element.dataOutput.flatMap(function(n){return Object(R.k)(e.dataOutput,t.blockRendererId,n).map(function(e){return e.value})}).filter(function(e){return e instanceof E.ValueObjectRefs||e instanceof E.ValueList||e instanceof E.ValueBool}),dataInput:Object(T.b)(e.dataInputs,t.element.id)}},function(e,t){return{onChange:function(n,r){r.foreach(function(r){return e(Object(U.D)({output:r,value:n,blockRendererId:t.blockRendererId,displayId:t.display.id}))})},dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.currentForm===t.currentForm},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(k.isEqual)(e.value,t.value)&&Object(k.isEqual)(e.dataInput,t.dataInput)&&Object(k.isEqual)(e.formFields,t.formFields)}})(yc),vc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Oc=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getTitleValues",value:function(){return this.props.titleValues.map(function(e){return e.displayValues}).getOrElse(function(){return[]})}},{key:"render",value:function(){return d.createElement(Ia.a,null,d.createElement(xa.a,null,d.createElement(Pa.a,null),this.getTitleValues().map(function(e,t){return d.createElement(Pa.a,{key:t,style:{textAlign:"center"}},e.toString())})))}}]),t}(d.Component);Oc=vc([m.autobind],Oc);var Ec=Object(h.connect)(function(e,t){return{i18n:e.i18n,titleValues:Object(k.headOption)(t.display.children).flatMap(function(t){return Object(T.b)(e.dataInputs,t.id)})}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataInputs===t.dataInputs},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(k.isEqual)(e.titleValues,t.titleValues)}})(Oc),kc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},jc=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderTableBody",value:function(){var e=this;return d.createElement(Ra.a,null,this.props.display.children.map(function(t){return d.createElement(bc,{display:e.props.display,element:t,blockRendererId:e.props.blockRendererId,blockType:e.props.blockType})}))}},{key:"render",value:function(){return d.createElement(ja.a,null,d.createElement(Ec,{display:this.props.display}),this.renderTableBody())}}]),t}(d.Component);jc=kc([m.autobind],jc);var Cc=Object(h.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(jc),Rc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},wc=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getContainerClassName",value:function(){return"SelectionMatrixDisplay__container \n            "+Object(C.n)(this.props.display)+" \n            "+Object(C.B)(this.props.display,"container")}},{key:"render",value:function(){return d.createElement("div",{className:this.getContainerClassName(),style:this.props.style},d.createElement(Cc,{key:this.props.display.id.value,display:this.props.display,blockRendererId:this.props.blockRendererId,blockId:this.props.blockId,blockType:this.props.blockType,formId:this.props.formId}))}}]),t}(d.Component);wc=Rc([m.autobind],wc);var Ic=Object(h.connect)(function(e,t){return{i18n:e.i18n,error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),formFields:e.currentForm.data.flatMap(function(t){return Object(H.e)(e.fields,t.id)}).getOrElse(function(){return[]})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Object(fe.a)([function(e){e.display.children.forEach(function(t){return e.dispatch(Object(de.e)(e.blockRendererId,t,e.formId))})},function(e){e.display.children.forEach(function(t){return e.dispatch(Object(de.h)(e.blockRendererId,t,e.formId))})}],[],[],[function(e){e.display.children.forEach(function(t){return e.dispatch(Object(de.a)(e.blockRendererId,t))})}],function(e,t){return!function(e,t){return e.formId===t.formId&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId}(e,t)&&e.i18n!==t.i18n})(wc)),Sc=n(194),Pc=n(1544),Tc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},xc=function(e){function t(){o()(this,t);var e=u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.headers=["Дата","Ссылка"].map(function(t,n){return{id:n.toString(),title:e.props.i18n.t(t)}}),e}return s()(t,e),a()(t,[{key:"getRows",value:function(){var e=this;return this.props.logPage.getOrElse(function(){return[]}).map(function(t,n){return{payload:"",id:n.toString(),fields:e.getFields(t)}})}},{key:"getFields",value:function(e){var t=new Date(e.stamp);return[d.createElement("span",null,t.toLocaleDateString()," ",t.toLocaleTimeString()),e.url]}},{key:"onNextPage",value:function(){this.props.dispatch(Object(ll.h)(this.props.visitedUrlsLog.currentPage+1))}},{key:"onPrevPage",value:function(){this.props.dispatch(Object(ll.h)(this.props.visitedUrlsLog.currentPage-1))}},{key:"onFirstPage",value:function(){this.props.dispatch(Object(ll.h)(0))}},{key:"onLastPage",value:function(){this.props.dispatch(Object(ll.h)(Math.floor(this.getTotalRecords()/this.props.visitedUrlsLog.pageSize)))}},{key:"onPageSizeChanged",value:function(e){this.props.dispatch(Object(ll.i)(e)),this.onFirstPage()}},{key:"getTotalRecords",value:function(){var e=this;return this.props.currentFormRecord.flatMap(function(t){return Object(k.liftKey)(e.props.visitedUrlsLog.result,t.id.value).flatMap(function(e){return e.map(function(e){return e.total})})}).getOrElse(function(){return 0})}},{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(el.a,{fetching:this.props.logsFetching,showId:!1,error:this.props.logsFetchingError,headers:this.headers,rows:this.getRows(),columnStyles:[{flex:1},{flex:3},{flex:4}]}),d.createElement(ul.a,{pageSizes:[5,10,20,40,60],nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,changePageSize:this.onPageSizeChanged,currentPage:this.props.visitedUrlsLog.currentPage,rowPerPage:this.props.visitedUrlsLog.pageSize,totalRecords:this.getTotalRecords()}))}}]),t}(d.Component);xc=Tc([m.autobind],xc);var _c=function(e){e.currentFormRecord.foreach(function(t){var n,r,o,i;e.dispatch((n=e.formId,r=t.id,o=e.visitedUrlsLog.currentPage,i=e.visitedUrlsLog.pageSize,function(e){e(Object(ll.g)({formDataId:r}));var t=new E.VisitedUrlsListRequest(n,r,o,i,Object(k.toOption)(new E.Interval));return tl.a.send(new ol(t),Object(il.h)()).then(function(t){return e(Object(ll.j)({formDataId:r,resolved:t.page})),t}).catch(function(t){throw e(Object(ll.f)({formDataId:r,error:t})),t})}))})},Dc=Object(h.connect)(function(e,t){var n=Object(w.d)(e.blockRendererContext,t.blockRendererId);return{currentFormRecord:n,visitedUrlsLog:e.visitedUrlsLog,i18n:e.i18n,logPage:n.flatMap(function(t){return Object(k.liftKey)(e.visitedUrlsLog.result,t.id.value)}).flatMap(function(e){return e.map(function(e){return e.records})}),logsFetching:n.flatMap(function(t){return Object(k.liftKey)(e.visitedUrlsLog.fetching,t.id.value)}).getOrElse(function(){return!1}),logsFetchingError:n.flatMap(function(t){return Object(k.liftKey)(e.visitedUrlsLog.error,t.id.value)}).getOrElse(function(){return new k.None})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext&&e.visitedUrlsLog===t.visitedUrlsLog},areStatePropsEqual:function(e,t){return Object(k.isEqual)(e.currentFormRecord,t.currentFormRecord)&&Object(k.isEqual)(e.logPage,t.logPage)&&Object(k.isEqual)(e.logsFetchingError,t.logsFetchingError)&&e.logsFetching===t.logsFetching&&e.i18n===t.i18n&&e.visitedUrlsLog===t.visitedUrlsLog}})(Object(fe.a)([_c],[function(e,t){Object(k.isEqual)(e.currentFormRecord,t.currentFormRecord)||e.dispatch(Object(ll.h)(0))},function(e,t){if(e.isTokenChecked)if(!e.isTokenChecked||t.isTokenChecked){var n=e.visitedUrlsLog,r=n.currentPage,o=n.pageSize,i=t.visitedUrlsLog,a=i.currentPage,l=i.pageSize;a===r&&l===o||_c(e)}else _c(e)}])(Object(X.a)(xc))),Fc=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getLabelByCurrentBlockLang",value:function(e,t){var n=this.props.block.settings.selectedLangOrderIndex;return Object(k.headOption)(t.filter(function(e){return e.order===n})).flatMap(function(t){return Object(k.liftKey)(t.translationMap,e)})}},{key:"getAggregateMargin",value:function(e){var t=e.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new E.ElementProportions}),n=e.elementCss.flatMap(function(e){return e.align}).getOrElse(function(){return new E.ElementAlign}).justifySelf.getOrElse(function(){return"0 0 0 0"}).split(" ");return t.margin.map(function(e){return e.toString()}).getOrElse(function(){return(e.getDefaultMargin()+"px ").repeat(4).replace(/\s+$/,"")}).split(" ").map(function(e,t){return"auto"===n[t]?n[t]:e}).join(" ")}},{key:"getCellJustifyContent",value:function(e,t){return-1!==t.elementCss.flatMap(function(e){return e.align}).getOrElse(function(){return new E.ElementAlign}).justifySelf.getOrElse(function(){return"0 0 0 0"}).indexOf("auto")?void 0:e}},{key:"getDisplayRenderer",value:function(e){return d.createElement(Mc,{key:e.id.value,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,display:e,blockId:this.props.blockId,formId:this.props.formId,getBlockComponent:this.props.getBlockComponent,parentRecordId:this.props.parentRecordId,isRootElement:!1,handleButtonPress:this.props.handleButtonPress})}},{key:"getBlockJustifyContent",value:function(e){return e.map(function(e){return e.entity.ui.justifyContent})}},{key:"renderDisplayElement",value:function(e){var t=this;Object(b.b)(this.props.block,this.props.blockId).filter(function(e){return e.entity.languageConfig.enabled}).flatMap(function(n){return t.getLabelByCurrentBlockLang(Object(oe.e)(e.label.text),n.entity.languageConfig.langs)}).foreach(function(t){e=K(e,{label:{text:{$set:t}}})});var n=e.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new E.ElementProportions}),r=e.elementCss.flatMap(function(e){return e.align}).getOrElse(function(){return new E.ElementAlign}),o={margin:this.getAggregateMargin(e),padding:n.padding.map(function(e){return e.toString()}).getOrElse(function(){return e.getDefaultPadding()+"px"})};switch(e.tpe.value){case E.FieldElement.$Type.value:return d.createElement(Pi,{key:e.id.value,style:o,blockRendererId:this.props.blockRendererId,display:e,blockType:this.props.blockType,blockId:this.props.blockId,formId:this.props.formId,fieldId:e.dataInput.map(function(e){return e.formField}),parentRecordId:this.props.parentRecordId,getBlockComponent:this.props.getBlockComponent});case E.GroupElement.$Type.value:var i=e;return d.createElement(ya,{key:e.id.value,display:i,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"}),flexWrap:i.columnsWrapping?"wrap":"nowrap"}),components:Object(j.a)(i.children,"position").map(function(e){return t.getDisplayRenderer(e)})});case E.GroupElementCell.$Type.value:var a=e,l=this.props.isRootElement?"1 1 100%":"1 0 0px";return d.createElement(ha,{key:e.id.value,display:a,style:Object.assign({maxWidth:n.maxWidth.getOrElse(function(){return"none"}),minWidth:n.minWidth.getOrElse(function(){return"58px"}),flex:n.width.map(function(e){return"auto"===e?l:"0 0 "+e}).getOrElse(function(){return l})},o),components:Object(j.a)(a.children,"position").map(function(e){return d.createElement("div",{key:e.id.value,className:Object(C.n)(e),style:{display:"flex",flexGrow:0,justifyContent:t.getCellJustifyContent(r.justifyContent,e)}},t.getDisplayRenderer(e))})});case E.TabsDisplayElement.$Type.value:var u=e;return d.createElement(Li,{key:e.id.value,display:u,components:u.children.filter(function(e){return Object(k.toOption)(u.tabsPosition).filter(function(t){return(t instanceof E.TabsPositionRight||t instanceof E.TabsPositionLeft)&&(t.menuBottomContainer.value===e.id.value||t.menuTopContainer.value===e.id.value)}).isEmpty()}).filter(function(e){return e.id.value!==Sc.d&&e.id.value!==Sc.c}),style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),menuTopChildren:Object(k.toOption)(u.tabsPosition).map(function(e){return e instanceof E.TabsPositionRight||e instanceof E.TabsPositionLeft?u.children.filter(function(t){return e.menuTopContainer.value===t.id.value||t.id.value===Sc.d}):[]}).getOrElse(function(){return[]}).map(function(e){return t.getDisplayRenderer(e)}),menuBottomChildren:Object(k.toOption)(u.tabsPosition).map(function(e){return e instanceof E.TabsPositionRight||e instanceof E.TabsPositionLeft?u.children.filter(function(t){return e.menuBottomContainer.value===t.id.value||t.id.value===Sc.c}):[]}).getOrElse(function(){return[]}).map(function(e){return t.getDisplayRenderer(e)})},u.children.filter(function(e){return Object(k.toOption)(u.tabsPosition).filter(function(t){return(t instanceof E.TabsPositionRight||t instanceof E.TabsPositionLeft)&&(t.menuBottomContainer.value===e.id.value||t.menuTopContainer.value===e.id.value)}).isEmpty()}).filter(function(e){return e.id.value!==Sc.d&&e.id.value!==Sc.c}).map(function(e){return t.getDisplayRenderer(e)}));case E.StepperDisplayElement.$Type.value:var c=e,s=c.children;return d.createElement(Ji,{key:e.id.value,blockRendererId:this.props.blockRendererId,blockId:this.props.blockId,components:c.children,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:c},s.map(function(e){return t.getDisplayRenderer(e)}));case E.DocumentsElement.$Type.value:var p=e;return d.createElement(sa,{key:e.id.value,blockRendererId:this.props.blockRendererId,display:p,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})})});case E.ButtonElement.$Type.value:var f=e,h=Object(k.liftKey)(this.props.block.record,this.props.blockId.value).flatMap(function(e){return e.flatMap(function(e){return e.entity.ui.blockStyle})});return d.createElement(Ja,{key:e.id.value,display:f,handleButtonPress:this.props.handleButtonPress,style:Object.assign(o),blockStyle:h});case E.EmbeddedBlockElement.$Type.value:var m=e;return d.createElement(kl.a,{key:e.id.value,blockType:this.props.blockType,display:m,style:Object.assign(o,{flex:"1"}),blockRendererId:this.props.blockRendererId,getBlockComponent:this.props.getBlockComponent});case E.ParentsRefsElement.$Type.value:var g=e;return d.createElement(_l,{key:e.id.value,display:g,style:Object.assign(o,{flex:"1"}),blockRendererId:this.props.blockRendererId,getBlockComponent:this.props.getBlockComponent});case E.LabelElement.$Type.value:var y=e;return d.createElement(Ea,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),blockRendererId:this.props.blockRendererId,display:y});case E.LimitsElement.$Type.value:return d.createElement(Ha,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),blockRendererId:this.props.blockRendererId,display:e,formId:this.props.formId});case E.ImageElement.$Type.value:var v=e;return d.createElement(va,{style:Object.assign(o,{display:"flex-inline",margin:r.justifySelf.getOrElse(function(){return"0 0 0 0"})}),key:e.id.value,display:v});case E.LogElement.$Type.value:return d.createElement(ml,{blockRendererId:this.props.blockRendererId,formId:this.props.formId,blockId:this.props.blockId,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e});case E.HTMLElement.$Type.value:return d.createElement(yl,{key:e.id.value,style:o,display:e,blockRendererId:this.props.blockRendererId});case E.LanguageElement.$Type.value:return d.createElement(El,{key:e.id.value,style:o,display:e,blockId:this.props.blockId});case E.ErrorElement.$Type.value:return d.createElement(Fl,{key:e.id.value,style:o,display:e,blockRendererId:this.props.blockRendererId});case E.EmailListElement.$Type.value:return d.createElement(fu,{key:e.id.value,style:o,display:e,blockRendererId:this.props.blockRendererId});case E.DelimiterElement.$Type.value:var O=e;return d.createElement(Ou,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:O});case E.IFrameElement.$Type.value:var R=e;return d.createElement(Eu.a,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"}),margin:r.justifySelf.getOrElse(function(){return"0 0 0 0"})}),display:R});case E.CommentsListElement.$Type.value:return d.createElement(hc,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e,blockRendererId:this.props.blockRendererId});case E.ExpansionPanelDisplayElement.$Type.value:var w=e;return d.createElement(Du,{key:e.id.value,display:w,components:w.children,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})})},w.children.map(function(e){return t.getDisplayRenderer(e)}));case E.SelectionMatrixElement.$Type.value:return d.createElement(Ic,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e,blockRendererId:this.props.blockRendererId,blockId:this.props.blockId,blockType:this.props.blockType,formId:this.props.formId});case E.VisitedUrlsLogElement.$Type.value:return d.createElement(Dc,{blockRendererId:this.props.blockRendererId,formId:this.props.formId,blockId:this.props.blockId,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e});default:return d.createElement("div",null,this.props.i18n.t("Неизвестный тип элемента отображения"))}}},{key:"render",value:function(){var e=this.props.display;return this.props.isVisible&&d.createElement(bu,{blockId:this.props.blockId,elementCss:e.elementCss},d.createElement(Pc.a,{component:e},this.renderDisplayElement(e)))}}]),t}(d.Component),Mc=Object(h.connect)(function(e,t){return{block:e.block,i18n:e.i18n,isVisible:t.display.displayRule.map(function(n){return n.isVisible(function(n){return Object(R.e)(e.dataOutput,t.blockRendererId,n).matchWith(function(e){return Object(k.toOption)(e.value)},function(){return Object(w.g)(e.blockRendererContext,t.blockRendererId,n)})})}).getOrElse(function(){return!0})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.block===t.block&&e.blockRendererContext===t.blockRendererContext&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return e.isVisible===t.isVisible&&e.i18n===t.i18n&&e.block===t.block}})(Fc),Wc=Mc,Bc=n(164),Lc=n(1503),Ac=n(79),$c=n(624),Vc=function(e){return function(t,n){!function(e,t){t(Object(Lc.a)(e)).foreach(function(n){clearTimeout(n),t(Object(Bc.p)(e))})}(e,t),t(Object(U.H)(e)),t(Object(Bc.n)(e))}},qc=function(e){switch(e.tpe.value){case E.UrlHandlerAll.$Type.value:return Object(k.toOption)(window.location.href);case E.UrlHandlerParam.$Type.value:return Object(k.headOption)(Object($c.a)(window.location.search)[e.param]);default:return new k.None}},Nc=function(e,t,n){return Object(k.liftKey)(n.getOrElse(function(){return{}}),e.output.formField.value).filter(function(t){return t.value.tpe.value===E.ValueStr.$Type.value&&e.append}).matchWith(function(e){return new E.ValueStr(e.value.toString()+" "+t)},function(){return new E.ValueStr(t)})},zc=function(e,t,n){return function(r){Object(k.toOption)(t.tpe.value===E.UrlHandlerClientInfo.$Type.value).filter(function(e){return e}).matchWith(function(){new Promise(function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&200==this.status?e(JSON.parse(this.responseText).ip):t(new Error("Getting ip error"))},n.onerror=function(e){return t(e)},n.open("GET","//api.ipify.org?format=json",!0),n.send()}).then(function(o){return r(Object(U.G)({output:t.output,value:Nc(t,o+"(;)"+(i=window.navigator,"timeOpened:"+new Date+"(;)timezone:"+(new Date).getTimezoneOffset()/60+"(;)pageon:"+window.location.pathname+"(;)previousSites:"+document.referrer+"(;)referrer:"+history.length+"(;)appName:"+i.appName+"(;)appVersion:"+i.appVersion+"(;)product:"+i.product+"(;)appCodeName:"+i.appCodeName+"(;)onLine:"+i.onLine+"(;)connection:"+JSON.stringify(i.connection)+"(;)cookieEnabled:"+i.cookieEnabled+"(;)cookie:"+document.cookie+"(;)localStorage:"+JSON.stringify(localStorage)+"(;)deviceMemory:"+i.deviceMemory+"(;)language:"+i.language+"(;)languages:"+JSON.stringify(i.languages)+"(;)platform:"+i.platform+"(;)userAgent:"+i.userAgent+"(;)vendor:"+i.vendor+"(;)javaEnabled:"+i.javaEnabled()+"(;)colorDepth:"+window.screen.colorDepth+"(;)pixelDepth:"+window.screen.pixelDepth+"(;)width:"+window.screen.width+"(;)height:"+window.screen.height+"(;)availWidth:"+window.screen.availWidth+"(;)availHeight:"+window.screen.availHeight+"(;)innerWidth:"+innerWidth+"(;)innerHeight:"+innerHeight+"(;)"),n),blockRendererId:e}));var i})},function(){qc(t).foreach(function(o){return r(Object(U.G)({output:t.output,value:Nc(t,o,n),blockRendererId:e}))})})}},Hc=function(e,t){return Object(k.toOption)(Object.assign({},e.getOrElse(function(){return{}}),t.reduce(function(t,n){return qc(n).matchWith(function(r){return Object.assign(t,Bn()({},n.output.formField.value,new E.FormFieldValue(n.output.formField,Nc(n,r,e))))},function(){return t})},{})))},Uc=function(e,t,n,r,o,i,a,l,u){return function(c,s){c(Object(U.v)(e)),c(function(e,t,n){return function(r){return t.forEach(function(t){r(zc(e,t,n))})}}(e,o.entity.urlHandlers,l)),c(Object(Bc.s)({blockRendererId:e,rootBlockRendererId:t,formId:r,formRecord:a,blockId:o.id,blockType:i,initialValues:Hc(l,o.entity.urlHandlers),initialDictionaries:u,isPrivateCabinet:n})),function(e){var t="blockCustomCss-"+e.id.value;Object(k.toOption)(e.entity.ui.customCss).filter(function(n){return e.entity.ui.customCss.enabled&&Object(k.toOption)(document.getElementById(t)).isEmpty()}).flatMap(function(e){return e.value}).matchWith(function(e){var n=document.createElement("style");n.type="text/css",n.id=t,n.innerHTML=e,document.body.appendChild(n)},function(){})}(o),function(e){e.entity.externalScriptUrls.filter(function(e){return Object(k.toOption)(document.getElementById(e.id)).isEmpty()}).forEach(function(e){var t=document.createElement("script");t.src=e.url,t.async=!0,t.setAttribute("id",e.id),document.body.appendChild(t)})}(o),function(e,t,n,r){n(Object(Lc.a)(e)).foreach(function(t){clearTimeout(t),n(Object(Bc.p)(e))}),t.entity.ui.resetPage.foreach(function(t){if(t.enabled){var o=setTimeout(function(){n(Object(Bc.p)(e)),r().user.userRole.foreach(function(e){n(Object(Ac.p)(e.entity))})},t.interval);n(Object(Bc.o)({blockRendererId:e,timerId:o}))}})}(e,o,c,s),function(e){Object(k.toOption)(e).filter(function(e){return e.entity.payment instanceof E.BlockPaymentConfigDonatePayment&&e.entity.payment.enabled&&Object(k.toOption)(document.getElementById("stripeCheckoutScript")).isEmpty()}).foreach(function(){var e=document.createElement("script");e.src="https://checkout.stripe.com/checkout.js",e.async=!0,e.setAttribute("id","stripeCheckoutScript"),document.body.appendChild(e)})}(o)}},Kc=n(653),Gc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Yc=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(Kc.e)(this.props.report,this.props.formDataId))}},{key:"onDownloadClick",value:function(){var e=this;this.props.reports.result.filter(function(e){return e.data instanceof E.ReportDataReportFile}).foreach(function(t){e.props.dispatch(Object(Er.c)(t.data.meta.id)),e.props.onDownloadClick()})}},{key:"render",value:function(){return this.props.reports.resultFetching?d.createElement(O.a,null):this.props.reports.result.filter(function(e){return e.data instanceof E.ReportDataReportFile}).nonEmpty()?d.createElement("p",null,d.createElement("span",null,this.props.i18n.t("Отчет сформирован, для загрузки нажмите")+" "),d.createElement(jn.a,{onClick:this.onDownloadClick},d.createElement(Pr.a,null))):(this.props.reports.resultError.nonEmpty()&&d.createElement("p",null,this.props.i18n.t("В процессе формирования отчета произошла ошибка!")),null)}}]),t}(d.Component);Yc=Gc([m.autobind],Yc);var Jc=Object(h.connect)(function(e,t){return{i18n:e.i18n,reports:e.reports}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)})(Yc),Qc=n(1483),Xc=n(192),Zc=n(111),es=n(429),ts=n(48),ns=n(57),rs=n(69),os=n(1511),is=function(){return function(e,t){return t().eventLine.eventLineId.flatMap(function(n){return Object(k.headOption)(Object(y.f)(t().forms,n).filter(function(e){return E.FormType.isDocument(e.entity.formType)})).map(function(t){return e(Object(Z.b)(t.id)).then(function(){return e(function(e,t){return function(n,r){return new Promise(function(o,i){r().user.terminal.matchWith(function(a){Object(H.e)(r().fields,t).flatMap(function(e){return Object(k.headOption)(e.filter(function(e){return e.entity.valueType.tag.filter(function(e){return e.tpe.value===E.ValueTagTerminalId.$Type.value})}))}).matchWith(function(r){var i=Object(k.toOption)(new E.FilterCondition(r.id,new E.FilterExpressionContains,new E.ValueStr(a.value)));n(Object(ts.ab)(i)),n(Object(ns.x)(t)),n(Object(Ac.J)(e,new E.Id(E.FormType.ACCESS_ZONE_PASSSES),t)),o()},function(){i()})},function(){i()})})}}(n,t.id))})})}).getOrElse(function(){return new Promise(function(e,t){t()})})}},as=n(176),ls=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},us=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"componentWillUnmount",value:function(){this.cancelDefaultPageTimeout()}},{key:"cancelDefaultPageTimeout",value:function(){var e=this;this.props.dispatch(Object(Lc.a)(this.props.blockRendererId)).foreach(function(t){clearTimeout(t),e.props.dispatch(Object(Bc.p)(e.props.blockRendererId))})}},{key:"onListChildren",value:function(e){var t=e.refFieldId;this.props.dispatch(function(e,t,n){return function(r,o){Object(H.d)(o(),n,t).filter(function(e){return e.entity.valueType instanceof E.ValueTypeObjectRefs}).map(function(e){return e.entity.valueType.family}).foreach(function(n){var i=Object(k.headOption)(o().eventLines.list.filter(function(e){return Object(y.e)(o().forms,n).matchWith(function(t){return t.entity.eventLineId.value===e.id.value},function(){return!1})}));Object(R.e)(o().dataOutput,e,t).map(function(e){return e.value.id}).map(function(e){var t=Object(k.toOption)(new E.FilterGroupCondition([new E.RestrictedForm(n,e)].concat([]),new E.FilterPredicateAnd));r(Object(ts.ab)(t)),r(Object(ns.x)(n)),i.foreach(function(e){r(Object(Ac.J)(e.id,new E.Id(E.FormType.FORM),n))})})})}}(this.props.blockRendererId,t,this.props.formId))}},{key:"onSearchReferrers",value:function(e){this.props.dispatch(function(e,t){return function(n,r){Object(w.d)(r().blockRendererContext,e).foreach(function(e){var o=Object(k.headOption)(r().eventLines.list.filter(function(e){return Object(y.e)(r().forms,t.formId).matchWith(function(t){return t.entity.eventLineId.value===e.id.value},function(){return!1})})),i=Object(k.toOption)(new E.FilterGroupCondition([new E.FilterCondition(t.fieldId,new E.FilterExpressionContains,new E.ValueObjectRefs([e.id]))],new E.FilterPredicateAnd));t.firstMatch?Object(ee.g)(t.formId,i).then(function(e){return e.foreach(function(e){return o.foreach(function(t){return n(Object(Ac.H)(t.id,new E.Id(E.FormType.FORM),e.entity.formId,e.id))})})}):(n(Object(ts.ab)(i)),n(Object(ns.x)(t.formId)),o.foreach(function(e){n(Object(Ac.J)(e.id,new E.Id(E.FormType.FORM),t.formId))}))})}}(this.props.blockRendererId,e))}},{key:"sendJourneyEvent",value:function(e){var t=this;return this.props.dispatch(Object(de.k)(this.props.blockId,e,this.props.blockRendererId)).then(function(){t.props.dispatch(Object(wn.h)(t.props.i18n.t("Выполнено успешно")))}).catch(function(){t.props.dispatch(Object(wn.h)(t.props.i18n.t("Выполнено с ошибкой")))})}},{key:"handleButtonAction",value:function(e){var t,n,r,o=this;switch(e.tpe.value){case E.ButtonActionSave.$Type.value:return this.props.onSave(e.blockId).then(function(e){o.props.dispatch(Object(Bc.r)({formRecordId:Object(k.toOption)(e),blockRendererId:o.props.blockRendererId}))});case E.ButtonActionSaveAndPay.$Type.value:return this.props.onSaveAndPay&&this.props.onSaveAndPay(e.blockId),new Promise(function(e,t){return e()});case E.ButtonActionEdit.$Type.value:return this.props.onEdit(e.blockId),new Promise(function(e,t){return e()});case E.ButtonActionOpenBlock.$Type.value:return this.props.formRecordId.matchWith(function(t){return o.props.dispatch(Object(ee.f)(o.props.formId,t)).then(function(){return o.props.onOpenBlock&&o.props.onOpenBlock(e.blockId,o.props.formId,Object(k.toOption)(t))})},function(){return o.props.onOpenBlock&&o.props.onOpenBlock(e.blockId,o.props.formId,new k.None),new Promise(function(e,t){return e()})});case E.ButtonActionSearchReferrers.$Type.value:return new Promise(function(t,n){try{o.onSearchReferrers(e),t()}catch(e){n(e)}});case E.ButtonActionListChildren.$Type.value:return new Promise(function(t,n){try{o.onListChildren(e),t()}catch(e){n(e)}});case E.ButtonActionListPastPasses.$Type.value:return this.props.dispatch(is());case E.ButtonActionEmpty.$Type.value:return new Promise(function(e,t){return e()});case E.ButtonActionSendJourneyEvent.$Type.value:return this.sendJourneyEvent(e);case E.ButtonActionInvokeJsScript.$Type.value:return this.props.dispatch(function(e,t){return function(n,r){var o=e.args.reduce(function(e,n){return Object(R.e)(r().dataOutput,t,n.fieldId).map(function(t){return e[n.name]=Object(R.o)(t.value),e}).getOrElse(function(){return e})},{}),i=Function("formDataId","actionArgs","authToken",e.body),a=function(e,t,n){try{i(e,t,n)}catch(e){console.log("invokeJsActionError",e)}};Object(w.e)(r().blockRendererContext,t).matchWith(function(e){a(e.value.toString(),o,r().auth.token.getOrElse(function(){return""}))},function(){a("",o,r().auth.token.getOrElse(function(){return""}))})}}(e,this.props.blockRendererId)),new Promise(function(e,t){return e()});case E.ButtonActionLogin.$Type.value:return this.props.dispatch((t=this.props.formId,n=this.props.blockId,r=this.props.blockRendererId,function(e,o){return e(Object(Hi.g)(n,r,new No.None)).then(function(){return o().application.info.filter(function(e){return e.appType instanceof E.ApplicationTypePrivateCabinet}).map(function(e){return e.appType}).map(function(n){return Object(Qc.c)(n.credentials.fields.map(function(e){return Object(R.e)(o().dataOutput,r,e).map(function(t){return new E.FormFieldValue(e,t.value)})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),t).then(function(t){var r=t.context;e(Object(Xc.j)(r)),e(Object(Ac.m)(r.entity.formId,r.id,o().application.blockId.matchWith(function(e){return e},function(){return n.cabinetBlockId})))}).catch(function(e){throw new Zc.a})}).getOrElse(function(){return new Promise(function(e,t){return t()})})})}));case E.ButtonActionSearch.$Type.value:return this.props.dispatch(function(e,t,n,r){return function(o,i){return o(Object(Hi.g)(n,r,new No.None)).then(function(){return Object(ee.k)(new E.DataPageRequest(0,20,t,Object(k.toOption)(new E.FilterGroupCondition(e.fields.map(function(e){return Object(R.e)(i().dataOutput,r,e).map(function(t){return new E.FormFieldValue(e,t.value)})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]).map(function(e){return new E.FilterCondition(e.formFieldId,new E.FilterExpressionEq,e.value)}),new E.FilterPredicateAnd))))}).then(function(t){Object(k.headOption)(t.page.records).matchWith(function(t){o(Object(Xc.j)(t)),o(Object(Ac.m)(t.entity.formId,t.id,e.block))},function(){throw new Zc.f})})}}(e,this.props.formId,this.props.blockId,this.props.blockRendererId));case E.ButtonActionPause.$Type.value:return new Promise(function(t,n){return setTimeout(function(){return t()},e.timeout.getMilliseconds())});case E.ButtonActionExit.$Type.value:return this.props.dispatch(Object(os.a)()),this.props.dispatch(Object(rs.r)()),window.location.reload(),new Promise(function(e,t){return e()});case E.ButtonActionReport.$Type.value:return this.props.dispatch(function(e,t,n){return function(r,o){return new Promise(function(r,i){Object(w.e)(o().blockRendererContext,t).matchWith(function(t){var i=function(){n.handleDialogClose(a),r()},a=n.openDialog(o().i18n.t("Формирование отчета"),d.createElement(Jc,{report:e.report,formDataId:t,onDownloadClick:i}),[d.createElement(A.a,{variant:"raised",onClick:i,key:"close"},o().i18n.t("Закрыть"))])},function(){return i()})})}}(e,this.props.blockRendererId,this.props));case E.ButtonActionRefresh.$Type.value:return this.props.formRecordId.map(function(e){return o.props.dispatch(Object(ee.f)(o.props.formId,e))}).getOrElse(function(){return new Promise(function(e,t){return e()})});case E.ButtonActionOpenNextFormRecord.$Type.value:var i=e;return Object(ee.h)(new E.FormDataIdsOffsetRequest(this.props.formId,0,1,i.filter,i.sorting,new k.None)).then(function(e){Object(k.headOption)(e).matchWith(function(e){o.props.dispatch(Object(Pl.a)(o.props.formId,e))},function(){o.props.openSnackbar(d.createElement("span",null,o.props.i18n.t("Анкет по заданным параметрам фильтрации нет")),new k.None)})});case E.ButtonActionFollowLink.$Type.value:var a=e;return window.open(a.link,a.newWindow?"_blank":"_self"),new Promise(function(e){return e()});default:throw"unknown button action type"}}},{key:"handleButtonPress",value:function(e){var t=this,n=e.actions.map(function(e){return e});return new Promise(function(e,r){!function o(){0!==n.length?Object(k.toOption)(n.shift()).foreach(function(e){t.handleButtonAction(e).then(function(){return o()}).catch(function(e){t.props.dispatch(Object(ae.c)(e,t.props,t.props.blockRendererId,t.props.blockId)),r()})}):e()}()})}},{key:"renderBlockDisplay",value:function(e){return d.createElement(Wc,{key:e.id.value,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,display:e,blockId:this.props.blockId,formId:this.props.formId,getBlockComponent:this.props.getBlockComponent,parentRecordId:this.props.formRecordId,handleButtonPress:this.handleButtonPress,isRootElement:!0})}},{key:"getBlockJustifyContent",value:function(e){return e.map(function(e){return e.entity.ui.justifyContent}).getOrElse(function(){return"flex-start"})}},{key:"render",value:function(){var e=this;if(this.props.formAccessoriesError.nonEmpty())return d.createElement("div",null,this.props.i18n.t("Ошибка загрузки полей или словарей формы"));if(this.props.initialValuesError)return d.createElement("div",null,this.props.i18n.t("Ошибка загрузки записи, редактирование или отображение невозможно"));if(this.props.isBlockError)return d.createElement("div",null,this.props.i18n.t("Ошибка загрузки блока отображения"));var t=this.props.isBlockFetching&&!this.props.isBlockError&&this.props.block.isEmpty(),n=this.props.isFormAccessoriesFetching&&!this.props.isFormAccessoriesFetched&&this.props.formAccessoriesError.isEmpty();return t||n?d.createElement(O.a,null):d.createElement("div",{style:{display:"flex",flexGrow:0,justifyContent:this.getBlockJustifyContent(this.props.block)}},this.props.block.map(function(e){return e.entity.display}).getOrElse(function(){return[]}).map(function(t){return e.renderBlockDisplay(t)}))}}]),t}(d.Component);us=ls([m.autobind],us);var cs=function(e){e.block.isEmpty()&&!e.isBlockFetching&&e.dispatch(Object(v.c)(e.blockId)).then(function(t){return e.dispatch((n=t,function(e,t){t().auth.token.foreach(function(r){Object(C.a)(n.entity.display),e(Object(es.c)(n.entity.display,n.entity.ui.blockStyle,r,t().config.cdnAddress))})}));var n})},ss=function(e){return e.dispatch(Object(as.f)(e.formId))},ps=function(e){e.block.foreach(function(t){e.dispatch(Uc(e.blockRendererId,e.rootBlockRendererId,e.isPrivateCabinet||!1,e.formId,t,e.blockType,e.formRecord,Object(g.default)(e.initialValues)?new k.None:Object(k.toOption)(e.initialValues),Object(g.default)(e.initialDictionares)?new k.None:Object(k.toOption)(e.initialDictionares)))})},fs=function(e){e.dispatch(Object(Bc.u)({blockRendererId:e.blockRendererId,initialValues:Object(g.default)(e.initialValues)?new k.None:Object(k.toOption)(e.initialValues)}))};t.a=Object(h.connect)(function(e,t){return{isFormAccessoriesFetching:e.forms.fetching||Object(y.b)(e.forms,t.formId).getOrElse(function(){return!1}),isFormAccessoriesFetched:Object(y.a)(e.forms,t.formId).getOrElse(function(){return!1}),formAccessoriesError:Object(y.d)(e.forms,t.formId),isBlockFetching:Object(b.d)(e.block,t.blockId).getOrElse(function(){return!1}),isBlockError:Object(b.c)(e.block,t.blockId).nonEmpty(),block:Object(b.b)(e.block,t.blockId),i18n:e.i18n,token:e.auth.token,fonts:e.fonts,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:function(t){return e(t)}}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.block===t.block&&e.forms===t.forms&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.formId.value===t.formId.value&&e.blockId.value===t.blockId.value&&e.blockType.tpe.value===t.blockType.tpe.value&&Object(k.isEqual)(e.formRecord,t.formRecord)&&Object(k.isEqual)(e.formRecordId,t.formRecordId)&&e.initialValues===t.initialValues&&e.initialDictionares===t.initialDictionares&&e.initialValuesError===t.initialValuesError}})(Object(fe.a)([ss,cs,ps],[function(e,t){e.formId.value!==t.formId.value&&e.isTokenChecked&&ss(e),e.formId.value===t.formId.value&&e.isTokenChecked&&!t.isTokenChecked&&ss(e)},function(e,t){e.blockId.value!==t.blockId.value&&e.isTokenChecked&&cs(e),e.blockId.value===t.blockId.value&&e.isTokenChecked&&!t.isTokenChecked&&cs(e)},function(e,t){Object(k.isEqual)(e.block,t.block)||ps(e)},function(e,t){var n;Object(k.isEqual)(e.formRecord,t.formRecord)||(n=e).dispatch(Object(Bc.q)({blockRendererId:n.blockRendererId,formRecord:n.formRecord}))},function(e,t){return Object(g.default)(e.initialValues)!==Object(g.default)(t.initialValues)?fs(e):e.initialValues!==t.initialValues?fs(e):void 0},function(e,t){var n;Object(g.default)(e.initialDictionares)!==Object(g.default)(t.initialDictionares)&&(n=e).dispatch(Object(Bc.t)({blockRendererId:n.blockRendererId,initialDictionaries:Object(g.default)(n.initialDictionares)?new k.None:Object(k.toOption)(n.initialDictionares)}))}],[],[function(e){e.dispatch(Vc(e.blockRendererId))}])(Object(tu.a)(Object(X.a)(us))))},1497:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(160),g=n.n(m),y=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},b=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("div",{style:{height:"210px",boxSizing:"border-box",width:"100%",textAlign:"center",padding:"30px",opacity:1}},d.createElement(g.a,{size:150,thickness:2}))}}]),t}(d.Component);b=y([h.autobind],b),t.a=b},1498:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return p});var r=n(1),o=n(372),i=n(148),a=n(0),l=n(1492),u=n(264),c=function(e){return function(t,n){var r=n();return Object(o.d)(r.blockRendererContext,e).map(function(e){return e.entity.permissions.map(function(e){return e.limits}).getOrElse(function(){return[]})}).getOrElse(function(){return[]})}},s=function(e,t){return function(n,i){var u=Object(a.headOption)(e),c=u.map(function(e){return e.defaultSource.value}).getOrElse(function(){return r.DisplayTypeByBlockSchemaType.$Type.value}),s=u.map(function(e){return e.filterActions}).getOrElse(function(){return[]}),p=Object(o.d)(i().blockRendererContext,t).map(function(e){return[e]}).getOrElse(function(){return[]}),f=s.filter(function(e){return 0!=p.filter(function(t){return Object(l.e)(t,Object(a.toOption)(e.filter))}).length});return f.length>0?Object(a.headOption)(f).map(function(e){return e.valueSource.value}).getOrElse(function(){return c}):c}},p=function(e){return function(t,n){return e.flatMap(function(r){return r.autoSuggestRef.map(function(r){return Object(i.f)(n().dictionaries,r.family).getOrElse(function(){return!1})?new Promise(function(t,r){return t(e.flatMap(function(e){return e.autoSuggestRef.flatMap(function(e){return Object(a.lift)(e.displayFields,0).map(function(t){return Object(i.b)(n().dictionaries,e.family).getOrElse(function(){return[]}).map(function(e){return Object(a.liftKey)(e.entity.values,t.value).map(function(e){return e.value.toString()}).getOrElse(function(){return""})})})})}).getOrElse(function(){return[]}))}):t(Object(u.c)(r.family,new a.None)).then(function(e){return Object(a.lift)(r.displayFields,0).map(function(t){return e.list.map(function(e){return Object(a.liftKey)(e.entity.values,t.value).map(function(e){return e.value.toString()}).getOrElse(function(){return""})})}).getOrElse(function(){return[]})})})}).getOrElse(function(){return new Promise(function(e,t){return e([])})})}}},1499:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),o.default.createElement("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"})),"ArrowUpward");t.default=i},1500:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(95),g=n(13),y=n(26),b=n.n(y),v=n(32),O=n.n(v),E=n(34),k=n.n(E),j=n(30),C=n.n(j),R=n(25),w=n.n(R),I=n(1490),S=n.n(I),P=n(1),T=n(3),x=n(1472),_=n.n(x),D=n(538),F=n.n(D),M=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},W=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"onDeleteClick",value:function(){this.props.onRemove(this.props.idx)}},{key:"render",value:function(){return d.createElement(_.a,{style:{marginRight:"5px"},label:this.props.name,avatar:d.createElement(F.a,null,d.createElement(S.a,null)),onDelete:this.onDeleteClick})}}]),t}(d.Component);W=M([g.autobind],W);var B=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(W),L=n(0),A=n(99),$=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},V=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},q=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={files:[]},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(A.d)(this.props.attachments.map(function(e){return e.fileId})))}},{key:"onAddFileButtonClick",value:function(){this.fileUpload(this.fileChanged)}},{key:"fileUpload",value:function(e){this.fileInput.foreach(function(e){return e.click()})}},{key:"onRemove",value:function(e){this.props.onChange(T(this.props.attachments,{$splice:[[e,1]]}))}},{key:"fileChanged",value:function(e){var t=this,n=e.target.files[0];Object(A.h)(n,this.props.cdnAddress,this.props.auth.token,this.props.organisation.organisationId,this.props.eventLine.eventLineId,new L.None,new L.Some(new P.FileTypeMailAttach),"true").then(function(e){Object(A.b)(e).then(function(e){t.setState(T(t.state,{files:{$push:[e.record]}}))}),t.props.onChange(T(t.props.attachments,{$push:[new P.AttachmentFileAttachment(e)]}))}).catch(function(e){console.error("File uploaded with error",e)})}},{key:"fileInputHandler",value:function(e){this.fileInput=Object(L.toOption)(e)}},{key:"render",value:function(){var e=this;return d.createElement("div",null,d.createElement("input",{ref:this.fileInputHandler,type:"file",onChange:this.fileChanged,style:{display:"none"}}),d.createElement("div",null,this.state.files.map(function(t,n){return d.createElement(B,{key:n,idx:n,name:t.entity.originalName,onRemove:e.onRemove})})),d.createElement("div",null,d.createElement(w.a,{onClick:this.onAddFileButtonClick,style:{marginRight:"10px"}},d.createElement(S.a,null))))}}]),t}(d.Component);q=$([g.autobind,V("design:paramtypes",[Object])],q);var N=Object(h.connect)(function(e,t){return{i18n:e.i18n,cdnAddress:e.config.cdnAddress,auth:e.auth,organisation:e.organisation,eventLine:e.eventLine}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.config.cdnAddress===t.config.cdnAddress},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.cdnAddress===t.cdnAddress}})(q),z=n(16),H=n(424),U=n(245),K=n(246),G=n(247),Y=n(266),J=n(292),Q=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},X=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Z=new z.CompositeDecorator([{strategy:U.b,component:U.a},{strategy:K.b,component:K.a},{strategy:G.b,component:G.a}]),ee=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=Object(Y.a)(n.props.html,Z,[],[],[],n.props.i18n.t);z.EditorState.moveSelectionToEnd(r);return n.state={editorState:r,htmlBody:n.props.html,showHtml:!1},n}return s()(t,e),a()(t,[{key:"onEditorStateChange",value:function(e){var t=this;this.setState(T(this.state,{editorState:{$set:e}}),function(){setTimeout(function(){t.state.editorState===e&&t.props.onChange(Object(J.a)(Object(z.convertToRaw)(e.getCurrentContent())))},200)})}},{key:"onShowHTMLChange",value:function(e){this.setState(T(this.state,{showHtml:{$set:e}}))}},{key:"onHtmlChange",value:function(e){var t=this;this.setState(T(this.state,{htmlBody:{$set:e}}),function(){t.props.onChange(e)})}},{key:"render",value:function(){return d.createElement(H.a,{showInsertionButtons:!1,formId:new L.None,organisationId:this.props.organisationId,html:this.state.htmlBody,showHtml:this.state.showHtml,editorState:this.state.editorState,onChange:this.onEditorStateChange,onShowHTMLChange:this.onShowHTMLChange,onHtmlChange:this.onHtmlChange,fields:[],insertions:[],attachments:[],urlLinks:[],onAttachmentsChange:function(){},onInsertionsChange:function(){},onUrlLinksChange:function(){}})}}]),t}(d.Component);ee=Q([g.autobind,X("design:paramtypes",[Object])],ee);var te=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(ee),ne=n(136),re=n(648);n.d(t,"a",function(){return ie});var oe=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ie="EmailDataObjectReplyForm",ae=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderMailBoxSelect",value:function(){return d.createElement(O.a,{fullWidth:!0},d.createElement(k.a,null,this.props.i18n.t("Ящик отправки")),d.createElement(C.a,{native:!0,value:this.props.fields.mailBoxId.value,onChange:this.props.fields.mailBoxId.onChange},d.createElement("option",{value:""}),this.props.mailBoxConfigs.list.map(function(e){return d.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)})))}},{key:"render",value:function(){var e=this.props,t=e.fields,n=t.subject,r=t.replyTo,o=t.attachments,i=(t.body,t.html),a=t.cc,l=t.bcc,u=e.handleSubmit;return d.createElement("form",{style:{width:"100%"},onSubmit:u},this.props.showMailBoxSelector&&this.renderMailBoxSelect(),d.createElement(b.a,{value:r.value,onChange:r.onChange,fullWidth:!0,label:this.props.i18n.t("Кому")}),d.createElement(b.a,{value:a.value,onChange:a.onChange,fullWidth:!0,label:this.props.i18n.t("Сс")}),d.createElement(b.a,{value:l.value,onChange:l.onChange,fullWidth:!0,label:this.props.i18n.t("Bcc")}),d.createElement(b.a,{value:n.value,onChange:n.onChange,fullWidth:!0,label:this.props.i18n.t("Тема")}),d.createElement(te,{html:i.value||"<div></div>",onChange:i.onChange,organisationId:this.props.organisationId}),d.createElement(N,{attachments:o.value||[],onChange:o.onChange}))}}]),t}(d.Component);ae=oe([g.autobind],ae);t.b=Object(h.connect)(function(e){return{i18n:e.i18n,mailBoxConfigs:e.mailBoxConfigs,eventLineId:e.eventLine.eventLineId}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:ie,fields:["subject","mailBoxId","emailId","attachments","replyTo","html","body","cc","bcc"],validate:function(e,t){return{}}})(Object(ne.a)(function(e){e.isTokenChecked&&e.eventLineId.foreach(function(t){e.dispatch(Object(re.a)(t))})})(ae)))},1501:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return c});var r=n(147),o=n(164),i=n(372),a=n(87),l=n(0),u=function(e,t,n){return function(i){return i(Object(o.w)(n)),r.n(e,t,new l.None).then(function(e){return i(Object(o.x)({blockRendererId:n,limits:e})),e}).catch(function(e){throw i(Object(o.v)({blockRendererId:n,error:e})),e})}},c=function(e,t,n){return Object(a.b)(function(e){return!Object(i.l)(e.blockRendererContext,n)&&Object(i.k)(e.blockRendererContext,n)},u(e,t,n))}},1502:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return b});var r=n(2),o=n(1),i=n(19),a=n.n(i),l=n(1540),u=n(640),c=n(1477),s=n(1517),p=n(1534),f=n(71),d=n(87),h=n(0),m=(n(623),function(e,t){return function(n,r){return n(Object(d.a)(function(e){return Object(u.e)(e.formDataDocuments,t)},function(e){return Object(u.d)(e.formDataDocuments,t)},function(e){return Object(u.c)(e.formDataDocuments,t)},function(e){return Object(u.b)(e.formDataDocuments,t)},Object(c.e)(e,t),function(e){return e.list}))}}),g=function(e){return function(e){return e.map(function(e){return e.pages.map(function(e){return e.elements.filter(function(e){return e.display instanceof o.DocumentElementDisplayBarcode})}).reduce(function(e,t){return e.concat(t)},[])}).getOrElse(function(){return[]})}(e).filter(function(e){return e.display.config.filter(function(e){return e.barcodeProviderType.tpe.value===o.BarcodeProviderTypeAssignment.$Type.value}).nonEmpty()})},y=function(e){return function(t,n){return new Promise(function(n,o){var i="",u=!1,c=t(function(e,t,n,o,i){return function(u,c){var s=e.openDialog(c().i18n.t("Значение штрихкода"),r.createElement(l.a,{onChange:t,onSave:n,withRemoveOldValue:o}),[r.createElement(a.a,{variant:"raised",style:{marginRight:"5px"},onClick:function(){i&&i(),e.handleDialogClose(s)}},c().i18n.t("Отмена")),r.createElement(a.a,{variant:"raised",color:"primary",onClick:n},c().i18n.t("Сохранить"))]);return s}}(e,function(e,t){i=e,u=t},function(){e.handleDialogClose(c),n({assignValue:i,removeOldCodes:u})},!1,function(){return o()}))})}},b=function(e,t,n,r){return function(i){switch(n.entity.rfid.tpe.value){case o.RfidBefore.$Type.value:return i(function(e,t,n,r){return function(i,a){return n.entity.template.matchWith(function(a){return i(y(e)).then(function(e){return Object(s.d)(a).then(function(i){var a=g(i.record.entity.documentSchema.definition);return Object(p.b)(t,n.id,[new o.AssignBarcode(Object(h.headOption)(a).map(function(e){return e.display.id}).matchWith(function(e){return e},function(){return new o.BarcodeId("")}),e.assignValue)],r).then(function(e){return new h.Success(e)}).catch(function(e){return new h.Failure(e)})})},function(e){return new h.Failure(e)})},function(){return i(y(e)).then(function(e){return Object(p.b)(t,n.id,[new o.AssignBarcode(new o.BarcodeId(""),e.assignValue)],r).then(function(e){return new h.Success(e)}).catch(function(e){return new h.Failure(e)})},function(e){return new h.Failure(e)})})}}(e,t,n,r));case o.RfidAfter.$Type.value:return i(function(e,t,n,r){return function(i,a){return Object(p.b)(t,n.id,[],r).then(function(t){return i(y(e)).then(function(e){return Object(p.a)(t.docId,[new o.AssignBarcode(new o.BarcodeId(""),e.assignValue)],e.removeOldCodes).then(function(){return i(Object(f.h)(a().i18n.t("Код записан"))),new h.Success(t)}).catch(function(){return i(Object(f.h)(a().i18n.t("Не удалось записать код"))),new h.Failure(new Error("code was not assigned"))})},function(e){return new h.Failure(new Error("code  reading with error"))})},function(e){return new h.Failure(new Error("document was not printed"))})}}(e,t,n,r));case o.RfidDisabled.$Type.value:return function(e,t,n){return Object(p.b)(e,t.id,[],n).then(function(e){return new h.Success(e)},function(e){return new h.Failure(e)})}(t,n,r);default:return new Promise(function(e,t){return e(new h.Failure(new Error("unknown document rfid type")))})}}}},1503:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(372),o=function(e){return function(t,n){return Object(r.c)(n().blockRendererContext,e)}},i=function(e){return function(t,n){return Object(r.i)(n().blockRendererContext,e)}}},1504:function(e,t,n){"use strict";var r=n(43),o=n.n(r),i=n(1),a=n(100),l=n(131),u=n(0),c=n(264),s=n(147),p=n(29),f=n(104),d=(n(148),n(291)),h=n(636),m=n(1486);n.d(t,"b",function(){return b}),n.d(t,"a",function(){return v});var g=function(e,t,n,r,o,l){return function(c,s){var f=Object(p.e)(s().fields,e).getOrElse(function(){return[]}),d=s().currentForm.data.map(function(e){return i.FormType.isSimpleDictionary(e.entity.formType)}).getOrElse(function(){return!1}),h=Object(u.headOption)(f.filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===i.ValueTagSimpleDictionaryPosition.$Type.value}).getOrElse(function(){return!1})}));c(Object(a.y)({blockRendererId:r,displayId:n})),c(Object(a.J)({id:n,blockRendererId:r,display:(d?h.map(function(e){return o.sort(function(t,n){var r=t.entity.values[e.id.value].value,o=n.entity.values[e.id.value].value;return r.value-o.value})}).getOrElse(function(){return o}):o).map(function(n){return new a.t(n.id,function(e,t,n,r){var o=Object(p.e)(r().fields,n).getOrElse(function(){return[]});return e.map(function(e){switch(e.tpe.value){case i.DisplayFieldByTemplate.$Type.value:var n=e;return Object(m.a)(t,new u.None,new u.Some(n.template))(r()).getOrElse(function(){return r().i18n.t("Значение не  найдено")});case i.DisplayFieldByField.$Type.value:default:var a=e;if(a.objRefDisplayFieldId.nonEmpty()){var l=Object(u.headOption)(o.filter(function(e){return e.id.value===a.fieldId.value})).map(function(e){return e.entity.formId.value}).getOrElse(function(){return""});return Object(u.headOption)(Object(u.liftKey)(r().fields.list,l).getOrElse(function(){return[]}).filter(function(e){return e.id.value===a.fieldId.value})).map(function(e){var n=e.entity.valueType.family,o=Object(u.liftKey)(r().dictionaries.list,n.value).getOrElse(function(){return[]}),i=Object(u.liftKey)(t.entity.values,a.fieldId.value).map(function(e){return e.value.id}).getOrElse(function(){return[]}),l=a.objRefDisplayFieldId.getOrElse(function(){return a.fieldId});return o.filter(function(e){return i.filter(function(t){return t.value===e.id.value}).length>0}).map(function(e){return Object(m.a)(e,Object(u.toOption)(l),new u.None)(r()).getOrElse(function(){return r().i18n.t("Значение не  найдено")})})}).getOrElse(function(){return[]}).join("; ")}return Object(m.a)(t,Object(u.toOption)(a.fieldId),new u.None)(r()).getOrElse(function(){return r().i18n.t("Значение не  найдено")})}})}(t,n,e,s),n)}),total:l}))}},y=function(e,t,n,r,o){return function(a,s,m){var y=Object(p.e)(s().fields,t).getOrElse(function(){return[]}),b=y.filter(function(e){return n.filter(function(e){return e.tpe.value===i.DisplayFieldByField.$Type.value}).filter(function(t){return t.fieldId.value===e.id.value}).length>0}).filter(function(e){return e.entity.valueType.tpe.value===i.ValueTypeObjectRefs.$Type.value}).map(function(e){return e.entity.valueType}).filter(function(e){return Object(f.e)(s().forms,e.family).matchWith(function(e){return i.FormType.isAnyDictionary(e.entity.formType)},function(){return!1})}).map(function(e){return e.family}).reduce(function(e,t){return 0===e.filter(function(e){return e.value===t.value}).length?e.concat([t]):e},[]).map(function(e){return a(Object(h.b)(e,new u.None))}),v=y.filter(function(e){return n.filter(function(e){return e.tpe.value===i.DisplayFieldByField.$Type.value}).filter(function(t){return t.fieldId.value===e.id.value}).length>0}).filter(function(e){return e.entity.valueType instanceof i.ValueTypeObjectRefs&&Object(f.e)(s().forms,e.entity.valueType.family).map(function(e){return i.FormType.isForm(e.entity.formType)}).getOrElse(function(){return!1})}).map(function(t){var n=e.records.map(function(e){return Object(u.toOption)(e.entity.values[t.id.value]).filter(function(e){return e.value instanceof i.ValueObjectRefs}).map(function(e){return e.value.id}).getOrElse(function(){return[]})}).reduce(function(e,t){return e.concat(t.filter(function(t){return 0===e.filter(function(e){return e.value===t.value}).length}))},[]).filter(function(e){return Object(d.b)(s().formRecords,t.entity.valueType.family,e).isEmpty()});return 0===n.length?new Promise(function(e,t){return e()}):a(Object(c.b)(t.entity.valueType.family,n)).then(function(e){a(Object(l.e)({form:t.entity.valueType.family,resolved:e.list}))})});return 0===b.length&&0===v.length?a(g(t,n,r,o,e.records,e.total)):Promise.all(b.concat(v)).then(function(){a(g(t,n,r,o,e.records,e.total))}),e}},b=function(e,t,n){return function(r,o,i){var l=t.displayFields;return r(Object(a.z)({blockRendererId:n,displayId:t.id})),Object(s.m)(e).then(function(e){r(y(e.page,t.parentsForm,l,t.id,n))})}},v=function(e,t,n,r,l){return function(u,c,p){var f=function(e){return e instanceof i.ElementControlObjRefsTable?e.displayFields:e instanceof i.ElementControlTagsList?[].concat(o()(e.colorField.map(function(e){return[new i.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]})),o()(e.valueField.map(function(e){return[new i.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]}))):[]}(n);return u(Object(a.z)({blockRendererId:l,displayId:r})),Object(s.l)(e,t).then(function(t){u(y(t.page,e.formId,f,r,l))})}}},1508:function(e,t,n){"use strict";var r=n(1466),o=n(100),i=n(0),a=n(372),l=n(240),u=n(71);n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});var c=function(e,t,n){return function(o,a){o(Object(r.g)(n,t,Object(i.toOption)(e.id)))}},s=function(e,t){return function(n,c){return Object(a.b)(c().blockRendererContext,t).map(function(e){return e.blockId}).map(function(c){return n(Object(r.g)(c,t,Object(i.toOption)(e.id))).then(function(c){return e.dataOutput.foreach(function(r){n(Object(o.M)({blockRendererId:t,output:r,displayId:e.id}))}),n(function(e){return function(t,n){return Object(a.b)(n().blockRendererContext,e).matchWith(function(o){return t(Object(r.g)(o.blockId,e,new i.None)).then(function(){return t(Object(r.a)(o.blockId,e,o.formId))}).then(function(){return Object(a.e)(n().blockRendererContext,e).matchWith(function(i){return Object(l.b)(n().block,o.blockId).map(function(a){return t(Object(r.f)(o.blockId,o.formId,a.entity,e,i)).then(function(e){return t(Object(u.h)(n().i18n.t("Изменения успешно сохранены"))),e})}).getOrElse(function(){return new Promise(function(e,t){return t()})})},function(){return t(Object(r.c)(o.blockId,o.formId,e)).then(function(e){return e.id})})})},function(){return new Promise(function(e,t){return t()})})}}(t))})})}}},1510:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return d}),n.d(t,"d",function(){return h}),n.d(t,"a",function(){return m});var r=n(6),o=n.n(r),i=n(7),a=n.n(i),l=n(8),u=n.n(l),c=n(18),s=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Request",{id:e}))}return u()(t,e),t}(c.a),p=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Delete",{templateId:e}))}return u()(t,e),t}(c.a),f=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Create",{documentTemplate:e}))}return u()(t,e),t}(c.a),d=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Update",{documentTemplate:e}))}return u()(t,e),t}(c.a),h=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","List",{form:e}))}return u()(t,e),t}(c.a),m=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Copy",{documentTemplateId:e}))}return u()(t,e),t}(c.a)},1511:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return c});var r=n(4),o=n.n(r),i=n(1),a=n(0),l=n(3),u=function(e){return function(t,n){if(e.appType instanceof i.ApplicationTypePrivateCabinet){var r=e.token,l=localStorage.getItem("platform5_embedded_user_tokens_map");Object(a.toOption)(l).matchWith(function(e){var t=JSON.parse(e);return n().appKey.appKey.map(function(e){return Object.assign(t,o()({},e,r))})},function(){return n().appKey.appKey.map(function(e){return o()({},e,r)})}).foreach(function(e){localStorage.setItem("platform5_embedded_user_tokens_map",JSON.stringify(e))})}}},c=function(){return function(e,t){var n=localStorage.getItem("platform5_embedded_user_tokens_map");Object(a.toOption)(n).map(function(e){var n=JSON.parse(e);return t().appKey.appKey.map(function(e){return l(n,{$unset:[e]})})}).foreach(function(e){localStorage.setItem("platform5_embedded_user_tokens_map",JSON.stringify(e))})}}},1517:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"f",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return f});var r=n(21),o=n(1510),i=n(435),a=n(17),l=function(e){return a.a.send(new o.b(e),Object(r.f)())},u=function(e){return a.a.send(new o.a(e),Object(r.f)())},c=function(e){return a.a.send(new o.f(e),Object(r.f)())},s=function(e){return a.a.send(new o.c(e),Object(r.f)())},p=function(e){return a.a.send(new o.e(e),Object(r.e)())},f=function(e){return function(t){return t(Object(i.e)()),a.a.send(new o.d(e),Object(r.g)()).then(function(e){return t(Object(i.f)(e.list)),e}).catch(function(e){throw t(Object(i.d)(e)),e})}}},1523:function(e,t,n){e.exports=n(49)(224)},1524:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n(215),o=function(e){return function(t,n){return Object(r.c)(n().dataOutput,e)}},i=function(e,t){return function(n,o){return Object(r.h)(o().dataOutput,e,t)}}},1526:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(381),o=n(637),i=function(e,t,n,i){return function(a,l){return a(Object(r.f)()),o.h(e,t,n,i).then(function(e){return a(Object(r.g)({total:e.page.total,list:e.page.records})),e}).catch(function(e){throw a(Object(r.e)(e)),e})}},a=function(e,t,n,i){return function(a,l){return a(Object(r.f)()),o.g(e,t,n,i).then(function(e){return a(Object(r.g)({total:e.page.total,list:e.page.records})),e}).catch(function(e){throw a(Object(r.e)(e)),e})}}},1527:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),g=n(3),y=n(26),b=n.n(y),v=n(162),O=n.n(v),E=n(24),k=n.n(E),j=n(1593),C=n.n(j),R=n(1594),w=n.n(R),I=n(1528),S=n.n(I),P=n(262),T=n(0),x=n(1),_=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},D=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},F=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={searchValue:new T.None,searchField:Object(T.toOption)(new x.EmailFieldTypeHtmlText)},n}return s()(t,e),a()(t,[{key:"onSearchFormSubmit",value:function(){var e=this;this.props.onSearch(this.state.searchField.flatMap(function(t){return e.state.searchValue.map(function(e){return new x.EmailFilterExpressionFullTextSearch(e,t)})}))}},{key:"openDataSourceMenu",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[d.createElement(k.a,{key:"byHtmlText",onClick:function(){return t.onSearchFieldChange(new x.EmailFieldTypeHtmlText)}},this.props.i18n.t("Html письма")),d.createElement(k.a,{key:"byPlainText",onClick:function(){return t.onSearchFieldChange(new x.EmailFieldTypePlainText)}},this.props.i18n.t("Текст письма")),d.createElement(k.a,{key:"bySubject",onClick:function(){return t.onSearchFieldChange(new x.EmailFieldTypeSubject)}},this.props.i18n.t("Тема письма"))])}},{key:"onSearchValueChange",value:function(e){this.setState(g(this.state,{searchValue:{$set:Object(T.toOption)(e.target.value).filter(function(e){return""!==e})}}))}},{key:"onSearchFieldChange",value:function(e){var t=this;this.setState(g(this.state,{searchField:{$set:Object(T.toOption)(e)}}),function(){t.props.closeMenu()})}},{key:"onSearchValueClear",value:function(){var e=this;this.setState(g(this.state,{searchValue:{$set:new T.None}}),function(){e.props.onSearch(new T.None)})}},{key:"getPlaceholder",value:function(){var e=this;return this.state.searchField.matchWith(function(t){switch(t.tpe.value){case x.EmailFieldTypeHtmlText.$Type.value:return e.props.i18n.t("html");case x.EmailFieldTypePlainText.$Type.value:return e.props.i18n.t("текст");case x.EmailFieldTypeSubject.$Type.value:return e.props.i18n.t("тема");default:throw"unknown email field type"}},function(){return""})}},{key:"render",value:function(){return d.createElement("form",{onSubmit:this.onSearchFormSubmit,style:{display:"flex",flex:1,flexWrap:"nowrap"}},d.createElement(b.a,{fullWidth:!0,style:{marginRight:28,marginTop:0,marginBottom:0},variant:"outlined",value:this.state.searchValue.getOrElse(function(){return""}),placeholder:this.getPlaceholder(),onChange:this.onSearchValueChange,InputProps:{startAdornment:d.createElement(O.a,{position:"start"},d.createElement(S.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.openDataSourceMenu})),endAdornment:d.createElement(O.a,{position:"end"},d.createElement(C.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.onSearchFormSubmit}),this.state.searchValue.nonEmpty()&&d.createElement(w.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.onSearchValueClear}))}}))}}]),t}(d.Component);F=_([m.autobind,D("design:paramtypes",[Object])],F),t.a=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(P.a)(F))},1529:function(e,t,n){e.exports=n(97)(69)},1530:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("defs",null,o.default.createElement("path",{id:"a",d:"M24 24H0V0h24v24z"})),o.default.createElement("path",{d:"M2.5 4v3h5v12h3V7h5V4h-13zm19 5h-9v3h3v7h3v-7h3V9z"})),"TextFields");t.default=i},1532:function(e,t,n){"use strict";var r,o=n(10),i=n.n(o),a=n(7),l=n.n(a),u=n(8),c=n.n(u),s=n(6),p=n.n(s),f=n(4),d=n.n(f),h=n(11),m=n.n(h),g=n(2),y=n(14),b=n(13),v=n(220),O=n.n(v),E=n(1472),k=n.n(E),j=n(538),C=n.n(j),R=n(1490),w=n.n(R),I=n(1),S=n(0),P=n(623),T=n(3),x=n(25),_=n.n(x),D=n(1610),F=n.n(D),M=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},W=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},B=function(e){function t(e){p()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!1},n}return c()(t,e),i()(t,[{key:"onShowToggle",value:function(){this.setState(T(this.state,{show:{$set:!this.state.show}}))}},{key:"render",value:function(){return g.createElement("div",null,g.createElement(_.a,{onClick:this.onShowToggle},g.createElement(F.a,null)),this.state.show&&g.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.text}}))}}]),t}(g.Component),L=B=M([b.autobind,W("design:paramtypes",[Object])],B),A=n(56),$=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},V=(r={},d()(r,I.MessageAttachmentFile.$Type.value,function(e,t){return g.createElement(k.a,{key:e.fileId.value,style:{marginRight:"5px"},label:e.name,avatar:g.createElement(C.a,null,g.createElement(w.a,null)),onClick:function(n){return t.onSaveFileClick(e.fileId)}})}),d()(r,I.MessageAttachmentLink.$Type.value,function(e,t){return g.createElement(k.a,{key:e.attachId,style:{marginRight:"5px"},label:e.name,avatar:g.createElement(C.a,null,g.createElement(w.a,null)),onClick:function(n){return t.onSaveAttachLinkClick(e.attachId)}})}),r),q=function e(){p()(this,e)},N=function(e){function t(e){p()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.text=e,n}return c()(t,e),t}(q),z=function(e){function t(e){p()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.text=e,n}return c()(t,e),t}(q),H=function(e){function t(){return p()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),i()(t,[{key:"onSaveFileClick",value:function(e){var t=this;this.props.authToken.map(function(n){return Object(P.b)(e,n,t.props.cdnAddress)})}},{key:"onSaveAttachLinkClick",value:function(e){var t=this;this.props.authToken.foreach(function(n){return Object(P.a)(t.props.email.id.value,e,n,t.props.serverAddress)})}},{key:"getEmailSections",value:function(e){var t=e.indexOf("<blockquote"),n=e.lastIndexOf("</blockquote>")+"</blockquote>".length;return[new N(t>0?e.substring(0,t):e.substring(0))].concat(t<0||n<0?[]:[new z(e.substring(t,n))]).concat(t<0||n<0||n+1===e.length?[]:[new N(e.substring(n))])}},{key:"onEmailSectionClick",value:function(e){e.nativeEvent.preventDefault(),e.nativeEvent.stopImmediatePropagation(),Object(S.toOption)(e.nativeEvent.target.getAttribute("href")).foreach(function(e){window.open(e,"_blank")})}},{key:"renderEmailSection",value:function(e,t){if(e instanceof N)return g.createElement("div",{key:t,contentEditable:this.props.email.entity.meta.emailStatus.tpe.value===I.EmailStatusDraft.$Type.value,onClick:this.onEmailSectionClick,dangerouslySetInnerHTML:{__html:e.text}});if(e instanceof z)return g.createElement(L,{key:t,text:e.text});throw"Unknown section type"}},{key:"renderEmail",value:function(e){var t=this;return this.getEmailSections(e).map(function(e,n){return t.renderEmailSection(e,n)})}},{key:"renderAttachmentComponent",value:function(e){var t=this;return Object(A.b)(e.tpe.value)(V).matchWith(function(n){return n(e,t)},function(){throw"uknown attachment type"})}},{key:"render",value:function(){var e=this,t=this.props.email.entity.msgBody,n=t.attachments;return g.createElement("div",{style:{display:"flex",flex:1,flexDirection:"column"}},g.createElement("div",{style:{display:"flex",flexShrink:0,marginBottom:"10px"}},g.createElement("div",{style:{flexShrink:0}},g.createElement("span",{style:{fontWeight:600,fontSize:"16px"}},t.from.name),g.createElement("span",null," <"+t.from.email+">")),g.createElement("div",{style:{display:"flex",flex:1,justifyContent:"flex-end"}},new Date(this.props.email.entity.created).toLocaleString())),g.createElement("div",{style:{overflow:"auto"}},this.renderEmail(t.html.text)),n.length>0&&g.createElement("div",{style:{marginTop:"10px",flexShrink:0}},g.createElement(O.a,null),g.createElement("div",{style:{marginTop:"10px"}},n.map(function(t,n){return e.renderAttachmentComponent(t)}))))}}]),t}(g.Component);H=$([b.autobind],H);t.a=Object(y.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,cdnAddress:e.config.cdnAddress,serverAddress:e.config.serverAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(H)},1533:function(e,t,n){"use strict";var r=n(43),o=n.n(r),i=n(23),a=n(1),l=n(0),u=n(439),c=n(100),s=n(1486),p=function(e){switch(e.tpe.value){case a.ValueNumber.$Type.value:return e.value;default:return e.toString()}},f=function(e,t,n){return n?e.localeCompare(t):t.localeCompare(e)},d=function(e,t,n){return n?e-t:t-e};n.d(t,"a",function(){return h});var h=function(e,t,n,r,h,m,g){return function(y,b){y(Object(u.d)(e.id));var v=b().fields;switch(r.entity.valueType.tpe){case a.ValueTypeValuesList.$Type:var O=r.entity.valueType.values;y(Object(u.e)({displayId:e.id,input:t,form:n,fields:v,value:new a.ValueList(O),displayValues:[],displayValuesAdding:[],formRecords:[],total:m}));break;case a.ValueTypeBool.$Type:y(Object(u.e)({displayId:e.id,input:t,form:n,fields:v,value:new a.ValueEmpty,displayValues:[],displayValuesAdding:[],formRecords:[],total:m}));break;case a.ValueTypeObjectRefs.$Type:var E=r.entity.valueType.family;e.control.foreach(function(r){if(r instanceof a.ElementControlObjRefsTable)y(Object(u.e)({displayId:e.id,input:t,form:n,fields:v,value:new a.ValueObjectRefs(h.map(function(e){return e.id})),displayValues:h.map(function(e){var t=r.displayFields.map(function(t){switch(t.tpe.value){case a.DisplayFieldByTemplate.$Type.value:var n=t;return Object(s.a)(e,new l.None,new i.Some(n.template))(b()).getOrElse(function(){return b().i18n.t("Значение не  найдено")});case a.DisplayFieldByField.$Type.value:default:var r=t;return r.objRefDisplayFieldId.nonEmpty()?Object(l.headOption)(Object(l.liftKey)(b().fields.list,E.value).getOrElse(function(){return[]}).filter(function(e){return e.id.value===r.fieldId.value})).map(function(t){var n=t.entity.valueType.family,o=Object(l.liftKey)(b().dictionaries.list,n.value).getOrElse(function(){return[]}),i=Object(l.liftKey)(e.entity.values,r.fieldId.value).map(function(e){return e.value.id}).getOrElse(function(){return[]}),a=r.objRefDisplayFieldId.getOrElse(function(){return r.fieldId});return o.filter(function(e){return i.filter(function(t){return t.value===e.id.value}).length>0}).map(function(e){return Object(s.a)(e,Object(l.toOption)(a),new l.None)(b()).getOrElse(function(){return b().i18n.t("Значение не  найдено")})})}).getOrElse(function(){return[]}).join("; "):Object(s.a)(e,Object(l.toOption)(r.fieldId),new l.None)(b()).getOrElse(function(){return b().i18n.t("Значение не  найдено")})}});return new c.t(e.id,t,e)}),displayValuesAdding:h.map(function(e){var t=r.displayFieldsForAdding.map(function(t){switch(t.tpe.value){case a.DisplayFieldByTemplate.$Type.value:var n=t;return Object(s.a)(e,new l.None,new i.Some(n.template))(b()).getOrElse(function(){return b().i18n.t("Значение не  найдено")});case a.DisplayFieldByField.$Type.value:default:var r=t;return r.objRefDisplayFieldId.nonEmpty()?Object(l.headOption)(Object(l.liftKey)(b().fields.list,E.value).getOrElse(function(){return[]}).filter(function(e){return e.id.value===r.fieldId.value})).map(function(t){var n=t.entity.valueType.family,o=Object(l.liftKey)(b().dictionaries.list,n.value).getOrElse(function(){return[]}),i=Object(l.liftKey)(e.entity.values,r.fieldId.value).map(function(e){return e.value.id}).getOrElse(function(){return[]}),a=r.objRefDisplayFieldId.getOrElse(function(){return r.fieldId});return o.filter(function(e){return i.filter(function(t){return t.value===e.id.value}).length>0}).map(function(e){return Object(s.a)(e,Object(l.toOption)(a),new l.None)(b()).getOrElse(function(){return b().i18n.t("Значение не  найдено")})})}).getOrElse(function(){return[]}).join("; "):Object(s.a)(e,Object(l.toOption)(r.fieldId),new l.None)(b()).getOrElse(function(){return b().i18n.t("Значение не  найдено")})}});return new c.t(e.id,t,e)}),formRecords:h,total:m}));else if(r.tpe.value===a.ElementControlTagsList.$Type.value){var O=[].concat(o()(r.colorField.map(function(e){return[new a.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]})),o()(r.valueField.map(function(e){return[new a.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]})));y(Object(u.e)({displayId:e.id,input:t,form:n,fields:v,value:new a.ValueObjectRefs(h.map(function(e){return e.id})),displayValues:h.map(function(e){return new c.t(e.id,O.map(function(t){return Object(s.a)(e,new i.Some(t.fieldId),new l.None)(b()).getOrElse(function(){return b().i18n.t("Значение не  найдено")})}),e)}),displayValuesAdding:[],formRecords:h,total:m}))}else y(Object(u.e)({displayId:e.id,input:t,form:n,fields:v,value:new a.ValueObjectRefs(h.map(function(e){return e.id})),displayValues:r.sortingBy.map(function(e){return h.concat().sort(function(t,n){return function(e,t,n){return"number"==typeof e&&"number"==typeof t?d(e,t,n):f(e.toString(),t.toString(),n)}(Object(l.toOption)(t.entity.values[e.fieldId.value]).map(function(e){return p(e.value)}).getOrElse(function(){return""}),Object(l.toOption)(n.entity.values[e.fieldId.value]).map(function(e){return p(e.value)}).getOrElse(function(){return""}),e.asc)})}).getOrElse(function(){return h}).map(function(e){return new c.u(e.id,new a.ValueStr(r.valueCaptionTemplate.flatMap(function(t){return Object(l.toOption)(t.match(/\$id\d+/gi)).map(function(n){return n.reduce(function(t,n){var r=Object(l.toOption)(e.entity.values[n.slice("$id".length)]).map(function(e){return e.value.toString()}).getOrElse(function(){return g("Значение отсутствует")});return t.replace(n,r)},t)})}).getOrElse(function(){return g("Значение отсутствует")})))}),displayValuesAdding:[],formRecords:h,total:m}))})}}}},1534:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(7),a=n.n(i),l=n(8),u=n.n(l),c=n(18),s=n(0),p=function(e){function t(e,n,r,i){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new s.None;return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","Print",{context:e,document:n,assignBarcodes:r,printPdf:i,terminalCustomId:l}))}return u()(t,e),t}(c.a),f=function(e){function t(e,n,r){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","AssignBarcodes",{record:e,assignBarcodes:n,removeOldCodes:r}))}return u()(t,e),t}(c.a),d=function(e){function t(e,n){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","MassPrint",{context:e,document:n}))}return u()(t,e),t}(c.a),h=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","MassPrintAvailable",{context:e}))}return u()(t,e),t}(c.a),m=n(17);n.d(t,"b",function(){return g}),n.d(t,"a",function(){return y}),n.d(t,"c",function(){return b}),n.d(t,"d",function(){return v});var g=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new s.None;return m.a.send(new p(e,t,n,r,o),function(e){return e})},y=function(e,t,n){return m.a.send(new f(e,t,n||!1),function(e){return e})},b=function(e,t){return m.a.send(new d(e,t),function(e){return e})},v=function(e){return m.a.send(new h(e),function(e){return e})}},1535:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});var r=n(1),o=n(1466),i=n(147),a=n(100),l=n(268),u=n(215),c=function(e,t,n){return function(r,o){Object(u.d)(o().dataOutput,t,e).map(function(e){return e.value}).foreach(function(i){o().duplicateMerging.destinationBlockRendererId.foreach(function(o){r(Object(a.D)({output:e,value:i,blockRendererId:o,displayId:n})),r(Object(l.k)({output:e,blockRendererId:t,value:i}))})})}},s=function(e,t){return function(n,a){return a().duplicateMerging.destinationFormData.map(function(n){return Object(o.i)(t,[n.id],a().duplicateMerging.mergingResult).then(function(t){return a().duplicateMerging.formDataStatus.filter(function(e){return e.tpe.value!==r.FormDataStatusActive.$Type.value}).matchWith(function(t){return Object(i.w)(e,a().duplicateMerging.formDatas.map(function(e){return e.formData.id}).filter(function(e){return e.value!==n.id.value}),t)},function(){return new Promise(function(e,t){return e()})})})}).getOrElse(function(){return new Promise(function(e,t){return t()})})}}},1536:function(e,t,n){e.exports=n(49)(157)},1537:function(e,t,n){e.exports=n(49)(196)},1538:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(1),d=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getRootStyle",value:function(){return{display:this.props.titlePosition instanceof f.ElementPlacementLeft?"flex":"block"}}},{key:"getLabelContainerStyle",value:function(){return this.props.titlePosition instanceof f.ElementPlacementLeft?{flex:0,paddingRight:"5px",flexShrink:0}:{}}},{key:"getInputContainerStyle",value:function(){return this.props.titlePosition instanceof f.ElementPlacementLeft?{flex:1,paddingLeft:"5px"}:{}}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"form-group",style:this.getRootStyle()},p.createElement("div",{style:this.getLabelContainerStyle()},p.createElement("label",null,this.props.label)),p.createElement("div",{style:this.getInputContainerStyle()},p.createElement("div",null,p.createElement("select",{className:"form-control",id:this.props.id,style:this.props.error?{borderColor:"#dc3545"}:{},value:this.props.value,onChange:function(t){return e.props.onChange(t.target.value)}},this.props.options.map(function(e,t){return p.createElement("option",{key:t,value:e.value},e.label)}))),p.createElement("div",{style:this.props.error?{color:"#dc3545"}:{display:"none"}},this.props.error)))}}]),t}(p.Component);t.a=d},1539:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(14),d=n(1),h=n(215),m=n(0),g=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return p.createElement("span",null,this.props.value.map(function(e){return e.toString().replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull())}}]),t}(p.Component);t.a=Object(f.connect)(function(e,t){return{value:Object(h.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof d.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(m.isEqual)(e.value,t.value)}})(g)},1540:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),g=n(26),y=n.n(g),b=n(75),v=n.n(b),O=n(33),E=n.n(O),k=n(332),j=n(3),C=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},R=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:"",removeOldCodes:!1},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.currentAssignBarcodeValue!==e.currentAssignBarcodeValue&&(e.onChange(e.currentAssignBarcodeValue,this.state.removeOldCodes),e.onSave())}},{key:"componentWillMount",value:function(){this.props.dispatch(Object(k.e)())}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(k.d)())}},{key:"onChange",value:function(e){this.props.onChange(e.target.value,this.state.removeOldCodes),this.setState(j(this.state,{value:{$set:e.target.value}}))}},{key:"onRemoveOldValuesToggled",value:function(e,t){this.props.onChange(this.state.value,t),this.setState(j(this.state,{removeOldCodes:{$set:t}}))}},{key:"render",value:function(){return d.createElement("div",null,d.createElement(y.a,{value:this.state.value,onChange:this.onChange,fullWidth:!0,placeholder:this.props.i18n.t("Значение штрихкода")}),this.props.withRemoveOldValue&&d.createElement(E.a,{label:this.props.i18n.t("Удалять старые значения"),control:d.createElement(v.a,{checked:this.state.removeOldCodes,onChange:this.onRemoveOldValuesToggled})}))}}]),t}(d.Component);w=C([m.autobind,R("design:paramtypes",[Object])],w),t.a=Object(h.connect)(function(e){return{currentAssignBarcodeValue:e.assignBarcodes.currentAssignBarcodeValue.getOrElse(function(){return""}),i18n:e.i18n}})(w)},1541:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u});var r=n(438),o=n(264),i=n(639),a=n(87),l=function(e,t,n,i){return function(a,l){return a(Object(r.e)({formDataId:n,documentId:t})),a(Object(o.b)(e,i)).then(function(e){return a(Object(r.f)({formDataId:n,documentId:t,records:e.list})),e.list}).catch(function(e){throw a(Object(r.d)({formDataId:n,documentId:t,error:e})),e})}},u=function(e,t,n,r){return function(o,u){return o(Object(a.b)(function(e){return!Object(i.e)(e.documentRecords,n,t)&&Object(i.d)(e.documentRecords,n,t)},l(e,t,n,r)))}}},1542:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),g=n(59),y=n(3),b=n(19),v=n.n(b),O=n(25),E=n.n(O),k=n(72),j=n.n(k),C=n(62),R=n.n(C),w=n(1),I=n(100),S=n(0),P=n(50),T=n(1456),x=n(1475),_=n(173),D=n(372),F=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},M=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},W=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={embeddedBlockComponents:[]},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.display.displayFirstBlock&&this.addBlockComponent()}},{key:"addBlockComponent",value:function(){var e=this,t=g.v4();this.props.dispatch(Object(I.B)({blockRendererId:this.props.blockRendererId,displayId:this.props.display.id,embeddedBlockRendererId:t})),this.props.getBlockComponent(this.props.display.formId,new S.None,this.props.display.blockId,t,this.props.blockType,this.props.rootBlockRendererId.matchWith(function(e){return Object(S.toOption)(e)},function(){return Object(S.toOption)(e.props.blockRendererId)}),function(n){return e.setState(y(e.state,{embeddedBlockComponents:{$push:[{blockRendererId:t,component:n}]}}))})}},{key:"onAddBlockClick",value:function(){this.addBlockComponent()}},{key:"onDeleteBlockClick",value:function(e){this.setState(y(this.state,{embeddedBlockComponents:{$set:this.state.embeddedBlockComponents.filter(function(t){return t.blockRendererId!==e})}}))}},{key:"getButtonWidgetStyle",value:function(e){var t=e.flatMap(function(e){return e.proportions}).getOrElse(function(){return new w.ElementProportions}),n=e.flatMap(function(e){return e.background}).getOrElse(function(){return new w.ElementBackground}),r=e.flatMap(function(e){return e.fonts.map(function(e){return e.textFont})}).flatMap(function(e){return e}),o=e.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),i=Object(T.c)(r,o,new S.None),a=t.width,l=t.height,u=n.color,c="#fff"===u,s=l.filter(function(e){return""!==e}).nonEmpty();return{buttonStyle:Object.assign({width:a.getOrElse(function(){return"auto"}),height:l.getOrElse(function(){return"auto"})},c?{transition:"none"}:{backgroundColor:u}),textStyle:Object.assign(i,s?{lineHeight:l.map(function(e){return e+"px"}).getOrElse(function(){return"auto"})}:{}),width:a}}},{key:"getStyle",value:function(){var e=this.props.display.elementCss;return{borderTop:Object(x.d)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderRight:Object(x.c)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderBottom:Object(x.a)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderLeft:Object(x.b)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderRadius:"5px",marginTop:"10px",position:"relative"}}},{key:"render",value:function(){var e=this,t=this.getButtonWidgetStyle(this.props.display.elementCss);return d.createElement("div",{className:Object(P.B)(this.props.display,"container"),style:this.props.style},d.createElement("p",{style:{fontWeight:"bold"}},Object(_.c)(this.props.display.label.text)||this.props.i18n.t("Надпись")),d.createElement("div",null,this.state.embeddedBlockComponents.map(function(t,n){return d.createElement("div",{key:t.blockRendererId,style:e.getStyle()},t.component,e.props.display.addingEnabled&&(0!==n||!e.props.display.displayFirstBlock)&&d.createElement("div",{style:{textAlign:"right",position:"absolute",right:0,top:0}},d.createElement(E.a,{onClick:function(n){return e.onDeleteBlockClick(t.blockRendererId)}},d.createElement(j.a,null))))})),this.props.display.addingEnabled&&d.createElement("div",{style:{padding:"7px"}},d.createElement(v.a,{variant:"raised",onClick:this.onAddBlockClick,color:"primary",style:t.buttonStyle},d.createElement("div",{style:t.textStyle},this.props.i18n.t(this.props.display.buttonLabel.getOrElse(function(){return"Добавить"}))))))}}]),t}(d.Component);W=F([m.autobind,M("design:paramtypes",[Object])],W),t.a=Object(h.connect)(function(e,t){return{i18n:e.i18n,rootBlockRendererId:Object(D.j)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.display===t.display&&e.blockType===t.blockType&&e.blockRendererId===t.blockRendererId},areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(S.isEqual)(e.rootBlockRendererId,t.rootBlockRendererId)}})(W)},1543:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(14),d=n(62),h=n.n(d),m=n(1475),g=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getStyle",value:function(){var e=this.props.display.elementCss;return{borderTop:Object(m.d)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderRight:Object(m.c)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderBottom:Object(m.a)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderLeft:Object(m.b)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderRadius:"5px"}}},{key:"render",value:function(){var e=this.props.display.elementCss,t=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}).getOrElse(function(){return"100%"}),n=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}).getOrElse(function(){return"100%"}),r=this.props.display.src.getOrElse(function(){return""});return p.createElement("iframe",{src:r,width:t,height:n,frameBorder:"0",style:this.getStyle()},this.props.i18n.t("Ваш браузер не поддерживает плавающие фреймы"))}}]),t}(p.Component);t.a=Object(f.connect)(function(e,t){return{i18n:e.i18n}})(g)},1544:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(14),g=n(3),y=n(115),b=n.n(y),v=n(25),O=n.n(v),E=n(19),k=n.n(E),j=n(418),C=n(1),R=n(83),w=n(375),I=n.n(w),S=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},P=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},T=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:!1},n}return s()(t,e),a()(t,[{key:"getElementTipSettings",value:function(){return this.props.component.tip}},{key:"getElementTipEnabled",value:function(){return this.getElementTipSettings().map(function(e){return e.enabled}).getOrElse(function(){return!1})}},{key:"getElementTipVariant",value:function(){return this.getElementTipSettings().map(function(e){return e.variant}).getOrElse(function(){return new C.ElementTipVariantDialog})}},{key:"getElementTipBody",value:function(){var e=this.getElementTipSettings().flatMap(function(e){return e.body}).getOrElse(function(){return""});return d.createElement("div",{dangerouslySetInnerHTML:{__html:e}})}},{key:"getElementTipTooltipShowOnHover",value:function(){return this.getElementTipSettings().map(function(e){return e.variant}).filter(function(e){return e instanceof C.ElementTipVariantTooltip}).map(function(e){return e.showOnHover})}},{key:"onTipDialogRequest",value:function(){var e=this,t=this.props.openDialog("",d.createElement(d.Fragment,null,this.getElementTipBody()),[d.createElement(k.a,{key:"close",variant:"raised",onClick:function(){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"onTooltipOpen",value:function(){this.setState(g(this.state,{open:{$set:!0}}))}},{key:"handleTooltipClose",value:function(){this.setState(g(this.state,{open:{$set:!1}}))}},{key:"getTooltip",value:function(){var e=this;return this.getElementTipTooltipShowOnHover().filter(function(e){return e}).matchWith(function(){return d.createElement(b.a,{title:e.getElementTipBody()},d.createElement(O.a,null,d.createElement(j.a,null)))},function(){return d.createElement(I.a,{onClickAway:e.handleTooltipClose},d.createElement(b.a,{title:e.getElementTipBody(),onClose:e.handleTooltipClose,open:e.state.open,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},d.createElement(O.a,{onClick:e.onTooltipOpen},d.createElement(j.a,null))))})}},{key:"getTipElement",value:function(){switch(this.getElementTipVariant().tpe.value){case C.ElementTipVariantTooltip.$Type.value:return d.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:5}},this.getTooltip());case C.ElementTipVariantDialog.$Type.value:return d.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:5}},d.createElement(O.a,{onClick:this.onTipDialogRequest},d.createElement(j.a,null)))}}},{key:"render",value:function(){return d.createElement(d.Fragment,null,this.props.children,this.getElementTipEnabled()&&this.getTipElement())}}]),t}(d.Component);T=S([h.autobind,P("design:paramtypes",[Object])],T),t.a=Object(m.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(R.a)(T))},1548:function(e,t,n){"use strict";var r=n(17),o=n(6),i=n.n(o),a=n(7),l=n.n(a),u=n(8),c=n.n(u),s=n(18),p=(function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Request",{id:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","List",{orgId:e}))}return c()(t,e),t}(s.a)),f=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Update",{page:e}))}return c()(t,e),t}(s.a),d=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Create",{page:e}))}return c()(t,e),t}(s.a),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"InternetDomains","Delete",{id:e}))}return c()(t,e),t}(s.a),m=n(21);n.d(t,"c",function(){return g}),n.d(t,"d",function(){return y}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return v});var g=function(e){return r.a.send(new p(e),Object(m.g)())},y=function(e){return r.a.send(new f(e),Object(m.f)())},b=function(e){return r.a.send(new d(e),Object(m.c)())},v=function(e){return r.a.send(new h(e),Object(m.d)())}},1549:function(e,t,n){var r=n(1550);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1550:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FormRecordDisplay__row-title-top {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column; }\n\n.FormRecordDisplay__row-title-bottom {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column-reverse; }\n\n.FormRecordDisplay__row-title-left {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: row; }\n  .FormRecordDisplay__row-title-left .FormRecordDisplay__label-row {\n    margin-right: 2em; }\n\n.FormRecordDisplay__row-title-right {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: row-reverse;\n  justify-content: flex-end; }\n  .FormRecordDisplay__row-title-right .FormRecordDisplay__label-row {\n    margin-left: 2em; }\n\n.FormRecordDisplay__label-row {\n  margin-bottom: 5px; }\n\n.FormRecordDisplay__label {\n  font-weight: bold; }\n\n.FormRecordDisplay__image {\n  max-width: 250px;\n  max-height: 350px; }\n  .FormRecordDisplay__image > img {\n    max-height: 100%;\n    max-width: 100%; }\n",""])},1551:function(e,t,n){var r=n(1552);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1552:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},1553:function(e,t,n){var r=n(1554);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1554:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.ControlEditByClickWrapper__cover {\n  position: relative;\n  z-index: 2; }\n\n.ControlEditByClickWrapper__cover:hover {\n  position: relative; }\n  .ControlEditByClickWrapper__cover:hover .ControlEditByClickWrapper__button {\n    display: inline-block !important; }\n\n.ControlEditByClickWrapper__container:hover {\n  background-color: #B3E5FC !important;\n  cursor: pointer; }\n\n.ControlEditByClickWrapper__cover:before {\n  content: "";\n  display: block;\n  background-color: transparent;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 10; }\n\n.ControlEditByClickWrapper__button {\n  display: none !important;\n  position: absolute !important;\n  top: 50% !important;\n  right: 5px !important;\n  transform: translateY(-50%);\n  z-index: 11 !important; }\n',""])},1555:function(e,t,n){var r=n(1556);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1556:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".form-control {\n  display: block;\n  width: 100%;\n  height: 34px;\n  padding: 6px 12px;\n  font-size: 14px;\n  line-height: 1.42857143;\n  color: #555;\n  background-color: #fff;\n  background-image: none;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n  -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;\n  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;\n  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;\n  box-sizing: border-box; }\n\n.form-control.focus, .form-control:focus {\n  border-color: #2196F3;\n  outline: 0; }\n\n.form-group {\n  width: 100%;\n  margin-bottom: 25px; }\n  .form-group .form-control {\n    width: 100%;\n    box-shadow: none !important;\n    border-radius: 3px;\n    box-sizing: border-box; }\n  .form-group button, .form-group input, .form-group select, .form-group a {\n    outline: none !important;\n    box-sizing: border-box; }\n  .form-group label {\n    display: inline-block;\n    max-width: 100%;\n    margin-bottom: 5px;\n    font-weight: 400;\n    box-sizing: border-box; }\n",""])},1557:function(e,t,n){var r=n(1558);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1558:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FileListControlEditor__dropzone {\n  position: relative;\n  width: 100%;\n  height: 100px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.FileListControlEditor__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.FileListControlEditor__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n",""])},1559:function(e,t,n){var r=n(1560);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1560:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageListControlDisplay__root {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n  overflow: hidden; }\n\n.ImageListControlDisplay__silder-root {\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-around;\n  overflow: hidden; }\n\n.ImageListControlDisplay__slider-gridList {\n  flex: 1;\n  flex-wrap: nowrap;\n  transform: translateZ(0);\n  overflow: hidden; }\n\n.ImageListControlDisplay__silder-button {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 5px; }\n",""])},1561:function(e,t,n){var r=n(1562);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1562:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageListControlEditor__container {\n  display: flex;\n  flex-flow: row wrap;\n  align-items: center; }\n\n.ImageListControlEditor__image {\n  max-height: 100%;\n  max-width: 100%;\n  object-fit: contain; }\n\n.ImageListControlEditor__imageContainer {\n  max-height: 150px;\n  width: 150px;\n  margin: 4px;\n  display: flex;\n  justify-content: center; }\n\n.ImageListControlEditor__image-loader {\n  height: 150px;\n  width: 100%;\n  position: relative; }\n\n.ImageListControlEditor__image-addButton {\n  color: #03A9F4 !important;\n  height: 36px !important;\n  width: 36px !important; }\n",""])},1563:function(e,t,n){var r=n(1564);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1564:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageControlDisplay__container {\n  text-align: center; }\n\n.ImageControlDisplay__highlightError {\n  background-color: red;\n  opacity: 0.5;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0; }\n\n.ImageControlDisplay__imageWrapper {\n  position: relative;\n  display: inline-block;\n  font-size: 0; }\n\n.ImageControlDisplay__image {\n  height: 300px;\n  width: 225px; }\n\n.ImageControlDisplay__image-loader {\n  height: 300px;\n  width: 100%;\n  position: relative; }\n",""])},1565:function(e,t,n){var r=n(1566);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1566:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageControlEditor__container {\n  text-align: left; }\n\n.ImageControlEditor__wrapper {\n  display: inline-block;\n  position: relative;\n  overflow: hidden; }\n\n.ImageControlEditor__highlightError {\n  background-color: red;\n  opacity: 0.5;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0; }\n\n.ImageControlEditor__imageWrapper {\n  max-height: 100%;\n  max-width: 100%;\n  min-height: 100px;\n  min-width: 150px;\n  position: relative;\n  font-size: 0; }\n\n.ImageControlEditor__image {\n  width: 100%;\n  height: auto; }\n\n.ImageControlEditor__image-loader {\n  height: 300px;\n  width: 100%;\n  margin-bottom: 6px;\n  position: relative; }\n\n.ImageControlEditor__image-error {\n  height: 300px;\n  width: 100%;\n  margin-bottom: 6px;\n  position: relative; }\n\n.ImageControlEditor__image-buttonsBar {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center; }\n\n.ImageControlEditor__imageDialog-wrapper {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 100000;\n  display: flex;\n  background-color: rgba(50, 50, 50, 0.7); }\n\n.ImageControlEditor__imageDialog-container {\n  margin: auto;\n  height: 95%;\n  max-width: 95%;\n  display: flex; }\n\n.ImageControlEditor__imageDialog-image {\n  margin: auto;\n  width: auto;\n  height: auto;\n  max-height: 100%;\n  max-width: 100%; }\n",""])},1567:function(e,t,n){var r=n(1568);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1568:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".UsersControlDisplay__container {\n  display: flex;\n  margin: 4px 0; }\n\n.UsersControlDisplay__chip {\n  margin: 4px !important; }\n",""])},1569:function(e,t,n){var r=n(1570);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1570:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".GroupWidget__container {\n  box-sizing: border-box; }\n",""])},1571:function(e,t,n){var r=n(1572);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1572:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".CommentsListDisplayItem-root {\n  position: relative; }\n  .CommentsListDisplayItem-root:hover > .CommentsListDisplayItem-more {\n    display: inline-block; }\n\n.CommentsListDisplayItem-more {\n  position: absolute;\n  right: 0;\n  top: 0;\n  display: none; }\n\n.CommentsListDisplayItem-more:hover {\n  display: inline-block !important; }\n",""])},1591:function(e,t,n){"use strict";var r=n(17),o=n(6),i=n.n(o),a=n(7),l=n.n(a),u=n(8),c=n.n(u),s=n(18),p=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Request",{id:e}))}return c()(t,e),t}(s.a),f=(function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","List",{orgId:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","ListDescriptions",{orgId:e}))}return c()(t,e),t}(s.a)),d=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Create",{page:e}))}return c()(t,e),t}(s.a),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Update",{page:e}))}return c()(t,e),t}(s.a),m=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"WebPages","Delete",{id:e}))}return c()(t,e),t}(s.a),g=(n(296),n(449)),y=n(21);n.d(t,"a",function(){return b}),n.d(t,"e",function(){return v}),n.d(t,"b",function(){return O}),n.d(t,"d",function(){return E}),n.d(t,"c",function(){return k});var b=function(e){return r.a.send(new d(e),Object(y.f)())},v=function(e){return r.a.send(new h(e),Object(y.f)())},O=function(e){return r.a.send(new m(e),Object(y.f)())},E=function(e){return function(t){return t(Object(g.e)()),r.a.send(new p(e),Object(y.e)()).then(function(e){return t(Object(g.f)(e.record)),e}).catch(function(e){throw t(Object(g.d)(e)),e})}},k=function(e){return r.a.send(new f(e),function(e){return e})}},1592:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),g=n(325),y=n.n(g),b=n(71),v=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},O=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"hideNotification",value:function(){this.props.dispatch(Object(b.f)())}},{key:"render",value:function(){var e=this;return d.createElement(y.a,{open:this.props.screen.snackbar.open,autoHideDuration:4e3,onClose:function(){return e.hideNotification()},message:d.createElement("div",null,this.props.screen.snackbar.message)})}}]),t}(d.Component);O=v([m.autobind],O),t.a=Object(h.connect)(function(e){return{screen:e.screen}})(O)},1595:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l});var r=n(296),o=n(1591),i=n(87),a=function(e){return function(t,n){return t(Object(r.h)()),o.c(e).then(function(e){return t(Object(r.i)(e)),e}).catch(function(e){throw t(Object(r.g)(e)),e})}},l=function(e){return function(t){return t(Object(i.b)(function(e){return!e.webPages.descriptionsFetching&&e.webPages.descriptionsFetching},a(e)))}}},1596:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l});var r=n(445),o=n(1548),i=n(87),a=function(e){return function(t,n){return t(Object(r.e)()),o.c(e).then(function(e){return t(Object(r.f)(e.list)),e.list}).catch(function(e){throw t(Object(r.d)(e)),e})}},l=function(e){return function(t){return t(Object(i.b)(function(e){return!e.internetDomains.fetching&&e.internetDomains.fetched},a(e)))}}},1601:function(e,t,n){var r=n(1602);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1602:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FullScreen {\n  height: 100%;\n  display: flex;\n  flex-direction: column; }\n\n.FullScreen__top {\n  width: 100%; }\n\n.FullScreen__content {\n  display: flex;\n  flex-direction: row;\n  flex: 1 1 auto;\n  min-height: 0; }\n",""])},1603:function(e,t,n){var r=n(1604);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1604:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".Screen__container {\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 auto;\n  min-height: 0;\n  overflow: hidden;\n  background-color: #eeeded;\n  padding: 8px;\n  box-sizing: border-box; }\n\n.DefaultPage__paper {\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  width: 100%;\n  overflow: auto; }\n",""])},1612:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14z"})),"FilterNone");t.default=i},1613:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),o.default.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"})),"ArrowDownward");t.default=i},1768:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(642);t.a=function(e){return function(t){function n(){return o()(this,n),u()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s()(n,t),a()(n,[{key:"render",value:function(){var t=this;return p.createElement(f.a,null,function(n){return p.createElement(e,Object.assign({onTabChange:n.onTabChange,currentTab:n.currentTab,ref:function(e){return t.ref=e}},t.props))})}}]),n}(p.Component)}},1769:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"})),"Dashboard");t.default=i},1770:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(2),f=n(647);t.a=function(e){return function(t){function n(){return o()(this,n),u()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s()(n,t),a()(n,[{key:"render",value:function(){var t=this;return p.createElement(f.a,null,function(n){return p.createElement(e,Object.assign({createPortal:n.createPortal},t.props))})}}]),n}(p.Component)}},1816:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"KeyboardArrowUp");t.default=i},1828:function(e,t,n){e.exports=n(97)(290)},1829:function(e,t,n){e.exports=n(97)(95)},1830:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"ExpandLess");t.default=i},1831:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t){return Object.assign({background:e.isDragging?"lightgreen":"inherit"},t.draggableProps.style,(e.isDragging,{}))}},1832:function(e,t,n){"use strict";var r=n(2),o=n(1496);t.a=function(e,t,n,i,a,l,u){return u(r.createElement(o.a,{formId:e,blockRendererId:i,rootBlockRendererId:l,blockType:a,formRecord:t,formRecordId:t.map(function(e){return e.id}),blockId:n,initialValues:{},initialValuesError:!1,getBlockComponent:(void 0).getBlockComponent,onSave:function(){return new Promise(function(e,t){return t(new Error("onSave not implemented"))})},onEdit:function(){return new Promise(function(e,t){return t(new Error("onEdit not implemented"))})}}))}},1895:function(e,t,n){"use strict";var r=n(1),o=n(0),i=n(109),a=/\$id\d+/gi,l=/\$value-[a-z0-9\-]{36}/gi,u=/\$link-(\d+)/gi;t.a=function(e,t,c,s,p,f,d){return function(e,t,n){return e.replace(a,function(e){return Object(o.headOption)(t.filter(function(t){return t.id.value===e.slice("$id".length)})).map(function(e){return"{{"+e.entity.caption+"}}"}).getOrElse(function(){return"{{"+n("Поле не найдено")+"}}"})})}(function(e,t,n){return e.replace(l,function(e){return Object(o.headOption)(t.filter(function(t){return t.id===e.slice("$value-".length)})).map(function(e){return"{{"+e.name+"}}"}).getOrElse(function(){return"{{"+n("Значение для вставки не найдено")+"}}"})})}(function(e,t,o,a,l){return e.replace('<img style="width: auto','<img style="width: 100%').replace(u,function(e){return o.map(function(t){return Object(i.b)(t,new r.Id(e.slice("$link-".length)),l)}).getOrElse(function(){return n(854)})})}(e,0,p,0,d),c,f),t,f)}},1919:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),l=n(7),u=n.n(l),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(1522),g=n(13),y=n(98),b=n.n(y),v=n(376),O=n.n(v),E=n(1),k=n(42),j=n(4),C=n.n(j),R=n(538),w=n.n(R),I=n(1472),S=n.n(I),P=n(1530),T=n.n(P),x=n(380),_=n.n(x),D=n(56),F=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},M=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderChip",value:function(e){var t;return Object(D.b)(this.props.controlType.value)((t={},C()(t,E.HtmlContentElement.$Type.value,e(this.props.i18n.t("Html"),d.createElement(T.a,null))),C()(t,E.EmailButtonElement.$Type.value,e(this.props.i18n.t("Кнопка"),d.createElement(_.a,null))),C()(t,E.EmailImageElement.$Type.value,e(this.props.i18n.t("Изображение"),d.createElement(T.a,null))),C()(t,E.EmailDividerElement.$Type.value,e(this.props.i18n.t("Разделитель"),d.createElement(T.a,null))),t)).getOrElse(function(){return d.createElement(S.a,null,"Unknown")})}},{key:"handleDoubleClick",value:function(e){this.props.onAddControl(this.props.controlType)}},{key:"render",value:function(){var e=this;return d.createElement("div",{className:"ControlWidget__container"},this.renderChip(function(t,n){return d.createElement(S.a,{onDoubleClick:e.handleDoubleClick,label:t,avatar:d.createElement(w.a,null,n)})}))}}]),t}(d.Component);M=F([g.autobind],M);var W=Object(h.connect)(function(e){return{i18n:e.i18n}})(M),B=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},L=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderChip",value:function(e){return Object(D.b)(this.props.controlType.value)(C()({},E.EmailRowElement.$Type.value,e(this.props.i18n.t("Ряд"),d.createElement(T.a,null)))).getOrElse(function(){return d.createElement(S.a,null,"Unknown")})}},{key:"handleDoubleClick",value:function(e){this.props.onAddControl(this.props.controlType)}},{key:"render",value:function(){var e=this;return d.createElement("div",{className:"ContainerWidget__container"},this.renderChip(function(t,n){return d.createElement(S.a,{onDoubleClick:e.handleDoubleClick,label:t,avatar:d.createElement(w.a,null,n)})}))}}]),t}(d.Component);L=B([g.autobind],L);var A=Object(h.connect)(function(e){return{i18n:e.i18n}})(L),$=n(0),V=n(177),q=n(83);n(1939);n.d(t,"a",function(){return z});var N=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},z="ComponentsListType",H=function(e,t,n){return d.createElement(m.b,{key:e,draggableId:e,index:t},function(e,t){return d.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps),n)})},U=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"handleAddControl",value:function(e){var t=this;this.props.emailEditor.selectedElementId.matchWith(function(n){Object(V.c)(t.props.advancedEmailTemplate,n).filter(function(t){return t instanceof E.EmailRowElement&&e.value===E.EmailColumnElement.$Type.value||t instanceof E.EmailRootElement||t instanceof E.EmailColumnElement}).matchWith(function(n){t.props.onComponentAdded(Object($.toOption)(n.id),e,n.children.length),t.props.dispatch(Object(k.Eb)())},function(){t.addToRoot(e)})},function(){t.addToRoot(e)})}},{key:"addToRoot",value:function(e){var t=this;Object($.headOption)(this.props.advancedEmailTemplate.rootContainerElement.map(function(e){return e.children}).getOrElse(function(){return[]})).foreach(function(n){t.props.openComponentAttributes(Object($.toOption)(n.id),e,n.children.length)})}},{key:"render",value:function(){var e=this,t=this.props.i18n;return d.createElement(m.c,{droppableId:z,isDropDisabled:!0},function(n,r){return d.createElement("div",{className:e.props.className,ref:n.innerRef},d.createElement(b.a,{style:{flex:1}},d.createElement(O.a,null,t.t("Контейнеры")),H(E.EmailRowElement.$Type.value,0,d.createElement("div",{className:"ConfigComponentsList__row"},d.createElement(A,{controlType:E.EmailRowElement.$Type,onAddControl:e.handleAddControl}))),d.createElement(O.a,null,t.t("Html")),H(E.HtmlContentElement.$Type.value,1,d.createElement("div",{className:"ConfigComponentsList__row"},d.createElement(W,{controlType:E.HtmlContentElement.$Type,onAddControl:e.handleAddControl}))),d.createElement(O.a,null,t.t("Изображения")),H(E.EmailImageElement.$Type.value,2,d.createElement("div",{className:"ConfigComponentsList__row"},d.createElement(W,{controlType:E.EmailImageElement.$Type,onAddControl:e.handleAddControl}))),d.createElement(O.a,null,t.t("Кнопки")),H(E.EmailButtonElement.$Type.value,3,d.createElement("div",{className:"ConfigComponentsList__row"},d.createElement(W,{controlType:E.EmailButtonElement.$Type,onAddControl:e.handleAddControl}))),d.createElement(O.a,null,t.t("Прочие")),H(E.EmailDividerElement.$Type.value,4,d.createElement("div",{className:"ConfigComponentsList__row"},d.createElement(W,{controlType:E.EmailDividerElement.$Type,onAddControl:e.handleAddControl})))))})}}]),t}(d.Component);U=N([g.autobind],U);t.b=Object(h.connect)(function(e){return{i18n:e.i18n,emailEditor:e.emailEditor,advancedEmailTemplate:e.advancedEmailTemplate.present}})(Object(q.a)(U))},1932:function(e,t){e.exports=function(e,t,n,r){var o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(t),u=0;u<i.length;u++){var c=i[u];if(!l(c))return!1;var s=e[c],p=t[c];if(!1===(o=n?n.call(r,s,p,c):void 0)||void 0===o&&s!==p)return!1}return!0}},1933:function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),l=(r=a)&&r.__esModule?r:{default:r},u=n(2);var c={action:null,isActive:!1,nextLocation:null},s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._prevUserAction="",n._isMounted=!0,n.block=n.block.bind(n),n.onBeforeUnload=n.onBeforeUnload.bind(n),n.onCancel=n.onCancel.bind(n),n.onConfirm=n.onConfirm.bind(n),n.when=n.when.bind(n),n.state=o({},c,{unblock:function(){}}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),i(t,[{key:"componentDidMount",value:function(){this.props.disableNative||window.addEventListener("beforeunload",this.onBeforeUnload),this.setState({unblock:this.props.history.block(this.block)})}},{key:"componentDidUpdate",value:function(e,t){"CANCEL"===this._prevUserAction&&"function"==typeof this.props.afterCancel?this.props.afterCancel():"CONFIRM"===this._prevUserAction&&"function"==typeof this.props.afterConfirm&&this.props.afterConfirm(),this._prevUserAction=""}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,"CONFIRM"===this._prevUserAction&&"function"==typeof this.props.afterConfirm&&(this._prevUserAction="",this.props.afterConfirm()),this.state.unblock(),this.props.disableNative||window.removeEventListener("beforeunload",this.onBeforeUnload)}},{key:"block",value:function(e,t){var n=this.when(e);return n&&this.setState({action:t,nextLocation:e,isActive:!0}),!n}},{key:"navigateToNextLocation",value:function(e){var t=this,n=this.state,r=n.action,i=n.nextLocation;r={POP:this.props.allowGoBack?"goBack":"push",PUSH:"push",REPLACE:"replace"}[r||"PUSH"],i||(i={pathname:"/"});var a=this.props.history;if(this.state.unblock(),this._prevUserAction="CONFIRM","goBack"===r){var l=a.listen(function(){l(),t._isMounted&&t.setState(o({},c,{unblock:a.block(t.block)}))});a.goBack()}else a[r](i),this._isMounted&&this.setState(o({},c,{unblock:this.props.history.block(this.block)}))}},{key:"onCancel",value:function(){var e=this;(this.props.beforeCancel||function(e){e()})(function(){e._prevUserAction="CANCEL",e.setState(o({},c))})}},{key:"onConfirm",value:function(){var e=this;(this.props.beforeConfirm||function(e){e()})(function(){e.navigateToNextLocation(e.props.afterConfirm)})}},{key:"onBeforeUnload",value:function(e){if(this.when()){var t="Do you want to leave this site?\n\nChanges you made may not be saved.";return e.returnValue=t,t}}},{key:"when",value:function(e){return"function"==typeof this.props.when?this.props.when(this.props.location,e):this.props.when}},{key:"render",value:function(){return this.state.isActive||this.props.renderIfNotActive?l.default.createElement("div",null,this.props.children({isActive:this.state.isActive,onConfirm:this.onConfirm,onCancel:this.onCancel})):null}}]),t}();t.default=(0,u.withRouter)(s)},function(e,t){e.exports=n(2)},function(e,t){e.exports=n(2012)}])},1934:function(e,t,n){"use strict";var r={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i=Object.defineProperty,a=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,u=Object.getOwnPropertyDescriptor,c=Object.getPrototypeOf,s=c&&c(Object);e.exports=function e(t,n,p){if("string"!=typeof n){if(s){var f=c(n);f&&f!==s&&e(t,f,p)}var d=a(n);l&&(d=d.concat(l(n)));for(var h=0;h<d.length;++h){var m=d[h];if(!(r[m]||o[m]||p&&p[m])){var g=u(n,m);try{i(t,m,g)}catch(e){}}}return t}return t}},1935:function(e,t,n){"use strict";var r=n(2),o=n(94),i=n.n(o);t.a=function(e){return r.createElement(i.a,Object.assign({},e),r.createElement("path",{d:"M5.35,12.65L6.5,9L7.65,12.65M5.5,7L2.3,16H4.2L4.9,14H8.1L8.8,16H10.7L7.5,7M11,20H22V18H11M14,16H19V11H22L16.5,5.5L11,11H14V16Z"}))}},1938:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"})),"Photo");t.default=i},1939:function(e,t,n){var r=n(1940);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1940:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},1941:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"})),"Undo");t.default=i},1942:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"})),"Redo");t.default=i},1943:function(e,t,n){"use strict";var r=n(2),o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},u={base:{position:"absolute",userSelect:"none",MsUserSelect:"none"},top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}},c=function(e){return Object(r.createElement)("div",{className:e.className,style:a({},u.base,u[e.direction],e.replaceStyles||{}),onMouseDown:function(t){e.onResizeStart(t,e.direction)},onTouchStart:function(t){e.onResizeStart(t,e.direction)}},e.children)},s={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},p={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"},f=function(e,t,n){return Math.max(Math.min(e,n),t)},d=function(e,t){return Math.round(e/t)*t},h=function(e,t){return t.reduce(function(t,n){return Math.abs(n-e)<Math.abs(t-e)?n:t})},m=function(e,t){return e.substr(e.length-t.length,t.length)===t},g=function(e){return"auto"===e.toString()?e.toString():m(e.toString(),"px")?e.toString():m(e.toString(),"%")?e.toString():m(e.toString(),"vh")?e.toString():m(e.toString(),"vw")?e.toString():m(e.toString(),"vmax")?e.toString():m(e.toString(),"vmin")?e.toString():e+"px"},y=["style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatioX","resizeRatioY"],b=function(e){function t(e){o(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isResizing:!1,resizeCursor:"auto",width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0}},n.updateExtendsProps(e),n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),"undefined"!=typeof window&&(window.addEventListener("mouseup",n.onMouseUp),window.addEventListener("mousemove",n.onMouseMove),window.addEventListener("mouseleave",n.onMouseUp),window.addEventListener("touchmove",n.onMouseMove),window.addEventListener("touchend",n.onMouseUp)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),i(t,[{key:"updateExtendsProps",value:function(e){this.extendsProps=Object.keys(e).reduce(function(t,n){return-1!==y.indexOf(n)?t:(t[n]=e[n],t)},{})}},{key:"getParentSize",value:function(){var e=this.base;if(!e)return{width:window.innerWidth,height:window.innerHeight};var t=!1,n=this.parentNode.style.flexWrap,r=e.style.minWidth;"wrap"!==n&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%";var o={width:e.offsetWidth,height:e.offsetHeight};return e.style.position="absolute",t&&(this.parentNode.style.flexWrap=n),e.style.minWidth=r,o}},{key:"componentDidMount",value:function(){var e=this.size;this.setState({width:this.state.width||e.width,height:this.state.height||e.height});var t=this.parentNode;if(t instanceof HTMLElement&&!this.base){var n=document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.transform="scale(0, 0)",n.style.left="0",n.style.flex="0",n.classList?n.classList.add("__resizable_base__"):n.className+="__resizable_base__",t.appendChild(n)}}},{key:"componentWillReceiveProps",value:function(e){this.updateExtendsProps(e)}},{key:"componentWillUnmount",value:function(){if("undefined"!=typeof window){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseleave",this.onMouseUp),window.removeEventListener("touchmove",this.onMouseMove),window.removeEventListener("touchend",this.onMouseUp);var e=this.parentNode,t=this.base;if(!t||!e)return;if(!(e instanceof HTMLElement&&t instanceof Node))return;e.removeChild(t)}}},{key:"calculateNewSize",value:function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"}},{key:"onResizeStart",value:function(e,t){var n=0,r=0;if(e.nativeEvent instanceof MouseEvent){if(n=e.nativeEvent.clientX,r=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent instanceof TouchEvent&&(n=e.nativeEvent.touches[0].clientX,r=e.nativeEvent.touches[0].clientY);this.props.onResizeStart&&this.props.onResizeStart(e,t,this.resizable),this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.setState({original:{x:n,y:r,width:this.size.width,height:this.size.height},isResizing:!0,resizeCursor:window.getComputedStyle(e.target).cursor,direction:t})}},{key:"onMouseMove",value:function(e){if(this.state.isResizing){var t=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,n=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,r=this.state,o=r.direction,i=r.original,a=r.width,l=r.height,u=this.props,c=u.lockAspectRatio,s=u.lockAspectRatioExtraHeight,p=u.lockAspectRatioExtraWidth,g=this.props.scale||1,y=this.props,b=y.maxWidth,v=y.maxHeight,O=y.minWidth,E=y.minHeight,k=this.props.resizeRatioX||1,j=this.props.resizeRatioY||1,C=this.getParentSize();if(b&&"string"==typeof b&&m(b,"%")){var R=Number(b.replace("%",""))/100;b=C.width*R}if(v&&"string"==typeof v&&m(v,"%")){var w=Number(v.replace("%",""))/100;v=C.height*w}if(O&&"string"==typeof O&&m(O,"%")){var I=Number(O.replace("%",""))/100;O=C.width*I}if(E&&"string"==typeof E&&m(E,"%")){var S=Number(E.replace("%",""))/100;E=C.height*S}b=void 0===b?void 0:Number(b),v=void 0===v?void 0:Number(v),O=void 0===O?void 0:Number(O),E=void 0===E?void 0:Number(E);var P="number"==typeof c?c:i.width/i.height,T=i.width,x=i.height;if(/right/i.test(o)&&(T=i.width+(t-i.x)*k/g,c&&(x=(T-p)/P+s)),/left/i.test(o)&&(T=i.width-(t-i.x)*k/g,c&&(x=(T-p)/P+s)),/bottom/i.test(o)&&(x=i.height+(n-i.y)*j/g,c&&(T=(x-s)*P+p)),/top/i.test(o)&&(x=i.height-(n-i.y)*j/g,c&&(T=(x-s)*P+p)),"parent"===this.props.bounds){var _=this.parentNode;if(_ instanceof HTMLElement){var D=_.getBoundingClientRect(),F=D.left,M=D.top,W=this.resizable.getBoundingClientRect(),B=W.left,L=W.top,A=_.offsetWidth+(F-B),$=_.offsetHeight+(M-L);b=b&&b<A?b:A,v=v&&v<$?v:$}}else if("window"===this.props.bounds){if("undefined"!=typeof window){var V=this.resizable.getBoundingClientRect(),q=V.left,N=V.top,z=window.innerWidth-q,H=window.innerHeight-N;b=b&&b<z?b:z,v=v&&v<H?v:H}}else if(this.props.bounds instanceof HTMLElement){var U=this.props.bounds.getBoundingClientRect(),K=U.left,G=U.top,Y=this.resizable.getBoundingClientRect(),J=Y.left,Q=Y.top;if(!(this.props.bounds instanceof HTMLElement))return;var X=this.props.bounds.offsetWidth+(K-J),Z=this.props.bounds.offsetHeight+(G-Q);b=b&&b<X?b:X,v=v&&v<Z?v:Z}var ee=void 0===O?10:O,te=void 0===b||b<0?T:b,ne=void 0===E?10:E,re=void 0===v||v<0?x:v;if(c){var oe=(ne-s)*P+p,ie=(re-s)*P+p,ae=(ee-p)/P+s,le=(te-p)/P+s,ue=Math.max(ee,oe),ce=Math.min(te,ie),se=Math.max(ne,ae),pe=Math.min(re,le);T=f(T,ue,ce),x=f(x,se,pe)}else T=f(T,ee,te),x=f(x,ne,re);this.props.grid&&(T=d(T,this.props.grid[0])),this.props.grid&&(x=d(x,this.props.grid[1])),this.props.snap&&this.props.snap.x&&(T=h(T,this.props.snap.x)),this.props.snap&&this.props.snap.y&&(x=h(x,this.props.snap.y));var fe={width:T-i.width,height:x-i.height};if(a&&"string"==typeof a&&m(a,"%"))T=T/C.width*100+"%";if(l&&"string"==typeof l&&m(l,"%"))x=x/C.height*100+"%";this.setState({width:this.calculateNewSize(T,"width"),height:this.calculateNewSize(x,"height")}),this.props.onResize&&this.props.onResize(e,o,this.resizable,fe)}}},{key:"onMouseUp",value:function(e){var t=this.state,n=t.isResizing,r=t.direction,o=t.original;if(n){var i={width:this.size.width-o.width,height:this.size.height-o.height};this.props.onResizeStop&&this.props.onResizeStop(e,r,this.resizable,i),this.props.size&&this.setState(this.props.size),this.setState({isResizing:!1,resizeCursor:"auto"})}}},{key:"updateSize",value:function(e){this.setState({width:e.width,height:e.height})}},{key:"renderResizer",value:function(){var e=this,t=this.props,n=t.enable,o=t.handleStyles,i=t.handleClasses,a=t.handleWrapperStyle,l=t.handleWrapperClass,u=t.handleComponent;if(!n)return null;var s=Object.keys(n).map(function(t){return!1!==n[t]?Object(r.createElement)(c,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:o&&o[t],className:i&&i[t]},u&&u[t]?Object(r.createElement)(u[t]):null):null});return Object(r.createElement)("span",{className:l,style:a},s)}},{key:"render",value:function(){var e=this,t=this.state.isResizing?s:p;return Object(r.createElement)("div",a({ref:function(t){t&&(e.resizable=t)},style:a({position:"relative"},t,this.props.style,this.sizeStyle,{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box"}),className:this.props.className},this.extendsProps),this.state.isResizing&&Object(r.createElement)("div",{style:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:""+(this.state.resizeCursor||"auto"),opacity:"0",position:"fixed",zIndex:"9999",top:"0",left:"0",bottom:"0",right:"0"}}),this.props.children,this.renderResizer())}},{key:"parentNode",get:function(){return this.resizable.parentNode}},{key:"propsSize",get:function(){return this.props.size||this.props.defaultSize}},{key:"base",get:function(){var e=this.parentNode;if(e)for(var t=[].slice.call(e.children),n=0;n<t.length;n+=1){var r=t[n];if(r instanceof HTMLElement&&r.classList.contains("__resizable_base__"))return r}}},{key:"size",get:function(){var e=0,t=0;if("undefined"!=typeof window){var n=this.resizable.offsetWidth,r=this.resizable.offsetHeight,o=this.resizable.style.position;"relative"!==o&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:r,this.resizable.style.position=o}return{width:e,height:t}}},{key:"sizeStyle",get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&m(e.propsSize[t].toString(),"%")){if(m(e.state[t].toString(),"%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return g(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?g(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?g(t.height):n("height")}}}]),t}();b.defaultProps={onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatioX:1,resizeRatioY:1},t.a=b},1944:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M16.48 2.52c3.27 1.55 5.61 4.72 5.97 8.48h1.5C23.44 4.84 18.29 0 12 0l-.66.03 3.81 3.81 1.33-1.32zm-6.25-.77c-.59-.59-1.54-.59-2.12 0L1.75 8.11c-.59.59-.59 1.54 0 2.12l12.02 12.02c.59.59 1.54.59 2.12 0l6.36-6.36c.59-.59.59-1.54 0-2.12L10.23 1.75zm4.6 19.44L2.81 9.17l6.36-6.36 12.02 12.02-6.36 6.36zm-7.31.29C4.25 19.94 1.91 16.76 1.55 13H.05C.56 19.16 5.71 24 12 24l.66-.03-3.81-3.81-1.33 1.32z"})),"ScreenRotation");t.default=i},1945:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 9h-4v-7h4v7z"})),"Devices");t.default=i},2012:function(e,t,n){"use strict";n.r(t);var r=n(108),o=n.n(r),i=n(2),a=n.n(i),l=n(31),u=n.n(l),c=n(1529),s=n(1480),p=n.n(s),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=d(this,e.call.apply(e,[this].concat(i))),r.state={match:r.computeMatch(r.props.history.location.pathname)},d(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:f({},this.context.router,{history:this.props.history,route:{location:this.props.history.location,match:this.state.match}})}},t.prototype.computeMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}},t.prototype.componentWillMount=function(){var e=this,t=this.props,n=t.children,r=t.history;p()(null==n||1===a.a.Children.count(n),"A <Router> may have only one child element"),this.unlisten=r.listen(function(){e.setState({match:e.computeMatch(r.location.pathname)})})},t.prototype.componentWillReceiveProps=function(e){o()(this.props.history===e.history,"You cannot change <Router history>")},t.prototype.componentWillUnmount=function(){this.unlisten()},t.prototype.render=function(){var e=this.props.children;return e?a.a.Children.only(e):null},t}(a.a.Component);h.propTypes={history:u.a.object.isRequired,children:u.a.node},h.contextTypes={router:u.a.object},h.childContextTypes={router:u.a.object.isRequired};var m=h,g=m;function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=y(this,e.call.apply(e,[this].concat(i))),r.history=Object(c.createBrowserHistory)(r.props),y(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){o()(!this.props.history,"<BrowserRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { BrowserRouter as Router }`.")},t.prototype.render=function(){return a.a.createElement(g,{history:this.history,children:this.props.children})},t}(a.a.Component);b.propTypes={basename:u.a.string,forceRefresh:u.a.bool,getUserConfirmation:u.a.func,keyLength:u.a.number,children:u.a.node};var v=b;function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=O(this,e.call.apply(e,[this].concat(i))),r.history=Object(c.createHashHistory)(r.props),O(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){o()(!this.props.history,"<HashRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { HashRouter as Router }`.")},t.prototype.render=function(){return a.a.createElement(g,{history:this.history,children:this.props.children})},t}(a.a.Component);E.propTypes={basename:u.a.string,getUserConfirmation:u.a.func,hashType:u.a.oneOf(["hashbang","noslash","slash"]),children:u.a.node};var k=E,j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var R=function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)},w=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=C(this,e.call.apply(e,[this].concat(i))),r.handleClick=function(e){if(r.props.onClick&&r.props.onClick(e),!e.defaultPrevented&&0===e.button&&!r.props.target&&!R(e)){e.preventDefault();var t=r.context.router.history,n=r.props,o=n.replace,i=n.to;o?t.replace(i):t.push(i)}},C(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=(e.replace,e.to),n=e.innerRef,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["replace","to","innerRef"]);p()(this.context.router,"You should not use <Link> outside a <Router>"),p()(void 0!==t,'You must specify the "to" property');var o=this.context.router.history,i="string"==typeof t?Object(c.createLocation)(t,null,null,o.location):t,l=o.createHref(i);return a.a.createElement("a",j({},r,{onClick:this.handleClick,href:l,ref:n}))},t}(a.a.Component);w.propTypes={onClick:u.a.func,target:u.a.string,replace:u.a.bool,to:u.a.oneOfType([u.a.string,u.a.object]).isRequired,innerRef:u.a.oneOfType([u.a.string,u.a.func])},w.defaultProps={replace:!1},w.contextTypes={router:u.a.shape({history:u.a.shape({push:u.a.func.isRequired,replace:u.a.func.isRequired,createHref:u.a.func.isRequired}).isRequired}).isRequired};var I=w;function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var P=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=S(this,e.call.apply(e,[this].concat(i))),r.history=Object(c.createMemoryHistory)(r.props),S(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){o()(!this.props.history,"<MemoryRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { MemoryRouter as Router }`.")},t.prototype.render=function(){return a.a.createElement(m,{history:this.history,children:this.props.children})},t}(a.a.Component);P.propTypes={initialEntries:u.a.array,initialIndex:u.a.number,getUserConfirmation:u.a.func,keyLength:u.a.number,children:u.a.node};var T=P,x=n(1828),_=n.n(x),D={},F=0,M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];"string"==typeof t&&(t={path:t});var r=t,o=r.path,i=r.exact,a=void 0!==i&&i,l=r.strict,u=void 0!==l&&l,c=r.sensitive;if(null==o)return n;var s=function(e,t){var n=""+t.end+t.strict+t.sensitive,r=D[n]||(D[n]={});if(r[e])return r[e];var o=[],i={re:_()(e,o,t),keys:o};return F<1e4&&(r[e]=i,F++),i}(o,{end:a,strict:u,sensitive:void 0!==c&&c}),p=s.re,f=s.keys,d=p.exec(e);if(!d)return null;var h=d[0],m=d.slice(1),g=e===h;return a&&!g?null:{path:o,url:"/"===o&&""===h?"/":h,isExact:g,params:f.reduce(function(e,t,n){return e[t.name]=m[n],e},{})}},W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function B(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var L=function(e){return 0===a.a.Children.count(e)},A=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=B(this,e.call.apply(e,[this].concat(i))),r.state={match:r.computeMatch(r.props,r.context.router)},B(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:W({},this.context.router,{route:{location:this.props.location||this.context.router.route.location,match:this.state.match}})}},t.prototype.computeMatch=function(e,t){var n=e.computedMatch,r=e.location,o=e.path,i=e.strict,a=e.exact,l=e.sensitive;if(n)return n;p()(t,"You should not use <Route> or withRouter() outside a <Router>");var u=t.route,c=(r||u.location).pathname;return M(c,{path:o,strict:i,exact:a,sensitive:l},u.match)},t.prototype.componentWillMount=function(){o()(!(this.props.component&&this.props.render),"You should not use <Route component> and <Route render> in the same route; <Route render> will be ignored"),o()(!(this.props.component&&this.props.children&&!L(this.props.children)),"You should not use <Route component> and <Route children> in the same route; <Route children> will be ignored"),o()(!(this.props.render&&this.props.children&&!L(this.props.children)),"You should not use <Route render> and <Route children> in the same route; <Route children> will be ignored")},t.prototype.componentWillReceiveProps=function(e,t){o()(!(e.location&&!this.props.location),'<Route> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),o()(!(!e.location&&this.props.location),'<Route> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.'),this.setState({match:this.computeMatch(e,t.router)})},t.prototype.render=function(){var e=this.state.match,t=this.props,n=t.children,r=t.component,o=t.render,i=this.context.router,l=i.history,u=i.route,c=i.staticContext,s={match:e,location:this.props.location||u.location,history:l,staticContext:c};return r?e?a.a.createElement(r,s):null:o?e?o(s):null:"function"==typeof n?n(s):n&&!L(n)?a.a.Children.only(n):null},t}(a.a.Component);A.propTypes={computedMatch:u.a.object,path:u.a.string,exact:u.a.bool,strict:u.a.bool,sensitive:u.a.bool,component:u.a.func,render:u.a.func,children:u.a.oneOfType([u.a.func,u.a.node]),location:u.a.object},A.contextTypes={router:u.a.shape({history:u.a.object.isRequired,route:u.a.object.isRequired,staticContext:u.a.object})},A.childContextTypes={router:u.a.object.isRequired};var $=A,V=$,q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var z=function(e){var t=e.to,n=e.exact,r=e.strict,o=e.location,i=e.activeClassName,l=e.className,u=e.activeStyle,c=e.style,s=e.isActive,p=e["aria-current"],f=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["to","exact","strict","location","activeClassName","className","activeStyle","style","isActive","aria-current"]),d="object"===(void 0===t?"undefined":N(t))?t.pathname:t,h=d&&d.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1");return a.a.createElement(V,{path:h,exact:n,strict:r,location:o,children:function(e){var n=e.location,r=e.match,o=!!(s?s(r,n):r);return a.a.createElement(I,q({to:t,className:o?[l,i].filter(function(e){return e}).join(" "):l,style:o?q({},c,u):c,"aria-current":o&&p||null},f))}})};z.propTypes={to:I.propTypes.to,exact:u.a.bool,strict:u.a.bool,location:u.a.object,activeClassName:u.a.string,className:u.a.string,activeStyle:u.a.object,style:u.a.object,isActive:u.a.func,"aria-current":u.a.oneOf(["page","step","location","date","time","true"])},z.defaultProps={activeClassName:"active","aria-current":"page"};var H=z;var U=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.enable=function(e){this.unblock&&this.unblock(),this.unblock=this.context.router.history.block(e)},t.prototype.disable=function(){this.unblock&&(this.unblock(),this.unblock=null)},t.prototype.componentWillMount=function(){p()(this.context.router,"You should not use <Prompt> outside a <Router>"),this.props.when&&this.enable(this.props.message)},t.prototype.componentWillReceiveProps=function(e){e.when?this.props.when&&this.props.message===e.message||this.enable(e.message):this.disable()},t.prototype.componentWillUnmount=function(){this.disable()},t.prototype.render=function(){return null},t}(a.a.Component);U.propTypes={when:u.a.bool,message:u.a.oneOfType([u.a.func,u.a.string]).isRequired},U.defaultProps={when:!0},U.contextTypes={router:u.a.shape({history:u.a.shape({block:u.a.func.isRequired}).isRequired}).isRequired};var K=U,G={},Y=0,J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"/"===e?e:function(e){var t=e,n=G[t]||(G[t]={});if(n[e])return n[e];var r=_.a.compile(e);return Y<1e4&&(n[e]=r,Y++),r}(e)(t,{pretty:!0})},Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var X=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.isStatic=function(){return this.context.router&&this.context.router.staticContext},t.prototype.componentWillMount=function(){p()(this.context.router,"You should not use <Redirect> outside a <Router>"),this.isStatic()&&this.perform()},t.prototype.componentDidMount=function(){this.isStatic()||this.perform()},t.prototype.componentDidUpdate=function(e){var t=Object(c.createLocation)(e.to),n=Object(c.createLocation)(this.props.to);Object(c.locationsAreEqual)(t,n)?o()(!1,"You tried to redirect to the same route you're currently on: \""+n.pathname+n.search+'"'):this.perform()},t.prototype.computeTo=function(e){var t=e.computedMatch,n=e.to;return t?"string"==typeof n?J(n,t.params):Q({},n,{pathname:J(n.pathname,t.params)}):n},t.prototype.perform=function(){var e=this.context.router.history,t=this.props.push,n=this.computeTo(this.props);t?e.push(n):e.replace(n)},t.prototype.render=function(){return null},t}(a.a.Component);X.propTypes={computedMatch:u.a.object,push:u.a.bool,from:u.a.string,to:u.a.oneOfType([u.a.string,u.a.object]).isRequired},X.defaultProps={push:!1},X.contextTypes={router:u.a.shape({history:u.a.shape({push:u.a.func.isRequired,replace:u.a.func.isRequired}).isRequired,staticContext:u.a.object}).isRequired};var Z=X,ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function te(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ne=function(e){return"/"===e.charAt(0)?e:"/"+e},re=function(e,t){return e?ee({},t,{pathname:ne(e)+t.pathname}):t},oe=function(e,t){if(!e)return t;var n=ne(e);return 0!==t.pathname.indexOf(n)?t:ee({},t,{pathname:t.pathname.substr(n.length)})},ie=function(e){return"string"==typeof e?e:Object(c.createPath)(e)},ae=function(e){return function(){p()(!1,"You cannot %s with <StaticRouter>",e)}},le=function(){},ue=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=te(this,e.call.apply(e,[this].concat(i))),r.createHref=function(e){return ne(r.props.basename+ie(e))},r.handlePush=function(e){var t=r.props,n=t.basename,o=t.context;o.action="PUSH",o.location=re(n,Object(c.createLocation)(e)),o.url=ie(o.location)},r.handleReplace=function(e){var t=r.props,n=t.basename,o=t.context;o.action="REPLACE",o.location=re(n,Object(c.createLocation)(e)),o.url=ie(o.location)},r.handleListen=function(){return le},r.handleBlock=function(){return le},te(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:{staticContext:this.props.context}}},t.prototype.componentWillMount=function(){o()(!this.props.history,"<StaticRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { StaticRouter as Router }`.")},t.prototype.render=function(){var e=this.props,t=e.basename,n=(e.context,e.location),r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["basename","context","location"]),o={createHref:this.createHref,action:"POP",location:oe(t,Object(c.createLocation)(n)),push:this.handlePush,replace:this.handleReplace,go:ae("go"),goBack:ae("goBack"),goForward:ae("goForward"),listen:this.handleListen,block:this.handleBlock};return a.a.createElement(m,ee({},r,{history:o}))},t}(a.a.Component);ue.propTypes={basename:u.a.string,context:u.a.object.isRequired,location:u.a.oneOfType([u.a.string,u.a.object])},ue.defaultProps={basename:"",location:"/"},ue.childContextTypes={router:u.a.object.isRequired};var ce=ue;var se=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){p()(this.context.router,"You should not use <Switch> outside a <Router>")},t.prototype.componentWillReceiveProps=function(e){o()(!(e.location&&!this.props.location),'<Switch> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),o()(!(!e.location&&this.props.location),'<Switch> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.')},t.prototype.render=function(){var e=this.context.router.route,t=this.props.children,n=this.props.location||e.location,r=void 0,o=void 0;return a.a.Children.forEach(t,function(t){if(null==r&&a.a.isValidElement(t)){var i=t.props,l=i.path,u=i.exact,c=i.strict,s=i.sensitive,p=i.from,f=l||p;o=t,r=M(n.pathname,{path:f,exact:u,strict:c,sensitive:s},e.match)}}),r?a.a.cloneElement(o,{location:n,computedMatch:r}):null},t}(a.a.Component);se.contextTypes={router:u.a.shape({route:u.a.object.isRequired}).isRequired},se.propTypes={children:u.a.node,location:u.a.object};var pe=se,fe=J,de=M,he=n(1934),me=n.n(he),ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var ye=function(e){var t=function(t){var n=t.wrappedComponentRef,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["wrappedComponentRef"]);return a.a.createElement($,{children:function(t){return a.a.createElement(e,ge({},r,t,{ref:n}))}})};return t.displayName="withRouter("+(e.displayName||e.name)+")",t.WrappedComponent=e,t.propTypes={wrappedComponentRef:u.a.func},me()(t,e)};n.d(t,"BrowserRouter",function(){return v}),n.d(t,"HashRouter",function(){return k}),n.d(t,"Link",function(){return I}),n.d(t,"MemoryRouter",function(){return T}),n.d(t,"NavLink",function(){return H}),n.d(t,"Prompt",function(){return K}),n.d(t,"Redirect",function(){return Z}),n.d(t,"Route",function(){return V}),n.d(t,"Router",function(){return g}),n.d(t,"StaticRouter",function(){return ce}),n.d(t,"Switch",function(){return pe}),n.d(t,"generatePath",function(){return fe}),n.d(t,"matchPath",function(){return de}),n.d(t,"withRouter",function(){return ye})},2169:function(e,t,n){var r=n(2170);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2170:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".WebPagesConfigForm__dropzone {\n  position: relative;\n  width: 100%;\n  height: 100px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.WebPagesConfigForm__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.WebPagesConfigForm__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n",""])},2171:function(e,t,n){var r=n(2172);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2172:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".WebPage_ComponentsList-row {\n  margin-bottom: 5px; }\n",""])},2212:function(e,t,n){var r=n(2213);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2213:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.subtitle {\n  margin: 2em 0 2em 0; }\n\n.fancy {\n  line-height: 0.5;\n  text-align: center; }\n\n.fancy span {\n  display: inline-block;\n  position: relative; }\n\n.fancy span:before,\n.fancy span:after {\n  content: "";\n  position: absolute;\n  border-bottom: 1px solid white;\n  border-top: 1px solid white;\n  height: 5px;\n  top: 0;\n  width: 600px; }\n\n.fancy span:before {\n  right: 100%;\n  margin-right: 15px; }\n\n.fancy span:after {\n  left: 100%;\n  margin-left: 15px; }\n',""])},2214:function(e,t,n){var r=n(2215);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2215:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".WebPageRootWidget__container-children {\n  display: flex;\n  flex-direction: column; }\n",""])},2216:function(e,t,n){var r=n(2217);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2217:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},2218:function(e,t,n){var r=n(2219);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2219:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".WebPageRowWidget__container-children {\n  display: flex;\n  flex-direction: row; }\n",""])},2220:function(e,t,n){var r=n(2221);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2221:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},2222:function(e,t,n){var r=n(2223);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2223:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ElementRenderer__component-selected {\n  background-color: #B3E5FC;\n  cursor: pointer;\n  min-height: 200px;\n  z-index: 1; }\n\n.ElementRenderer__component {\n  cursor: pointer;\n  min-height: 200px;\n  z-index: 1; }\n\n.ElementRenderer__container {\n  position: relative;\n  display: flex;\n  flex-direction: column; }\n\n.ElementRenderer__container-selected {\n  position: relative;\n  display: flex;\n  flex-direction: column; }\n  .ElementRenderer__container-selected > .ElementRenderer__container-selection {\n    background-color: rgba(136, 136, 136, 0.3) !important; }\n\n.ElementRenderer__button {\n  position: absolute !important;\n  font-size: 15px;\n  width: 15px;\n  height: 15px;\n  top: 0px !important;\n  right: 0px !important;\n  z-index: 11 !important; }\n",""])},2224:function(e,t,n){var r=n(2225);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2225:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.ComponentWidget__cover {\n  display: flex;\n  flex: 1;\n  position: relative;\n  z-index: 2; }\n\n.ComponentWidget__wrapper {\n  cursor: pointer;\n  z-index: 1; }\n  .ComponentWidget__wrapper--selected, .ComponentWidget__wrapper--dragging, .ComponentWidget__wrapper:hover {\n    background-color: #B3E5FC; }\n  .ComponentWidget__wrapper--dragging .ComponentWidget__cover {\n    opacity: 0; }\n  .ComponentWidget__wrapper:hover .ComponentWidget__button {\n    display: block; }\n\n.ComponentWidget__container {\n  position: relative;\n  display: flex;\n  flex: 1; }\n\n.ComponentWidget__cover:before {\n  content: "";\n  display: block;\n  background-color: transparent;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 10; }\n\n.ComponentWidget__button {\n  display: none;\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  z-index: 11; }\n\n.ComponentWidget__dropzone {\n  position: relative;\n  width: 100%;\n  height: 100px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.ComponentWidget__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.ComponentWidget__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n\n.ComponentWidget__imageControlEditor-container {\n  text-align: center; }\n\n.ComponentWidget__imageControlEditor-wrapper {\n  display: inline-block; }\n\n.ComponentWidget__imageControlEditor-image {\n  height: 300px;\n  width: 225px;\n  margin-bottom: 6px; }\n\n.ComponentWidget__imageControlEditor-button {\n  width: 100%;\n  display: block !important; }\n\n.ComponentWidget__ImageListControlEditor-container {\n  text-align: center;\n  display: flex;\n  align-items: center;\n  justify-content: center; }\n\n.ComponentWidget__ImageListControlEditor-imagesWrapper {\n  display: flex;\n  flex-flow: row nowrap; }\n\n.ComponentWidget__ImageListControlEditor-image {\n  width: 100%;\n  max-width: 100px; }\n\n.ComponentWidget__ImageListControlEditor-imageContainer {\n  margin: 4px; }\n\n.ComponentWidget__ImageListControlEditor-addButton {\n  color: #03A9F4 !important;\n  height: 36px !important;\n  width: 36px !important; }\n\n.ComponentWidget__ObjRefsTableEditor-background {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%; }\n\n.ComponentWidget__ObjRefsTableEditor-background:hover {\n  background-color: #B3E5FC !important; }\n\n.LogWidget__title {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  font-size: 75px;\n  transform: translateX(-50%) translateY(-50%);\n  opacity: 0.1; }\n\n.ComponentWidget__colorPickerWidget {\n  width: 100%;\n  position: relative; }\n  .ComponentWidget__colorPickerWidget-color {\n    position: absolute;\n    width: 50%;\n    height: 80%;\n    top: 5%;\n    right: 25%; }\n\n.ComponentWidget__tagsWidget {\n  margin: .5em 0;\n  display: flex; }\n  .ComponentWidget__tagsWidget > * {\n    margin: .3em; }\n\n.HTMLWidget__title {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  font-size: 3em;\n  opacity: 0.2; }\n\n.HTMLWidget__placeholder {\n  width: 100%;\n  position: relative;\n  min-height: 150px;\n  min-width: 250px;\n  border: 1px dashed; }\n',""])},2717:function(e,t,n){"use strict";n.r(t);var r,o=n(4),i=n.n(o),a=n(6),l=n.n(a),u=n(10),c=n.n(u),s=n(7),p=n.n(s),f=n(8),d=n.n(f),h=n(11),m=n.n(h),g=n(2),y=n(14),b=n(13),v=n(1932),O=n.n(v),E=n(1933),k=n.n(E),j=n(93),C=n.n(j),R=n(19),w=n.n(R),I=n(25),S=n.n(I),P=n(33),T=n.n(P),x=n(75),_=n.n(x),D=n(1935),F=n(1945),M=n.n(F),W=n(241),B=n.n(W),L=n(261),A=n.n(L),$=n(242),V=n.n($),q=n(243),N=n.n(q),z=n(1),H=n(1595),U=n(133),K=n(772),G=n.n(K),Y=n(58),J=n(202),Q=n(638),X=n(109),Z=n(0),ee=n(56),te=function(e){switch(e.elementCss.align.getOrElse(function(){return new z.ElementAlign}).justifySelf.getOrElse(function(){return""})){case"none":case"left":return"flex-start";case"right":return"flex-end";case"center":return"center";default:return"flex-start"}},ne=function(e){switch(e.elementCss.align.getOrElse(function(){return new z.ElementAlign}).justifyContent){case"top":return"flex-start";case"bottom":return"flex-end";case"baseline":return"baseline";case"middle":return"center";default:return"flex-start"}},re=function(e){switch(e){case"none":return"0 0 0 0";case"left":return"0 auto 0 0";case"right":return"0 0 0 auto";case"center":return"0 auto";default:return"0 0 0 0"}},oe=n(655),ie=n(106),ae=n(50),le=n(62),ue=n.n(le),ce=n(490),se=n(18),pe=function(e){return'<div style="display:flex;flex-direction:column;align-self:'+te(e)+";align-items:"+function(e){switch(e.elementCss.align.getOrElse(function(){return new z.ElementAlign}).justifyContent){case"left":return"flex-start";case"right":return"flex-end";case"center":return"center";default:return"flex-start"}}(e)+";"+e.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return"margin:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return""})+e.elementCss.proportions.flatMap(function(e){return e.padding}).map(function(e){return"padding:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return""})+"box-sizing:border-box;width:"+e.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"})+";max-width:"+e.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"})+';">'+Object(U.a)(e.children,"position").map(function(e){return be(e)}).join("")+"</div>"},fe=function(e){return e.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto%"})},de=function(e){return e.elementCss.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"})},he=function(e){return'<a href="'+me(e)+'" style="width:'+fe(e)+";height:"+de(e)+";"+e.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return"margin:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return"margin:"+z.WebPageElement.DEFAULT_MARGIN+"px;"})+e.elementCss.proportions.flatMap(function(e){return e.padding}).map(function(e){return"padding:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return"padding:"+z.WebPageElement.DEFAULT_PADDING+"px;"})+'box-sizing:border-box;"><img src="'+function(e){switch(e.src.tpe.value){case z.WebPageImageSrcExternal.$Type.value:return e.src.src;case z.WebPageImageSrcFile.$Type.value:return"$link-"+e.src.file.value;default:throw"unknown image src type"}}(e)+'"width="100%" ></img></a>'},me=function(e){switch(e.href.tpe.value){case z.WebPageButtonHrefAppLogin.$Type.value:return"$actionUrl-"+e.href.uid;case z.WebPageButtonHrefJourneyEvent.$Type.value:return"$actionUrl-"+e.href.eventId;case z.WebPageButtonHrefExternal.$Type.value:return e.href.link;default:throw"unknown button href type"}},ge=function(e){return function(e){var t=Object(Z.toOption)(e.elementCss),n=Object(ie.d)(t).getOrElse(function(){return 1})+"px "+Object(ae.g)(Object(ie.c)(t)).getOrElse(function(){return"solid"})+" "+Object(ie.b)(t).getOrElse(function(){return ue.a[600]});switch(e.type.tpe.value){case z.WebPageDividerElementWithLabel.$Type.value:var r=e.type,o=r.label.getOrElse(function(){return""}),i=r.labelFont;return'<table width="100%" style="padding: 15px"><tbody><tr><td style="border-bottom: '+n+'"></td><td style="width: 1%; white-space: nowrap; text-align: center; height: 1px; line-height: 1px; padding: 0 15px 0 15px; color: '+i.map(function(e){return e.color}).getOrElse(function(){return"inherit"})+"; font-style: "+i.flatMap(function(e){return e.fontFace.map(function(e){return e.fontStyle})}).getOrElse(function(){return"inherit"})+"; font-weight: "+i.flatMap(function(e){return e.fontFace.map(function(e){return e.fontWeight})}).getOrElse(function(){return"inherit"})+'; ">'+o+'</td><td style="border-bottom: '+n+'"></td></tr></tbody></table>';case z.WebPageDividerElementSimple.$Type.value:default:return'<table width="100%" cellpadding="0" cellspacing="0" style="border-bottom: '+n+'"><tbody><tr><td></td></tr></tbody></table>'}}(e)},ye=(r={},i()(r,z.WebPageContentElement.$Type.value,function(e){return'<div style="display:flex;flex-direction:column;align-self:'+te(t=e)+";"+t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return"margin:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return""})+t.elementCss.proportions.flatMap(function(e){return e.padding}).map(function(e){return"padding:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return""})+"box-sizing:border-box;width:"+t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"})+";max-width:"+t.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"})+';">'+Object(U.a)(t.children,"position").map(function(e){return be(e)}).join("")+"</div>";var t}),i()(r,z.WebPageHtmlContentElement.$Type.value,function(e){return function(e){return e.content}(e)}),i()(r,z.WebPageImageElement.$Type.value,function(e){return he(e)}),i()(r,z.WebPageButtonElement.$Type.value,function(e){return function(e){return'<a href="'+me(e)+'" style="width:'+fe(e)+";height:"+de(e)+";text-decoration: none;"+e.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return"margin:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return"margin:"+z.WebPageElement.DEFAULT_MARGIN+"px;"})+"padding: 8px 16px;border: 0px solid;border-radius:3px;box-sizing:border-box;"+e.elementCss.background.map(function(e){return"background-color: "+e.color+";"}).getOrElse(function(){return"background-color: #000000;"})+e.elementCss.fonts.flatMap(function(e){return e.titleFont.map(function(e){return e.color})}).map(function(e){return"color: "+e+";"}).getOrElse(function(){return"color: #000000;"})+'">'+e.label+"</a>"}(e)}),i()(r,z.WebPageDividerElement.$Type.value,function(e){return ge(e)}),i()(r,z.WebPageRowElement.$Type.value,function(e){return'<div style="display:flex;'+(t=e).elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return"margin:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return"margin:"+z.WebPageElement.DEFAULT_MARGIN+"px;"})+t.elementCss.proportions.flatMap(function(e){return e.padding}).map(function(e){return"padding:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return"padding:"+z.WebPageElement.DEFAULT_PADDING+"px;"})+"box-sizing:border-box;align-self:"+te(t)+";align-items:"+ne(t)+";justify-content:"+t.horizontalContentAlignment+";flex-wrap:"+(t.columnsWrapping?"wrap":"nowrap")+";width:"+t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"})+";max-width:"+t.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"})+';">'+Object(U.a)(t.children,"position").map(function(e){return be(e)}).join("")+"</div>";var t}),i()(r,z.WebPageColumnElement.$Type.value,function(e){return pe(e)}),i()(r,z.WebPageBlockElement.$Type.value,function(e){return function(e){return'<div id="'+e.blockId.map(function(e){return e.value}).getOrElse(function(){return"embeddedApp"})+'" api-key="'+e.apiKey.getOrElse(function(){return""})+'" lng-code="'+e.lngCode.getOrElse(function(){return"ru"})+'" server="'+e.server.getOrElse(function(){return"drserver.accredcenter.ru"})+'" ><script type="text/javascript" src='+e.scriptUrl.getOrElse(function(){return""})+" async><\/script></div>"}(e)}),i()(r,z.WebPageFormRecordsListElement.$Type.value,function(e){return function(e){return'<div id="'+e.id+'"></div>'}(e)}),r),be=function(e){return Object(ee.b)(e.tpe.value)(ye).map(function(t){return t(e)}).getOrElse(function(){return""})},ve=function(e,t){return function(n,r){return Object(Z.headOption)(r().applications.list.filter(function(e){return e.id.value===t.map(function(e){return e.value}).getOrNull()})).flatMap(function(t){return Object(Z.toOption)(function e(t){return t.reduce(function(t,n){return n instanceof z.WebPageContainerElement?t.concat(e(n.children)):t.concat(n)},[])}(e.children)).filter(function(e){return e.length>0}).map(function(e){return e.filter(function(e){return e instanceof z.WebPageFormRecordsListElement})}).map(function(e){return'<script>var script = document.createElement("script");script.src = "webpage-app.js";script.type = "text/javascript";script.defer = true;script.onload = function(){window.WebPageApp.initialize(\''+t.entity.apiKey+"',function(){"+e.map(function(e){return"window.WebPageApp.renderFormRecordsList('"+escape(JSON.stringify(se.a.transformValues(e)))+"');"}).join("")+"});};document.head.appendChild(script);<\/script>"})}).getOrElse(function(){return""})}},Oe=function(e,t){return function(n,r){return r().advancedWebPageBody.present.rootContainerElement.matchWith(function(r){return n(function(e,t,n,r){return function(o,i){return"<!DOCTYPE html><html><head><title>"+n+"</title>"+o(ve(t,r))+"</head>"+e+"</html>"}}('<div style="display:flex;flex-direction:column;'+(o=r).elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return"margin:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return""})+o.elementCss.proportions.flatMap(function(e){return e.padding}).map(function(e){return"padding:"+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px;"}).getOrElse(function(){return""})+"box-sizing:border-box;width:"+o.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"})+";max-width:"+o.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"})+';">'+Object(U.a)(o.children,"position").map(function(e){return be(e)}).join("")+"</div>",r,e,t));var o},function(){return""})}},Ee=function(e,t){return function(n,r){return new Promise(function(n,o){var i=new Image;i.src=function(e,t){switch(e.src.tpe.value){case z.WebPageImageSrcExternal.$Type.value:return e.src.src;case z.WebPageImageSrcFile.$Type.value:return Object(X.c)(e.src.file,t);default:throw"unknown image src type"}}(e,t),i.onload=function(t){var o=t.target.naturalWidth,i=t.target.naturalHeight,a=G()(o,i);n(Object(Z.toOption)({width:o,height:i,aspectRatioWidth:o/a,aspectRatioHeight:i/a,elementId:e.id,fileName:Object(Z.toOption)(e.src).filter(function(e){return e instanceof z.WebPageImageSrcFile}).flatMap(function(e){return Object(Z.headOption)(r().fileMetas.list.filter(function(t){return t.id.value===e.file.value}))}).map(function(e){return e.entity.originalName})}))},i.onerror=function(e){return n(new Z.None)}})}},ke=function(e){return function(t,n){var r=n(),o=Object(Q.c)(r.advancedWebPageBody.present,e.id),i=Object(ce.b)(e);t(Object(Y.H)({parent:o,component:i})),t(Object(J.r)())}},je=n(351),Ce=n(79),Re=n(1467),we=n(1478),Ie=n(627),Se=n(136),Pe=n(1461),Te=n(3),xe=n(71),_e=n(1591),De=n(87),Fe=function(e){return function(t){return t(Object(De.b)(function(t){return t.webPage.data.filter(function(t){return t.id.value===e.value}).nonEmpty()&&!t.webPage.fetching},Object(_e.d)(e)))}},Me=n(1941),We=n.n(Me),Be=n(1942),Le=n.n(Be),Ae=n(280),$e=n(1768),Ve=n(95),qe=n(417),Ne=n(26),ze=n.n(Ne),He=n(32),Ue=n.n(He),Ke=n(34),Ge=n.n(Ke),Ye=n(30),Je=n.n(Ye),Qe=n(24),Xe=n.n(Qe),Ze=n(856),et=n.n(Ze),tt=n(857),nt=n.n(tt),rt=n(1479),ot=n(1596),it=n(1483),at=n(620),lt=n(83),ut=(n(2169),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),ct=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onHtmlChange",value:function(e){this.props.dispatch(Object(je.e)(e.target.value))}},{key:"handleFilesDrop",value:function(e,t){var n=this;if(0===e.length)throw"There are not files to process";var r=e[e.length-1],o=new FileReader;o.onload=function(e){if(e.target){var r=e.target.result,o=r.indexOf("<body"),i=r.indexOf("</body");if(-1!==o&&-1!==i){var a=(new DOMParser).parseFromString(r,"text/html");n.props.dispatch(Object(je.e)(a.body.innerHTML)),n.props.handleDialogClose(t)}else n.props.dispatch(Object(xe.h)(n.props.i18n.t("Файл должен содержать открывающий (<body>) и закрывающий </body> тег")))}},o.readAsText(r)}},{key:"onReadFromFileClick",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Редактирование анкеты"),g.createElement(qe,{className:"WebPagesConfigForm__dropzone",onDrop:function(n){return e.handleFilesDrop(n,t)},accept:".html, .txt"},function(t){var n=t.isDragActive;return g.createElement("div",{className:n?"WebPagesConfigForm__dropzone-wrapper":""},g.createElement("div",{className:"WebPagesConfigForm__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),[g.createElement(w.a,{variant:"raised",onClick:function(n){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"render",value:function(){return g.createElement("div",{style:{flex:1,paddingLeft:15}},g.createElement(ze.a,{fullWidth:!0,multiline:!0,rows:10,value:this.props.html,onChange:this.onHtmlChange,label:this.props.i18n.t("Тело")}),g.createElement(w.a,{variant:"outlined",onClick:this.onReadFromFileClick,color:"primary"},this.props.i18n.t("Cчитать из файла")))}}]),t}(g.Component);ct=ut([b.autobind],ct);var st=Object(y.connect)(function(e,t){return{i18n:e.i18n,html:e.simpleWebPageBody.present.html.getOrElse(function(){return""})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.simpleWebPageBody.present.html,t.simpleWebPageBody.present.html)},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.html===t.html}})(Object(lt.a)(ct)),pt=n(1522),ft=n(220),dt=n.n(ft),ht=n(224),mt=n.n(ht),gt=n(225),yt=n.n(gt),bt=n(223),vt=n.n(bt),Ot=n(52),Et=n.n(Ot),kt=n(191),jt=n.n(kt),Ct=n(1769),Rt=n.n(Ct),wt=n(669),It=n.n(wt),St=n(670),Pt=n.n(St),Tt=n(98),xt=n.n(Tt),_t=n(376),Dt=n.n(_t),Ft=n(538),Mt=n.n(Ft),Wt=n(1472),Bt=n.n(Wt),Lt=n(1530),At=n.n(Lt),$t=n(380),Vt=n.n($t),qt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Nt=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"renderChip",value:function(e){var t;return Object(ee.b)(this.props.controlType.value)((t={},i()(t,z.WebPageHtmlContentElement.$Type.value,e(this.props.i18n.t("Html"),g.createElement(At.a,null))),i()(t,z.WebPageButtonElement.$Type.value,e(this.props.i18n.t("Кнопка"),g.createElement(Vt.a,null))),i()(t,z.WebPageImageElement.$Type.value,e(this.props.i18n.t("Изображение"),g.createElement(At.a,null))),i()(t,z.WebPageDividerElement.$Type.value,e(this.props.i18n.t("Разделитель"),g.createElement(At.a,null))),i()(t,z.WebPageBlockElement.$Type.value,e(this.props.i18n.t("Блок"),g.createElement(Vt.a,null))),i()(t,z.WebPageFormRecordsListElement.$Type.value,e(this.props.i18n.t("Список анкет"),g.createElement(At.a,null))),t)).getOrElse(function(){return g.createElement(Bt.a,null,"Unknown")})}},{key:"handleDoubleClick",value:function(e){this.props.onAddControl(this.props.controlType)}},{key:"render",value:function(){var e=this;return g.createElement("div",{className:"ControlWidget__container"},this.renderChip(function(t,n){return g.createElement(Bt.a,{onDoubleClick:e.handleDoubleClick,label:t,avatar:g.createElement(Mt.a,null,n)})}))}}]),t}(g.Component);Nt=qt([b.autobind],Nt);var zt=Object(y.connect)(function(e){return{i18n:e.i18n}})(Nt),Ht=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ut=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"renderChip",value:function(e){return Object(ee.b)(this.props.controlType.value)(i()({},z.WebPageRowElement.$Type.value,e(this.props.i18n.t("Ряд"),g.createElement(At.a,null)))).getOrElse(function(){return g.createElement(Bt.a,null,"Unknown")})}},{key:"handleDoubleClick",value:function(e){this.props.onAddControl(this.props.controlType)}},{key:"render",value:function(){var e=this;return g.createElement("div",{className:"ContainerWidget__container"},this.renderChip(function(t,n){return g.createElement(Bt.a,{onDoubleClick:e.handleDoubleClick,label:t,avatar:g.createElement(Mt.a,null,n)})}))}}]),t}(g.Component);Ut=Ht([b.autobind],Ut);var Kt=Object(y.connect)(function(e){return{i18n:e.i18n}})(Ut),Gt=(n(2171),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Yt=function(e,t,n){return g.createElement(pt.b,{key:e,draggableId:e,index:t},function(e,t){return g.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps),n)})},Jt=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"handleAddControl",value:function(e){var t=this;this.props.pageEditor.selectedElementId.matchWith(function(n){Object(Q.b)(t.props.advancedWebPageBody,n).filter(function(t){return t instanceof z.WebPageRowElement&&e.value===z.WebPageColumnElement.$Type.value||t instanceof z.WebPageContentElement||t instanceof z.WebPageColumnElement}).matchWith(function(n){t.props.onComponentAdded(Object(Z.toOption)(n.id),e,n.children.length),t.props.dispatch(Object(J.r)())},function(){t.addToRoot(e)})},function(){t.addToRoot(e)})}},{key:"addToRoot",value:function(e){var t=this;Object(Z.headOption)(this.props.advancedWebPageBody.rootContainerElement.map(function(e){return e.children}).getOrElse(function(){return[]})).foreach(function(n){t.props.openComponentAttributes(Object(Z.toOption)(n.id),e,n.children.length)})}},{key:"render",value:function(){var e=this,t=this.props.i18n;return g.createElement(pt.c,{droppableId:"ComponentsListType",isDropDisabled:!0},function(n,r){return g.createElement("div",{className:e.props.className,ref:n.innerRef},g.createElement(xt.a,{style:{flex:1}},g.createElement(Dt.a,null,t.t("Контейнеры")),Yt(z.WebPageRowElement.$Type.value,0,g.createElement(Kt,{controlType:z.WebPageRowElement.$Type,onAddControl:e.handleAddControl})),g.createElement(Dt.a,null,t.t("Html")),Yt(z.WebPageHtmlContentElement.$Type.value,0,g.createElement(zt,{controlType:z.WebPageHtmlContentElement.$Type,onAddControl:e.handleAddControl})),g.createElement(Dt.a,null,t.t("Изображения")),Yt(z.WebPageImageElement.$Type.value,0,g.createElement(zt,{controlType:z.WebPageImageElement.$Type,onAddControl:e.handleAddControl})),g.createElement(Dt.a,null,t.t("Кнопки")),Yt(z.WebPageButtonElement.$Type.value,0,g.createElement(zt,{controlType:z.WebPageButtonElement.$Type,onAddControl:e.handleAddControl})),g.createElement(Dt.a,null,t.t("Блоки")),Yt(z.WebPageBlockElement.$Type.value,0,g.createElement("div",{className:"ConfigComponentsList__row"},g.createElement(zt,{controlType:z.WebPageBlockElement.$Type,onAddControl:e.handleAddControl}))),g.createElement(Dt.a,null,t.t("Прочие")),g.createElement("div",{className:"WebPage_ComponentsList-row"},Yt(z.WebPageDividerElement.$Type.value,0,g.createElement(zt,{controlType:z.WebPageDividerElement.$Type,onAddControl:e.handleAddControl}))),Yt(z.WebPageFormRecordsListElement.$Type.value,0,g.createElement(zt,{controlType:z.WebPageFormRecordsListElement.$Type,onAddControl:e.handleAddControl}))))})}}]),t}(g.Component);Jt=Gt([b.autobind],Jt);var Qt=Object(y.connect)(function(e){return{i18n:e.i18n,pageEditor:e.advancedWebPageEditor,advancedWebPageBody:e.advancedWebPageBody.present}})(Object(lt.a)(Jt)),Xt=n(16),Zt=n(424),en=n(245),tn=n(246),nn=n(247),rn=n(266),on=n(292),an=n(29),ln=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},un=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cn=new Xt.CompositeDecorator([{strategy:en.b,component:en.a},{strategy:tn.b,component:tn.a},{strategy:nn.b,component:nn.a}]),sn=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=Object(rn.a)(n.props.element.content,cn,n.props.fields.getOrElse(function(){return[]}),[],[],n.props.i18n.t);Xt.EditorState.moveSelectionToEnd(r);return n.state={editorState:r,htmlBody:n.props.element.content,showHtml:!1,insertions:[],urlLinks:[],attachments:[]},n}return d()(t,e),c()(t,[{key:"onAttachmentsChange",value:function(e){this.setState(Te(this.state,{attachments:{$set:e}}))}},{key:"onInsertionsChange",value:function(e){this.setState(Te(this.state,{insertions:{$set:e}}))}},{key:"onUrlLinksChange",value:function(e){this.setState(Te(this.state,{urlLinks:{$set:e}}))}},{key:"onEditorStateChange",value:function(e){var t=this;this.setState(Te(this.state,{editorState:{$set:e}}),function(){setTimeout(function(){t.state.editorState===e&&t.props.dispatch(Object(Y.R)(Te(t.props.element,{content:{$set:Object(on.a)(Object(Xt.convertToRaw)(e.getCurrentContent()))}})))},200)})}},{key:"onShowHTMLChange",value:function(e){this.setState(Te(this.state,{showHtml:{$set:e}}))}},{key:"onHtmlChange",value:function(e){var t=this;this.setState(Te(this.state,{htmlBody:{$set:e}}),function(){t.props.dispatch(Object(Y.R)(Te(t.props.element,{content:{$set:e}})))})}},{key:"render",value:function(){return g.createElement(Zt.a,{showInsertionButtons:!0,hideInsertionButton:!0,formId:this.props.formId,fields:this.props.fields.getOrElse(function(){return[]}),organisationId:this.props.organisationId,insertions:[],attachments:[],urlLinks:[],onAttachmentsChange:this.onAttachmentsChange,onInsertionsChange:this.onInsertionsChange,onUrlLinksChange:this.onUrlLinksChange,html:this.state.htmlBody,showHtml:this.state.showHtml,editorState:this.state.editorState,onChange:this.onEditorStateChange,onShowHTMLChange:this.onShowHTMLChange,onHtmlChange:this.onHtmlChange})}}]),t}(g.Component);sn=ln([b.autobind,un("design:paramtypes",[Object])],sn);var pn=Object(y.connect)(function(e,t){return{i18n:e.i18n,fields:t.formId.flatMap(function(t){return Object(an.e)(e.fields,t)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(sn),fn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hn=new Xt.CompositeDecorator([{strategy:en.b,component:en.a},{strategy:tn.b,component:tn.a},{strategy:nn.b,component:nn.a}]),mn=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=Object(rn.a)(n.props.template,hn,Object(an.e)(n.props.fields,n.props.formId).getOrElse(function(){return[]}),[],[],n.props.i18n.t);Xt.EditorState.moveSelectionToEnd(r);return n.state={editorState:r,htmlBody:n.props.template,showHtml:!1,insertions:[],urlLinks:[],attachments:[]},n}return d()(t,e),c()(t,[{key:"onAttachmentsChange",value:function(e){this.setState(Te(this.state,{attachments:{$set:e}}))}},{key:"onInsertionsChange",value:function(e){this.setState(Te(this.state,{insertions:{$set:e}}))}},{key:"onUrlLinksChange",value:function(e){this.setState(Te(this.state,{urlLinks:{$set:e}}))}},{key:"onEditorStateChange",value:function(e){var t=this;this.setState(Te(this.state,{editorState:{$set:e}}),function(){setTimeout(function(){t.state.editorState===e&&t.props.onChange(Object(on.a)(Object(Xt.convertToRaw)(e.getCurrentContent())))},200)})}},{key:"onShowHTMLChange",value:function(e){this.setState(Te(this.state,{showHtml:{$set:e}}))}},{key:"onHtmlChange",value:function(e){var t=this;this.setState(Te(this.state,{htmlBody:{$set:e}}),function(){t.props.onChange(e)})}},{key:"render",value:function(){return console.log(),g.createElement(Zt.a,{showInsertionButtons:!0,formId:Object(Z.toOption)(this.props.formId),fields:Object(an.e)(this.props.fields,this.props.formId).getOrElse(function(){return[]}),organisationId:this.props.organisationId,insertions:[],attachments:[],urlLinks:[],onAttachmentsChange:this.onAttachmentsChange,onInsertionsChange:this.onInsertionsChange,onUrlLinksChange:this.onUrlLinksChange,html:this.state.htmlBody,showHtml:this.state.showHtml,editorState:this.state.editorState,onChange:this.onEditorStateChange,onShowHTMLChange:this.onShowHTMLChange,onHtmlChange:this.onHtmlChange})}}]),t}(g.Component);mn=fn([b.autobind,dn("design:paramtypes",[Object])],mn);var gn=Object(y.connect)(function(e,t){return{i18n:e.i18n,fields:e.fields}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fields===t.fields},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.fields===t.fields}})(mn),yn=n(343),bn=function(e){var t=e.openDialog(e.i18n.t("Редактирование содержимого"),g.createElement(yn.b,null,g.createElement(pn,{element:e.component,formId:e.formId,organisationId:e.organisationId})),[g.createElement(w.a,{variant:"raised",onClick:function(){return e.handleDialogClose(t)},style:{marginRight:"10px"}},e.i18n.t("Закрыть"))])},vn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},On=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onContentEdit",value:function(){bn(this.props)}},{key:"render",value:function(){return g.createElement("div",null,g.createElement(w.a,{variant:"raised",onClick:this.onContentEdit},this.props.i18n.t("Отредактировать содержимое")))}}]),t}(g.Component);On=vn([b.autobind],On);var En=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(lt.a)(On)),kn=n(43),jn=n.n(kn),Cn=n(86),Rn=n.n(Cn),wn=n(433),In=n(153),Sn=n(99),Pn=n(420),Tn=n(686),xn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_n=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Dn=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element,attachments:e.attachments},n}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(Te(this.state,{element:{$set:e.element}})),this.props.attachments!==e.attachments&&this.setState(Te(this.state,{attachments:{$set:e.attachments}}))}},{key:"updateSrc",value:function(e){return Te(this.state.element,{src:{$set:e}})}},{key:"onWebPageImageSrcTypeChange",value:function(e){switch(e.target.value){case z.WebPageImageSrcExternal.$Type.value:this.props.dispatch(Object(Y.Q)(this.updateSrc(new z.WebPageImageSrcExternal("")))),this.setState(Te(this.state,{element:{$set:this.updateSrc(new z.WebPageImageSrcExternal(""))}}));break;case z.WebPageImageSrcFile.$Type.value:this.props.dispatch(Object(Y.Q)(this.updateSrc(new z.WebPageImageSrcFile(new z.Id(""))))),this.setState(Te(this.state,{element:{$set:this.updateSrc(new z.WebPageImageSrcFile(new z.Id("")))}}))}}},{key:"onFileDialogOpen",value:function(){var e=this;this.props.organisationId.foreach(function(t){var n=void 0,r=e.props.openDialog(e.props.i18n.t("Файлы"),g.createElement(wn.a,{organisationId:t,excludedFolders:[].concat(jn()(z.FileTypes.map(function(e){return Object(In.b)(e.$Type.value)}))),initialFolder:Object(Z.toOption)("free"),onSelectionChange:function(e){Object(Z.headOption)(e).foreach(function(e){n=e})},acceptedFiles:Object(Z.toOption)("image/*"),cropper:!0,elementId:Object(Z.toOption)(e.state.element.id)}),[g.createElement(w.a,{variant:"raised",onClick:function(){return e.props.handleDialogClose(r)},style:{marginRight:"10px"}},e.props.i18n.t("Закрыть")),g.createElement(w.a,{variant:"raised",onClick:function(){Object(Z.toOption)(n).foreach(function(t){var n=e.state.element,o=e.updateSrc(new z.WebPageImageSrcFile(new z.Id(t))),i=e.state.attachments.filter(function(e){return e instanceof z.AttachmentLinkAttachment&&n.src instanceof z.WebPageImageSrcFile&&e.fileId.value!==n.src.file.value}).concat(new z.AttachmentLinkAttachment(new z.Id(t)));e.props.dispatch(Object(Y.S)(o)),e.setState(Te(e.state,{element:{$set:o},attachments:{$set:i}})),e.props.handleDialogClose(r)})},color:"primary"},e.props.i18n.t("Выбрать"))])})}},{key:"onWebPageImageSrcChange",value:function(e){this.props.dispatch(Object(Y.T)(this.updateSrc(new z.WebPageImageSrcExternal(e.target.value)))),this.setState(Te(this.state,{element:{$set:this.updateSrc(new z.WebPageImageSrcExternal(e.target.value))}}))}},{key:"openFileNameDialog",value:function(e,t,n){var r=this,o=void 0,i=this.props.openDialog(this.props.i18n.t("Сохранение"),g.createElement(Tn.a,{ref:function(e){return o=Object(Z.toOption)(e).flatMap(function(e){return Object(Z.toOption)(e.wrappedInstance)})},onSubmit:function(e){return t(e,i)},initialValues:{name:e.entity.originalName,deleteSource:!0}}),[g.createElement(w.a,{variant:"raised",onClick:function(){n(),r.props.handleDialogClose(i)},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),g.createElement(w.a,{variant:"raised",onClick:function(){return o.map(function(e){return e.ref.submit()})},color:"primary"},this.props.i18n.t("Создать"))])}},{key:"uploadImage",value:function(e,t){var n=this;return Object(Sn.h)(e,this.props.cdnAddress,this.props.authToken,this.props.organisationId,this.props.eventLineId,new Z.None,new Z.None,"true",!1,new Z.None,new Z.None,new Z.None,Object(Z.toOption)(t)).catch(function(e){throw n.props.dispatch(Object(xe.h)(n.props.i18n.t("Во время загрузки файла произошла ошибка"))),e})}},{key:"openImageFileEditor",value:function(e,t){var n=this,r=this.props.openDialog(this.props.i18n.t("Редактирование фотографии"),g.createElement(Pn.b,{src:Object(Z.toOption)(Object(X.c)(e.id,this.props.cdnAddress)),onClose:function(){return n.props.handleDialogClose(r)},onFileChange:function(e){},onFileCreate:function(e){},onSave:function(t,o){n.openFileNameDialog(e,function(i,a){return new Promise(function(t,r){i.deleteSource?Object(Sn.a)(e.id).then(function(){t()}).catch(function(e){n.props.dispatch(Object(xe.h)(n.props.i18n.t("Во время удаления файла произошла ошибка"))),r(e)}):t()}).then(function(){return n.uploadImage(t,i.name).then(function(e){var t=n.state.element,o=n.updateSrc(new z.WebPageImageSrcFile(e)),i=n.state.attachments.filter(function(e){return e instanceof z.AttachmentLinkAttachment&&t.src instanceof z.WebPageImageSrcFile&&e.fileId.value!==t.src.file.value}).concat(new z.AttachmentLinkAttachment(e));n.props.dispatch(Object(Y.S)(o)),n.setState(Te(n.state,{element:{$set:o},attachments:{$set:i}})),n.props.handleDialogClose(a),n.props.handleDialogClose(r)})}).catch(function(){o()})},o)},onDelete:function(){var e=n.state.element,t=n.updateSrc(new z.WebPageImageSrcFile(new z.Id(""))),r=n.state.attachments.filter(function(t){return t instanceof z.AttachmentLinkAttachment&&e.src instanceof z.WebPageImageSrcFile&&t.fileId.value!==e.src.file.value});n.props.dispatch(Object(Y.S)(t)),n.setState(Te(n.state,{element:{$set:t},attachments:{$set:r}}))},aspectRatioEdit:!0,resizeEdit:!0,defaultSrc:new Z.None,recommendedAspectRatios:t.reduce(function(e,t){return e.filter(function(e){return e.aspectRatioHeight===t.aspectRatioHeight&&e.aspectRatioWidth===t.aspectRatioWidth}).length>0?e:e.concat(t)},[]).filter(function(e){return e.elementId!==n.state.element.id}),recommendedSizes:t.reduce(function(e,t){return e.filter(function(e){return e.height===t.height&&e.width===t.width}).length>0?e:e.concat(t)},[])}),[])}},{key:"onImageFileEditClick",value:function(e){var t,n=this;console.log(this.state.element.id),this.props.dispatch((t=this.state.element.id,function(e,n){return Object(Q.b)(n().advancedWebPageBody.present,t).filter(function(e){return e instanceof z.WebPageImageElement}).flatMap(function(r){return Object(Q.c)(n().advancedWebPageBody.present,t).flatMap(function(e){return Object(Q.c)(n().advancedWebPageBody.present,e)}).flatMap(function(e){return Object(Q.b)(n().advancedWebPageBody.present,e)}).filter(function(e){return e instanceof z.WebPageRowElement}).map(function(e){return Object(U.a)(e.children,"position").map(function(e){return e.children.filter(function(e){return e instanceof z.WebPageImageElement})}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return e.src.file.value})}).map(function(t){return e(Object(oe.b)(t.map(function(e){return e.src}).filter(function(e){return e instanceof z.WebPageImageSrcFile}).map(function(e){return e.file}))).then(function(r){return Promise.all(t.map(function(t){return e(Ee(t,n().config.cdnAddress))})).then(function(e){return e.reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[])})})})})})).getOrElse(function(){return new Promise(function(e,t){return e([])})}).then(function(t){n.openImageFileEditor(e,t)})}},{key:"renderWebPageImageSrcSettings",value:function(e){var t=this,n=Object(Z.headOption)(this.props.fileMetas.list.filter(function(t){return t.id.value===e.file.value}));return g.createElement("div",null,g.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},g.createElement("div",{style:{overflowX:"hidden",wordBreak:"break-word"}},n.map(function(e){return e.entity.originalName}).getOrElse(function(){return t.props.i18n.t("Файл не найден")})),n.map(function(e){return g.createElement(S.a,{onClick:function(){return t.onImageFileEditClick(e)}},g.createElement(Rn.a,null))}).getOrNull()),g.createElement(w.a,{variant:"raised",onClick:this.onFileDialogOpen},this.props.i18n.t("Выбрать файл")))}},{key:"render",value:function(){return g.createElement("div",null,g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Тип добавления")),g.createElement(Je.a,{value:this.state.element.src.tpe.value,onChange:this.onWebPageImageSrcTypeChange},g.createElement(Xe.a,{value:z.WebPageImageSrcExternal.$Type.value},this.props.i18n.t("По внешней ссылке")),g.createElement(Xe.a,{value:z.WebPageImageSrcFile.$Type.value},this.props.i18n.t("Файл")))),this.state.element.src.tpe.value===z.WebPageImageSrcFile.$Type.value&&this.renderWebPageImageSrcSettings(this.state.element.src),this.state.element.src.tpe.value===z.WebPageImageSrcExternal.$Type.value&&g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Ссылка на файл"),value:this.state.element.src.src,onChange:this.onWebPageImageSrcChange}))}}]),t}(g.Component);Dn=xn([b.autobind,_n("design:paramtypes",[Object])],Dn);var Fn=Object(y.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,attachments:e.advancedEmailTemplate.present.attachments,authToken:e.auth.token,eventLineId:e.eventLine.eventLineId,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas.list===t.fileMetas.list&&e.advancedEmailTemplate.present.attachments===t.advancedEmailTemplate.present.attachments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.attachments===t.attachments&&e.fileMetas===t.fileMetas}})(Object(at.a)([function(e){e.element.src instanceof z.WebPageImageSrcFile&&e.dispatch(Object(oe.a)([e.element.src.file].filter(function(e){return""!==e.value})))}],[function(e,t){e.element.src instanceof z.WebPageImageSrcFile&&t.element.src!==e.element.src&&e.dispatch(Object(oe.a)([e.element.src.file].filter(function(e){return""!==e.value})))}])(Object(lt.a)(Dn))),Mn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Wn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Bn=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element},n}return d()(t,e),c()(t,[{key:"onLabelChange",value:function(e){var t=Te(this.props.element,{label:{$set:e.target.value}});this.props.dispatch(Object(Y.P)(t)),this.setState(Te(this.state,{element:{$set:t}}))}},{key:"render",value:function(){return g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Надпись"),value:this.state.element.label,onChange:this.onLabelChange})}}]),t}(g.Component);Bn=Mn([b.autobind,Wn("design:paramtypes",[Object])],Bn);var Ln=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(lt.a)(Bn)),An=n(366),$n=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Vn=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onEventLineChanged",value:function(e){this.props.onChange(z.Id.createId(e.target.value))}},{key:"render",value:function(){return g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.label||this.props.i18n.t("Мероприятие")),g.createElement(Je.a,{fullWidth:!0,native:!0,value:this.props.eventLineId.map(function(e){return e.value}).getOrElse(function(){return""}),onChange:this.onEventLineChanged},"   ",g.createElement("option",{value:""},""),this.props.eventLines.list.map(function(e){return g.createElement("option",{value:e.id.value},e.entity.name)})))}}]),t}(g.Component);Vn=$n([b.autobind],Vn);var qn=Object(y.connect)(function(e,t){return{i18n:e.i18n,forms:e.forms,eventLines:e.eventLines}})(Vn),Nn=n(176),zn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Hn=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"getFormFields",value:function(){return Object(an.e)(this.props.fields,this.props.component.formId).getOrElse(function(){return[]})}},{key:"onEventLineIdChanged",value:function(e){var t=this;e.foreach(function(e){t.props.dispatch(Object(Y.Q)(Te(t.props.component,{eventLineId:{$set:e}})))})}},{key:"onFormdIdChanged",value:function(e){var t=this;e.foreach(function(e){t.props.dispatch(Object(Y.Q)(Te(t.props.component,{formId:{$set:e}})))})}},{key:"getListType",value:function(e){switch(e){case z.WebPageFormRecordsListTypeTable.$Type.value:return new z.WebPageFormRecordsListTypeTable([]);case z.WebPageFormRecordsListTypeTiles.$Type.value:return new z.WebPageFormRecordsListTypeTiles("<div></div>");default:throw"wrong form records list type"}}},{key:"onListTypeChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.component,{listType:{$set:this.getListType(e.target.value)}})))}},{key:"onColumnsChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.component,{listType:{columns:{$set:e}}})))}},{key:"renderTableAttributes",value:function(){var e=this.props.component.listType;return g.createElement("div",null,g.createElement(An.a,{label:this.props.i18n.t("Cтолбцы"),displayFields:e.columns,formId:this.props.component.formId,mirrorSettingsLabel:new Z.None,onChange:this.onColumnsChanged}))}},{key:"onTileTemplateChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.component,{listType:{template:{$set:e}}})))}},{key:"renderTilesAttributes",value:function(){var e=this.props.component.listType;return this.props.tileTemplateRenderer(e.template,this.onTileTemplateChanged,this.props.organisationId)}},{key:"renderListTypeAttributes",value:function(){switch(this.props.component.listType.tpe.value){case z.WebPageFormRecordsListTypeTable.$Type.value:return this.renderTableAttributes();case z.WebPageFormRecordsListTypeTiles.$Type.value:return this.renderTilesAttributes();default:throw"wrong form records list type"}}},{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(qn,{eventLineId:Object(Z.toOption)(this.props.component.eventLineId),onChange:this.onEventLineIdChanged}),""!==this.props.component.eventLineId.value&&g.createElement("div",null,g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Форма")),g.createElement(Je.a,{fullWidth:!0,native:!0,value:this.props.component.formId.value,onChange:function(t){return e.onFormdIdChanged(z.Id.createId(t.target.value))}},"   ",g.createElement("option",{value:""},""),this.props.forms.list.map(function(e){return g.createElement("option",{value:e.id.value,key:e.id.value},e.entity.name)}))),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Тип списка")),g.createElement(Je.a,{fullWidth:!0,native:!0,value:this.props.component.listType.tpe.value,onChange:this.onListTypeChanged},"   ",g.createElement("option",{value:""},""),g.createElement("option",{value:z.WebPageFormRecordsListTypeTable.$Type.value},this.props.i18n.t("Таблица")),g.createElement("option",{value:z.WebPageFormRecordsListTypeTiles.$Type.value},this.props.i18n.t("Карточки")))),""!==this.props.component.formId.value&&this.renderListTypeAttributes()))}}]),t}(g.Component);Hn=zn([b.autobind],Hn);var Un=Object(y.connect)(function(e,t){return{i18n:e.i18n,forms:e.forms,fields:e.fields}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.forms===t.forms&&e.fields===t.fields},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.forms===t.forms&&e.fields===t.fields}})(Object(Se.a)(function(e){e.isTokenChecked&&""!==e.component.formId.value&&e.dispatch(Object(Nn.h)(e.component.formId))},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&""!==e.component.formId.value&&e.dispatch(Object(Nn.h)(e.component.formId)),e.isTokenChecked&&t.component.formId.value!==e.component.formId.value&&""!==e.component.formId.value&&e.dispatch(Object(Nn.h)(e.component.formId))})(Hn)),Kn=n(59),Gn=n(422),Yn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Jn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Qn=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element,urlLinks:e.urlLinks},n}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(Te(this.state,{element:{$set:e.element}})),this.props.urlLinks!==e.urlLinks&&this.setState(Te(this.state,{urlLinks:{$set:e.urlLinks}}))}},{key:"updateHref",value:function(e){return Te(this.state.element,{href:{$set:e}})}},{key:"onHrefTypeChanged",value:function(e){var t=this,n=this.state.element.href,r=Object(Z.headOption)(this.props.urlLinks.filter(function(e){return n instanceof z.WebPageButtonHrefAppLogin&&e instanceof z.UrlLinkAppLogin&&e.uid===n.uid||n instanceof z.WebPageButtonHrefJourneyEvent&&e instanceof z.UrlLinkJourneyEvent&&e.eventId.value===n.eventId})),o=this.props.urlLinks.filter(function(e){return r.matchWith(function(t){return t!==e},function(){return!0})});if(e.target.value!==z.WebPageButtonHrefAppLogin.$Type.value)if(e.target.value!==z.WebPageButtonHrefJourneyEvent.$Type.value)this.setState(Te(this.state,{element:{$set:this.updateHref(new z.WebPageButtonHrefExternal(""))},urlLinks:{$set:o}}),function(){t.props.dispatch(Object(Y.O)(t.updateHref(new z.WebPageButtonHrefExternal(""))))});else{var i=Object(Z.headOption)(this.props.journeyEventIds.list).map(function(e){return[new z.UrlLinkJourneyEvent("",e.id)]}).getOrElse(function(){return[]}),a=new z.WebPageButtonHrefJourneyEvent("");this.setState(Te(this.state,{element:{$set:this.updateHref(a)},urlLinks:{$set:[].concat(jn()(o),jn()(i))}}),function(){t.props.dispatch(Object(Y.O)(t.updateHref(a)))})}else{var l=Kn.v4(),u=new z.UrlLinkAppLogin(l,new z.Id(""),""),c=new z.WebPageButtonHrefAppLogin(l);this.setState(Te(this.state,{element:{$set:this.updateHref(c)},urlLinks:{$set:o.concat(u)}}),function(){t.props.dispatch(Object(Y.O)(t.updateHref(c)))})}}},{key:"onExternalUrlChange",value:function(e){var t=this;this.setState(Te(this.state,{element:{$set:this.updateHref(new z.WebPageButtonHrefExternal(e.target.value))},urlLinks:{$set:this.props.urlLinks}}),function(){t.props.dispatch(Object(Y.N)(t.updateHref(new z.WebPageButtonHrefExternal(e.target.value))))})}},{key:"renderHrefExternal",value:function(e){return g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Путь"),value:e.link,onChange:this.onExternalUrlChange})}},{key:"onLinkEventIdChange",value:function(e){var t=this,n=this.state.element.href,r=Object(Z.headOption)(this.props.urlLinks.filter(function(e){return n instanceof z.WebPageButtonHrefJourneyEvent&&e instanceof z.UrlLinkJourneyEvent&&e.eventId.value===n.eventId})),o=this.props.urlLinks.filter(function(e){return r.matchWith(function(t){return t!==e},function(){return!0})}),i=this.updateHref(new z.WebPageButtonHrefJourneyEvent(e.target.value)),a=z.Id.createId(e.target.value).getOrElse(function(){throw"wrong journey event id"}),l=o.concat(r.matchWith(function(e){return Te(e,{eventId:{$set:a}})},function(){return new z.UrlLinkJourneyEvent("",a)}));this.setState(Te(this.state,{element:{$set:i},urlLinks:{$set:l}}),function(){t.props.dispatch(Object(Y.L)(i))})}},{key:"onJourneyEventUrlChange",value:function(e){var t=this,n=this.state.element.href,r=Object(Z.headOption)(this.props.urlLinks.filter(function(e){return n instanceof z.WebPageButtonHrefJourneyEvent&&e instanceof z.UrlLinkJourneyEvent&&e.eventId.value===n.eventId})),o=this.props.urlLinks.filter(function(e){return r.matchWith(function(t){return t!==e},function(){return!0})}),i=Object(Z.headOption)(this.props.journeyEventIds.list).map(function(t){return[new z.UrlLinkJourneyEvent(e.target.value,t.id)]}).getOrElse(function(){return[]}),a=o.concat.apply(o,jn()(r.matchWith(function(t){return[Te(t,{redirectUrl:{$set:e.target.value}})]},function(){return i})));this.setState(Te(this.state,{element:{$set:this.state.element},urlLinks:{$set:a}}),function(){t.props.dispatch(Object(Y.M)(t.state.element))})}},{key:"renderHrefJourneyEvent",value:function(e){var t=Object(Z.headOption)(this.props.urlLinks.filter(function(t){return t instanceof z.UrlLinkJourneyEvent&&t.eventId.value===e.eventId}));return g.createElement("div",null,0===this.props.journeyEventIds.list.length?g.createElement("div",{style:{paddingTop:10}},this.props.i18n.t("Не выбран идентификатор события")):g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Путь"),value:t.map(function(e){return e.redirectUrl}).getOrElse(function(){return""}),onChange:this.onJourneyEventUrlChange}),g.createElement(Gn.a,{label:this.props.i18n.t("Идентификатор события"),fullWidth:!0,eventLineId:this.props.eventLineId,value:t.map(function(e){return e.eventId.value}).getOrElse(function(){return""}),onChange:this.onLinkEventIdChange}))}},{key:"onAppLoginAppIdChange",value:function(e){var t=this,n=this.state.element.href,r=Object(Z.headOption)(this.props.urlLinks.filter(function(e){return n instanceof z.WebPageButtonHrefAppLogin&&e instanceof z.UrlLinkAppLogin&&e.uid===n.uid})),o=this.props.urlLinks.filter(function(e){return r.matchWith(function(t){return t!==e},function(){return!0})}),i=Kn.v4(),a=this.updateHref(new z.WebPageButtonHrefAppLogin(i)),l=o.concat(r.matchWith(function(t){return Te(t,{appId:{$set:new z.Id(e.target.value)},uid:{$set:i}})},function(){return new z.UrlLinkAppLogin(i,new z.Id(e.target.value),"")}));this.setState(Te(this.state,{element:{$set:a},urlLinks:{$set:l}}),function(){t.props.dispatch(Object(Y.J)(a))})}},{key:"onAppLoginUrlChange",value:function(e){var t=this,n=this.state.element.href,r=n.uid,o=Object(Z.headOption)(this.state.urlLinks.filter(function(e){return n instanceof z.WebPageButtonHrefAppLogin&&e instanceof z.UrlLinkAppLogin&&e.uid===r})),i=this.state.urlLinks.filter(function(e){return o.matchWith(function(t){return t!==e},function(){return!0})}).concat(o.matchWith(function(t){return Te(t,{appUrl:{$set:e.target.value}})},function(){return t.updateHref(new z.WebPageButtonHrefAppLogin(r)),new z.UrlLinkAppLogin(r,new z.Id(""),e.target.value)}));this.setState(Te(this.state,{element:{$set:this.state.element},urlLinks:{$set:i}}),function(){t.props.dispatch(Object(Y.K)(t.state.element))})}},{key:"renderHrefAppLogin",value:function(e){var t=Object(Z.headOption)(this.props.urlLinks.filter(function(t){return t instanceof z.UrlLinkAppLogin&&t.uid===e.uid}));return g.createElement("div",null,g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Путь"),value:t.map(function(e){return e.appUrl}).getOrElse(function(){return""}),onChange:this.onAppLoginUrlChange}),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("application|Приложение")),g.createElement(Je.a,{fullWidth:!0,value:t.map(function(e){return e.appId.value}).getOrElse(function(){return""}),onChange:this.onAppLoginAppIdChange},this.props.applications.list.map(function(e){return g.createElement(Xe.a,{key:e.id.value,value:e.id.value},e.entity.name)}))))}},{key:"render",value:function(){var e=this.state.element.href;return g.createElement("div",null,!this.props.hideTitle&&g.createElement("h3",null,this.props.i18n.t("Ссылка")),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Тип ссылки")),g.createElement(Je.a,{value:this.state.element.href.tpe.value,onChange:this.onHrefTypeChanged},g.createElement(Xe.a,{value:z.WebPageButtonHrefExternal.$Type.value},this.props.i18n.t("Обычный")),g.createElement(Xe.a,{value:z.WebPageButtonHrefJourneyEvent.$Type.value},this.props.i18n.t("Ссылка на событие")),g.createElement(Xe.a,{value:z.WebPageButtonHrefAppLogin.$Type.value},this.props.i18n.t("Ссылка для логина лк")))),e instanceof z.WebPageButtonHrefExternal&&this.renderHrefExternal(e),e instanceof z.WebPageButtonHrefAppLogin&&this.renderHrefAppLogin(e),e instanceof z.WebPageButtonHrefJourneyEvent&&this.renderHrefJourneyEvent(e))}}]),t}(g.Component);Qn=Yn([b.autobind,Jn("design:paramtypes",[Object])],Qn);var Xn=Object(y.connect)(function(e,t){return{i18n:e.i18n,applications:e.applications,urlLinks:e.advancedEmailTemplate.present.urlLinks,journeyEventIds:e.journeyEventIds}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.applications===t.applications&&e.advancedEmailTemplate.present.urlLinks===t.advancedEmailTemplate.present.urlLinks&&e.journeyEventIds===t.journeyEventIds},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.applications===t.applications&&e.urlLinks===t.urlLinks&&e.journeyEventIds===t.journeyEventIds}})(Qn),Zn=n(23),er=n(103),tr=n(188),nr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},rr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},or=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element,eventLineId:new Zn.None},n}return d()(t,e),c()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.element.formId.foreach(function(t){e.setState(Te(e.state,{eventLineId:{$set:Object(Zn.headOption)(e.props.forms.list.filter(function(e){return e.id.value===t.value})).map(function(e){return e.entity.eventLineId.value})}})),e.props.dispatch(Object(tr.b)(t))})}},{key:"componentWillReceiveProps",value:function(e){var t=this;Object(Zn.isEqual)(e.element.formId,this.props.element.formId)||e.element.formId.foreach(function(e){return t.props.dispatch(Object(tr.b)(e))})}},{key:"changeElement",value:function(e){this.props.dispatch(Object(Y.Q)(e)),this.setState(Te(this.state,{element:{$set:e}}))}},{key:"onBlockIdChange",value:function(e){var t=Te(this.props.element,{blockId:{$set:z.Id.createId(e.target.value)}});this.changeElement(t)}},{key:"onLangCodeChange",value:function(e){var t=Te(this.props.element,{lngCode:{$set:Object(Zn.toOption)(e.target.value)}});this.changeElement(t)}},{key:"onServerAddressChange",value:function(e){var t=Te(this.props.element,{server:{$set:Object(Zn.toOption)(e.target.value)}});this.changeElement(t)}},{key:"onScriptUrlChange",value:function(e){var t=Te(this.props.element,{scriptUrl:{$set:Object(Zn.toOption)(e.target.value)}});this.changeElement(t)}},{key:"onEventLineIdChange",value:function(e){this.setState(Te(this.state,{eventLineId:{$set:Object(Zn.toOption)(e.target.value)}}))}},{key:"onFormIdChange",value:function(e){var t=Te(this.props.element,{formId:{$set:z.Id.createId(e.target.value)}});this.changeElement(t)}},{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Проект")),g.createElement(Je.a,{fullWidth:!0,value:this.state.eventLineId.getOrElse(function(){return""}),onChange:this.onEventLineIdChange},this.props.eventLines.list.map(function(e,t){return g.createElement(Xe.a,{key:t,value:e.id.value},e.entity.name)}))),this.state.eventLineId.nonEmpty()&&g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Форма")),g.createElement(Je.a,{fullWidth:!0,value:this.props.element.formId.map(function(e){return e.value}).getOrElse(function(){return""}),onChange:this.onFormIdChange},this.props.forms.list.filter(function(e){return z.FormType.isForm(e.entity.formType)}).filter(function(t){return e.state.eventLineId.map(function(e){return t.entity.eventLineId.value===e}).getOrElse(function(){return!1})}).map(function(e,t){return g.createElement(Xe.a,{key:t,value:e.id.value},e.entity.name)}))),this.props.element.formId.nonEmpty()&&g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Блок")),g.createElement(Je.a,{fullWidth:!0,value:this.props.element.blockId.map(function(e){return e.value}).getOrElse(function(){return""}),onChange:this.onBlockIdChange},this.props.element.formId.flatMap(function(t){return Object(er.c)(e.props.blocks,t)}).getOrElse(function(){return[]}).map(function(e,t){return g.createElement(Xe.a,{key:t,value:e.id.toString()},e.name)}))),g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Язык"),value:this.state.element.lngCode.getOrElse(function(){return""}),onChange:this.onLangCodeChange}),g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Адрес сервера"),value:this.state.element.server.getOrElse(function(){return""}),onChange:this.onServerAddressChange}),g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Ссылка на скрипт"),value:this.state.element.scriptUrl.getOrElse(function(){return""}),onChange:this.onScriptUrlChange}))}}]),t}(g.Component);or=nr([b.autobind,rr("design:paramtypes",[Object])],or);var ir=Object(y.connect)(function(e,t){return{i18n:e.i18n,eventLines:e.eventLines,forms:e.forms,blocks:e.blocks,block:e.block}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.eventLines===t.eventLines&&e.forms===t.forms&&e.blocks===t.blocks},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.eventLines===t.eventLines&&e.forms===t.forms&&e.blocks===t.blocks}})(Object(lt.a)(or)),ar=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},lr=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onContentEdit",value:function(){var e,t;e=this.props,t=e.openDialog(e.i18n.t("Редактирование шаблона"),g.createElement(gn,{template:e.template,onChange:e.onChange,formId:e.formId,organisationId:e.organisationId}),[g.createElement(w.a,{variant:"raised",onClick:function(){return e.handleDialogClose(t)},style:{marginRight:"10px"}},e.i18n.t("Закрыть"))])}},{key:"render",value:function(){return g.createElement("div",null,g.createElement(w.a,{variant:"raised",onClick:this.onContentEdit},this.props.i18n.t("Отредактировать шаблон")))}}]),t}(g.Component);lr=ar([b.autobind],lr);var ur=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(lt.a)(lr)),cr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},sr=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"renderButtonAttributes",value:function(e){return g.createElement(g.Fragment,null,g.createElement(Ln,{element:e}),this.props.eventLineId.map(function(t){return g.createElement(Xn,{eventLineId:t,element:e})}).getOrNull())}},{key:"renderImageAttributes",value:function(e){return g.createElement(g.Fragment,null,g.createElement(Fn,{element:e,organisationId:this.props.organisationId}),this.props.eventLineId.map(function(t){return g.createElement(Xn,{eventLineId:t,element:e})}).getOrNull())}},{key:"renderFormRecordsListAttributes",value:function(e){return g.createElement(Un,{component:e,organisationId:this.props.organisationId,tileTemplateRenderer:function(t,n,r){return g.createElement(ur,{template:t,onChange:n,formId:e.formId,organisationId:r})}})}},{key:"renderHtmlContentAttributes",value:function(e){return g.createElement(En,{component:e,formId:this.props.formId,organisationId:this.props.organisationId})}},{key:"renderBlockAttributes",value:function(e){return g.createElement(ir,{element:e})}},{key:"render",value:function(){return this.props.element instanceof z.WebPageHtmlContentElement?this.renderHtmlContentAttributes(this.props.element):this.props.element instanceof z.WebPageImageElement?this.renderImageAttributes(this.props.element):this.props.element instanceof z.WebPageButtonElement?this.renderButtonAttributes(this.props.element):this.props.element instanceof z.WebPageBlockElement?this.renderBlockAttributes(this.props.element):this.props.element instanceof z.WebPageFormRecordsListElement?this.renderFormRecordsListAttributes(this.props.element):void 0}}]),t}(g.Component);sr=cr([b.autobind],sr);var pr=Object(y.connect)(function(e,t){return{i18n:e.i18n,eventLineId:e.eventLine.eventLineId}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(sr),fr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dr={width:45},hr={display:"flex",width:200,justifyContent:"space-between",marginBottom:16,alignItems:"baseline"},mr=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"updateMargin",value:function(e){return Te(this.props.element,{elementCss:{proportions:{$set:Object(Z.toOption)(this.props.element.elementCss.proportions.matchWith(function(e){return e},function(){return new z.ElementProportions})).map(function(t){return Te(t,{margin:{$set:Object(Z.toOption)(t.margin.matchWith(function(e){return e},function(){return new z.ElementMargin(z.EmailElement.DEFAULT_MARGIN,z.EmailElement.DEFAULT_MARGIN,z.EmailElement.DEFAULT_MARGIN,z.EmailElement.DEFAULT_MARGIN)})).map(function(t){return e(t)})}})})}}})}},{key:"handleMarginTopChanged",value:function(e){this.props.dispatch(Object(Y.X)(this.updateMargin(function(t){return Te(t,{top:{$set:e}})})))}},{key:"handleMarginRightChanged",value:function(e){this.props.dispatch(Object(Y.W)(this.updateMargin(function(t){return Te(t,{right:{$set:e}})})))}},{key:"handleMarginBottomChanged",value:function(e){this.props.dispatch(Object(Y.U)(this.updateMargin(function(t){return Te(t,{bottom:{$set:e}})})))}},{key:"handleMarginLeftChanged",value:function(e){this.props.dispatch(Object(Y.V)(this.updateMargin(function(t){return Te(t,{left:{$set:e}})})))}},{key:"render",value:function(){var e=this,t=this.props.element,n=this.props.element.elementCss.proportions.getOrElse(function(){return new z.ElementProportions});return g.createElement("div",null,g.createElement("h3",null,this.props.i18n.t("Отступы снаружи")),g.createElement("div",{style:hr},g.createElement(ze.a,{value:n.margin.map(function(e){return e.top}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginTopChanged(t.target.value)},label:this.props.i18n.t("Cверху"),type:"number",style:dr}),g.createElement(ze.a,{value:n.margin.map(function(e){return e.right}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginRightChanged(t.target.value)},label:this.props.i18n.t("Cправа"),type:"number",style:dr}),g.createElement(ze.a,{value:n.margin.map(function(e){return e.bottom}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginBottomChanged(t.target.value)},label:this.props.i18n.t("Cнизу"),type:"number",style:dr}),g.createElement(ze.a,{value:n.margin.map(function(e){return e.left}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginLeftChanged(t.target.value)},label:this.props.i18n.t("Cлева"),type:"number",style:dr})))}}]),t}(g.Component);mr=fr([b.autobind],mr);var gr=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(mr),yr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},br={width:45},vr={display:"flex",width:200,justifyContent:"space-between",paddingBottom:16,alignItems:"baseline"},Or=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"updatePadding",value:function(e){return Te(this.props.element,{elementCss:{proportions:{$set:Object(Z.toOption)(this.props.element.elementCss.proportions.matchWith(function(e){return e},function(){return new z.ElementProportions})).map(function(t){return Te(t,{padding:{$set:Object(Z.toOption)(t.padding.matchWith(function(e){return e},function(){return new z.ElementPadding(z.EmailElement.DEFAULT_PADDING,z.EmailElement.DEFAULT_PADDING,z.EmailElement.DEFAULT_PADDING,z.EmailElement.DEFAULT_PADDING)})).map(function(t){return e(t)})}})})}}})}},{key:"handlePaddingTopChanged",value:function(e){this.props.dispatch(Object(Y.cb)(this.updatePadding(function(t){return Te(t,{top:{$set:e}})})))}},{key:"handlePaddingRightChanged",value:function(e){this.props.dispatch(Object(Y.bb)(this.updatePadding(function(t){return Te(t,{right:{$set:e}})})))}},{key:"handlePaddingBottomChanged",value:function(e){this.props.dispatch(Object(Y.Z)(this.updatePadding(function(t){return Te(t,{bottom:{$set:e}})})))}},{key:"handlePaddingLeftChanged",value:function(e){this.props.dispatch(Object(Y.ab)(this.updatePadding(function(t){return Te(t,{left:{$set:e}})})))}},{key:"render",value:function(){var e=this,t=this.props.element,n=this.props.element.elementCss.proportions.getOrElse(function(){return new z.ElementProportions});return g.createElement("div",null,g.createElement("h3",null,this.props.i18n.t("Отступы внутри")),g.createElement("div",{style:vr},g.createElement(ze.a,{value:n.padding.map(function(e){return e.top}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingTopChanged(t.target.value)},label:this.props.i18n.t("Cверху"),type:"number",style:br}),g.createElement(ze.a,{value:n.padding.map(function(e){return e.right}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingRightChanged(t.target.value)},label:this.props.i18n.t("Cправа"),type:"number",style:br}),g.createElement(ze.a,{value:n.padding.map(function(e){return e.bottom}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingBottomChanged(t.target.value)},label:this.props.i18n.t("Cнизу"),type:"number",style:br}),g.createElement(ze.a,{value:n.padding.map(function(e){return e.left}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingLeftChanged(t.target.value)},label:this.props.i18n.t("Cлева"),type:"number",style:br})))}}]),t}(g.Component);Or=yr([b.autobind],Or);var Er=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Or),kr=n(1495),jr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Cr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Rr=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element},n}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(Te(this.state,{element:{$set:e.element}}))}},{key:"getSizeValue",value:function(e){return e.flatMap(function(e){var t=/(\d*)(\D*)/.exec(e);return Object(Z.toOption)(t).map(function(e){return{value:e[1],valueType:e[2]}})}).getOrElse(function(){return{value:"",valueType:"auto"}})}},{key:"updateWidth",value:function(e){return Te(this.state.element,{elementCss:{proportions:{$set:Object(Z.toOption)(this.state.element.elementCss.proportions.matchWith(function(e){return e},function(){return new z.ElementProportions})).map(function(t){return Te(t,{width:{$set:e}})})}}})}},{key:"updateHeight",value:function(e){return Te(this.state.element,{elementCss:{proportions:{$set:Object(Z.toOption)(this.state.element.elementCss.proportions.matchWith(function(e){return e},function(){return new z.ElementProportions})).map(function(t){return Te(t,{height:{$set:e}})})}}})}},{key:"updateWidthType",value:function(e){this.props.dispatch(Object(Y.Q)(this.updateWidth(e))),this.setState(Te(this.state,{element:{$set:this.updateWidth(e)}}))}},{key:"updateHeightType",value:function(e){this.props.dispatch(Object(Y.Q)(this.updateHeight(e))),this.setState(Te(this.state,{element:{$set:this.updateHeight(e)}}))}},{key:"updateWidthValue",value:function(e){this.props.dispatch(Object(Y.db)(this.updateWidth(e))),this.setState(Te(this.state,{element:{$set:this.updateWidth(e)}}))}},{key:"updateHeightValue",value:function(e){this.props.dispatch(Object(Y.Q)(this.updateHeight(e))),this.setState(Te(this.state,{element:{$set:this.updateHeight(e)}}))}},{key:"updateMaxWidth",value:function(e){return Te(this.state.element,{elementCss:{proportions:{$set:Object(Z.toOption)(this.state.element.elementCss.proportions.matchWith(function(e){return e},function(){return new z.ElementProportions})).map(function(t){return Te(t,{maxWidth:{$set:e}})})}}})}},{key:"updateMaxWidthType",value:function(e){this.props.dispatch(Object(Y.Q)(this.updateMaxWidth(e))),this.setState(Te(this.state,{element:{$set:this.updateMaxWidth(e)}}))}},{key:"updateMaxWidthValue",value:function(e){this.props.dispatch(Object(Y.Y)(this.updateMaxWidth(e))),this.setState(Te(this.state,{element:{$set:this.updateMaxWidth(e)}}))}},{key:"handleWidthValueChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.width}));this.updateWidthValue(Object(Z.toOption)(""+e.target.value+t.valueType))}},{key:"handleHeightValueChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.height}));this.updateHeightValue(Object(Z.toOption)(""+e.target.value+t.valueType))}},{key:"handleMaxWidthValueChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.maxWidth}));this.updateMaxWidthValue(Object(Z.toOption)(""+e.target.value+t.valueType))}},{key:"handleWidthValueTypeChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.width}));this.updateWidthType("auto"!==e?Object(Z.toOption)(""+t.value+e):new Z.None)}},{key:"handleHeightValueTypeChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.height}));this.updateHeightType("auto"!==e?Object(Z.toOption)(""+t.value+e):new Z.None)}},{key:"handleMaxWidthValueTypeChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.maxWidth}));this.updateMaxWidthType("auto"!==e?Object(Z.toOption)(""+t.value+e):new Z.None)}},{key:"isContainerElement",value:function(){return this.state.element instanceof z.WebPageContainerElement}},{key:"isRootContainerElement",value:function(){return this.state.element instanceof z.WebPageRootContainer}},{key:"renderWidthAttributes",value:function(){var e=this,t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.width}));return g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement(ze.a,{value:t.value,disabled:"auto"===t.valueType,onChange:this.handleWidthValueChanged,label:this.props.i18n.t("Ширина"),style:{flex:"1 0 47%",marginTop:0}}),g.createElement("div",{style:{display:"flex",marginLeft:5}},g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleWidthValueTypeChanged("auto")}},"auto"===t.valueType?{color:"primary"}:{},{variant:"auto"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("auto"))),g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleWidthValueTypeChanged("px")}},"px"===t.valueType?{color:"primary"}:{},{variant:"px"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("px"))),g.createElement("div",null,g.createElement(kr.a,Object.assign({onClick:function(){return e.handleWidthValueTypeChanged("%")}},"%"===t.valueType?{color:"primary"}:{},{variant:"%"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("%")))))}},{key:"renderHeightAttributes",value:function(){var e=this,t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.height}));return g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement(ze.a,{value:t.value,disabled:"auto"===t.valueType,onChange:this.handleHeightValueChanged,label:this.props.i18n.t("Высота"),style:{flex:"1 0 47%",marginTop:0}}),g.createElement("div",{style:{display:"flex",marginLeft:5}},g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleHeightValueTypeChanged("auto")}},"auto"===t.valueType?{color:"primary"}:{},{variant:"auto"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("auto"))),g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleHeightValueTypeChanged("px")}},"px"===t.valueType?{color:"primary"}:{},{variant:"px"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("px"))),g.createElement("div",null,g.createElement(kr.a,Object.assign({onClick:function(){return e.handleHeightValueTypeChanged("%")}},"%"===t.valueType?{color:"primary"}:{},{variant:"%"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("%")))))}},{key:"renderMaxWidthAttributes",value:function(){var e=this,t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.maxWidth}));return g.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:15}},g.createElement(ze.a,{value:t.value,disabled:"auto"===t.valueType,onChange:this.handleMaxWidthValueChanged,label:this.props.i18n.t("Max ширина"),style:{flex:"1 0 47%",marginTop:0}}),g.createElement("div",{style:{display:"flex",marginLeft:5}},g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleMaxWidthValueTypeChanged("auto")}},"auto"===t.valueType?{color:"primary"}:{},{variant:"auto"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("auto"))),g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleMaxWidthValueTypeChanged("px")}},"px"===t.valueType?{color:"primary"}:{},{variant:"px"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("px"))),g.createElement("div",null,g.createElement(kr.a,Object.assign({onClick:function(){return e.handleMaxWidthValueTypeChanged("%")}},"%"===t.valueType?{color:"primary"}:{},{variant:"%"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("%")))))}},{key:"render",value:function(){return g.createElement("div",null,!this.props.hideTitle&&g.createElement("h3",null,this.props.i18n.t("Размер")),this.renderWidthAttributes(),this.renderHeightAttributes(),this.isContainerElement()&&!this.isRootContainerElement()&&this.renderMaxWidthAttributes())}}]),t}(g.Component);Rr=jr([b.autobind,Cr("design:paramtypes",[Object])],Rr);var wr=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Rr),Ir=n(45),Sr=n.n(Ir),Pr=n(72),Tr=n.n(Pr),xr=n(113),_r=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Dr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Fr=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element},n}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(Te(this.state,{element:{$set:e.element}}))}},{key:"updateBackground",value:function(e){return Te(this.state.element,{elementCss:{background:{$set:Object(Z.toOption)(this.state.element.elementCss.background.matchWith(function(e){return e},function(){return new z.ElementBackground})).map(function(t){return e(t)})}}})}},{key:"updateBackgroundImage",value:function(e){var t=this.updateBackground(function(t){return Te(t,{file:{fileId:{$set:e}}})});this.props.dispatch(Object(Y.I)(t)),this.setState(Te(this.state,{element:{$set:t}}))}},{key:"onFileDialogOpen",value:function(){var e=this;this.props.organisationId.foreach(function(t){var n=void 0,r=e.props.openDialog(e.props.i18n.t("Файлы"),g.createElement(wn.a,{organisationId:t,excludedFolders:[].concat(jn()(z.FileTypes.map(function(e){return Object(In.b)(e.$Type.value)}))),initialFolder:Object(Z.toOption)("free"),onSelectionChange:function(e){Object(Z.headOption)(e).foreach(function(e){n=e})},acceptedFiles:new Z.None,elementId:new Z.None}),[g.createElement(w.a,{variant:"raised",onClick:function(){return e.props.handleDialogClose(r)},style:{marginRight:"10px"}},e.props.i18n.t("Закрыть")),g.createElement(w.a,{variant:"raised",onClick:function(){Object(Z.toOption)(n).foreach(function(t){e.state.element,e.updateBackgroundImage(Object(Z.toOption)(new z.Id(t))),e.props.handleDialogClose(r)})},color:"primary"},e.props.i18n.t("Выбрать"))])})}},{key:"handleBackgroundImageToggled",value:function(){var e=this.updateBackground(function(e){return Te(e,{file:{enabled:{$set:!e.file.enabled}}})});this.props.dispatch(Object(Y.Q)(e)),this.setState(Te(this.state,{element:{$set:e}}))}},{key:"handleBackgroundColorUpdated",value:function(e){var t=this.updateBackground(function(t){return Te(t,{color:{$set:e}})});this.props.dispatch(Object(Y.Q)(t)),this.setState(Te(this.state,{element:{$set:t}}))}},{key:"handleBackgroundImageFileDelete",value:function(e){this.updateBackgroundImage(new Z.None)}},{key:"render",value:function(){var e=this,t=(this.state.element,this.state.element.elementCss.background.getOrElse(function(){return new z.ElementBackground})),n=Object(Z.headOption)(this.props.fileMetas.list.filter(function(e){return e.id.value===t.file.fileId.map(function(e){return e.value}).getOrNull()}));return g.createElement("div",null,!this.props.hideTitle&&g.createElement("h3",null,this.props.i18n.t("Фон")),g.createElement(T.a,{label:this.props.i18n.t("Без заливки"),control:g.createElement(Sr.a,{checked:"transparent"===t.color,onChange:function(t,n){return e.handleBackgroundColorUpdated(n?"transparent":"#fff")}})}),"transparent"!==t.color&&g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement("span",null,this.props.i18n.t("Заливка")),g.createElement(xr.a,{value:t.color,onChange:this.handleBackgroundColorUpdated})),g.createElement(T.a,{label:this.props.i18n.t("Отображать фоновое изображение"),control:g.createElement(Sr.a,{checked:t.file.enabled,onChange:function(t,n){return e.handleBackgroundImageToggled()}})}),t.file.enabled&&g.createElement("div",null,g.createElement("p",null,this.props.i18n.t("Файл фонового изображения")),g.createElement("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},g.createElement("div",{style:{overflowX:"hidden",wordBreak:"break-word"}},n.map(function(e){return e.entity.originalName}).getOrElse(function(){return e.props.i18n.t("Файл не найден")})),n.map(function(t){return g.createElement(S.a,{onClick:function(){return e.handleBackgroundImageFileDelete(t.id)}},g.createElement(Tr.a,null))}).getOrNull()),g.createElement(w.a,{variant:"raised",onClick:this.onFileDialogOpen},this.props.i18n.t("Выбрать файл"))))}}]),t}(g.Component);Fr=_r([b.autobind,Dr("design:paramtypes",[Object])],Fr);var Mr=Object(y.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas}})(Object(at.a)([function(e){e.element.elementCss.background.flatMap(function(e){return e.file.fileId}).filter(function(e){return""!==e.value}).foreach(function(t){e.dispatch(Object(oe.a)([t]))})}],[function(e,t){Object(Z.isEqual)(e.element.elementCss.background.flatMap(function(e){return e.file.fileId.map(function(e){return e.value})}),t.element.elementCss.background.flatMap(function(e){return e.file.fileId.map(function(e){return e.value})}))||e.element.elementCss.background.flatMap(function(e){return e.file.fileId}).filter(function(e){return""!==e.value}).foreach(function(t){e.dispatch(Object(oe.a)([t]))})}])(Object(lt.a)(Fr))),Wr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Br=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"updateTitleFont",value:function(e){return Te(this.props.element,{elementCss:{fonts:{$set:Object(Z.toOption)(this.props.element.elementCss.fonts.matchWith(function(e){return e},function(){return new z.ElementFonts})).map(function(t){return Te(t,{titleFont:{$set:Object(Z.toOption)(t.titleFont.matchWith(function(e){return e},function(){return new z.ElementFont(z.FontFile.createDefault())})).map(function(t){return e(t)})}})})}}})}},{key:"handleTitleFontColorUpdated",value:function(e){this.props.dispatch(Object(Y.Q)(this.updateTitleFont(function(t){return Te(t,{color:{$set:e}})})))}},{key:"render",value:function(){var e=this.props.element.elementCss.fonts.flatMap(function(e){return e.titleFont});return g.createElement("div",null,g.createElement("h3",null,this.props.i18n.t("Шрифт")),g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement("span",null,this.props.i18n.t("Цвет шрифта заголовка")),g.createElement(xr.a,{value:e.map(function(e){return e.color}).getOrElse(function(){return"#000000"}),onChange:this.handleTitleFontColorUpdated})))}}]),t}(g.Component);Br=Wr([b.autobind],Br);var Lr=Object(y.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,attachments:e.advancedEmailTemplate.present.attachments}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas&&e.advancedEmailTemplate.present.attachments===t.advancedEmailTemplate.present.attachments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas&&e.attachments===t.attachments}})(Object(at.a)([function(e){e.element.elementCss.background.flatMap(function(e){return e.file.fileId}).filter(function(e){return""!==e.value}).foreach(function(t){e.dispatch(Object(oe.a)([t]))})}],[function(e,t){Object(Z.isEqual)(e.element.elementCss.background.flatMap(function(e){return e.file.fileId.map(function(e){return e.value})}),t.element.elementCss.background.flatMap(function(e){return e.file.fileId.map(function(e){return e.value})}))||e.element.elementCss.background.flatMap(function(e){return e.file.fileId}).filter(function(e){return""!==e.value}).foreach(function(t){e.dispatch(Object(oe.a)([t]))})}])(Object(lt.a)(Br))),Ar=n(329),$r=n.n(Ar),Vr=n(331),qr=n.n(Vr),Nr=n(272),zr=n.n(Nr),Hr=n(330),Ur=n.n(Hr),Kr=n(105),Gr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Yr=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{align:{$set:Object(Z.toOption)(this.props.element.elementCss.align.matchWith(function(e){return e},function(){return new z.ElementAlign(new Z.None)})).map(function(t){return Te(t,{justifySelf:{$set:Object(Z.toOption)(e).filter(function(e){return"none"!==e})}})})}}})))}},{key:"render",value:function(){var e=this;return g.createElement("div",null,!this.props.hideTitle&&g.createElement("h3",null,this.props.i18n.t("Выравнивание")),g.createElement(S.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("left")}},g.createElement(zr.a,null)),g.createElement(S.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("center")}},g.createElement($r.a,null)),g.createElement(S.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("right")}},g.createElement(Ur.a,null)),g.createElement(S.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("none")}},g.createElement(qr.a,null)))}}]),t}(g.Component);Yr=Gr([b.autobind],Yr);var Jr=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(Kr.a)(Yr)),Qr=n(429),Xr=n(680),Zr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},eo=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"handleTopBorderThicknessChange",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(Z.toOption)(Te(t,{top:{$set:e}}))},function(){return Object(Z.toOption)(ie.a)})}}})))}},{key:"handleRightBorderThicknessChange",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(Z.toOption)(Te(t,{right:{$set:e}}))},function(){return Object(Z.toOption)(ie.a)})}}})))}},{key:"handleBottomBorderThicknessChange",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(Z.toOption)(Te(t,{bottom:{$set:e}}))},function(){return Object(Z.toOption)(ie.a)})}}})))}},{key:"handleLeftBorderThicknessChange",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(Z.toOption)(Te(t,{left:{$set:e}}))},function(){return Object(Z.toOption)(ie.a)})}}})))}},{key:"handleElementBorderTypeChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(Z.toOption)(Te(t,{borderType:{$set:Object(ae.w)(e.target.value)}}))},function(){return Object(Z.toOption)(ie.a)})}}})))}},{key:"handleElementBorderColorChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(Z.toOption)(Te(t,{color:{$set:Object(Z.toOption)(e)}}))},function(){return Object(Z.toOption)(ie.a)})}}})))}},{key:"handleWebPageDividerElementTypeChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{type:{$set:Object(ae.E)(e.target.value)}})))}},{key:"handleLabelChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{type:{label:{$set:Object(Z.toOption)(e.target.value)}}})))}},{key:"handleLabelColorChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{type:{labelFont:{$set:Object(Z.toOption)(this.props.element.type.labelFont.map(function(t){return Te(t,{color:{$set:e}})}).getOrElse(function(){return new z.ElementFont(z.FontFile.createDefault(),16,!1,e)}))}}})))}},{key:"handleLabelStyleChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{type:{labelFont:{$set:Object(Z.toOption)(this.props.element.type.labelFont.map(function(t){return Te(t,{fontFace:{$set:Object(Z.toOption)(t.fontFace.map(function(t){return Te(t,{fontStyle:{$set:e.target.value}})}).getOrElse(function(){return new z.ElementFontFace("",e.target.value,"")}))}})}).getOrElse(function(){return new z.ElementFont(z.FontFile.createDefault(),16,!1,"#000",new z.ElementHorizontalAlignmentLeft,new z.ElementVerticalAlignmentMiddle,Object(Z.toOption)(new z.ElementFontFace("",e.target.value,"")))}))}}})))}},{key:"handleLabelWeightChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{type:{labelFont:{$set:Object(Z.toOption)(this.props.element.type.labelFont.map(function(t){return Te(t,{fontFace:{$set:Object(Z.toOption)(t.fontFace.map(function(t){return Te(t,{fontWeight:{$set:e.target.value}})}).getOrElse(function(){return new z.ElementFontFace("","",e.target.value)}))}})}).getOrElse(function(){return new z.ElementFont(z.FontFile.createDefault(),16,!1,"#000",new z.ElementHorizontalAlignmentLeft,new z.ElementVerticalAlignmentMiddle,Object(Z.toOption)(new z.ElementFontFace("","",e.target.value)))}))}}})))}},{key:"renderLabelProperties",value:function(e){return g.createElement(g.Fragment,null,g.createElement(ze.a,{fullWidth:!0,label:this.props.i18n.t("Надпись"),value:e.label.getOrElse(function(){return"label"}),onChange:this.handleLabelChanged}),g.createElement("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center",marginTop:"10px"}},g.createElement(xr.a,{style:{marginLeft:0},value:e.labelFont.map(function(e){return e.color}).getOrElse(function(){return"#000"}),onChange:this.handleLabelColorChanged}),this.props.i18n.t("Цвет надписи")),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Стиль")),g.createElement(Je.a,{native:!0,value:e.labelFont.flatMap(function(e){return e.fontFace}).map(function(e){return e.fontStyle}).getOrElse(function(){return""}),onChange:this.handleLabelStyleChanged},"   ",g.createElement("option",{value:"empty"}),Qr.a.map(function(e,t){return g.createElement("option",{value:e,key:t},e)}))),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Толщина")),g.createElement(Je.a,{native:!0,value:e.labelFont.flatMap(function(e){return e.fontFace}).map(function(e){return e.fontWeight}).getOrElse(function(){return""}),onChange:this.handleLabelWeightChanged},"   ",g.createElement("option",{value:"empty"}),Qr.b.map(function(e,t){return g.createElement("option",{value:e,key:t},e)}))))}},{key:"handleElementBorderRadiusChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(Z.toOption)(Te(t,{borderRadius:{$set:Object(Z.toOption)(parseInt(e.target.value,10))}}))},function(){return Object(Z.toOption)(ie.a)})}}})))}},{key:"render",value:function(){var e=this,t=Object(Z.toOption)(this.props.element.elementCss),n=Object(ie.e)(t).getOrElse(function(){return ie.a}),r=n.borderRadius.getOrElse(function(){return n.getDefaultBorderRadius()}),o=this.props.element.type;return g.createElement("div",null,!this.props.hideTitle&&g.createElement("h3",null,this.props.i18n.t("Граница")),g.createElement(Xr.a,{top:n.top,right:n.right,bottom:n.bottom,left:n.left,onTopChange:this.handleTopBorderThicknessChange,onRightChange:this.handleRightBorderThicknessChange,onBottomChange:this.handleBottomBorderThicknessChange,onLeftChange:this.handleLeftBorderThicknessChange}),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Тип границы")),g.createElement(Je.a,{onChange:this.handleElementBorderTypeChanged,value:n.borderType.tpe.value},z.ElementBorderTypes.map(function(t){return g.createElement(Xe.a,{key:t.tpe.value,value:t.tpe.value},Object(ae.x)(t.tpe.value,e.props.i18n.t))}))),g.createElement("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center",marginTop:"10px"}},this.props.i18n.t("Цвет границы"),g.createElement(xr.a,{style:{marginLeft:0},value:Object(ie.b)(t).getOrElse(function(){return"#000"}),onChange:this.handleElementBorderColorChanged})),g.createElement(ze.a,{fullWidth:!0,type:"number",label:this.props.i18n.t("Скругление границ"),defaultValue:4,InputProps:{inputProps:{min:0}},value:r,onChange:this.handleElementBorderRadiusChanged}),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Тип центральной части")),g.createElement(Je.a,{onChange:this.handleWebPageDividerElementTypeChanged,value:o.tpe.value},g.createElement(Xe.a,{value:z.WebPageDividerElementSimple.$Type.value},this.props.i18n.t("Простой")),g.createElement(Xe.a,{value:z.WebPageDividerElementWithLabel.$Type.value},this.props.i18n.t("Надпись")))),o instanceof z.WebPageDividerElementWithLabel&&this.renderLabelProperties(o))}}]),t}(g.Component);eo=Zr([b.autobind],eo);var to=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(eo),no=n(54),ro=n.n(no),oo=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},io=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{align:{$set:Object(Z.toOption)(this.props.element.elementCss.align.matchWith(function(e){return e},function(){return new z.ElementAlign(new Z.None)})).map(function(t){return Te(t,{justifyContent:{$set:e}})})}}})))}},{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Горизонтальное")),g.createElement(Je.a,{value:this.props.element.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return""}),onChange:function(t){return e.handleSelfAlignmentValueChanged(t.target.value)}},g.createElement(Xe.a,{value:"left"},g.createElement(ro.a,{primary:this.props.i18n.t("По левому краю")})),g.createElement(Xe.a,{value:"center"},g.createElement(ro.a,{primary:this.props.i18n.t("По центру")})),g.createElement(Xe.a,{value:"right"},g.createElement(ro.a,{primary:this.props.i18n.t("По правому краю")})))))}}]),t}(g.Component);io=oo([b.autobind],io);var ao=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(io),lo=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},uo=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{elementCss:{align:{$set:Object(Z.toOption)(this.props.element.elementCss.align.matchWith(function(e){return e},function(){return new z.ElementAlign(new Z.None,"top")})).map(function(t){return Te(t,{justifyContent:{$set:e}})})}}})))}},{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Вертикальное")),g.createElement(Je.a,{value:this.props.element.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"top"}),onChange:function(t){return e.handleSelfAlignmentValueChanged(t.target.value)}},g.createElement(Xe.a,{value:"top"},g.createElement(ro.a,{primary:this.props.i18n.t("По верху")})),g.createElement(Xe.a,{value:"middle"},g.createElement(ro.a,{primary:this.props.i18n.t("По середине")})),g.createElement(Xe.a,{value:"bottom"},g.createElement(ro.a,{primary:this.props.i18n.t("По низу")})),g.createElement(Xe.a,{value:"baseline"},g.createElement(ro.a,{primary:this.props.i18n.t("По нижней линии текста")})))))}}]),t}(g.Component);uo=lo([b.autobind],uo);var co=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(uo),so=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},po=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{horizontalContentAlignment:{$set:e}})))}},{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Горизонтальное")),g.createElement(Je.a,{value:this.props.element.horizontalContentAlignment,onChange:function(t){return e.handleSelfAlignmentValueChanged(t.target.value)}},g.createElement(Xe.a,{value:"flex-start"},g.createElement(ro.a,{primary:this.props.i18n.t("По левому краю")})),g.createElement(Xe.a,{value:"center"},g.createElement(ro.a,{primary:this.props.i18n.t("По середине")})),g.createElement(Xe.a,{value:"flex-end"},g.createElement(ro.a,{primary:this.props.i18n.t("По правому краю")})))))}}]),t}(g.Component);po=so([b.autobind],po);var fo=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(po),ho=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},mo=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){return g.createElement(g.Fragment,null,g.createElement("h3",null,this.props.i18n.t("Выравнивание содержимого")),this.props.element instanceof z.WebPageRowElement&&g.createElement(co,{element:this.props.element}),this.props.element instanceof z.WebPageRowElement&&g.createElement(fo,{element:this.props.element}),(this.props.element instanceof z.WebPageContentElement||this.props.element instanceof z.WebPageColumnElement)&&g.createElement(ao,{element:this.props.element}))}}]),t}(g.Component);mo=ho([b.autobind],mo);var go=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(mo),yo=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},bo=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"handleColumnWrapChanged",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{columnsWrapping:{$set:e}})))}},{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(T.a,{label:this.props.i18n.t("Переносить колонки"),control:g.createElement(Sr.a,{checked:this.props.element.columnsWrapping,onChange:function(t,n){return e.handleColumnWrapChanged(n)}})}))}}]),t}(g.Component);bo=yo([b.autobind],bo);var vo=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(bo),Oo=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Eo=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){return g.createElement("div",null,(this.props.element instanceof z.WebPageContainerElement||this.props.element instanceof z.WebPageButtonElement)&&g.createElement(Mr,{element:this.props.element,organisationId:this.props.organisationId}),this.props.element instanceof z.WebPageButtonElement&&g.createElement(Lr,{element:this.props.element,organisationId:this.props.organisationId}),g.createElement(gr,{element:this.props.element}),g.createElement(Er,{element:this.props.element}),g.createElement(wr,{element:this.props.element}),(this.props.element instanceof z.WebPageContentElement||this.props.element instanceof z.WebPageRowElement||this.props.element instanceof z.WebPageColumnElement)&&g.createElement(go,{element:this.props.element}),!(this.props.element instanceof z.WebPageRootContainer)&&g.createElement(Jr,{element:this.props.element}),this.props.element instanceof z.WebPageDividerElement&&g.createElement(to,{element:this.props.element}),this.props.element instanceof z.WebPageRowElement&&g.createElement(vo,{element:this.props.element}))}}]),t}(g.Component);Eo=Oo([b.autobind],Eo);var ko=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Eo),jo=n(437),Co=n.n(jo),Ro=n(432),wo=n.n(Ro),Io=n(46),So=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Po=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"isRowSelected",value:function(){return this.props.element.tpe.value===z.WebPageRowElement.$Type.value}},{key:"isColumnSelected",value:function(){return this.props.element.tpe.value===z.WebPageColumnElement.$Type.value}},{key:"handleChildWidthValueChanged",value:function(e,t,n){this.props.dispatch(Object(Y.db)(this.handleChildWidthChanged(e,new Z.Some(""+t+n.valueType))))}},{key:"handleChildWidthValueTypeChanged",value:function(e,t,n){"auto"===t?this.props.dispatch(Object(Y.Q)(this.handleChildWidthChanged(e,new Z.Some(""+t)))):this.props.dispatch(Object(Y.Q)(this.handleChildWidthChanged(e,new Z.Some(""+n.value+t))))}},{key:"handleChildWidthChanged",value:function(e,t){return Te(e,{elementCss:{proportions:{$set:Object(Z.toOption)(this.props.element.elementCss.proportions.matchWith(function(e){return e},function(){return new z.ElementProportions})).map(function(e){return Te(e,{width:{$set:t}})})}}})}},{key:"handleColumnAdded",value:function(){var e=this.props.element.children.length;this.isColumnSelected()&&this.props.onComponentAdded(Object(Z.toOption)(this.props.element.id),z.WebPageRowElement.$Type,e),this.isRowSelected()&&this.props.onComponentAdded(Object(Z.toOption)(this.props.element.id),z.WebPageColumnElement.$Type,e),this.props.dispatch(Object(J.r)())}},{key:"handleColumnDelete",value:function(e){this.props.dispatch(Object(Y.D)(e.id))}},{key:"getSizeValue",value:function(e){return e.flatMap(function(e){var t=/(\d*)(\D*)/.exec(e);return Object(Z.toOption)(t).map(function(e){return{value:e[1],valueType:e[2]}})}).getOrElse(function(){return{value:"150",valueType:"px"}})}},{key:"onSwapActions",value:function(e,t,n){if(void 0!==e[t]&&void 0!==e[n]){var r=t>n?n:t,o=t>n?t:n,i=[].concat(jn()(e.slice(0,r)),[e[o]],jn()(e.slice(r+1,o)),[e[r]],jn()(e.slice(o+1)));this.props.dispatch(Object(Y.Q)(Te(this.props.element,{children:{$set:i}})))}}},{key:"render",value:function(){var e=this;return g.createElement("div",null,Object(U.a)(this.props.element.children,"position").map(function(t,n,r){var o=t.elementCss.proportions.getOrElse(function(){return new z.ElementProportions}),i=e.getSizeValue(o.width);return g.createElement("div",{key:t.id,style:{display:"flex",alignItems:"center"}},g.createElement(ze.a,{style:{width:"30%",marginLeft:10},disabled:"auto"===i.valueType,fullWidth:!0,value:i.value,onChange:function(n){return e.handleChildWidthValueChanged(t,n.target.value,i)},label:e.props.i18n.t("Ширина")}),g.createElement("div",{style:{display:"flex",marginTop:33,marginLeft:15}},g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleChildWidthValueTypeChanged(t,"auto",i)}},"auto"===i.valueType?{color:"primary"}:{},{variant:"auto"===i.valueType?"raised":"text",size:"small"}),e.props.i18n.t("auto"))),g.createElement("div",{style:{marginRight:5}},g.createElement(kr.a,Object.assign({onClick:function(){return e.handleChildWidthValueTypeChanged(t,"px",i)}},"px"===i.valueType?{color:"primary"}:{},{variant:"px"===i.valueType?"raised":"text",size:"small"}),e.props.i18n.t("px"))),g.createElement("div",null,g.createElement(kr.a,Object.assign({onClick:function(){return e.handleChildWidthValueTypeChanged(t,"px",i)}},"%"===i.valueType?{color:"primary"}:{},{variant:"%"===i.valueType?"raised":"text",size:"small"}),e.props.i18n.t("%")))),g.createElement(S.a,{style:Object.assign({},Io.f,{marginTop:33}),onClick:function(){return e.onSwapActions(r,n,n-1)}},g.createElement(Co.a,{style:Io.g})),g.createElement(S.a,{style:Object.assign({},Io.f,{marginTop:33}),onClick:function(){return e.onSwapActions(r,n,n+1)}},g.createElement(wo.a,{style:Io.g})),g.createElement(S.a,{style:Object.assign({},Io.f,{marginTop:33}),onClick:function(){return e.handleColumnDelete(t)}},g.createElement(Tr.a,{style:Io.g})))}),g.createElement(w.a,{variant:"raised",onClick:this.handleColumnAdded},this.isColumnSelected()?this.props.i18n.t("Добавить ряд"):this.props.i18n.t("Добавить колонку")))}}]),t}(g.Component);Po=So([b.autobind],Po);var To=Object(y.connect)(function(e,t){return{i18n:e.i18n}})(Po),xo=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_o=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"isHtmlContentSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===z.WebPageHtmlContentElement.$Type.value}).nonEmpty()}},{key:"isImageSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===z.WebPageImageElement.$Type.value}).nonEmpty()}},{key:"isButtonSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===z.WebPageButtonElement.$Type.value}).nonEmpty()}},{key:"isBlockSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===z.WebPageBlockElement.$Type.value}).nonEmpty()}},{key:"onWebPageEditorAttributesExpandedToogle",value:function(){this.props.dispatch(Object(J.m)(!this.props.expandAttributes))}},{key:"isFormRecordsListSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===z.WebPageFormRecordsListElement.$Type.value}).nonEmpty()}},{key:"render",value:function(){var e=this;return g.createElement(C.a,null,(this.isHtmlContentSelected()||this.isImageSelected()||this.isButtonSelected()||this.isBlockSelected()||this.isFormRecordsListSelected())&&g.createElement("div",null,g.createElement(vt.a,null,g.createElement(mt.a,{expandIcon:g.createElement(jt.a,null)},g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement(Rt.a,{style:{marginRight:15}}),g.createElement(Et.a,null,this.props.i18n.t("Свойства")))),g.createElement(yt.a,null,g.createElement(Et.a,{component:"div",style:{width:"100%"}},this.props.selectedElement.map(function(t){return g.createElement(pr,{element:t,formId:e.props.formId,organisationId:e.props.organisationId})}).getOrNull()))),g.createElement(dt.a,null)),this.props.selectedElement.map(function(t){return g.createElement("div",null,g.createElement(vt.a,{expanded:e.props.expandAttributes},g.createElement(mt.a,{expandIcon:g.createElement(jt.a,{onClick:e.onWebPageEditorAttributesExpandedToogle})},g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement(It.a,{style:{marginRight:15}}),g.createElement(Et.a,null,e.props.i18n.t("Стиль")))),g.createElement(yt.a,null,g.createElement(Et.a,{component:"div",style:{width:"100%"}},g.createElement(ko,{element:t,organisationId:e.props.organisationId})))),g.createElement(dt.a,null))}).getOrNull(),this.props.selectedElement.filter(function(e){return e.tpe.value===z.WebPageRowElement.$Type.value}).map(function(t){return g.createElement("div",null,g.createElement(vt.a,null,g.createElement(mt.a,{expandIcon:g.createElement(jt.a,null)},g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement(Pt.a,{style:{marginRight:15}}),g.createElement(Et.a,null,e.props.i18n.t("Колонки")))),g.createElement(yt.a,null,g.createElement(Et.a,{component:"div",style:{width:"100%"}},g.createElement(To,{element:t,onComponentAdded:e.props.onComponentAdded})))))}).getOrNull(),g.createElement(vt.a,null,g.createElement(mt.a,{expandIcon:g.createElement(jt.a,null)},g.createElement("div",{style:{display:"flex",alignItems:"center"}},g.createElement(Rt.a,{style:{marginRight:15}}),g.createElement(Et.a,null,this.props.i18n.t("Элементы")))),g.createElement(yt.a,null,g.createElement(Et.a,{component:"div",style:{width:"100%"}},g.createElement(Qt,{className:"FormBlockViewport__viewport-actions",onComponentAdded:this.props.onComponentAdded,openComponentAttributes:this.props.openComponentAttributes})))))}}]),t}(g.Component);_o=xo([b.autobind],_o);var Do=Object(y.connect)(function(e,t){return{i18n:e.i18n,selectedElement:e.advancedWebPageEditor.selectedElementId.flatMap(function(t){return Object(Q.b)(e.advancedWebPageBody.present,t)}),expandAttributes:e.advancedWebPageEditor.expandAttributes}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.advancedWebPageEditor.selectedElementId,t.advancedWebPageEditor.selectedElementId)&&Object(Z.isEqual)(e.advancedWebPageBody.present.rootContainerElement,t.advancedWebPageBody.present.rootContainerElement)&&e.advancedWebPageEditor.expandAttributes===t.advancedWebPageEditor.expandAttributes},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.selectedElement,t.selectedElement)&&e.expandAttributes===t.expandAttributes}})(_o),Fo=n(115),Mo=n.n(Fo),Wo=n(1499),Bo=n.n(Wo),Lo=n(1612),Ao=n.n(Lo),$o=n(269),Vo=n(1816),qo=n.n(Vo),No=n(1528),zo=n.n(No),Ho=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Uo=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onMoveUp",value:function(){var e=this;0!==this.props.element.position&&this.props.parentId.foreach(function(t){return e.props.dispatch(Object(Y.E)({sourcePosition:e.props.element.position,targetPosition:e.props.element.position-1,parentId:t}))})}},{key:"onMoveDown",value:function(){var e=this;this.props.parentId.foreach(function(t){return e.props.dispatch(Object(Y.E)({sourcePosition:e.props.element.position,targetPosition:e.props.element.position+1,parentId:t}))})}},{key:"render",value:function(){return g.createElement(g.Fragment,null,g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Переместить вверх")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onMoveUp},g.createElement(qo.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Переместить вниз")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onMoveDown},g.createElement(zo.a,{style:Io.g}))))}}]),t}(g.Component);Uo=Ho([b.autobind],Uo);var Ko=Object(y.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Uo),Go=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Yo=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.htmlContentWidgetRef.foreach(function(e){return e.click()})}},{key:"onContentEdit",value:function(){bn(this.props)}},{key:"onHorizontalAlignment",value:function(e){this.props.openPopover(Object(Zn.toOption)(e.currentTarget),g.createElement($o.b,null,g.createElement(Jr,{element:this.props.component,hideTitle:!0})))}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(ke(this.props.component))}},{key:"onHtmlContentWidgetSettingsClick",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.s)(this.props.component.id));var t=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"}),n=Object(ae.j)(t);this.props.openPopover(Object(Zn.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},g.createElement(Mo.a,{placement:"bottom",title:this.props.i18n.t("Выравнивание текста")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onHorizontalAlignment},g.createElement(n,{style:Io.g}))),g.createElement(Mo.a,{placement:"bottom",title:this.props.i18n.t("Редактирование контента")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onContentEdit},g.createElement(Rn.a,{style:Io.g}))),g.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дублировать")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onDuplicate},g.createElement(Ao.a,{style:Io.g}))),g.createElement(Ko,{element:this.props.component,parentId:this.props.parent})),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Zn.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this;return g.createElement("div",{className:"WebPageEditor-HtmlContentWidget",dangerouslySetInnerHTML:{__html:this.props.getDisplayHtml(this.props.component.content)},onClick:this.onHtmlContentWidgetSettingsClick,ref:function(t){return e.htmlContentWidgetRef=Object(Zn.toOption)(t)}})}}]),t}(g.PureComponent);Yo=Go([b.autobind],Yo);var Jo=Object(y.connect)(function(e,t){return{i18n:e.i18n,parent:Object(Q.c)(e.advancedWebPageBody.present,t.component.id),selectedElementId:e.advancedWebPageEditor.selectedElementId,fields:t.formId.flatMap(function(t){return Object(an.e)(e.fields,t)}).getOrElse(function(){return[]})}})(Object(lt.a)(Object(Kr.a)(Yo))),Qo=n(383),Xo=n.n(Qo),Zo=n(1938),ei=n.n(Zo),ti=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ni=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.buttonWidgetRef.foreach(function(e){return e.click()})}},{key:"onHorizontalAlignment",value:function(e){this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement(Jr,{element:this.props.component,hideTitle:!0}))}},{key:"openInsertLinkPopover",value:function(e){var t=this;this.props.eventLineId.foreach(function(n){t.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:15}},g.createElement(Xn,{eventLineId:n,element:t.props.component,hideTitle:!0})))})}},{key:"openLabelChangePopover",value:function(e){this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:15}},g.createElement($o.b,null,g.createElement(Ln,{element:this.props.component}))))}},{key:"openBackgroundChangePopover",value:function(e){this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:15}},g.createElement($o.b,null,g.createElement(Mr,{element:this.props.component,organisationId:this.props.organisationId,hideTitle:!0}))))}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(ke(this.props.component))}},{key:"onButtonSettingsClick",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.s)(this.props.component.id));var t=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"}),n=Object(ae.j)(t);this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},g.createElement(Mo.a,{placement:"bottom",title:this.props.i18n.t("Выравнивание текста")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onHorizontalAlignment},g.createElement(n,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Вставить ссылку")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.openInsertLinkPopover},g.createElement(Xo.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Редактировать надпись")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.openLabelChangePopover},g.createElement(Rn.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Заливка")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.openBackgroundChangePopover},g.createElement(ei.a,{style:Io.g}))),g.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дублировать")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onDuplicate},g.createElement(Ao.a,{style:Io.g}))),g.createElement(Ko,{element:this.props.component,parentId:this.props.parent})),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this;return g.createElement("div",{style:{textDecoration:"none",textAlign:"center",padding:"8px 16px",border:"0px solid",borderRadius:"3px",color:this.props.component.elementCss.fonts.flatMap(function(e){return e.titleFont.map(function(e){return e.color})}).getOrElse(function(){return"#000000"})},ref:function(t){return e.buttonWidgetRef=Object(Z.toOption)(t)},onClick:this.onButtonSettingsClick},Object(Z.toOption)(this.props.component.label).filter(function(e){return""!==e}).getOrElse(function(){return e.props.i18n.t("Кнопка")}))}}]),t}(g.PureComponent);ni=ti([b.autobind],ni);var ri=Object(y.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,parent:Object(Q.c)(e.advancedWebPageBody.present,t.component.id),selectedElementId:e.advancedWebPageEditor.selectedElementId,eventLineId:e.eventLine.eventLineId}})(Object(Kr.a)(ni)),oi=n(681),ii=n.n(oi),ai=n(414),li=n.n(ai),ui=n(682),ci=n.n(ui),si=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},pi=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.imageWidgetRef.foreach(function(e){return e.click()})}},{key:"getSrc",value:function(){var e=this;switch(this.props.component.src.tpe.value){case z.WebPageImageSrcExternal.$Type.value:return Object(Z.toOption)(this.props.component.src.src).filter(function(e){return""!==e}).getOrElse(function(){return n(854)});case z.WebPageImageSrcFile.$Type.value:return this.props.authToken.map(function(t){return Object(Z.toOption)(e.props.component.src.file).filter(function(e){return""!==e.value}).map(function(n){return Object(X.b)(t,n,e.props.cdnAddress)}).getOrElse(function(){return n(854)})}).getOrElse(function(){return n(854)});default:return n(854)}}},{key:"onImageHorizontalAlignment",value:function(e){this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement(Jr,{element:this.props.component,hideTitle:!0}))}},{key:"openInsertLinkPopover",value:function(e){var t=this;this.props.eventLineId.foreach(function(n){t.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:15}},g.createElement(Xn,{eventLineId:n,element:t.props.component,hideTitle:!0})))})}},{key:"onWebPageImageSrcChange",value:function(e){this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:15}},g.createElement($o.b,null,g.createElement(Fn,{element:this.props.component,organisationId:this.props.organisationId}))))}},{key:"onImageSizeChange",value:function(e){this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:15}},g.createElement(wr,{element:this.props.component,hideTitle:!0})))}},{key:"onImageRemove",value:function(){var e=this;Object(Z.toOption)(this.props.component).foreach(function(t){return e.props.dispatch(Object(Y.D)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onImageSettingsClick",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.s)(this.props.component.id));var t=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"}),n=Object(ae.j)(t);this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},g.createElement(Mo.a,{placement:"bottom",title:this.props.i18n.t("Выравнивание текста")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onImageHorizontalAlignment},g.createElement(n,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Вставить ссылку")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.openInsertLinkPopover},g.createElement(Xo.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Изменить изображение")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onWebPageImageSrcChange},g.createElement(ii.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Изменить размер")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onImageSizeChange},g.createElement(ci.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Удалить")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onImageRemove},g.createElement(li.a,{style:Io.g}))),g.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),g.createElement(Ko,{element:this.props.component,parentId:this.props.parent})),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=this.props.component.elementCss.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"});return g.createElement("div",null,g.createElement("img",{style:{width:"100%",height:t},src:this.getSrc(),onClick:this.onImageSettingsClick,ref:function(t){return e.imageWidgetRef=Object(Z.toOption)(t)}}))}}]),t}(g.Component);pi=si([b.autobind],pi);var fi=Object(y.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,parent:Object(Q.c)(e.advancedWebPageBody.present,t.component.id),selectedElementId:e.advancedWebPageEditor.selectedElementId,cdnAddress:e.config.cdnAddress,eventLineId:e.eventLine.eventLineId}})(Object(Kr.a)(pi)),di=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},hi=function(e){function t(){l()(this,t);var e=p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.formRecordsListWidgetRef=new Z.None,e}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.formRecordsListWidgetRef.foreach(function(e){return e.click()})}},{key:"onListRemove",value:function(){var e=this;Object(Z.toOption)(this.props.component).foreach(function(t){return e.props.dispatch(Object(Y.D)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onListSettingsClick",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.s)(this.props.component.id));var t=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"});Object(ae.j)(t);this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Удалить")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onListRemove},g.createElement(li.a,{style:Io.g}))),g.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),g.createElement(Ko,{element:this.props.component,parentId:this.props.parent})),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this;return g.createElement("div",{ref:function(t){return e.formRecordsListWidgetRef=Object(Z.toOption)(t)},onClick:this.onListSettingsClick},this.props.i18n.t("Список анкет"))}}]),t}(g.Component);hi=di([b.autobind],hi);var mi=Object(y.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,parent:Object(Q.c)(e.advancedWebPageBody.present,t.component.id),selectedElementId:e.advancedWebPageEditor.selectedElementId,cdnAddress:e.config.cdnAddress,eventLineId:e.eventLine.eventLineId}})(Object(Kr.a)(hi)),gi=n(177),yi=(n(2212),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),bi=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.dividerWidgetRef.foreach(function(e){return e.click()})}},{key:"getLabel",value:function(){return this.props.component.type.label.getOrElse(function(){return""})}},{key:"getLabelStyle",value:function(){return this.props.component.type.labelFont.map(function(e){return{color:e.color,fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""})}}).getOrElse(function(){return{}})}},{key:"onStyleEdit",value:function(){this.props.onComponentUpdate(this.props.parent,this.props.component)}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(ke(this.props.component))}},{key:"onDividerWidgetSettingsClick",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.s)(this.props.component.id)),this.props.openPopover(Object(Zn.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},g.createElement(Mo.a,{placement:"bottom",title:this.props.i18n.t("Редактирование стиля")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onStyleEdit},g.createElement(Rn.a,{style:Io.g}))),g.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дублировать")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onDuplicate},g.createElement(Ao.a,{style:Io.g}))),g.createElement(Ko,{element:this.props.component,parentId:this.props.parent})),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Zn.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=Object(Zn.toOption)(this.props.component.elementCss),n="\n            "+Object(ie.d)(t).getOrElse(function(){return 1})+"px \n            "+Object(ae.g)(Object(ie.c)(t)).getOrElse(function(){return"solid"})+" \n            "+Object(ie.b)(t).getOrElse(function(){return ue.a[600]})+"\n        ";switch(this.props.component.type.tpe.value){case z.WebPageDividerElementWithLabel.$Type.value:return g.createElement("table",{style:{width:"100%",padding:"15px 0 15px 0"},onClick:this.onDividerWidgetSettingsClick,ref:function(t){return e.dividerWidgetRef=Object(Zn.toOption)(t)}},g.createElement("tbody",null,g.createElement("tr",null,g.createElement("td",{style:{borderBottom:n}}),g.createElement("td",{style:Object.assign({},this.getLabelStyle(),{width:"1%",whiteSpace:"nowrap",textAlign:"center",height:"1px",lineHeight:"1px",padding:"0 15px 0 15px"})},this.getLabel()),g.createElement("td",{style:{borderBottom:n}}))));case z.WebPageDividerElementSimple.$Type.value:default:return g.createElement("div",{style:{width:"100%",padding:10,borderBottom:n},onClick:this.onDividerWidgetSettingsClick,ref:function(t){return e.dividerWidgetRef=Object(Zn.toOption)(t)}})}}}]),t}(g.PureComponent);bi=yi([b.autobind],bi);var vi=Object(y.connect)(function(e,t){return{i18n:e.i18n,parent:Object(gi.e)(e.advancedEmailTemplate.present,t.component.id),selectedElementId:e.emailEditor.selectedElementId}})(Object(Kr.a)(bi)),Oi=n(1613),Ei=n.n(Oi),ki=n(1830),ji=n.n(ki),Ci=n(692),Ri=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},wi=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onComponentDelete",value:function(e){e.stopPropagation(),this.props.dispatch(Object(Y.D)(this.props.component.id))}},{key:"onComponentExpanded",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.l)(this.props.component.id))}},{key:"onComponentClosed",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.k)(this.props.component.id))}},{key:"render",value:function(){return g.createElement("div",{style:{display:"flex",height:"56px",backgroundColor:"#fff"}},g.createElement("div",{style:{flex:1,alignSelf:"center",marginLeft:"10px"}}),this.props.expanded?g.createElement(S.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onComponentClosed},g.createElement(ji.a,null)):g.createElement(S.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onComponentExpanded},g.createElement(jt.a,null)),this.props.component.tpe.value!==z.WebPageContentElement.$Type.value&&g.createElement(S.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onComponentDelete},g.createElement(Tr.a,null)))}}]),t}(g.Component);wi=Ri([b.autobind],wi);var Ii=Object(y.connect)(function(e,t){return{expanded:Object(Ci.b)(e.advancedWebPageEditor,t.component.id)}})(wi),Si=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){return g.createElement("div",{className:this.props.className},this.props.expanded?this.props.children:null)}}]),t}(g.Component),Pi=Object(y.connect)(function(e,t){return{expanded:Object(Ci.b)(e.advancedWebPageEditor,t.containerId)||e.advancedWebPageEditor.isWYSIWYG}})(Si),Ti=n(1770),xi=n(1831),_i=(n(2214),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Di=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.rootWidgetContainerRef.foreach(function(e){return e.click()})}},{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(J.s)(e.id))}),this.onRowSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Y.D)(e.id))})}},{key:"getBorderStyle",value:function(){var e=this,t=this.props.component.elementCss.proportions.getOrElse(function(){return new z.ElementProportions});return{borderLeft:t.margin.map(function(e){return 0==e.left}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isLeftPadded?"none":"1px #aaaaaa dashed",borderRight:t.margin.map(function(e){return 0==e.right}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isRightPadded?"none":"1px #aaaaaa dashed",borderTop:t.margin.map(function(e){return 0==e.top}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isTopPadded?"none":"1px #aaaaaa dashed",borderBottom:t.margin.map(function(e){return 0==e.bottom}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isBottomPadded?"none":"1px #aaaaaa dashed"}}},{key:"onSelectChild",value:function(){var e=this;Object(Z.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(J.s)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onRowSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),Object(Z.headOption)(this.props.component.children).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectChild},g.createElement(Ei.a,{style:Io.g})))),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.pageEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"getStyle",value:function(e){return Object.assign({width:"100%",margin:"0 0 0 0",minHeight:"56px",background:e?"lightblue":"inherit"},this.getBorderStyle())}},{key:"render",value:function(){var e=this,t=this.props.pageEditor.draggingElement.map(function(t){return e.props.component.id===t.id}).getOrElse(function(){return!1});return g.createElement(pt.c,{key:Object.keys(this.props.advancedWebPageBody.elementRelations).length,droppableId:this.props.component.id},function(n,r){return g.createElement("div",{onClick:e.onComponentSelected,ref:function(t){e.rootWidgetContainerRef=Object(Z.toOption)(t),n.innerRef(t)},className:e.isSelected(e.props)?"RootWidget__container-selected":"RootWidget__container",style:e.getStyle(r.isDraggingOver)},g.createElement("div",{className:"RootWidget__selection",style:{opacity:t?0:1}},!e.props.pageEditor.isWYSIWYG&&g.createElement(Ii,{component:e.props.component}),g.createElement(Pi,{containerId:e.props.component.id,className:"WebPageRootWidget__container-children"},Object(U.a)(e.props.component.children,"position").map(function(t,n){return g.createElement(pt.b,{key:t.id,draggableId:t.id,index:n},function(r,o){return e.props.createPortal(g.createElement("div",Object.assign({key:t.id,ref:r.innerRef},r.draggableProps,r.dragHandleProps,{style:Object.assign({width:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),height:t.elementCss.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"}),maxWidth:t.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),margin:re(t.elementCss.align.flatMap(function(e){return e.justifySelf}).filter(function(e){return""!==e}).matchWith(function(e){return e},function(){return e.props.component.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"none"})}))},Object(xi.a)(o,r))}),g.createElement("div",{style:{padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"}),boxSizing:"border-box"}},g.createElement(na,{key:t.id,position:t.position,component:t,formId:e.props.formId,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1}))),o.isDragging)})}))))})}}]),t}(g.Component);Di=_i([b.autobind],Di);var Fi=Object(y.connect)(function(e){return{pageEditor:e.advancedWebPageEditor,advancedWebPageBody:e.advancedWebPageBody.present,i18n:e.i18n,auth:e.auth,cdnAddress:e.config.cdnAddress}})(Object(Kr.a)(Object(Ti.a)(Di))),Mi=(n(2216),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Wi=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.rootContainerWidgetContainerRef.foreach(function(e){return e.click()})}},{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(J.s)(e.id))}),this.onRootContainerSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Y.D)(e.id))})}},{key:"getBorderStyle",value:function(){var e=this,t=this.props.component.elementCss.proportions.getOrElse(function(){return new z.ElementProportions});return{borderLeft:t.margin.map(function(e){return 0==e.left}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isLeftPadded?"none":"1px #aaaaaa dashed",borderRight:t.margin.map(function(e){return 0==e.right}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isRightPadded?"none":"1px #aaaaaa dashed",borderTop:t.margin.map(function(e){return 0==e.top}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isTopPadded?"none":"1px #aaaaaa dashed",borderBottom:t.margin.map(function(e){return 0==e.bottom}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isBottomPadded?"none":"1px #aaaaaa dashed"}}},{key:"onSelectChild",value:function(){var e=this;Object(Z.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(J.s)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onRootContainerSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),Object(Z.headOption)(this.props.component.children).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectChild},g.createElement(Ei.a,{style:Io.g})))),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.pageEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=this.props.pageEditor.draggingElement.map(function(t){return e.props.component.id===t.id}).getOrElse(function(){return!1}),n=(this.props.component.elementCss.proportions.getOrElse(function(){return new z.ElementProportions}),new z.ElementBackground);n.file.enabled&&n.file.fileId.flatMap(function(t){return Object(X.a)(e.props.auth,t,e.props.cdnAddress).map(function(e){return'url("'+e+'")'})}).getOrElse(function(){return"none"});return g.createElement("div",{onClick:this.onComponentSelected,ref:function(t){return e.rootContainerWidgetContainerRef=Object(Z.toOption)(t)},className:this.isSelected(this.props)?"RootContainerWidget__container-selected":"RootContainerWidget__container",style:Object.assign({width:"100%",margin:"0 0 0 0",minHeight:"56px"},this.getBorderStyle())},g.createElement("div",{className:"RootContainerWidget__selection",style:{opacity:t?0:1}},!this.props.pageEditor.isWYSIWYG&&g.createElement(Ii,{component:this.props.component}),g.createElement(Pi,{containerId:this.props.component.id,className:"RootContainerWidget__container-children"},Object(U.a)(this.props.component.children,"position").map(function(t,n){return g.createElement("div",{key:t.id,style:{width:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),height:t.elementCss.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"}),maxWidth:t.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),margin:re(t.elementCss.align.flatMap(function(e){return e.justifySelf}).filter(function(e){return""!==e}).matchWith(function(e){return e},function(){return e.props.component.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"none"})}))}},g.createElement("div",{style:{padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"}),boxSizing:"border-box"}},g.createElement(na,{key:t.id,position:t.position,component:t,formId:e.props.formId,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1})))}))))}}]),t}(g.Component);Wi=Mi([b.autobind],Wi);var Bi=Object(y.connect)(function(e){return{pageEditor:e.advancedWebPageEditor,i18n:e.i18n,auth:e.auth,advancedWebPageBody:e.advancedWebPageBody.present,cdnAddress:e.config.cdnAddress}})(Object(Kr.a)(Wi)),Li=(n(2218),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Ai=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(J.s)(e.id))}),this.onRowSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Y.D)(e.id))})}},{key:"getBorderStyle",value:function(){var e=this,t=this.props.component.elementCss.proportions.getOrElse(function(){return new z.ElementProportions});return{borderLeft:t.margin.map(function(e){return 0==e.left}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isLeftPadded?"none":"1px #aaaaaa dashed",borderRight:t.margin.map(function(e){return 0==e.right}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isRightPadded?"none":"1px #aaaaaa dashed",borderTop:t.margin.map(function(e){return 0==e.top}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isTopPadded?"none":"1px #aaaaaa dashed",borderBottom:t.margin.map(function(e){return 0==e.bottom}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isBottomPadded?"none":"1px #aaaaaa dashed"}}},{key:"onSelectChild",value:function(){var e=this;Object(Z.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(J.s)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(ke(this.props.component))}},{key:"onRowSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),Object(Z.headOption)(this.props.component.children).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectChild},g.createElement(Ei.a,{style:Io.g}))),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дублировать")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onDuplicate},g.createElement(Ao.a,{style:Io.g}))),g.createElement(Ko,{element:this.props.component,parentId:Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id)})),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.pageEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=this.props.pageEditor.draggingElement.map(function(t){return e.props.component.id===t.id}).getOrElse(function(){return!1}),n=(this.props.component.elementCss.proportions.getOrElse(function(){return new z.ElementProportions}),new z.ElementBackground),r=(n.file.enabled&&n.file.fileId.flatMap(function(t){return Object(X.a)(e.props.auth,t,e.props.cdnAddress).map(function(e){return'url("'+e+'")'})}).getOrElse(function(){return"none"}),Object(U.a)(this.props.component.children,"position"));return g.createElement("div",{onClick:this.onComponentSelected,className:this.isSelected(this.props)?"RowWidget__container-selected":"RowWidget__container",style:Object.assign({flex:1,overflowX:"auto",margin:"0 0 0 0",minHeight:"56px"},this.getBorderStyle())},g.createElement("div",{className:"RowWidget__selection",style:{opacity:t?0:1}},!this.props.pageEditor.isWYSIWYG&&g.createElement(Ii,{component:this.props.component}),g.createElement(Pi,{containerId:this.props.component.id,className:"WebPageRowWidget__container-children"},g.createElement("div",{style:{width:"100%",justifyContent:this.props.component.horizontalContentAlignment,alignItems:ne(this.props.component),display:"flex"}},r.map(function(t,n){return g.createElement("div",{key:t.id,style:{flex:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),maxWidth:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"})}},g.createElement(na,{key:t.id,position:t.position,component:t,formId:e.props.formId,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1}))})))))}}]),t}(g.Component);Ai=Li([b.autobind],Ai);var $i=Object(y.connect)(function(e){return{pageEditor:e.advancedWebPageEditor,advancedWebPageBody:e.advancedWebPageBody.present,i18n:e.i18n,auth:e.auth,cdnAddress:e.config.cdnAddress}})(Object(Kr.a)(Ai)),Vi=(n(2220),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),qi=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.columWidgetContainerRef.foreach(function(e){return e.click()})}},{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(J.s)(e.id))}),this.onColumnSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Y.D)(e.id))})}},{key:"getBorderStyle",value:function(){var e=this,t=this.props.component.elementCss.proportions.getOrElse(function(){return new z.ElementProportions});return{borderLeft:t.margin.map(function(e){return 0==e.left}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isLeftPadded?"none":"1px #aaaaaa dashed",borderRight:t.margin.map(function(e){return 0==e.right}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isRightPadded?"none":"1px #aaaaaa dashed",borderTop:t.margin.map(function(e){return 0==e.top}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isTopPadded?"none":"1px #aaaaaa dashed",borderBottom:t.margin.map(function(e){return 0==e.bottom}).getOrElse(function(){return 0==e.props.component.getDefaultMargin()})&&!this.props.isBottomPadded?"none":"1px #aaaaaa dashed"}}},{key:"onSelectChild",value:function(){var e=this;Object(Z.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(J.s)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onColumnSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},Object(Q.c)(this.props.advancedWebPageBody,this.props.component.id).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g}))),Object(Z.headOption)(this.props.component.children).nonEmpty()&&g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectChild},g.createElement(Ei.a,{style:Io.g})))),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.pageEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"getStyle",value:function(e){var t=0===this.props.component.children.length;return Object.assign({flex:1,margin:0,minHeight:t?100:56,background:e?"lightblue":"inherit"},this.getBorderStyle())}},{key:"getContainerStyle",value:function(e,t){return{width:e.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),height:e.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"}),maxWidth:e.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),margin:re(e.align.flatMap(function(e){return e.justifySelf}).filter(function(e){return""!==e}).matchWith(function(e){return e},function(){return t.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"none"})}))}}},{key:"render",value:function(){var e=this,t=Object(Z.toOption)(this.props.component).flatMap(function(t){return e.props.pageEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1}),n=this.props.pageEditor.draggingElement.map(function(t){return e.props.component.id===t.id}).getOrElse(function(){return!1});return g.createElement(pt.c,{key:this.props.position,droppableId:this.props.component.id},function(r,o){return g.createElement("div",{onClick:e.onComponentSelected,ref:function(t){e.columWidgetContainerRef=Object(Z.toOption)(t),r.innerRef(t)},className:t?"ColumnWidget__container-selected":"ColumnWidget__container",style:e.getStyle(o.isDraggingOver)},g.createElement("div",{className:"ColumnWidget__selection",style:{opacity:n?0:1}},!e.props.pageEditor.isWYSIWYG&&g.createElement(Ii,{component:e.props.component}),g.createElement(Pi,{containerId:e.props.component.id,className:"ColumnWidget__container-children"},Object(U.a)(e.props.component.children,"position").map(function(t,n){return g.createElement(pt.b,{key:t.id,draggableId:t.id,index:n},function(r,o){return e.props.createPortal(g.createElement("div",Object.assign({key:t.id,ref:r.innerRef},r.draggableProps,r.dragHandleProps,{style:Object.assign({},e.getContainerStyle(t.elementCss,e.props.component.elementCss),Object(xi.a)(o,r))}),g.createElement("div",{style:{padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"}),boxSizing:"border-box"}},g.createElement(na,{key:t.id,position:t.position,component:t,formId:e.props.formId,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1}))),o.isDragging)})}))))})}}]),t}(g.Component);qi=Vi([b.autobind],qi);var Ni=Object(y.connect)(function(e){return{pageEditor:e.advancedWebPageEditor,advancedWebPageBody:e.advancedWebPageBody.present,i18n:e.i18n,auth:e.auth,cdnAddress:e.config.cdnAddress}})(Object(Kr.a)(Object(Ti.a)(qi))),zi=(n(2222),n(2224),n(1496)),Hi=n(1832),Ui=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ki=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Gi=Kn.v4(),Yi=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={blockRendererId:new Z.None,initialValues:{}},n}return d()(t,e),c()(t,[{key:"componentWillMount",value:function(){this.setState(Te(this.state,{blockRendererId:{$set:Object(Z.toOption)(Gi)}}))}},{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.blockWidgetRef.foreach(function(e){return e.click()})}},{key:"onHorizontalAlignment",value:function(e){this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement(Jr,{element:this.props.component,hideTitle:!0}))}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(J.s)(t))})}},{key:"onBlockSettingsClick",value:function(e){e.stopPropagation(),this.props.dispatch(Object(J.s)(this.props.component.id));var t=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"}),n=Object(ae.j)(t);this.props.openPopover(Object(Z.toOption)(e.currentTarget),g.createElement("div",{style:{padding:10}},g.createElement(Mo.a,{placement:"bottom",title:this.props.i18n.t("Выравнивание текста")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onHorizontalAlignment},g.createElement(n,{style:Io.g}))),g.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),g.createElement(Mo.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},g.createElement(S.a,{style:Object.assign({},Io.f,{margin:5}),onClick:this.onSelectParent},g.createElement(Bo.a,{style:Io.g})))),function(){},{top:0,left:0},{horizontal:"right",vertical:"top"})}},{key:"isSelected",value:function(e){return Object(Z.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"renderPlaceholder",value:function(){return g.createElement("div",{style:{padding:10}},this.props.i18n.t("Блок"))}},{key:"render",value:function(){var e=this;return g.createElement("div",{ref:function(t){return e.blockWidgetRef=Object(Z.toOption)(t)},onClick:this.onBlockSettingsClick,style:{border:"1px dotted ".concat(ue.a[600]),borderRadius:5,width:"100%"}},this.state.blockRendererId.map(function(t){return e.props.component.formId.map(function(n){return e.props.component.blockId.map(function(r){return g.createElement(zi.a,{formId:n,blockRendererId:t,rootBlockRendererId:Object(Z.toOption)(t),blockType:z.webRegistrationBlockTypeDisplay,formRecordId:new Z.None,formRecord:new Z.None,blockId:r,initialValues:e.state.initialValues,initialValuesError:!1,getBlockComponent:Hi.a,onSave:function(){return new Promise(function(e,t){return t(new Error("onSave not implemented"))})},onEdit:function(){return new Promise(function(e,t){return t(new Error("onEdit not implemented"))})}})}).getOrElse(function(){return e.renderPlaceholder()})}).getOrElse(function(){return e.renderPlaceholder()})}).getOrNull())}}]),t}(g.PureComponent);Yi=Ui([b.autobind,Ki("design:paramtypes",[Object])],Yi);var Ji,Qi=Object(y.connect)(function(e,t){return{parent:Object(Q.c)(e.advancedWebPageBody.present,t.component.id),selectedElementId:e.advancedWebPageEditor.selectedElementId}})(Object(Kr.a)(Yi)),Xi=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Zi=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ea=(Ji={},i()(Ji,z.WebPageHtmlContentElement.$Type.value,function(e,t){return g.createElement(Jo,{key:t.id,component:t,getDisplayHtml:e.getDisplayHtml,i18n:e.i18n,formId:e.formId,organisationId:e.organisationId})}),i()(Ji,z.WebPageDividerElement.$Type.value,function(e,t){return g.createElement(vi,{key:t.id,component:t,onComponentUpdate:e.onComponentUpdate})}),i()(Ji,z.WebPageFormRecordsListElement.$Type.value,function(e,t){return g.createElement(mi,{key:t.id,component:t,organisationId:e.organisationId})}),i()(Ji,z.WebPageImageElement.$Type.value,function(e,t){return g.createElement(fi,{key:t.id,component:t,organisationId:e.organisationId})}),i()(Ji,z.WebPageButtonElement.$Type.value,function(e,t){return g.createElement(ri,{key:t.id,i18n:e.i18n,component:t,organisationId:e.organisationId})}),i()(Ji,z.WebPageContentElement.$Type.value,function(e,t){return g.createElement(Fi,{key:t.id,component:t,position:t.position,formId:e.formId,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),i()(Ji,z.WebPageRootContainer.$Type.value,function(e,t){return g.createElement(Bi,{key:t.id,component:t,position:0,formId:e.formId,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),i()(Ji,z.WebPageRowElement.$Type.value,function(e,t){return g.createElement($i,{key:t.id,component:t,position:t.position,formId:e.formId,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),i()(Ji,z.WebPageColumnElement.$Type.value,function(e,t){return g.createElement(Ni,{key:t.id,component:t,position:t.position,formId:e.formId,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),i()(Ji,z.WebPageBlockElement.$Type.value,function(e,t){return g.createElement(Qi,{key:t.id,i18n:e.i18n,component:t,organisationId:e.organisationId})}),Ji),ta=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hovered:!1},n}return d()(t,e),c()(t,[{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(J.s)(e.id))})}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(Z.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Y.D)(e.id))})}},{key:"renderComponent",value:function(e){var t=this;return Object(ee.b)(e.tpe.value)(ea).map(function(n){return n(t.props,e)}).getOrElse(function(){return g.createElement("div",null,t.props.i18n.t("Неизвестный тип элемента"))})}},{key:"onMouseEnter",value:function(e){e.stopPropagation(),this.setState(Te(this.state,{hovered:{$set:!0}}))}},{key:"onMouseLeave",value:function(e){e.stopPropagation(),this.setState(Te(this.state,{hovered:{$set:!1}}))}},{key:"render",value:function(){var e=this,t=this.props.component.elementCss.proportions.getOrElse(function(){return new z.ElementProportions}),n=this.props.component.elementCss.background.getOrElse(function(){return new z.ElementBackground("inherit")}),r=this.props.pageEditor.draggingElement.map(function(t){return e.props.component.id===t.id}).getOrElse(function(){return!1}),o=n.file.enabled?n.file.fileId.flatMap(function(t){return Object(X.a)(e.props.auth,t,e.props.cdnAddress).map(function(e){return'url("'+e+'")'})}).getOrElse(function(){return"none"}):"none",i=Object.assign({boxSizing:"border-box",maxWidth:t.maxWidth.getOrElse(function(){return"none"}),minWidth:t.minWidth.getOrElse(function(){return"58px"}),overflowY:"hidden",overflowX:"hidden",width:"100%",backgroundColor:r?"#B3E5FC":n.color,backgroundImage:o,backgroundSize:"cover"},{}),a=Object(Z.toOption)(this.props.component).flatMap(function(t){return e.props.pageEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1});return g.createElement("div",{className:a?"ElementRenderer__container-selected":"ElementRenderer__container",onMouseOver:this.onMouseEnter,onMouseOut:this.onMouseLeave,onClick:this.onComponentSelected,style:i,id:this.props.component.id,key:this.props.component.id},g.createElement("div",{className:"ElementRenderer__container-selection",style:{boxSizing:"border-box",opacity:r?0:1,padding:t.padding.map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultPadding()+"px"})}},this.renderCellBody(a),this.props.component.tpe.value!==z.WebPageContentElement.$Type.value&&this.props.component.tpe.value!==z.WebPageRootContainer.$Type.value&&g.createElement(S.a,{className:"ElementRenderer__button",style:{visibility:this.state.hovered?"visible":"hidden"},onClick:this.onComponentDelete},g.createElement(Tr.a,{style:Io.g}))))}},{key:"renderCellBody",value:function(e){return g.createElement("div",{key:this.props.component.id,style:{display:"flex",flex:"1",justifyContent:(new z.ElementAlign).justifyContent}},this.renderComponent(this.props.component))}}]),t}(g.Component);ta=Xi([b.autobind,Zi("design:paramtypes",[Object])],ta);var na=Object(y.connect)(function(e,t){return{pageEditor:e.advancedWebPageEditor,i18n:e.i18n,auth:e.auth,fields:t.formId.flatMap(function(t){return Object(an.e)(e.fields,t)}).getOrElse(function(){return[]}),organisationId:e.organisation.organisationId,cdnAddress:e.config.cdnAddress}})(Object(lt.a)(ta)),ra=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},oa=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onComponentUnselected",value:function(){this.props.dispatch(Object(J.q)())}},{key:"render",value:function(){var e=this;return g.createElement("div",{onClick:this.onComponentUnselected,style:{flex:1,paddingLeft:"10px",overflowY:"auto"}},g.createElement("div",{style:{border:"1px solid rgb(117, 117, 117)"}},this.props.rootContainerElement.map(function(t){return g.createElement("div",{key:t.id},g.createElement("div",{style:{width:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),maxWidth:t.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return t.getDefaultMargin()+"px"}),boxSizing:"border-box"}},g.createElement(na,{key:t.id,position:0,component:t,formId:e.props.formId,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:!1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1})))}).getOrElse(function(){return g.createElement("div",null)})))}}]),t}(g.Component);oa=ra([b.autobind],oa);var ia=Object(y.connect)(function(e,t){return{i18n:e.i18n,rootContainerElement:e.advancedWebPageBody.present.rootContainerElement}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.advancedWebPageBody.present.rootContainerElement===t.advancedWebPageBody.present.rootContainerElement},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.rootContainerElement===t.rootContainerElement}})(oa),aa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},la=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){return g.createElement("div",null,g.createElement(pn,{element:this.props.element,formId:this.props.formId,organisationId:this.props.organisationId}))}}]),t}(g.Component);la=aa([b.autobind],la);var ua=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(la),ca=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},sa=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){return g.createElement("div",null,g.createElement(Fn,{element:this.props.element,organisationId:this.props.organisationId}))}}]),t}(g.Component);sa=ca([b.autobind],sa);var pa=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(sa),fa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},da=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){var e=this;return g.createElement("div",null,g.createElement(Ln,{element:this.props.element}),g.createElement(Mr,{element:this.props.element,organisationId:this.props.organisationId,hideTitle:!0}),this.props.eventLineId.map(function(t){return g.createElement(Xn,{eventLineId:t,element:e.props.element,hideTitle:!0})}).getOrNull())}}]),t}(g.Component);da=fa([b.autobind],da);var ha=Object(y.connect)(function(e,t){return{i18n:e.i18n,eventLineId:e.eventLine.eventLineId}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(da),ma=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ga=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){return g.createElement("div",null,g.createElement(To,{element:this.props.element,onComponentAdded:this.props.onComponentAdded}))}}]),t}(g.Component);ga=ma([b.autobind],ga);var ya=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(ga),ba=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},va=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){var e=this;return g.createElement("div",null,this.props.element.filter(function(e){return e instanceof z.WebPageFormRecordsListElement}).map(function(t){return g.createElement(Un,{component:t,organisationId:e.props.organisationId,tileTemplateRenderer:function(e,n,r){return g.createElement(gn,{template:e,onChange:n,formId:t.formId,organisationId:r})}})}).getOrNull())}}]),t}(g.Component);va=ba([b.autobind],va);var Oa=Object(y.connect)(function(e,t){return{i18n:e.i18n,element:Object(Q.b)(e.advancedWebPageBody.present,t.elementId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.advancedWebPageBody.present!==t.advancedWebPageBody.present},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.element,t.element)}})(va),Ea=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ka=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){return g.createElement("div",null,g.createElement(to,{element:this.props.element,hideTitle:!0}))}}]),t}(g.Component);ka=Ea([b.autobind],ka);var ja=Object(y.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(ka),Ca=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ra=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onApplicationsSelect",value:function(e){this.props.dispatch(Object(Y.Q)(Te(this.props.element,{apiKey:{$set:Object(Zn.headOption)(this.props.applications.list.filter(function(t){return t.id.value===e.target.value})).map(function(e){return e.entity.apiKey})}})))}},{key:"getAppByApiKey",value:function(){var e=this;return Object(Zn.headOption)(this.props.applications.list.filter(function(t){return e.props.element.apiKey.map(function(e){return e===t.entity.apiKey}).getOrElse(function(){return!1})})).map(function(e){return e.id.value})}},{key:"render",value:function(){return g.createElement("div",null,g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("application|Приложение")),g.createElement(Je.a,{fullWidth:!0,value:this.getAppByApiKey().getOrElse(function(){return""}),onChange:this.onApplicationsSelect},this.props.applications.list.map(function(e){return g.createElement(Xe.a,{key:e.id.value,value:e.id.value},e.entity.name)}))))}}]),t}(g.Component);Ra=Ca([b.autobind],Ra);var wa,Ia=Object(y.connect)(function(e,t){return{i18n:e.i18n,eventLineId:e.eventLine.eventLineId,applications:e.applications}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Ra),Sa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Pa=(wa={},i()(wa,z.WebPageHtmlContentElement.$Type.value,function(e,t){return g.createElement(ua,{element:t,formId:e.props.formId,organisationId:e.props.organisationId})}),i()(wa,z.WebPageRowElement.$Type.value,function(e,t){return g.createElement(ya,{element:t,onComponentAdded:e.props.onComponentAdded})}),i()(wa,z.WebPageImageElement.$Type.value,function(e,t){return g.createElement(pa,{element:t,organisationId:e.props.organisationId})}),i()(wa,z.WebPageButtonElement.$Type.value,function(e,t){return g.createElement(ha,{element:t,organisationId:e.props.organisationId})}),i()(wa,z.WebPageDividerElement.$Type.value,function(e,t){return g.createElement(ja,{element:t})}),i()(wa,z.WebPageBlockElement.$Type.value,function(e,t){return g.createElement(Ia,{element:t})}),i()(wa,z.WebPageFormRecordsListElement.$Type.value,function(e,t){return g.createElement(Oa,{elementId:t.id,organisationId:e.props.organisationId})}),wa),Ta=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"render",value:function(){var e=this;return this.props.element.flatMap(function(t){return Object(ee.b)(t.tpe.value)(Pa).map(function(n){return n(e,t)})}).getOrNull()}}]),t}(g.Component);Ta=Sa([b.autobind],Ta);var xa,_a=Object(y.connect)(function(e,t){return{i18n:e.i18n,element:Object(Q.b)(e.advancedWebPageBody.present,t.elementId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.advancedWebPageBody.present.rootContainerElement,t.advancedWebPageBody.present.rootContainerElement)},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.element,t.element)}})(Ta),Da=n(1895),Fa=n(1919),Ma=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Wa=(xa={},i()(xa,z.WebPageHtmlContentElement.$Type.value,function(e,t){return Te(new z.WebPageHtmlContentElement("<div>"+e.i18n.t("Контент")+"</div>",t),{elementCss:{background:{$set:Object(Z.toOption)(new z.ElementBackground("transparent"))}}})}),i()(xa,z.WebPageRowElement.$Type.value,function(e,t){return Te(new z.WebPageRowElement([Te(new z.WebPageColumnElement([],0),{elementCss:{proportions:{$set:Object(Z.toOption)(new z.ElementProportions(new Z.None,new Z.None,Object(Z.toOption)(new z.ElementMargin(z.WebPageElement.DEFAULT_MARGIN,0,z.WebPageElement.DEFAULT_MARGIN,0))))},align:{$set:Object(Z.toOption)(new z.ElementAlign(new Z.None,"top"))}}})],t),{elementCss:{proportions:{$set:Object(Z.toOption)(new z.ElementProportions(Object(Z.toOption)("100%"),new Z.None,Object(Z.toOption)(new z.ElementMargin(z.WebPageElement.DEFAULT_MARGIN,0,0,0))))}}})}),i()(xa,z.WebPageColumnElement.$Type.value,function(e,t){return Te(new z.WebPageColumnElement([],0),{elementCss:{proportions:{$set:Object(Z.toOption)(new z.ElementProportions(new Z.None,new Z.None,Object(Z.toOption)(new z.ElementMargin(z.WebPageElement.DEFAULT_MARGIN,0,z.WebPageElement.DEFAULT_MARGIN,0))))}}})}),i()(xa,z.WebPageImageElement.$Type.value,function(e,t){return Te(new z.WebPageImageElement(new z.WebPageImageSrcFile(new z.Id("")),"",t),{elementCss:{background:{$set:Object(Z.toOption)(new z.ElementBackground("transparent"))},proportions:{$set:Object(Z.toOption)(new z.ElementProportions(Object(Z.toOption)("100%")))}}})}),i()(xa,z.WebPageButtonElement.$Type.value,function(e,t){return Te(new z.WebPageButtonElement(new z.WebPageButtonHrefExternal(""),"",t),{elementCss:{background:{$set:Object(Z.toOption)(new z.ElementBackground(Io.a))},proportions:{$set:Object(Z.toOption)(new z.ElementProportions(Object(Z.toOption)("100px")))}}})}),i()(xa,z.WebPageDividerElement.$Type.value,function(e,t){return Te(new z.WebPageDividerElement(t),{elementCss:{proportions:{$set:Object(Z.toOption)(new z.ElementProportions(Object(Z.toOption)("100%"),new Z.None,Object(Z.toOption)(new z.ElementMargin(z.WebPageElement.DEFAULT_MARGIN,0,z.WebPageElement.DEFAULT_MARGIN,0))))},border:{$set:Object(Z.toOption)(ie.a)}}})}),i()(xa,z.WebPageBlockElement.$Type.value,function(e,t){return Te(new z.WebPageBlockElement(new Z.None),{elementCss:{proportions:{$set:Object(Z.toOption)(new z.ElementProportions(Object(Z.toOption)("100%")))}}})}),i()(xa,z.WebPageFormRecordsListElement.$Type.value,function(e,t){return Te(new z.WebPageFormRecordsListElement(e.i18n.t("Список"),t,new z.Id(""),new z.Id(""),new z.WebPageFormRecordsListTypeTable([])),{elementCss:{background:{$set:Object(Z.toOption)(new z.ElementBackground("transparent"))}}})}),xa),Ba=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"getWebPageElement",value:function(e,t){var n=this;return Object(ee.b)(e.value)(Wa).map(function(e){return e(n.props,t)}).getOrElse(function(){return new z.WebPageRowElement([],t)})}},{key:"onComponentAdded",value:function(e,t,n){var r=this.getWebPageElement(t,n);this.props.dispatch(Object(Y.H)({parent:e,component:r}))}},{key:"openComponentAttributes",value:function(e,t,n){var r=this.getWebPageElement(t,n);this.props.dispatch(Object(Y.H)({parent:e,component:r})),this.props.dispatch(Object(J.r)()),this.onComponentUpdate(e,r)}},{key:"onComponentUpdate",value:function(e,t){var n=this,r=this.props.openDialog(this.props.i18n.t("Редактирование элемента"),g.createElement(_a,{elementId:t.id,formId:this.props.formId,organisationId:this.props.organisationId,onComponentAdded:this.onComponentAdded}),[g.createElement(w.a,{key:"close",variant:"raised",onClick:function(){return n.props.handleDialogClose(r)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"getDisplayHtml",value:function(e){return Object(Da.a)(e,this.props.fields.getOrElse(function(){return[]}),[],[],this.props.token,this.props.i18n.t,this.props.cdnAddress)}},{key:"addWidgetToScene",value:function(e,t){this.openComponentAttributes(Object(Z.toOption)(t.droppableId),new Z.TypeId(e.draggableId),t.index)}},{key:"relocateElement",value:function(e,t){e.source.droppableId!==Fa.a&&this.props.dispatch(Object(Y.F)({targetId:Object(Z.toOption)(t.droppableId),elementId:e.draggableId,position:t.index}))}},{key:"moveElement",value:function(e,t){e.source.droppableId!==Fa.a&&e.source.index!==t.index&&e.source.droppableId===t.droppableId&&this.props.dispatch(Object(Y.E)({sourcePosition:e.source.index,targetPosition:t.index,parentId:t.droppableId}))}},{key:"onDragEnd",value:function(e){var t=this;Object(Z.toOption)(e.destination).foreach(function(n){Object(Z.toOption)(e.source.droppableId===Fa.a).filter(function(e){return e}).foreach(function(){return t.addWidgetToScene(e,n)}),Object(Z.toOption)(e.source.droppableId!==n.droppableId).filter(function(e){return e}).foreach(function(){return t.relocateElement(e,n)}),t.moveElement(e,n)})}},{key:"render",value:function(){return g.createElement(pt.a,{onDragEnd:this.onDragEnd},g.createElement("div",{style:{display:"flex",flex:1}},g.createElement("div",{style:{width:"270px",overflowY:"auto",boxSizing:"border-box"}},g.createElement(Do,{formId:this.props.formId,organisationId:this.props.organisationId,onComponentAdded:this.onComponentAdded,openComponentAttributes:this.openComponentAttributes})),g.createElement(ia,{formId:this.props.formId,onComponentAdded:this.onComponentAdded,onComponentUpdate:this.onComponentUpdate,getDisplayHtml:this.getDisplayHtml})))}}]),t}(g.Component);Ba=Ma([b.autobind],Ba);var La=Object(y.connect)(function(e,t){return{i18n:e.i18n,token:e.auth.token,cdnAddress:e.config.cdnAddress,fields:t.formId.flatMap(function(t){return Object(an.e)(e.fields,t)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(Z.isEqual)(e.token,t.token)}})(Object(lt.a)(Ba)),Aa=n(174),$a=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Va=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qa=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={htmlBodyParseError:!1},n}return d()(t,e),c()(t,[{key:"getPathValue",value:function(){var e=this;return"https://"+Object(Z.headOption)(this.props.internetDomains.list.filter(function(t){return t.id.value===e.props.fields.domainId.value}).map(function(e){return e.entity.domain})).getOrElse(function(){return""})+"/"+(this.props.fields.path.value||"")}},{key:"onPathChange",value:function(e){var t=new URL(e.target.value);this.props.fields.path.onChange(t.pathname.slice(1))}},{key:"componentWillReceiveProps",value:function(e){e.currentTab!==this.props.currentTab&&e.dispatch(1===e.currentTab?Object(J.o)():Object(J.n)())}},{key:"componentDidMount",value:function(){var e=this;this.props.dispatch(1===this.props.currentTab?Object(J.o)():Object(J.n)()),z.Id.createId(this.props.fields.formId.value).foreach(function(t){e.props.dispatch(Object(Aa.e)(t))})}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(J.n)())}},{key:"handleFilesDrop",value:function(e,t){var n=this;if(0===e.length)throw"There are not files to process";var r=e[e.length-1],o=new FileReader;o.onload=function(e){if(e.target){var r=e.target.result,o=r.indexOf("<body"),i=r.indexOf("</body");if(-1!==o&&-1!==i){var a=(new DOMParser).parseFromString(r,"text/html");n.props.fields.body.onChange(a.body.innerHTML),n.props.handleDialogClose(t)}else n.props.dispatch(Object(xe.h)(n.props.i18n.t("Файл должен содержать открывающий (<body>) и закрывающий </body> тег")))}},o.readAsText(r)}},{key:"onReadFromFileClick",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Редактирование анкеты"),g.createElement(qe,{className:"WebPagesConfigForm__dropzone",onDrop:function(n){return e.handleFilesDrop(n,t)},accept:".html, .txt"},function(t){var n=t.isDragActive;return g.createElement("div",{className:n?"WebPagesConfigForm__dropzone-wrapper":""},g.createElement("div",{className:"WebPagesConfigForm__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),[g.createElement(w.a,{variant:"raised",onClick:function(n){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"renderAdvancedEditor",value:function(){return g.createElement(La,{formId:z.Id.createId(this.props.fields.formId.value),organisationId:this.props.organisation.organisationId})}},{key:"renderSimpleEditor",value:function(){return g.createElement(st,null)}},{key:"onFormIdChange",value:function(e){var t=this;z.Id.createId(e.target.value).foreach(function(e){t.props.dispatch(Object(Aa.e)(e))}),this.props.fields.formId.onChange(e)}},{key:"renderSettings",value:function(){var e=this,t=this.props.fields,n=t.name,r=t.path,o=t.domainId,i=t.title,a=t.appId,l=t.formId;return g.createElement("div",{style:{padding:15}},g.createElement(ze.a,{fullWidth:!0,autoFocus:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Название"),error:n.touched&&n.error,helperText:n.touched&&Object(Z.toOption)(n.error).map(function(e){return e}).getOrNull()}),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Домен")),g.createElement(Je.a,{value:o.value,onChange:o.onChange},this.props.internetDomains.list.filter(function(e){return e.entity.target.tpe.value===z.DomainTargetWebPage.$Type.value}).map(function(e){return g.createElement(Xe.a,{value:e.id.value},e.entity.name)}))),o.value&&g.createElement(ze.a,{fullWidth:!0,value:this.getPathValue(),onChange:this.onPathChange,label:this.props.i18n.t("Путь"),error:r.touched&&r.error,helperText:r.touched&&Object(Z.toOption)(r.error).map(function(e){return e}).getOrNull()}),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("application|Приложение")),g.createElement(Je.a,{value:a.value,onChange:a.onChange},g.createElement("option",null),this.props.applications.list.filter(function(e){return e.entity.appType.tpe.value===z.ApplicationTypeApiKeys.$Type.value}).map(function(e){return g.createElement("option",{value:e.id.value,key:e.id.value},e.entity.name)}))),g.createElement(Ue.a,{fullWidth:!0},g.createElement(Ge.a,null,this.props.i18n.t("Форма")),g.createElement(Je.a,{value:l.value,native:!0,onChange:this.onFormIdChange},g.createElement("option",{value:""}),this.props.eventLines.list.map(function(t){return g.createElement("optgroup",{key:t.id.value,label:t.entity.name},e.props.forms.list.filter(function(e){return e.entity.eventLineId.value===t.id.value}).map(function(e){return g.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)}))}))),g.createElement(ze.a,{fullWidth:!0,value:i.value,onChange:i.onChange,label:this.props.i18n.t("Заголовок"),error:i.touched&&i.error,helperText:i.touched&&Object(Z.toOption)(i.error).map(function(e){return e}).getOrNull()}))}},{key:"renderEditor",value:function(){switch(this.props.fields.editorType.value){case z.WebPageEditorTypeAdvanced.$Type.value:return this.renderAdvancedEditor();case z.WebPageEditorTypeSimple.$Type.value:return this.renderSimpleEditor();default:throw"unknown web page editor type"}}},{key:"renderTabContents",value:function(){switch(this.props.currentTab){case 0:return this.renderSettings();case 1:return g.createElement("div",{style:{display:"flex",flex:1,minHeight:0,padding:"15px 15px 15px 0"}},this.renderEditor());default:throw"throw unknown tab index"}}},{key:"render",value:function(){var e=this;return g.createElement("form",{style:{display:"flex",flexDirection:"column",minHeight:0}},g.createElement(nt.a,{value:this.props.currentTab,onChange:function(t,n){return e.props.onTabChange(n)},indicatorColor:"primary",textColor:"primary",fullWidth:!0},g.createElement(et.a,{value:0,label:this.props.i18n.t("Настройки")}),g.createElement(et.a,{value:1,label:this.props.i18n.t("Html")})),g.createElement(rt.a,{style:{display:"flex",flex:1,minHeight:0}},this.renderTabContents()))}}]),t}(g.Component);qa=$a([b.autobind,Va("design:paramtypes",[Object])],qa);var Na=Object(y.connect)(function(e){return{i18n:e.i18n,internetDomains:e.internetDomains,organisation:e.organisation,applications:e.applications,forms:e.forms,eventLines:e.eventLines}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{withRef:!0})(Object($e.a)(Object(Ve.reduxForm)({form:"webPageEditForm",fields:["name","path","domainId","title","editorType","appId","formId"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.domainId&&0!==e.domainId.trim().length||(n.domainId=t.i18n.t("Обязательное значение")),e.path&&0!==e.path.trim().length||(n.path=t.i18n.t("Пожалуйста, добавьте путь страницы к домену")),n}})(Object(at.a)([function(e){e.organisation.organisationId.foreach(function(t){e.dispatch(Object(ot.b)(t)),e.dispatch(Object(it.e)(t))})}])(Object(lt.a)(qa))))),za=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ha=function(e){function t(){return l()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),c()(t,[{key:"onUndo",value:function(){return this.isWebPageBodyTab()?this.props.dispatch(Object(Y.fb)()):this.isFormTab()?this.props.dispatch(Ae.ActionCreators.undo()):void 0}},{key:"onRedo",value:function(){return this.isWebPageBodyTab()?this.props.dispatch(Object(Y.eb)()):this.isFormTab()?this.props.dispatch(Ae.ActionCreators.redo()):void 0}},{key:"isWebPageBodyTab",value:function(){return 1===this.props.currentTab}},{key:"isFormTab",value:function(){return 0===this.props.currentTab}},{key:"isUndoDisabled",value:function(){return this.isWebPageBodyTab()?0===this.props.undoableWebPageBody.past.length:!!this.isFormTab()&&0===this.props.undoableForm.past.length}},{key:"isRedoDisabled",value:function(){return this.isWebPageBodyTab()?0===this.props.undoableWebPageBody.future.length:!!this.isFormTab()&&0===this.props.undoableForm.future.length}},{key:"render",value:function(){return g.createElement(g.Fragment,null,g.createElement(S.a,{disabled:this.isUndoDisabled(),onClick:this.onUndo},g.createElement(We.a,null)),g.createElement(S.a,{disabled:this.isRedoDisabled(),onClick:this.onRedo},g.createElement(Le.a,null)))}}]),t}(g.Component);Ha=za([b.autobind],Ha);var Ua,Ka=Object(y.connect)(function(e,t){return{i18n:e.i18n,undoableForm:e.undoableForm,undoableWebPageBody:e.advancedWebPageBody}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.undoableForm===t.undoableForm&&e.advancedWebPageBody===t.advancedWebPageBody},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.undoableForm===t.undoableForm&&e.undoableWebPageBody===t.undoableWebPageBody}})(Object($e.a)(Ha)),Ga=n(1943),Ya=n(441),Ja=n.n(Ya),Qa=n(218),Xa=n.n(Qa),Za=n(1594),el=n.n(Za),tl=n(1944),nl=n.n(tl),rl=n(262),ol=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},il=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},al=function e(t,n,r){l()(this,e),this.code=t,this.width=n,this.height=r},ll=[new al("GALAXY_S5",360,640),new al("PIXEL_2",411,731),new al("PIXEL_2_XL",411,823),new al("IPHONE_5_SE",320,568),new al("IPHONE_6_7_8",375,667),new al("IPHONE_6_7_8_PLUS",414,736),new al("IPHONE_X",375,812),new al("IPAD",768,1024),new al("IPAD_PRO",1024,1366)],ul=(Ua={},i()(Ua,"GALAXY_S5","Galaxy S5"),i()(Ua,"PIXEL_2","Pixel 2"),i()(Ua,"PIXEL_2_XL","Pixel 2 XL"),i()(Ua,"IPHONE_5_SE","iPhone 5 SE"),i()(Ua,"IPHONE_6_7_8","iPhone 6/7/8"),i()(Ua,"IPHONE_6_7_8_PLUS","iPhone 6/7/8 Plus"),i()(Ua,"IPHONE_X","iPhone X"),i()(Ua,"IPAD","iPad"),i()(Ua,"IPAD_PRO","iPad Pro"),Ua),cl=function(e){return Object(ee.b)(e.code)(ul).getOrElse(function(){throw"unknown device type"})},sl=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:800,height:600,tempHeight:new Z.None,tempWidth:new Z.None,responsive:!0,device:new Z.None},n}return d()(t,e),c()(t,[{key:"changeScreenSize",value:function(e,t){this.setState(Te(this.state,{width:{$set:e},height:{$set:t}}))}},{key:"onScreenSizeMenuSelect",value:function(e,t,n,r){this.setState(Te(this.state,{width:{$set:e},height:{$set:t},responsive:{$set:n},device:{$set:r}}))}},{key:"openScreenSizeMenu",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[g.createElement(Xe.a,{key:"RESPONSIVE",value:"RESPONSIVE",onClick:function(){return t.onScreenSizeMenuSelect(t.state.width,t.state.height,!0,new Z.None)}},this.props.i18n.t("Responsive"))].concat(ll.map(function(e){return g.createElement(Xe.a,{key:e.code,value:e.code,onClick:function(){return t.onScreenSizeMenuSelect(e.width,e.height,!1,Object(Z.toOption)(e))}},cl(e))})))}},{key:"onRotationChange",value:function(){this.setState(Te(this.state,{width:{$set:this.state.height},height:{$set:this.state.width}}))}},{key:"onWidthChange",value:function(e){/^\d+$/.test(e.target.value)&&this.changeScreenSize(parseInt(e.target.value),this.state.height)}},{key:"onHeightChange",value:function(e){/^\d+$/.test(e.target.value)&&this.changeScreenSize(this.state.height,parseInt(e.target.value))}},{key:"onResizeStart",value:function(e,t,n,r){this.setState(Te(this.state,{tempWidth:{$set:Object(Z.toOption)(this.state.width)},tempHeight:{$set:Object(Z.toOption)(this.state.height)}}))}},{key:"onResizeStop",value:function(e,t,n,r){this.setState(Te(this.state,{width:{$set:this.state.width+r.width},height:{$set:this.state.height+r.height},tempWidth:{$set:new Z.None},tempHeight:{$set:new Z.None}}))}},{key:"onResize",value:function(e,t,n,r){this.setState(Te(this.state,{tempWidth:{$set:Object(Z.toOption)(this.state.width+r.width)},tempHeight:{$set:Object(Z.toOption)(this.state.height+r.height)}}))}},{key:"render",value:function(){var e=this;return g.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"#eeeded"}},g.createElement(Ja.a,{position:"static",style:{flexShrink:0}},g.createElement(Xa.a,null,g.createElement("div",{style:{flex:1,flexDirection:"column",display:"flex"}},g.createElement("div",{style:{alignSelf:"center"}},g.createElement(w.a,{onClick:this.openScreenSizeMenu,color:"inherit"},this.state.responsive?this.props.i18n.t("Responsive"):this.state.device.map(function(e){return cl(e)}).getOrElse(function(){throw"device has not been provided"}),g.createElement(wo.a,null)),g.createElement(ze.a,{disabled:!this.state.responsive,value:this.state.tempWidth.getOrElse(function(){return e.state.width}),onChange:this.onWidthChange,style:{marginRight:"5px",width:"50px",color:"inherit"},InputProps:{style:{color:"inherit"}},inputProps:{style:{textAlign:"center",color:"inherit"}}}),g.createElement("div",{style:{marginTop:"20px",display:"inline-flex"}},g.createElement("span",{style:{verticalAlign:"baseline"}},"x")),g.createElement(ze.a,{disabled:!this.state.responsive,value:this.state.tempHeight.getOrElse(function(){return e.state.height}),onChange:this.onHeightChange,style:{marginLeft:"5px",width:"50px",color:"inherit"},InputProps:{style:{color:"inherit"}},inputProps:{style:{textAlign:"center",color:"inherit"}}}),g.createElement(S.a,{color:"inherit",onClick:this.onRotationChange,style:{marginLeft:"10px"}},g.createElement(nl.a,null)))),g.createElement(S.a,{color:"inherit",onClick:this.props.handleClose,style:{flexShrink:0}},g.createElement(el.a,null)))),g.createElement("div",{style:{overflow:"auto",minHeight:0}},g.createElement(Ga.a,{style:{margin:"20px auto"},enable:{top:this.state.responsive,left:this.state.responsive,right:this.state.responsive,bottom:this.state.responsive,topLeft:this.state.responsive,topRight:this.state.responsive,bottomLeft:this.state.responsive,bottomRight:this.state.responsive},onResize:this.onResize,onResizeStart:this.onResizeStart,onResizeStop:this.onResizeStop,resizeRatioX:2,resizeRatioY:1,size:{width:this.state.tempWidth.getOrElse(function(){return e.state.width}),height:this.state.tempHeight.getOrElse(function(){return e.state.height})}},g.createElement(C.a,{style:{width:"100%",height:"100%"}},g.createElement("iframe",{width:"100%",height:"100%",frameBorder:0,srcDoc:this.props.isAdvancedEditorType?this.props.dispatch(Oe("",this.props.appId)):this.props.html.getOrElse(function(){return""})})))))}}]),t}(g.Component);sl=ol([b.autobind,il("design:paramtypes",[Object])],sl);var pl=Object(y.connect)(function(e,t){return{i18n:e.i18n,html:e.simpleWebPageBody.present.html,token:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(rl.a)(sl)),fl=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dl=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hl=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(Re.a.screenInitialState(),{savedValues:new Z.None,initialFormValues:new Z.None,autoSave:!0,openPreviewDialog:!1})));return n.formInstance=new Z.None,n.interval=new Z.None,n.runAutoSave(),n}return d()(t,e),c()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.webPage.data.foreach(function(t){var n=e.getInitialValues(t);e.setState(Te(e.state,{savedValues:{$set:Object(Z.toOption)({formValues:n,templateRootContainer:e.initAdvancedWebPageBody(t),html:e.initSimpleWebPageBody(t)})},initialFormValues:{$set:Object(Z.toOption)(n)}}))})}},{key:"componentWillReceiveProps",value:function(e){var t=this;!Object(Z.isEqual)(this.props.webPage.data.map(function(e){return e.id.value}),e.webPage.data.map(function(e){return e.id.value}))&&this.state.savedValues.isEmpty()&&e.webPage.data.foreach(function(e){var n=t.getInitialValues(e);t.setState(Te(t.state,{savedValues:{$set:Object(Z.toOption)({formValues:n,templateRootContainer:t.initAdvancedWebPageBody(e),html:t.initSimpleWebPageBody(e)})},initialFormValues:{$set:Object(Z.toOption)(n)}}))}),this.props.params.webPageId!==e.params.webPageId&&e.webPage.data.foreach(function(e){t.setState(Te(t.state,{savedValues:{$set:new Z.None},initialFormValues:{$set:new Z.None}}))})}},{key:"initAdvancedWebPageBody",value:function(e){var t=this;return Object(Z.toOption)(e).filter(function(e){return e.entity.editorType instanceof z.WebPageEditorTypeAdvanced}).map(function(e){var n=e.entity.editorType.state.root;return t.props.dispatch(Object(Y.G)(n)),n})}},{key:"initSimpleWebPageBody",value:function(e){var t=this;return Object(Z.toOption)(e).filter(function(e){return e.entity.editorType instanceof z.WebPageEditorTypeSimple}).map(function(e){var n=t.getBody(e.entity.body);return t.props.dispatch(Object(je.f)(n)),n})}},{key:"getFormValues",value:function(){return Object(Z.toOption)(this.props.undoableForm.present.webPageEditForm).flatMap(function(e){return Object(Z.toOption)(Object.keys(e).filter(function(e){return 0!==e.indexOf("_")})).filter(function(e){return e.length>0}).map(function(t){return t.reduce(function(t,n){return Object(Z.toOption)(e[n]).flatMap(function(e){return Object(Z.toOption)(e.value)}).matchWith(function(e){return Te(t,i()({},n,{$set:e}))},function(){return t})},{})})})}},{key:"getTitle",value:function(e){return(new DOMParser).parseFromString(e,"text/html").title}},{key:"getBody",value:function(e){return(new DOMParser).parseFromString(e,"text/html").body.innerHTML}},{key:"runAutoSave",value:function(){var e=this;this.interval=Object(Z.toOption)(setInterval(function(){if(!e.state.savedValues.isEmpty()&&e.state.autoSave){var t=e.getFormValues();e.isValuesChanged()&&t.foreach(function(t){e.setState(Te(e.state,{savedValues:{$set:Object(Z.toOption)({formValues:t,templateRootContainer:e.props.advancedWebPageBody.rootContainerElement,html:e.props.simpleWebPageBody.html})}}),function(){e.saveWebPage(t).then(function(t){e.props.dispatch(Object(_e.d)(t))})})})}},1e3))}},{key:"getInitialValues",value:function(e){return{name:e.entity.name,editorType:e.entity.editorType.tpe.value,domainId:e.entity.domainId.value,appId:e.entity.appId.map(function(e){return e.value}).getOrUndefined(),formId:e.entity.formId.map(function(e){return e.value}).getOrUndefined(),path:e.entity.path,title:this.getTitle(e.entity.body)}}},{key:"getHtmlBody",value:function(e){switch(e.editorType){case z.WebPageEditorTypeAdvanced.$Type.value:return this.props.dispatch(Oe(e.title,z.Id.createId(e.appId)));case z.WebPageEditorTypeSimple.$Type.value:return"<html><head><title>"+e.title+"</title></head><body>"+this.props.simpleWebPageBody.html.getOrElse(function(){return""})+"</body></html>";default:throw"unknown web page editor type"}}},{key:"getEditorType",value:function(e){switch(e.editorType){case z.WebPageEditorTypeAdvanced.$Type.value:return new z.WebPageEditorTypeAdvanced(this.props.advancedWebPageBody.rootContainerElement.matchWith(function(e){return new z.WebPageEditorState(e)},function(){return Object(z.getDefaultEditorState)()}));case z.WebPageEditorTypeSimple.$Type.value:return new z.WebPageEditorTypeSimple;default:throw"unknown web page editor type"}}},{key:"saveWebPage",value:function(e){var t=this;return new Promise(function(n,r){t.props.organisation.data.map(function(o){t.props.webPage.data.matchWith(function(i){Object(_e.e)(Te(i,{entity:{name:{$set:e.name},path:{$set:e.path||""},body:{$set:t.getHtmlBody(e)},editorType:{$set:t.getEditorType(e)},domainId:{$set:z.Id.createId(e.domainId).getOrElse(function(){throw"wrong domain id"})},appId:{$set:z.Id.createId(e.appId)},formId:{$set:z.Id.createId(e.formId)}}})).then(function(e){n(e.id),t.props.dispatch(Object(H.a)(o.id))}).catch(function(e){r(e)})},function(){r(t.props.i18n.t("Ошибка, веб-страница не была загружена"))})}).getOrElse(function(){r("Organisation has not been provided")})})}},{key:"renderNavigation",value:function(){return g.createElement(Ie.a,null)}},{key:"onSave",value:function(e){var t=this;return new Promise(function(n,r){t.saveWebPage(e).then(function(e){t.setState(Te(t.state,{savedValues:{$set:new Z.None}}),function(){n(e),t.props.dispatch(Object(_e.d)(z.Id.createId(t.props.params.webPageId).getOrElse(function(){throw"wrong web page id"}))).then(function(e){t.setState(Te(t.state,{savedValues:{$set:Object(Z.toOption)(t.getInitialValues(e.record))}}))}),t.props.organisation.organisationId.foreach(function(e){t.props.dispatch(Object(H.a)(e))}),t.props.dispatch(Object(xe.h)(t.props.i18n.t("Сохранение успешно завершено"))),t.handleDialogClose(!1)})}).catch(function(e){r(e),t.props.dispatch(Object(xe.h)(t.props.i18n.t("Сохранение завершилось ошибкой")))})})}},{key:"webPageFormRefHandler",value:function(e){this.formInstance=Object(Z.toOption)(e).flatMap(function(e){return Object(Z.toOption)(e.wrappedInstance.ref)})}},{key:"onSaveClick",value:function(){this.formInstance.foreach(function(e){e.submit()})}},{key:"getForm",value:function(e){return g.createElement(Na,{ref:this.webPageFormRefHandler,initialValues:e,onSubmit:this.onSave})}},{key:"renderPagePreviewDialog",value:function(e,t){return g.createElement(B.a,{fullWidth:!0,fullScreen:!0,open:this.state.openPreviewDialog},g.createElement(pl,{handleClose:this.closePreviewDialog,isAdvancedEditorType:e,appId:t}))}},{key:"onWYSIWYGToggled",value:function(){this.props.dispatch(Object(J.p)())}},{key:"onAutoSaveToggled",value:function(){this.setState(Te(this.state,{autoSave:{$set:!this.state.autoSave}}))}},{key:"openPreviewDialog",value:function(){this.setState(Te(this.state,{openPreviewDialog:{$set:!0}}))}},{key:"closePreviewDialog",value:function(){this.setState(Te(this.state,{openPreviewDialog:{$set:!1}}))}},{key:"onGoBackRequested",value:function(){this.props.dispatch(Object(Ce.Qb)())}},{key:"isValuesChanged",value:function(){var e=this;return this.state.savedValues.matchWith(function(t){return!O()(t.formValues,e.getFormValues().getOrElse(function(){return{}}))||!Object(Z.isEqual)(e.props.advancedWebPageBody.rootContainerElement,t.templateRootContainer)||!Object(Z.isEqual)(e.props.simpleWebPageBody.html,t.html)},function(){return!1})}},{key:"render",value:function(){var e=this,t=this.props.webPage.data,n=t.map(function(e){return e.entity.name}).getOrElse(function(){return""}),r=t.filter(function(e){return e.entity.editorType instanceof z.WebPageEditorTypeAdvanced}).nonEmpty(),o=t.flatMap(function(e){return e.entity.appId});return this.renderScreenBody({className:""},g.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:0}},g.createElement(k.a,{when:this.isValuesChanged()},function(t){var n=t.isActive,r=t.onCancel,o=t.onConfirm;return g.createElement(B.a,{fullWidth:!0,open:n},g.createElement(A.a,{style:{borderBottom:"none"}},e.props.i18n.t("Выход из редактора")),g.createElement(V.a,null,e.props.i18n.t("Есть несохраненные изменения. Вы действительно хотите покинуть редактор?")),g.createElement(N.a,{style:{borderTop:"none"}},g.createElement(w.a,{key:"close",variant:"raised",onClick:r,style:{marginRight:"10px"}},e.props.i18n.t("Нет")),",",g.createElement(w.a,{key:"save",variant:"raised",onClick:o,color:"primary"},e.props.i18n.t("Да"))))}),g.createElement(we.a,{title:this.props.i18n.t("Страница")+" "+n,onGoBackRequested:this.onGoBackRequested,rightButtonGroup:[g.createElement("div",null,g.createElement(Ka,null),g.createElement(S.a,{onClick:this.onAutoSaveToggled},this.state.autoSave?g.createElement(D.a,{style:{fill:"#E91E63"}}):g.createElement(D.a,null)),this.props.showWYSIWYGToggle&&r&&g.createElement(T.a,{label:this.props.i18n.t("WYSIWYG"),control:g.createElement(_.a,{checked:this.props.isWYSIWYG,onChange:function(){return e.onWYSIWYGToggled()}})}),this.props.showWYSIWYGToggle&&g.createElement(S.a,{onClick:this.openPreviewDialog},g.createElement(M.a,null)),g.createElement(w.a,{variant:"raised",style:{margin:"0px 15px"},onClick:this.onSaveClick,color:"primary"},this.props.i18n.t("Сохранить")))]}),g.createElement(C.a,{className:"DefaultPage__paper",style:{boxSizing:"border-box"}},this.state.initialFormValues.map(function(t){return e.getForm(t)}).getOrElse(function(){return g.createElement("div",null)})),this.renderPagePreviewDialog(r,o)))}}]),t}(Re.a);hl=fl([b.autobind,dl("design:paramtypes",[Object])],hl);t.default=Object(y.connect)(function(e){return{advancedWebPageBody:e.advancedWebPageBody.present,undoableForm:e.undoableForm,simpleWebPageBody:e.simpleWebPageBody.present,showWYSIWYGToggle:e.advancedWebPageEditor.showWYSIWYGToggle,isWYSIWYG:e.advancedWebPageEditor.isWYSIWYG,i18n:e.i18n,webPage:e.webPage,organisation:e.organisation}})(Object(Pe.a)(Object(Se.a)(function(){},function(e){e.isTokenChecked&&(e.dispatch(Fe(z.Id.createId(e.params.webPageId).getOrElse(function(){throw"wrong web page id"}))),e.dispatch(Object(it.e)(e.organisation.organisationId.getOrElse(function(){throw new Error("Unknown organisation")}))))},function(e,t){e.params.webPageId!==t.params.webPageId&&(e.dispatch(Fe(z.Id.createId(e.params.webPageId).getOrElse(function(){throw"wrong web page id"}))),e.dispatch(Object(it.e)(e.organisation.organisationId.getOrElse(function(){throw new Error("Unknown organisation")})))),e.params.webPageId===t.params.webPageId&&e.isTokenChecked&&!t.isTokenChecked&&e.dispatch(Fe(z.Id.createId(e.params.webPageId).getOrElse(function(){throw"wrong web page id"})))})(hl)))}}]);