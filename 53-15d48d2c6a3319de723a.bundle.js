(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[53],{1462:function(e,t,n){"use strict";var r=n(855);Object.defineProperty(t,"__esModule",{value:!0});var a={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var i=r(n(1464));Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))})},1463:function(e,t,n){"use strict";var r=n(855),a=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(36)),o=a(n(2)),l=(a(n(31)),r(n(1462))),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.breakpoint,r=void 0===n?"sm":n;return(0,l.default)()(function(e){return o.default.createElement(t,(0,i.default)({fullScreen:(0,l.isWidthDown)(r,e.width)},e))})}};t.default=s},1464:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.isWidthDown=t.isWidthUp=void 0;var a=r(n(36)),i=r(n(39)),o=r(n(73)),l=r(n(74)),s=r(n(76)),c=r(n(77)),u=r(n(78)),p=r(n(2)),d=(r(n(31)),r(n(217))),f=r(n(373)),m=(n(61),r(n(539))),h=r(n(263)),v=n(859),g=r(n(860));t.isWidthUp=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?v.keys.indexOf(e)<v.keys.indexOf(t):v.keys.indexOf(e)<=v.keys.indexOf(t)};t.isWidthDown=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?v.keys.indexOf(t)<v.keys.indexOf(e):v.keys.indexOf(t)<=v.keys.indexOf(e)};var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.withTheme,r=void 0!==n&&n,y=e.noSSR,E=void 0!==y&&y,O=e.initialWidth,b=e.resizeInterval,k=void 0===b?166:b,j=function(e){function n(e){var t;return(0,o.default)(this,n),(t=(0,s.default)(this,(0,c.default)(n).call(this,e))).state={width:E?t.getWidth():void 0},"undefined"!=typeof window&&(t.handleResize=(0,f.default)(function(){var e=t.getWidth();e!==t.state.width&&t.setState({width:e})},k)),t}return(0,u.default)(n,e),(0,l.default)(n,[{key:"componentDidMount",value:function(){var e=this.getWidth();e!==this.state.width&&this.setState({width:e})}},{key:"componentWillUnmount",value:function(){this.handleResize.clear()}},{key:"getWidth",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,t=this.props.theme.breakpoints,n=null,r=1;null===n&&r<v.keys.length;){var a=v.keys[r];if(e<t.values[a]){n=v.keys[r-1];break}r+=1}return n=n||"xl"}},{key:"render",value:function(){var e=(0,g.default)({theme:this.props.theme,name:"MuiWithWidth",props:(0,a.default)({},this.props)}),n=e.initialWidth,o=e.theme,l=e.width,s=(0,i.default)(e,["initialWidth","theme","width"]),c=(0,a.default)({width:l||this.state.width||n||O},s);return void 0===c.width?null:(r&&(c.theme=o),p.default.createElement(p.default.Fragment,null,p.default.createElement(t,c),p.default.createElement(d.default,{target:"window",onResize:this.handleResize})))}}]),n}(p.default.Component);return(0,m.default)(j,t),(0,h.default)()(j)}};t.default=y},1465:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.isHorizontal=b,t.getAnchor=k,t.default=t.styles=void 0;var a=r(n(36)),i=r(n(55)),o=r(n(39)),l=r(n(73)),s=r(n(74)),c=r(n(76)),u=r(n(77)),p=r(n(78)),d=r(n(2)),f=(r(n(31)),r(n(47))),m=r(n(625)),h=r(n(38)),v=r(n(858)),g=r(n(93)),y=n(110),E=n(321),O={left:"right",right:"left",top:"down",bottom:"up"};function b(e){return-1!==["left","right"].indexOf(e.anchor)}function k(e){return"rtl"===e.theme.direction&&b(e)?O[e.anchor]:e.anchor}var j=function(e){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:e.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:"none"},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(e.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(e.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(e.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(e.palette.divider)},modal:{}}};t.styles=j;var I=function(e){function t(){var e,n;(0,l.default)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=(0,c.default)(this,(e=(0,u.default)(t)).call.apply(e,[this].concat(a)))).mounted=!1,n}return(0,p.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){var e=this.props,t=(e.anchor,e.BackdropProps),n=e.children,r=e.classes,l=e.className,s=e.elevation,c=e.ModalProps,u=(c=void 0===c?{}:c).BackdropProps,p=(0,o.default)(c,["BackdropProps"]),h=e.onClose,E=e.open,b=e.PaperProps,j=e.SlideProps,I=(e.theme,e.transitionDuration),C=e.variant,F=(0,o.default)(e,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","theme","transitionDuration","variant"]),T=k(this.props),w=d.default.createElement(g.default,(0,a.default)({elevation:"temporary"===C?s:0,square:!0,className:(0,f.default)(r.paper,r["paperAnchor".concat((0,y.capitalize)(T))],(0,i.default)({},r["paperAnchorDocked".concat((0,y.capitalize)(T))],"temporary"!==C))},b),n);if("permanent"===C)return d.default.createElement("div",(0,a.default)({className:(0,f.default)(r.root,r.docked,l)},F),w);var R=d.default.createElement(v.default,(0,a.default)({in:E,direction:O[T],timeout:I,appear:this.mounted},j),w);return"persistent"===C?d.default.createElement("div",(0,a.default)({className:(0,f.default)(r.root,r.docked,l)},F),R):d.default.createElement(m.default,(0,a.default)({BackdropProps:(0,a.default)({},t,u,{transitionDuration:I}),className:(0,f.default)(r.root,r.modal,l),open:E,onClose:h},F,p),R)}}]),t}(d.default.Component);I.defaultProps={anchor:"left",elevation:16,open:!1,transitionDuration:{enter:E.duration.enteringScreen,exit:E.duration.leavingScreen},variant:"temporary"};var C=(0,h.default)(j,{name:"MuiDrawer",flip:!1,withTheme:!0})(I);t.default=C},1473:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var a=r(n(1463))},1474:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var a=r(n(1465))},1476:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(2)),i=(0,r(n(44)).default)(a.default.createElement(a.default.Fragment,null,a.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),a.default.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})),"ArrowBack");t.default=i},1477:function(e,t,n){"use strict";var r=n(17),a=n(21),i=n(6),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(18),d=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Create",{document:e}))}return u()(t,e),t}(p.a),f=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Update",{document:e}))}return u()(t,e),t}(p.a),m=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Delete",{id:e}))}return u()(t,e),t}(p.a),h=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","List",{form:e}))}return u()(t,e),t}(p.a),v=function(e){function t(e,n){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListFormData",{formId:e,formDataId:n}))}return u()(t,e),t}(p.a),g=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListIds",{ids:e}))}return u()(t,e),t}(p.a),y=n(193);n.d(t,"c",function(){return E}),n.d(t,"d",function(){return O}),n.d(t,"e",function(){return b}),n.d(t,"f",function(){return k}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return I});var E=function(e){return function(t){return t(Object(y.q)(e)),r.a.send(new h(e),Object(a.g)()).then(function(n){return t(Object(y.r)({formId:e,documents:n.list})),n}).catch(function(n){throw t(Object(y.p)({formId:e,error:n})),n})}},O=function(e){return function(t){return t(Object(y.k)()),r.a.send(new g(e),Object(a.g)()).then(function(e){return t(Object(y.l)(e.list)),e}).catch(function(e){throw t(Object(y.j)(e)),e})}},b=function(e,t){return function(n){return n(Object(y.n)(t)),r.a.send(new v(e,t),Object(a.g)()).then(function(e){return n(Object(y.o)({formDataId:t,documents:e.list})),e}).catch(function(e){throw n(Object(y.m)({formDataId:t,error:e})),e})}},k=function(e){return r.a.send(new f(e),Object(a.f)())},j=function(e){return r.a.send(new d(e),Object(a.f)())},I=function(e){return r.a.send(new m(e),Object(a.f)())}},1509:function(e,t,n){"use strict";n(244);var r=n(17),a=n(6),i=n.n(a),o=n(7),l=n.n(o),s=n(8),c=n.n(s),u=n(18),p=(function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Export.Config","List",{}))}c()(t,e)}(u.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Export.Config","ListForm",{formId:e}))}c()(t,e)}(u.a),function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Export.Config","ListFormDescriptions",{formId:e}))}return c()(t,e),t}(u.a)),d=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Export.Config","Update",{config:e}))}return c()(t,e),t}(u.a),f=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Export.Config","Create",{config:e}))}return c()(t,e),t}(u.a),m=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Export.Config","Delete",{configId:e}))}return c()(t,e),t}(u.a),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Export.Config","Request",{configId:e}))}return c()(t,e),t}(u.a),v=n(21);n.d(t,"c",function(){return g}),n.d(t,"e",function(){return y}),n.d(t,"d",function(){return E}),n.d(t,"a",function(){return O}),n.d(t,"b",function(){return b});var g=function(e){return r.a.send(new p(e),function(e){return e})},y=function(e){return r.a.send(new d(e),Object(v.f)())},E=function(e){return r.a.send(new h(e),Object(v.e)())},O=function(e){return r.a.send(new f(e),Object(v.f)())},b=function(e){return r.a.send(new m(e),v.d)}},1512:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return l});var r=n(244),a=n(1509),i=n(87),o=function(e){return function(t,n){return t(Object(r.h)({form:e})),a.c(e).then(function(n){return t(Object(r.i)({form:e,resolved:n})),n}).catch(function(n){throw t(Object(r.g)({form:e,error:n})),n})}},l=function(e){return function(t){return t(Object(i.b)(function(e){return!e.exportPipelines.descriptionsFetching&&e.exportPipelines.descriptionsFetching},o(e)))}}},1590:function(e,t,n){"use strict";var r=n(21),a=n(6),i=n.n(a),o=n(7),l=n.n(o),s=n(8),c=n.n(s),u=n(18),p=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","ListByEventLine",{eventLineId:e}))}return c()(t,e),t}(u.a),d=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","Create",{generator:e}))}return c()(t,e),t}(u.a),f=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","Update",{generator:e}))}return c()(t,e),t}(u.a),m=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ValuesGenerators","Delete",{generatorId:e}))}return c()(t,e),t}(u.a),h=n(17),v=n(440);n.d(t,"a",function(){return g}),n.d(t,"d",function(){return y}),n.d(t,"b",function(){return E}),n.d(t,"c",function(){return O});var g=function(e){return h.a.send(new d(e),Object(r.c)())},y=function(e){return h.a.send(new f(e),Object(r.f)())},E=function(e){return h.a.send(new m(e),Object(r.d)())},O=function(e){return function(t){return t(Object(v.e)()),h.a.send(new p(e),Object(r.g)()).then(function(e){return t(Object(v.f)(e.list)),e}).catch(function(e){throw t(Object(v.d)(e)),e})}}},2727:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),i=n(10),o=n.n(i),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),m=n(13),h=n(14),v=n(857),g=n.n(v),y=n(856),E=n.n(y),O=n(3),b=n(627),k=n(1467),j=n(43),I=n.n(j),C=n(142),F=n(19),T=n.n(F),w=n(25),R=n.n(w),D=n(93),A=n.n(D),P=n(86),x=n.n(P),_=n(414),N=n.n(_),S=n(437),B=n.n(S),$=n(432),W=n.n($),L=n(415),M=n(59),Z=n(143),V=n(160),z=n.n(V),H=n(98),G=n.n(H),U=n(107),q=n.n(U),K=n(24),J=n.n(K),Y=n(30),Q=n.n(Y),X=n(26),ee=n.n(X),te=n(75),ne=n.n(te),re=n(376),ae=n.n(re),ie=n(54),oe=n.n(ie),le=n(219),se=n.n(le),ce=n(34),ue=n.n(ce),pe=n(32),de=n.n(pe),fe=n(241),me=n.n(fe),he=n(261),ve=n.n(he),ge=n(242),ye=n.n(ge),Ee=n(243),Oe=n.n(Ee),be=n(72),ke=n.n(be),je=n(1),Ie=n(651),Ce=n(104),Fe=n(127),Te=n(1477),we=n(0),Re=n(1512),De=n(84),Ae=n(176),Pe=n(161),xe=n(137),_e=n(95),Ne=n(103),Se=n(29),Be=n(652),$e=n(442),We=n(50),Le=n(64),Me=n(136),Ze=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Ve=n(3),ze=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"onFieldMapDelete",value:function(e){this.props.onChange(Ve(this.props.fieldMaps,{$splice:[[e,1]]}))}},{key:"onSourceFieldIdChange",value:function(e,t,n){this.props.onChange(Ve(this.props.fieldMaps,{$splice:[[e,1,Ve(t,{source:{$set:new je.Id(n)}})]]}))}},{key:"onDestFieldIdChange",value:function(e,t,n){this.props.onChange(Ve(this.props.fieldMaps,{$splice:[[e,1,Ve(t,{dest:{$set:new je.Id(n)}})]]}))}},{key:"onFieldMapAdd",value:function(){var e=this;Object(we.headOption)(Object(Se.e)(this.props.fields,this.props.sourceFormId).getOrElse(function(){return[]})).flatMap(function(t){return Object(we.headOption)(Object(Se.e)(e.props.fields,e.props.destFormId).getOrElse(function(){return[]})).map(function(e){return new je.ActionCreateBlockParam(t.id,e.id)})}).foreach(function(t){e.props.onChange(Ve(e.props.fieldMaps,{$push:[t]}))})}},{key:"render",value:function(){var e=this;return f.createElement("div",null,f.createElement("p",null,this.props.i18n.t("Параметры")),f.createElement("div",null,this.props.fieldMaps.map(function(t,n){var r=Object(we.headOption)(Object(Se.e)(e.props.fields,e.props.sourceFormId).getOrElse(function(){return[]}).filter(function(e){return e.id.value===t.source.value}));return f.createElement("div",{key:n,style:{display:"flex"}},f.createElement("div",{style:{flex:1}},f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,e.props.i18n.t("Источник")),f.createElement(Q.a,{fullWidth:!0,value:t.source.value,onChange:function(r){return e.onSourceFieldIdChange(n,t,r.target.value)}},Object(Se.e)(e.props.fields,e.props.sourceFormId).getOrElse(function(){return[]}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.value},e.entity.caption)})))),f.createElement("div",{style:{flex:1}},f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,e.props.i18n.t("Приемник")),f.createElement(Q.a,{fullWidth:!0,value:t.dest.value,onChange:function(r){return e.onDestFieldIdChange(n,t,r.target.value)}},Object(Se.e)(e.props.fields,e.props.destFormId).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===r.map(function(e){return e.entity.valueType.tpe.value}).getOrElse(function(){return""})}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.value},e.entity.caption)})))),f.createElement(R.a,{style:{alignSelf:"center",flexShrink:0},onClick:function(){return e.onFieldMapDelete(n)}},f.createElement(ke.a,null)))})),f.createElement("div",null,f.createElement(T.a,{variant:"raised",onClick:this.onFieldMapAdd},this.props.i18n.t("Добавить"))))}}]),t}(f.Component);ze=Ze([m.autobind],ze);var He=Object(h.connect)(function(e){return{i18n:e.i18n,fields:e.fields}})(Object(Me.a)(function(e){e.isTokenChecked&&Object(Se.e)(e.fields,e.destFormId).isEmpty()&&e.dispatch(Object(De.c)(e.destFormId))},function(){},function(e,t){e.destFormId.value!==t.destFormId.value&&Object(Se.e)(e.fields,e.destFormId).isEmpty()&&e.dispatch(Object(De.c)(e.destFormId)),e.destFormId.value===t.destFormId.value&&e.isTokenChecked&&!t.isTokenChecked&&Object(Se.e)(e.fields,e.destFormId).isEmpty()&&e.dispatch(Object(De.c)(e.destFormId))})(ze)),Ge=n(188),Ue=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},qe=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ke=new je.Id(M.v4()),Je=new je.Id(M.v4()),Ye=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={currentDocumentId:new we.None},n}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.fields.documentRecordFilter.value;this.props.dispatch(t instanceof je.Filter?Object(Le.k)({filterId:Ke,filter:t}):Object(Le.k)({filterId:Ke,filter:new je.FilterGroupCondition([],new je.FilterPredicateOr)})),Object(we.toOption)(this.props.fields.creatingFormId.value).foreach(function(t){e.props.dispatch(Object(Ge.b)(new je.Id(t)))})}},{key:"componentWillReceiveProps",value:function(e){this.props.fields.creatingFormId.value!==e.fields.creatingFormId.value&&Object(we.toOption)(e.fields.creatingFormId.value).foreach(function(t){e.dispatch(Object(Ge.b)(new je.Id(t)))})}},{key:"onOperationChange",value:function(e){this.props.fields.operation.onChange(e.target.value)}},{key:"onFieldIdChange",value:function(e){this.props.fields.fieldId.onChange(e.target.value)}},{key:"onArgumentChange",value:function(e){var t=this;Object(We.b)(e.target.value,this.props.fields.argument.value,!1,function(n){return t.props.fields.argument.onChange(e.target.value)})}},{key:"onTypeChange",value:function(e){this.props.fields.type.onChange(e.target.value)}},{key:"onTerminalAddressTypeChange",value:function(e){this.props.fields.terminalAddressType.onChange(e.target.value)}},{key:"onTerminalIdChange",value:function(e){this.props.fields.terminalId.onChange(e.target.value)}},{key:"onMonitorChange",value:function(e){this.props.fields.monitorName.onChange(e.target.value)}},{key:"onFoundAndAllowedBlockIdChange",value:function(e){this.props.fields.foundAndAllowedBlockId.onChange(e.target.value)}},{key:"onFoundNotAllowedBlockIdChange",value:function(e){this.props.fields.foundNotAllowedBlockId.onChange(e.target.value)}},{key:"onFoundAnnuledBlockIdrChange",value:function(e){this.props.fields.foundAnnuledBlockId.onChange(e.target.value)}},{key:"onExportConfigIdChange",value:function(e){this.props.fields.exportConfigId.onChange(e.target.value)}},{key:"onCreatingFormIdChange",value:function(e){""!==e.target.value&&this.props.fields.creatingFormId.onChange(e.target.value)}},{key:"onCreatingBlockIdChange",value:function(e){""!==e.target.value&&this.props.fields.creatingBlockId.onChange(e.target.value)}},{key:"convertDocumentIdToName",value:function(e){var t=this;return Object(we.headOption)(this.props.accessRuleEditForm.formId.flatMap(function(e){return Object(Ie.b)(t.props.documents,e)}).getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.value})).map(function(e){return e.entity.name}).getOrElse(function(){return t.props.i18n.t("Документ не найден")})}},{key:"onCurrentDocumentChange",value:function(e){this.setState({currentDocumentId:new we.Some(new je.Id(e.target.value))})}},{key:"getNumericFields",value:function(){var e=this;return this.props.accessRuleEditForm.formId.map(function(t){return Object(we.liftKey)(e.props.formFields.list,t.value).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===je.ValueTypeNumber.$Type.value})}).getOrElse(function(){return[]})}},{key:"onDocumentDelete",value:function(e){var t=this;Object(xe.b)(this.props.filtersForm,Ke).foreach(function(n){t.props.dispatch(Object(Le.o)({filterId:Ke,parentGroups:[n],predicate:e}))})}},{key:"getDocuments",value:function(){var e=this;return this.props.accessRuleEditForm.formId.flatMap(function(t){return Object(Ie.b)(e.props.documents,t)}).getOrElse(function(){return[]}).filter(function(t){return Object($e.a)(e.props.accessRuleEditForm.documents,t.id)}).filter(function(t){return Object(xe.b)(e.props.filtersForm,Ke).map(function(e){return 0===e.conditions.filter(function(e){return e.value.toString()===t.id.value}).length}).getOrElse(function(){return!0})})}},{key:"isDocumentsFetching",value:function(){var e=this;return this.props.accessRuleEditForm.formId.map(function(t){return Object(Ie.d)(e.props.documents,t)}).getOrElse(function(){return!1})}},{key:"onDocumentAdd",value:function(){var e=this;Object(we.liftKey)(this.props.filtersForm.filter,Ke.value).foreach(function(t){Object(we.headOption)(e.props.forms.list.filter(function(e){return je.FormType.isDocument(e.entity.formType)})).flatMap(function(t){return Object(we.headOption)(Object(Se.e)(e.props.formFields,t.id).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===je.ValueTagDocumentId.$Type.value}).getOrElse(function(){return!1})}))}).foreach(function(n){(e.state.currentDocumentId.nonEmpty()?e.state.currentDocumentId.map(function(e){return e.value}):Object(we.headOption)(e.getDocuments()).map(function(e){return e.id.value})).foreach(function(r){e.props.dispatch(Object(Le.n)({filterId:Ke,parentGroups:[],group:t,predicate:new je.FilterCondition(n.id,new je.FilterExpressionEq,new je.ValueStr(r))}))})})})}},{key:"onDocumentAllAdd",value:function(){var e=this;Object(we.liftKey)(this.props.filtersForm.filter,Ke.value).foreach(function(t){Object(we.headOption)(e.props.forms.list.filter(function(e){return je.FormType.isDocument(e.entity.formType)})).flatMap(function(t){return Object(we.headOption)(Object(Se.e)(e.props.formFields,t.id).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===je.ValueTagDocumentId.$Type.value}).getOrElse(function(){return!1})}))}).foreach(function(n){var r=e.getDocuments();0!==r.length&&e.props.dispatch(Object(Le.p)({filterId:Ke,parentGroups:[],group:t,predicates:r.map(function(e){return new je.FilterCondition(n.id,new je.FilterExpressionEq,new je.ValueStr(e.id.value))})}))})})}},{key:"renderFiltrationSection",value:function(){var e=this,t=this.props.fields.formRecordFilter,n=this.getDocuments();return f.createElement(G.a,null,this.props.accessRuleEditForm.searchArea.map(function(t){return t===je.Barcode.$Type.value&&e.props.accessRuleEditForm.formId.nonEmpty()&&(e.isDocumentsFetching()?f.createElement(z.a,null):f.createElement("div",null,f.createElement(ae.a,null,e.props.i18n.t("Фильтрация по документам")),Object(xe.b)(e.props.filtersForm,Ke).map(function(t){return t.conditions.map(function(t){return f.createElement(q.a,{key:t.value.toString()},f.createElement(oe.a,{primary:e.convertDocumentIdToName(new je.Id(t.value.toString()))}),f.createElement(se.a,null,f.createElement(R.a,{onClick:function(){return e.onDocumentDelete(t)}},f.createElement(ke.a,null))))})}).getOrElse(function(){return[]}),f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0,display:"flex",alignItems:"center"}},f.createElement(de.a,{style:{flex:1}},f.createElement(ue.a,null,e.props.i18n.t("Документ")),f.createElement(Q.a,{value:e.state.currentDocumentId.map(function(e){return e.value}).getOrElse(function(){return Object(we.headOption)(n).map(function(e){return e.id.value}).getOrElse(function(){return""})}),onChange:e.onCurrentDocumentChange},n.map(function(e){return f.createElement(J.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),f.createElement(T.a,{variant:"raised",onClick:e.onDocumentAdd,disabled:0===n.length,style:{marginRight:"5px"}},e.props.i18n.t("Добавить")),f.createElement(T.a,{variant:"raised",onClick:e.onDocumentAllAdd,disabled:0===n.length},e.props.i18n.t("Добавить все")))))}).getOrNull(),f.createElement(ae.a,null,this.props.i18n.t("Фильтрация по данным анкеты")),this.props.accessRuleEditForm.formId.map(function(e){return f.createElement(Pe.a,{formId:e,filterId:Je,initialValue:""===t.value?new we.None:new we.Some(t.value)})}).getOrElse(function(){return f.createElement("p",null,e.props.i18n.t("Сначала выберите форму в правиле"))}))}},{key:"renderTerminalSection",value:function(){var e=this.props.fields.terminalAddressType,t=this.props.fields.terminalId,n=this.props.fields.monitorName;return f.createElement("div",null,f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Выбор терминала")),f.createElement(Q.a,{fullWidth:!0,value:e.value,onChange:this.onTerminalAddressTypeChange},f.createElement(J.a,{value:je.TerminalAddressTerminalSender.$Type.value},this.props.i18n.t("Соответствует источнику")),f.createElement(J.a,{value:je.TerminalAddressTerminalTarget.$Type.value},this.props.i18n.t("Соответствует выбранному")))),e.value===je.TerminalAddressTerminalTarget.$Type.value&&f.createElement(Q.a,{fullWidth:!0,value:t.value,onChange:this.onTerminalIdChange},this.props.terminals.list.map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.value},e.entity.name)})),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Монитор")),f.createElement(Q.a,{value:n.value,onChange:this.onMonitorChange},je.monitors.map(function(e,t){return f.createElement(J.a,{key:t,value:e.name},e.name)}))))}},{key:"render",value:function(){var e=this,t=this.props.fields.name,n=this.props.fields.type,r=this.props.fields.foundAndAllowedBlockId,a=this.props.fields.foundNotAllowedBlockId,i=this.props.fields.foundAnnuledBlockId,o=this.props.fields.operation,l=this.props.fields.argument,s=this.props.fields.fieldId,c=this.props.fields.exportConfigId,u=this.props.fields.creatingFormId,p=this.props.fields.creatingBlockId,d=this.props.fields.actionBlockCreateParams;return f.createElement("form",null,f.createElement(ee.a,{label:this.props.i18n.t("Название"),fullWidth:!0,error:t.touched&&t.error,value:t.value,onChange:t.onChange}),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Тип")),f.createElement(Q.a,{fullWidth:!0,value:n.value,onChange:this.onTypeChange},je.InteractionControlActionTypes.map(function(t,n){return f.createElement(J.a,{key:n,value:t.value},Object(We.i)(t,e.props.i18n.t))}))),n.value===je.AccessMathAction.$Type.value&&f.createElement("div",null,f.createElement("div",{style:{display:"flex"}},f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Поле")),f.createElement(Q.a,{fullWidth:!0,value:s.value,onChange:this.onFieldIdChange},this.getNumericFields().map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.value},e.entity.caption)}))),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,{style:{marginLeft:15}},this.props.i18n.t("Операция")),f.createElement(Q.a,{value:o.value,style:{marginLeft:15},onChange:this.onOperationChange},je.mathOperations.map(function(e,t){return f.createElement(J.a,{key:t,value:e.value},Object(We.d)(e))}))),f.createElement(ee.a,{fullWidth:!0,value:l.value,style:{marginLeft:15},onChange:this.onArgumentChange,label:this.props.i18n.t("Аргумент")})),this.renderFiltrationSection()),n.value===je.AccessTerminalPush.$Type.value&&f.createElement("div",null,this.renderFiltrationSection(),this.renderTerminalSection(),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Анкета найдена, фильтрация пройдена")),f.createElement(Q.a,{fullWidth:!0,value:r.value,onChange:this.onFoundAndAllowedBlockIdChange},this.props.accessRuleEditForm.formId.flatMap(function(t){return Object(Ne.c)(e.props.blocks,t)}).getOrElse(function(){return[]}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.toString()},e.name)}))),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Анкета найдена, фильтрация не пройдена")),f.createElement(Q.a,{fullWidth:!0,value:a.value,onChange:this.onFoundNotAllowedBlockIdChange},this.props.accessRuleEditForm.formId.flatMap(function(t){return Object(Ne.c)(e.props.blocks,t)}).getOrElse(function(){return[]}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.toString()},e.name)}))),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Анкета найдена, документ аннулирован")),f.createElement(Q.a,{fullWidth:!0,value:i.value,onChange:this.onFoundAnnuledBlockIdrChange},this.props.accessRuleEditForm.formId.flatMap(function(t){return Object(Ne.c)(e.props.blocks,t)}).getOrElse(function(){return[]}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.toString()},e.name)})))),n.value===je.AccessResultFormat.$Type.value&&f.createElement("div",null,this.props.accessRuleEditForm.formId.map(function(t){return f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,e.props.i18n.t("Кофигурация экспорта")),f.createElement(Q.a,{fullWidth:!0,value:c.value,onChange:e.onExportConfigIdChange},Object(Be.d)(e.props.exportPipelines,t).getOrElse(function(){return[]}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.toString()},e.name)})))}).getOrElse(function(){return f.createElement("p",null,e.props.i18n.t("Сначала выберите форму в правиле"))}),this.renderFiltrationSection()),n.value===je.InteractionBlockCreate.$Type.value&&f.createElement("div",null,f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Форма")),f.createElement(Q.a,{fullWidth:!0,value:u.value,onChange:this.onCreatingFormIdChange},this.props.forms.list.filter(function(e){return je.FormType.isForm(e.entity.formType)}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.value},e.entity.name)}))),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Блок")),f.createElement(Q.a,{fullWidth:!0,value:p.value,onChange:this.onCreatingBlockIdChange},Object(Ne.c)(this.props.blocks,new je.Id(u.value)).getOrElse(function(){return[]}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.toString()},e.name)}))),this.renderTerminalSection(),Object(we.toOption)(u.value).filter(function(e){return""!==e}).map(function(e){return new je.Id(e)}).map(function(t){return e.props.accessRuleEditForm.formId.map(function(e){return f.createElement(He,{sourceFormId:e,destFormId:t,fieldMaps:""!=d.value?d.value:[],onChange:d.onChange})}).getOrElse(function(){return f.createElement("p",null,e.props.i18n.t("Выберите форму в правиле"))})}).getOrElse(function(){return f.createElement("p",null,e.props.i18n.t("Выберите форму создания"))}),this.renderFiltrationSection()),n.value===je.InteractionLimitCheck.$Type.value&&f.createElement("div",null,f.createElement(ee.a,{label:this.props.i18n.t("Лимит"),fullWidth:!0,error:this.props.fields.limit.touched&&this.props.fields.limit.error,value:this.props.fields.limit.value,onChange:this.props.fields.limit.onChange}),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Условие")),f.createElement(Q.a,{fullWidth:!0,value:this.props.fields.limitExpression.value,onChange:this.props.fields.limitExpression.onChange},f.createElement(J.a,{value:je.FilterExpressionLt.$Type.value},this.props.i18n.t("Меньше")),f.createElement(J.a,{value:je.FilterExpressionGt.$Type.value},this.props.i18n.t("Больше")))),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Проверять значение")),f.createElement(Q.a,{fullWidth:!0,value:this.props.fields.limitMode.value,onChange:this.props.fields.limitMode.onChange},f.createElement(J.a,{value:je.LimitControlModeUpdate.$Type.value},this.props.i18n.t("Только активировать")),f.createElement(J.a,{value:je.LimitControlModeCheckAndUpdate.$Type.value},this.props.i18n.t("Активировать и проверить")),f.createElement(J.a,{value:je.LimitControlModeCheck.$Type.value},this.props.i18n.t("Только проверить")))),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Генератор")),f.createElement(Q.a,{fullWidth:!0,value:this.props.fields.generatorId.value,onChange:this.props.fields.generatorId.onChange},this.props.valuesGenerators.list.map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.value},e.entity.name)}))),f.createElement(ee.a,{label:this.props.i18n.t("Шаг"),fullWidth:!0,type:"number",error:this.props.fields.step.touched&&this.props.fields.step.error,value:this.props.fields.step.value,onChange:this.props.fields.step.onChange}),this.renderFiltrationSection()))}}]),t}(f.Component);Ye=Ue([m.autobind,qe("design:paramtypes",[Object])],Ye);var Qe=Object(h.connect)(function(e){return{i18n:e.i18n,blocks:e.blocks,terminals:e.terminals,accessRuleEditForm:e.accessRuleEditForm,forms:e.forms,filtersForm:e.filtersForm,formFields:e.fields,documents:e.formDocuments,exportPipelines:e.exportPipelines,valuesGenerators:e.valuesGenerators}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(_e.reduxForm)({form:"AccessControlActionForm",fields:["name","type","fieldId","operation","argument","documentRecordFilter","formRecordFilter","terminalAddressType","terminalId","monitorName","foundAndAllowedBlockId","foundNotAllowedBlockId","foundAnnuledBlockId","exportConfigId","creatingFormId","creatingBlockId","actionBlockCreateParams","limit","limitExpression","generatorId","limitMode","step"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.step&&0!==e.step.toString().trim().length||e.type!==je.InteractionLimitCheck.$Type.value||(n.step=t.i18n.t("Обязательное значение")),n}})(Ye)),Xe=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},et=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tt=function(e,t){switch(e.value){case je.TerminalAddressTerminalSender.$Type.value:return new je.TerminalAddressTerminalSender;case je.TerminalAddressTerminalTarget.$Type.value:return new je.TerminalAddressTerminalTarget(new je.Id(t.terminalId));default:throw"Unknown terminal address type"}},nt=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dialog:{open:!1,title:new we.None,body:new we.None,actions:[]}},n}return u()(t,e),o()(t,[{key:"openDialog",value:function(e,t,n){this.setState(O(this.state,{dialog:{open:{$set:!0},title:{$set:new we.Some(e)},body:{$set:new we.Some(t)},actions:{$set:n}}}))}},{key:"handleDialogClose",value:function(){this.setState(O(this.state,{dialog:{open:{$set:!1},title:{$set:new we.None},body:{$set:new we.None},actions:{$set:[]}}}))}},{key:"openActionForm",value:function(e,t,n){var r=this,a=void 0;this.openDialog(e,f.createElement(Qe,{ref:function(e){return a=Object(we.toOption)(e).flatMap(function(e){return Object(we.toOption)(e.wrappedInstance)})},initialValues:n,onSubmit:t}),[f.createElement(T.a,{variant:"raised",onClick:function(){return r.handleDialogClose()},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(T.a,{variant:"raised",onClick:function(){return a.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onActionDelete",value:function(e){this.props.dispatch(Object(Fe.w)(e))}},{key:"onActionEdit",value:function(e,t){var n=this;this.openActionForm(this.props.i18n.t("Редактирование действия"),function(e){return new Promise(function(r,a){try{n.props.dispatch(Object(Fe.v)({idx:t,action:n.getAction(e)})),n.handleDialogClose(),r()}catch(e){a(e)}})},this.getActionInitialValues(e))}},{key:"getActionInitialValues",value:function(e){var t={name:e.name,type:e.tpe.value,step:1};switch(e.tpe.value){case je.AccessTerminalPush.$Type.value:var n=e;switch(t=Object.assign(t,{terminalAddressType:n.terminal.tpe.value,terminalId:n.terminal.tpe.value===je.TerminalAddressTerminalTarget.$Type.value?n.terminal.id.value:"",monitorName:Object(we.headOption)(n.monitor).map(function(e){return e.name}).getOrElse(function(){return""}),documentRecordFilter:n.documentRecordFilter.getOrNull(),formRecordFilter:n.formRecordFilter.getOrNull()}),n.reaction.tpe.value){case je.AccessReactionFound.$Type.value:var r=n.reaction;t=Object.assign(t,{foundAndAllowedBlockId:r.foundAndAllowed.value,foundNotAllowedBlockId:r.foundNotAllowed.value,foundAnnuledBlockId:r.foundAnnuled.value});break;default:throw"Unknown access reaction type"}switch(n.terminal.tpe.value){case je.TerminalAddressTerminalSender.$Type.value:break;case je.TerminalAddressTerminalTarget.$Type.value:t=Object.assign(t,{terminalId:n.terminal.id.value});break;default:throw"Unknown terminal address type"}break;case je.AccessMathAction.$Type.value:var a=e;t=Object.assign(t,{documentRecordFilter:a.documentRecordFilter.getOrNull(),formRecordFilter:a.formRecordFilter.getOrNull(),operation:a.operation.tpe.value,argument:a.argument,fieldId:a.fieldId.value});break;case je.InteractionLimitCheck.$Type.value:var i=e;t=Object.assign(t,{documentRecordFilter:i.documentRecordFilter.getOrNull(),formRecordFilter:i.formRecordFilter.getOrNull(),limit:i.limit,step:i.step,limitExpression:i.expr.tpe.value,generatorId:i.generatorId.value,limitMode:i.mode.tpe.value});break;case je.InteractionBlockCreate.$Type.value:var o=e;t=Object.assign(t,{documentRecordFilter:o.documentRecordFilter.getOrNull(),formRecordFilter:o.formRecordFilter.getOrNull(),creatingFormId:o.formId.value,creatingBlockId:o.blockId.value,actionBlockCreateParams:o.params,terminalAddressType:o.terminal.tpe.value,terminalId:o.terminal.tpe.value===je.TerminalAddressTerminalTarget.$Type.value?o.terminal.id.value:"",monitorName:Object(we.headOption)(o.monitor).map(function(e){return e.name}).getOrElse(function(){return""})});break;case je.AccessResultFormat.$Type.value:var l=e;t=Object.assign(t,{documentRecordFilter:l.documentRecordFilter.getOrNull(),formRecordFilter:l.formRecordFilter.getOrNull(),exportConfigId:l.exportConfig.value});break;default:throw"Unknown action type"}return t}},{key:"getExpression",value:function(e){switch(e.limitExpression){case je.FilterExpressionGt.$Type.value:return new je.FilterExpressionGt;case je.FilterExpressionLt.$Type.value:return new je.FilterExpressionLt;default:throw"unknown expression type"}}},{key:"getAction",value:function(e){switch(e.type){case je.AccessTerminalPush.$Type.value:return new je.AccessTerminalPush(e.name,Object(xe.b)(this.props.filtersForm,Ke),Object(xe.b)(this.props.filtersForm,Je),tt(new we.TypeId(e.terminalAddressType),e),[new je.Monitor(e.monitorName)],new je.AccessReactionFound(new je.Id(e.foundAndAllowedBlockId),new je.Id(e.foundNotAllowedBlockId),new je.Id(e.foundAnnuledBlockId)));case je.AccessMathAction.$Type.value:return new je.AccessMathAction(e.name,new je.Id(e.fieldId),Object(xe.b)(this.props.filtersForm,Ke),Object(xe.b)(this.props.filtersForm,Je),parseFloat(e.argument),Object(We.c)(e.operation));case je.AccessResultFormat.$Type.value:return new je.AccessResultFormat(e.name,new je.Id(e.exportConfigId),Object(xe.b)(this.props.filtersForm,Ke),Object(xe.b)(this.props.filtersForm,Je));case je.InteractionBlockCreate.$Type.value:return new je.InteractionBlockCreate(e.name,new je.Id(e.creatingFormId),Object(xe.b)(this.props.filtersForm,Ke),Object(xe.b)(this.props.filtersForm,Je),new je.Id(e.creatingBlockId),tt(new we.TypeId(e.terminalAddressType),e),[new je.Monitor(e.monitorName)],e.actionBlockCreateParams);case je.InteractionLimitCheck.$Type.value:return new je.InteractionLimitCheck(e.name,new je.Id(e.generatorId),parseInt(e.limit),this.getExpression(e),je.LimitControlMode.valueOf(e.limitMode).getOrElse(function(){return new je.LimitControlModeCheck}),Object(xe.b)(this.props.filtersForm,Ke),Object(xe.b)(this.props.filtersForm,Je),parseInt(e.step));default:throw"Unknown action type"}}},{key:"onActionCreate",value:function(){var e=this;this.openActionForm(this.props.i18n.t("Редактирование действия"),function(t){return new Promise(function(n,r){try{e.props.dispatch(Object(Fe.u)(e.getAction(t))),e.handleDialogClose(),n()}catch(e){r(e)}})},{step:1})}},{key:"render",value:function(){var e=this;return f.createElement("div",null,f.createElement("div",null,this.props.accessRuleEditForm.actions.map(function(t,n){return f.createElement("div",{key:n,style:{display:"flex",alignItems:"center"}},f.createElement("div",{style:{flex:1}},t.name),f.createElement(R.a,{style:{alignSelf:"center",flexShrink:0},onClick:function(){return e.onActionEdit(t,n)}},f.createElement(x.a,null)),f.createElement(R.a,{style:{alignSelf:"center",flexShrink:0},onClick:function(){return e.onActionDelete(n)}},f.createElement(ke.a,null)))})),f.createElement("div",null,f.createElement(T.a,{variant:"raised",onClick:this.onActionCreate},this.props.i18n.t("Добавить"))),f.createElement(me.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose},f.createElement(ve.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),f.createElement(ye.a,null,this.state.dialog.body.getOrElse(function(){return f.createElement("div",null)})),f.createElement(Oe.a,{style:{borderTop:"none"}},this.state.dialog.actions)))}}]),t}(f.Component);nt=Xe([m.autobind,et("design:paramtypes",[Object])],nt);var rt=Object(h.connect)(function(e){return{i18n:e.i18n,accessRuleEditForm:e.accessRuleEditForm,actionConfigs:e.actionConfigs,filtersForm:e.filtersForm}})(Object(Me.a)(function(e){e.isTokenChecked&&e.accessRuleEditForm.formId.foreach(function(t){e.dispatch(Object(Ge.b)(t))})},function(){},function(e,t){e.accessRuleEditForm.formId.map(function(e){return e.value}).getOrNull()!==t.accessRuleEditForm.formId.map(function(e){return e.value}).getOrNull()&&e.isTokenChecked&&e.accessRuleEditForm.formId.foreach(function(t){e.dispatch(Object(Ge.b)(t))}),e.accessRuleEditForm.formId.map(function(e){return e.value}).getOrNull()===t.accessRuleEditForm.formId.map(function(e){return e.value}).getOrNull()&&e.isTokenChecked&&!t.isTokenChecked&&e.accessRuleEditForm.formId.foreach(function(t){e.dispatch(Object(Ge.b)(t))})})(nt)),at=n(68),it=n(1531),ot=n(677),lt=n(165),st=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},ct=new je.Id(M.v4()),ut=0,pt=function(e){function t(){a()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={selectedIndex:ut,dialog:{open:!1,actions:[],title:new we.None,body:new we.None}},e}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.initialValues?(this.props.dispatch(Object(Fe.H)(this.props.initialValues)),this.props.dispatch(Object(Te.c)(this.props.initialValues.formId)),this.props.dispatch(Object(Re.b)(this.props.initialValues.formId)),this.props.dispatch(Object(Ae.h)(this.props.initialValues.formId))):this.props.dispatch(Object(Fe.G)()),this.props.forms.list.filter(function(e){return je.FormType.isDocument(e.entity.formType)}).forEach(function(t){e.props.dispatch(Object(De.c)(t.id))})}},{key:"handleDialogClose",value:function(){this.setState(O(this.state,{dialog:{$set:O(this.state.dialog,{open:{$set:!1}})}}))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.setState(O(this.state,{dialog:{$set:{open:!0,title:new we.Some(e),body:new we.Some(t),actions:n||[]}}}))}},{key:"handleCreateAnBound",value:function(e){Object(Ae.d)(new je.Id(this.props.params.formId))}},{key:"onCreateNewTextField",value:function(){var e=this,t=Object(we.headOption)(this.props.eventLine.data.map(function(t){return Object(Ce.f)(e.props.forms,t.id)}).getOrElse(function(){return[]}).filter(function(e){return je.FormType.isAccessZonePasses(e.entity.formType)})),n={caption:this.props.i18n.t("Проходы"),name:"accessZones",valueTypeTag:je.ValueTagAccessLogRefs.$Type.value};t.foreach(function(e){n=Object.assign({},n,{referenceFamily:e.id.value})});var r={openDialog:this.openDialog,handleDialogClose:this.handleDialogClose,formId:new je.Id(this.props.params.formId),i18n:this.props.i18n,handleCreateAnBound:this.handleCreateAnBound,dispatch:this.props.dispatch,params:this.props.params};this.props.accessRuleEditForm.formId.foreach(function(e){r=Object.assign({},r,{formId:e})}),Object(it.d)(r,n)}},{key:"handleNameChange",value:function(e){this.props.dispatch(Object(Fe.K)(e.target.value))}},{key:"handleTagChange",value:function(e){this.props.dispatch(Object(Fe.M)(e.target.value))}},{key:"handleActiveToggle",value:function(){this.props.dispatch(Object(Fe.x)())}},{key:"handleFormChange",value:function(e){this.props.dispatch(Object(Te.c)(new je.Id(e.target.value))),this.props.dispatch(Object(De.c)(new je.Id(e.target.value))),this.props.dispatch(Object(Fe.F)(new je.Id(e.target.value)))}},{key:"handleSearchAreaChange",value:function(e){this.props.dispatch(Object(Fe.L)(e.target.value))}},{key:"handleCurrentDocumentChange",value:function(e){this.props.dispatch(Object(Fe.y)(new je.Id(e.target.value)))}},{key:"getDocuments",value:function(){var e=this;return this.props.accessRuleEditForm.formId.flatMap(function(t){return Object(Ie.b)(e.props.documents,t)}).getOrElse(function(){return[]})}},{key:"isDocumentsFetching",value:function(){var e=this;return this.props.accessRuleEditForm.formId.map(function(t){return Object(Ie.d)(e.props.documents,t)}).getOrElse(function(){return!0})}},{key:"handleDocumentAdd",value:function(){var e=this;(this.props.accessRuleEditForm.currentDocument.nonEmpty()?this.props.accessRuleEditForm.currentDocument:Object(we.headOption)(this.getDocuments().filter(function(t){return!Object(Z.a)(e.props.accessRuleEditForm.documents.map(function(e){return e.value}),t.id.value)})).map(function(e){return e.id})).foreach(function(t){e.props.dispatch(Object(Fe.A)(t))})}},{key:"handleDocumentAllAdd",value:function(){this.props.dispatch(Object(Fe.C)(this.getDocuments().map(function(e){return e.id})))}},{key:"handleDocumentDelete",value:function(e){this.props.dispatch(Object(Fe.B)(e))}},{key:"handleFieldChange",value:function(e){this.props.dispatch(Object(Fe.D)(new je.Id(e.target.value)))}},{key:"handleTimeRestrictionToggled",value:function(){var e=this;this.props.accessRuleEditForm.timeParam.map(function(t){t.enabled=!t.enabled,e.props.dispatch(Object(Fe.N)(t))}).getOrElse(function(){var t=new Date;t.setSeconds(0);var n=Object(we.toOption)(new je.ValueDate(t.getTime())),r=new je.TimeParam(!0,n,n);e.props.dispatch(Object(Fe.N)(r))})}},{key:"handleTimeRestrictionStartChange",value:function(e){var t=this;this.props.accessRuleEditForm.timeParam.map(function(n){n.start=e.map(function(e){return new je.ValueDate(e)}),t.props.dispatch(Object(Fe.N)(n))})}},{key:"handleTimeRestrictionEndChange",value:function(e){var t=this;this.props.accessRuleEditForm.timeParam.map(function(n){n.end=e.map(function(e){return new je.ValueDate(e)}),t.props.dispatch(Object(Fe.N)(n))})}},{key:"handleDateRestrictionToggle",value:function(){var e=this;this.props.accessRuleEditForm.dateParam.map(function(t){t.enabled=!t.enabled,e.props.dispatch(Object(Fe.z)(t))}).getOrElse(function(){var t=Object(we.toOption)(new je.ValueDate((new Date).getTime())),n=new je.DateParam(!0,!1,t,t);e.props.dispatch(Object(Fe.z)(n))})}},{key:"handleDateRestrictionSingleDayToggle",value:function(){var e=this;this.props.accessRuleEditForm.dateParam.map(function(t){t.singleDay=!t.singleDay,e.props.dispatch(Object(Fe.z)(t))})}},{key:"handleDateRestrictionStartChange",value:function(e){var t=this;this.props.accessRuleEditForm.dateParam.map(function(n){n.start=Object(we.toOption)(new je.ValueDate(Date.parse(e.target.value))),t.props.dispatch(Object(Fe.z)(n))})}},{key:"handleDateRestrictionEndChange",value:function(e){var t=this;this.props.accessRuleEditForm.dateParam.map(function(n){n.end=Object(we.toOption)(new je.ValueDate(Date.parse(e.target.value))),t.props.dispatch(Object(Fe.z)(n))})}},{key:"handleFilterChange",value:function(e){this.props.dispatch(Object(Fe.E)(e))}},{key:"handleLogToggle",value:function(){this.props.dispatch(Object(Fe.J)())}},{key:"handleLogFieldChange",value:function(e){this.props.dispatch(Object(Fe.I)(e))}},{key:"convertDocumentIdToName",value:function(e){var t=this;return Object(we.headOption)(this.getDocuments().filter(function(t){return t.id.value===e.value})).map(function(e){return e.entity.name}).getOrElse(function(){return t.props.i18n.t("Документ не найден")})}},{key:"onSelected",value:function(e){this.setState(O(this.state,{selectedIndex:{$set:e}}))}},{key:"renderTabContents",value:function(){var e=this;switch(this.state.selectedIndex){case ut:var t=(this.props.accessRuleEditForm.searchArea.map(function(t){return t===je.Barcode.$Type.value&&e.props.accessRuleEditForm.formId.nonEmpty()}).getOrElse(function(){return!1})?this.getDocuments():[]).filter(function(t){return!Object(Z.a)(e.props.accessRuleEditForm.documents.map(function(e){return e.value}),t.id.value)});return f.createElement(G.a,null,f.createElement(q.a,null,f.createElement(ee.a,{fullWidth:!0,value:this.props.accessRuleEditForm.name,onChange:this.handleNameChange,label:this.props.i18n.t("Имя")})),f.createElement(q.a,null,f.createElement(ee.a,{fullWidth:!0,value:this.props.accessRuleEditForm.tag.getOrElse(function(){return""}),onChange:this.handleTagChange,label:this.props.i18n.t("Тег")})),f.createElement(q.a,null,f.createElement(oe.a,{primary:this.props.i18n.t("Правило активно")}),f.createElement(se.a,null,f.createElement(ne.a,{checked:this.props.accessRuleEditForm.active,onClick:this.handleActiveToggle}))),f.createElement(ae.a,null,this.props.i18n.t("Основные настройки")),f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},this.props.forms.fetching?f.createElement(z.a,null):f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Поиск и ограничения по форме")),f.createElement(Q.a,{value:this.props.accessRuleEditForm.formId.map(function(e){return e.value}).getOrElse(function(){return""}),onChange:this.handleFormChange},Object(we.headOption)(this.props.eventLines.list.filter(function(t){return t.id.value===e.props.params.eventLineId})).map(function(t){return je.EventLine.getOwnForms(e.props.forms.list,t.id)}).map(function(e){return e.map(function(e){return f.createElement(J.a,{key:e.id.value,value:e.id.value},e.entity.name)})}).getOrNull()))),f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Способ поиска")),f.createElement(Q.a,{fullWidth:!0,value:this.props.accessRuleEditForm.searchArea.getOrElse(function(){return""}),onChange:this.handleSearchAreaChange},f.createElement(J.a,{value:je.Barcode.$Type.value},this.props.i18n.t("По бэйджу")),f.createElement(J.a,{value:je.FormDataField.$Type.value},this.props.i18n.t("По полю")),f.createElement(J.a,{value:je.LinkedForm.$Type.value},this.props.i18n.t("По форме"))))),this.props.accessRuleEditForm.searchArea.map(function(n){return n===je.Barcode.$Type.value&&e.props.accessRuleEditForm.formId.nonEmpty()&&(e.isDocumentsFetching()?f.createElement(z.a,null):f.createElement("div",null,e.props.accessRuleEditForm.documents.map(function(t){return f.createElement(q.a,{key:t.value,style:{margin:"10px 0px 0px 0px"}},f.createElement(oe.a,{primary:e.convertDocumentIdToName(t)}),f.createElement(se.a,{style:{marginRight:15}},f.createElement(R.a,{onClick:function(){return e.handleDocumentDelete(t)}},f.createElement(ke.a,null))))}),f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0,display:"flex",alignItems:"center"}},f.createElement(de.a,{style:{flex:1,marginRight:5}},f.createElement(ue.a,null,e.props.i18n.t("Документ")),f.createElement(Q.a,{value:e.props.accessRuleEditForm.currentDocument.map(function(e){return e.value}).getOrElse(function(){return Object(we.headOption)(t).map(function(e){return e.id.value}).getOrElse(function(){return""})}),onChange:e.handleCurrentDocumentChange},t.map(function(e){return f.createElement(J.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),f.createElement(T.a,{variant:"raised",onClick:e.handleDocumentAdd,style:{marginRight:"5px"},disabled:0===t.length},e.props.i18n.t("Добавить")),f.createElement(T.a,{variant:"raised",onClick:e.handleDocumentAllAdd,disabled:0===t.length},e.props.i18n.t("Добавить все")))))}).getOrNull(),this.props.accessRuleEditForm.searchArea.flatMap(function(t){return e.props.accessRuleEditForm.formId.map(function(n){return t===je.FormDataField.$Type.value&&Object(we.liftKey)(e.props.fields.fetching,n.value).map(function(t){return t?f.createElement(z.a,null):f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,e.props.i18n.t("Поле")),f.createElement(Q.a,{fullWidth:!0,value:e.props.accessRuleEditForm.field.map(function(e){return e.value}).getOrElse(function(){return""}),onChange:e.handleFieldChange},Object(we.liftKey)(e.props.fields.list,n.value).map(function(e){return e.map(function(e){return f.createElement(J.a,{key:e.id.value,value:e.id.value},e.entity.caption)})}).getOrNull())))}).getOrNull()})}).getOrNull(),f.createElement(ae.a,null,this.props.i18n.t("Настройки времени")),f.createElement(q.a,null,f.createElement(oe.a,{primary:this.props.i18n.t("Ограничить по времени")}),f.createElement(se.a,null,f.createElement(ne.a,{checked:this.props.accessRuleEditForm.timeParam.map(function(e){return e.enabled}).getOrElse(function(){return!1}),onClick:this.handleTimeRestrictionToggled}))),this.props.accessRuleEditForm.timeParam.map(function(t){return t.enabled&&f.createElement("div",null,f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},f.createElement(ee.a,{label:"С",type:"time",value:t.start.map(function(e){return Object(lt.a)(e.value,"HH:mm")}).getOrElse(function(){return Object(lt.a)(new Date,"HH:mm")}),onChange:function(t){return e.handleTimeRestrictionStartChange(Object(we.toOption)(Object(ot.a)(t.target.value,"HH:mm",new Date).getTime()))}})),f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},f.createElement(ee.a,{label:"По",type:"time",value:t.end.map(function(e){return Object(lt.a)(e.value,"HH:mm")}).getOrElse(function(){return Object(lt.a)(new Date,"HH:mm")}),onChange:function(t){return e.handleTimeRestrictionEndChange(Object(we.toOption)(Object(ot.a)(t.target.value,"HH:mm",new Date).getTime()))}})))}).getOrNull(),f.createElement(q.a,null,f.createElement(oe.a,{primary:this.props.i18n.t("Ограничить по дате")}),f.createElement(se.a,null,f.createElement(ne.a,{checked:this.props.accessRuleEditForm.dateParam.map(function(e){return e.enabled}).getOrElse(function(){return!1}),onClick:this.handleDateRestrictionToggle}))),this.props.accessRuleEditForm.dateParam.map(function(t){return t.enabled&&f.createElement("div",null,f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},f.createElement(ee.a,{label:"С",type:"date",value:t.start.map(function(e){return e.value.toISOString().slice(0,10)}).getOrElse(function(){return(new Date).toISOString().slice(0,10)}),onChange:e.handleDateRestrictionStartChange})),f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},f.createElement(ee.a,{label:"По",type:"date",value:t.end.map(function(e){return e.value.toISOString().slice(0,10)}).getOrElse(function(){return(new Date).toISOString().slice(0,10)}),onChange:e.handleDateRestrictionEndChange})),f.createElement(q.a,null,f.createElement(oe.a,{primary:e.props.i18n.t("Один день")}),f.createElement(se.a,null,f.createElement(ne.a,{checked:t.singleDay,onClick:e.handleDateRestrictionSingleDayToggle}))))}).getOrNull(),f.createElement(q.a,null,f.createElement(oe.a,{primary:this.props.i18n.t("Логирование")}),f.createElement(se.a,null,f.createElement(ne.a,{checked:this.props.accessRuleEditForm.logParams.enabled,onClick:function(t){return e.handleLogToggle()}}))),this.props.accessRuleEditForm.logParams.enabled&&f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0}},f.createElement("div",null,f.createElement(at.a,{fullWidth:!0,errorText:new we.None,fields:this.props.accessRuleEditForm.formId.flatMap(function(t){return Object(we.liftKey)(e.props.fields.list,t.value)}).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===je.ValueTypeObjectRefs.$Type.value}),labelText:Object(we.toOption)(this.props.i18n.t("Поле для логирования")),value:this.props.accessRuleEditForm.logParams.refId,onChanged:this.handleLogFieldChange,emptyDisabled:!0}),this.props.i18n.t("Или")+" ",f.createElement("span",{className:"link",style:{color:"blue",textDecoration:"underline"},onClick:this.onCreateNewTextField},this.props.i18n.t("создать новое ссылочное поле")))));case 1:return f.createElement("div",null,f.createElement(ae.a,null,this.props.i18n.t("Фильтрация по данным анкеты")),this.props.accessRuleEditForm.formId.map(function(t){return f.createElement(q.a,null,f.createElement(Pe.a,{formId:t,filterId:ct,value:e.props.accessRuleEditForm.filter,onChange:function(t){return e.handleFilterChange(t)}}))}).getOrElse(function(){return f.createElement("p",null,e.props.i18n.t("Сначала выберите форму"))}));case 2:return f.createElement(rt,null);default:return f.createElement("div",null,"unknown content")}}},{key:"render",value:function(){var e=this;return f.createElement("div",null,f.createElement(g.a,{centered:!0,onChange:function(t,n){return e.onSelected(n)},value:this.state.selectedIndex,indicatorColor:"primary",textColor:"primary",fullWidth:!0},f.createElement(E.a,{value:ut,label:this.props.i18n.t("Основные настройки")}),f.createElement(E.a,{value:1,label:this.props.i18n.t("Фильтрация правила")}),f.createElement(E.a,{value:2,label:this.props.i18n.t("Действия")})),this.renderTabContents(),f.createElement(me.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose},f.createElement(ve.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),f.createElement(ye.a,null,this.state.dialog.body.getOrElse(function(){return f.createElement("div",null)})),f.createElement(Oe.a,{style:{borderTop:"none"}},this.state.dialog.actions)))}}]),t}(f.Component);pt=st([m.autobind],pt);var dt=Object(h.connect)(function(e){return{i18n:e.i18n,accessRuleEditForm:e.accessRuleEditForm,documents:e.formDocuments,eventLines:e.eventLines,eventLine:e.eventLine,fields:e.fields,forms:e.forms}})(pt),ft=n(216),mt=n(186),ht=n(71),vt=n(46),gt=n(255),yt=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Et=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.initRules(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(C.a)(this.props.accessZones,e.accessZones)||this.initRules(e)}},{key:"initRules",value:function(e){var t=this;Object(we.headOption)(e.accessZones.list.filter(function(t){return t.id.value===e.params.accessZoneId})).map(function(e){return t.props.dispatch(Object(mt.v)(e.entity.rules))})}},{key:"openEditForm",value:function(e,t,n){var r=this;this.props.openDialog(e,f.createElement(dt,{initialValues:n,params:this.props.params}),[f.createElement(T.a,{variant:"raised",onClick:function(){return r.props.handleDialogClose(!0)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(T.a,{variant:"raised",onClick:t,color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"getRuleValues",value:function(){var e=this;return this.props.accessRuleEditForm.formId.flatMap(function(t){return e.props.accessRuleEditForm.searchArea.flatMap(function(n){var r=new we.None;switch(n){case je.Barcode.$Type.value:r=Object(we.toOption)(new je.Barcode(e.props.accessRuleEditForm.documents));break;case je.FormDataField.$Type.value:e.props.accessRuleEditForm.field.map(function(e){r=Object(we.toOption)(new je.FormDataField(e))});break;case je.LinkedForm.$Type.value:r=Object(we.toOption)(new je.LinkedForm);break;default:throw"Unknown searchAreaName"}return r.flatMap(function(n){var r=new je.DateRestriction(e.props.accessRuleEditForm.dateParam.getOrElse(function(){return new je.DateParam(!1,!1,new we.None,new we.None)}),e.props.accessRuleEditForm.timeParam.getOrElse(function(){return new je.TimeParam(!1,new we.None,new we.None)}));return Object(we.toOption)(new je.AccessRule(e.props.accessRuleEditForm.name,e.props.accessRuleEditForm.active,t,n,r,e.props.accessRuleEditForm.filter,e.props.accessRuleEditForm.actions,e.props.accessRuleEditForm.logParams,e.props.accessRuleEditForm.tag))})})})}},{key:"onCreateRequested",value:function(){var e=this;this.openEditForm(this.props.i18n.t("Новое правило"),function(){e.getRuleValues().map(function(t){e.props.dispatch(Object(mt.s)(t)),e.props.dispatch(Object(mt.n)(function(){e.props.dispatch(Object(ht.h)(e.props.i18n.t("Новое правило успешно создано!"))),e.props.handleDialogClose(!1)},e.props.params))})})}},{key:"onEdit",value:function(e){var t=this;this.openEditForm(this.props.i18n.t("Редактирование"),function(){t.getRuleValues().map(function(n){t.props.dispatch(Object(mt.u)({old:e,edited:n})),t.props.dispatch(Object(mt.n)(function(){t.props.dispatch(Object(ht.h)(t.props.i18n.t("Правило сохранено!"))),t.props.handleDialogClose(!1)},t.props.params))})},e)}},{key:"onDelete",value:function(e){var t=this;this.props.openDialog(this.props.i18n.t("Удаление"),f.createElement("p",null,this.props.i18n.t("Вы действительно хотите удалить правило? Это действие нельзя будет отменить")),[f.createElement(T.a,{variant:"raised",onClick:function(){t.props.handleDialogClose(!1)},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),f.createElement(T.a,{variant:"raised",color:"primary",onClick:function(){t.props.dispatch(Object(mt.t)(e)),t.props.dispatch(Object(mt.n)(function(){t.props.dispatch(Object(ht.h)(t.props.i18n.t("Новая зона успешно создана!"))),t.props.handleDialogClose(!1)},t.props.params))}},this.props.i18n.t("Удалить"))])}},{key:"getFormName",value:function(e){var t=this;return this.props.forms.fetching?this.props.i18n.t("Загрузка"):Object(we.headOption)(this.props.forms.list.filter(function(t){return t.id.value===e.value})).map(function(e){return e.entity.name}).getOrElse(function(){return t.props.i18n.t("Указанная форма е найдена")})}},{key:"getDateLabel",value:function(e){if(!e.enabled)return" - ";var t="";return e.start.map(function(e){t+=e.value.toLocaleDateString()}),e.singleDay||(t+=" - ",e.end.map(function(e){t+=e.value.toLocaleDateString()})),t}},{key:"getTimeLabel",value:function(e){if(!e.enabled)return" - ";var t="";return e.start.map(function(e){t+=e.value.toLocaleTimeString()}),t+=" - ",e.end.map(function(e){t+=e.value.toLocaleTimeString()}),t}},{key:"onSwapActions",value:function(e,t,n){var r=this;if(void 0!==e[t]&&void 0!==e[n]){var a=t>n?n:t,i=t>n?t:n,o=[].concat(I()(e.slice(0,a)),[e[i]],I()(e.slice(a+1,i)),[e[a]],I()(e.slice(i+1)));Object(we.headOption)(this.props.accessZones.list.filter(function(e){return e.id.value===r.props.params.accessZoneId})).map(function(e){Object(gt.e)(O(e,{entity:{rules:{$set:o}}})).then(function(){return r.props.dispatch(Object(mt.v)(o))})})}}},{key:"render",value:function(){var e=this;return Object(we.headOption)(this.props.accessZones.list.filter(function(t){return t.id.value===e.props.params.accessZoneId})).map(function(t){return f.createElement(A.a,{className:"FormsPage__paper",style:{flex:1}},f.createElement(ft.b,null,f.createElement(T.a,{variant:"raised",onClick:e.onCreateRequested,color:"primary"},e.props.i18n.t("Создать"))),f.createElement(L.a,{showId:!0,error:e.props.accessZones.error,fetching:e.props.accessZones.fetching,onRecordSelected:e.onEdit,empty:!e.props.accessZones.fetching&&0===t.entity.rules.length,withActions:!0,headers:[{id:"zoneRuleName",title:e.props.i18n.t("table|Название правила")},{id:"zoneRuleForm",title:e.props.i18n.t("table|Форма")},{id:"zoneRuleDate",title:e.props.i18n.t("table|Дата")},{id:"zoneRuleTime",title:e.props.i18n.t("table|Время")}],rows:e.props.accessZone.rules.map(function(t,n){return{id:n.toString(),payload:t,fields:[t.name,e.getFormName(t.formId),e.getDateLabel(t.dateRestriction.dateParam),e.getTimeLabel(t.dateRestriction.timeParam)],buttons:[f.createElement(R.a,{style:vt.f,key:"edit",onClick:function(n){n.stopPropagation(),e.onEdit(t)}},f.createElement(x.a,{style:vt.g})),f.createElement(R.a,{style:vt.f,key:"delete",onClick:function(n){n.stopPropagation(),e.onDelete(t)}},f.createElement(N.a,{style:vt.g})),f.createElement(R.a,{style:vt.f,onClick:function(){return e.onSwapActions(e.props.accessZone.rules,n,n-1)}},f.createElement(B.a,{style:vt.g})),f.createElement(R.a,{style:vt.f,onClick:function(){return e.onSwapActions(e.props.accessZone.rules,n,n+1)}},f.createElement(W.a,{style:vt.g}))]}})}))}).getOrNull()}}]),t}(f.Component);Et=yt([m.autobind],Et);var Ot=Object(h.connect)(function(e){return{accessZones:e.accessZones,accessZone:e.accessZone,accessRuleEditForm:e.accessRuleEditForm,forms:e.forms,i18n:e.i18n}})(Et),bt=n(233),kt=n(282),jt=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},It=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.initTerminals(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(C.a)(this.props.accessZones,e.accessZones)&&Object(C.a)(this.props.terminals,e.terminals)||this.initTerminals(e)}},{key:"initTerminals",value:function(e){e.terminals.fetching||this.props.dispatch(Object(mt.r)(e.terminals.list.filter(function(t){return t.entity.zoneId.map(function(t){return t.value===e.params.accessZoneId}).getOrElse(function(){return!1})}).map(function(e){return e.id})))}},{key:"selectCurrentTerminalChange",value:function(e){this.handleCurrentTerminalChange(e.target.value)}},{key:"handleCurrentTerminalChange",value:function(e){var t=this;Object(we.headOption)(this.props.terminals.list.filter(function(t){return t.id.value===e})).map(function(e){t.props.dispatch(Object(mt.o)(e))})}},{key:"handleTerminalAdd",value:function(){var e=this;this.props.accessZone.currentTerminal.map(function(t){return e.isTerminalBusy(t.entity.zoneId)?e.props.dispatch(Object(ht.h)(e.props.i18n.t("Невозможно добавить уже привязанный терминал"))):!Object(Z.a)(e.props.accessZone.terminals.map(function(e){return e.value}),t.id.value)?e.props.dispatch(Object(mt.p)(t.id)):void 0}),this.props.accessZone.currentTerminal.foreach(function(t){var n=e.props.terminals.list.filter(function(t){return e.props.accessZone.terminals.filter(function(e){return e.value===t.id.value}).length<1}),r=Object(bt.a)(n,function(e){return e.id.value===t.id.value});Object(we.lift)(n,r+1).foreach(function(t){return e.handleCurrentTerminalChange(t.id.value)})})}},{key:"isTerminalBusy",value:function(e){var t=this;return e.map(function(e){return!t.props.accessZones.fetching&&Object(we.headOption)(t.props.accessZones.list.filter(function(t){return t.id.value===e.value})).nonEmpty()}).getOrElse(function(){return!1})}},{key:"getTerminalSelectName",value:function(e){return e.entity.name+(this.isTerminalBusy(e.entity.zoneId)?" (Привязан)":"")}},{key:"getTerminalListName",value:function(e){return Object(we.headOption)(this.props.terminals.list.filter(function(t){return t.id.value===e.value})).map(function(e){return e.entity.name}).getOrElse(function(){return"---"})}},{key:"handleTerminalDelete",value:function(e){this.props.dispatch(Object(mt.q)(e))}},{key:"onSaveRequested",value:function(){var e=this,t=this.props.terminals.list.map(function(t){var n=t;return n.entity.zoneId=t.entity.zoneId.flatMap(function(t){return t.value===e.props.params.accessZoneId?new we.None:Object(we.toOption)(t)}),n}).map(function(t){return e.props.accessZone.terminals.find(function(e){return e.value===t.id.value})?O(t,{entity:{zoneId:{$set:Object(we.toOption)(new je.Id(e.props.params.accessZoneId))}}}):t});Object(kt.c)(t).then(function(t){e.props.dispatch(Object(gt.d)(new je.Id(e.props.params.eventLineId))),e.props.organisation.organisationId.map(function(t){e.props.dispatch(Object(kt.b)(t))}).getOrElse(function(){throw"Organisation has not been provided"}),e.props.dispatch(Object(ht.h)(e.props.i18n.t("Сохранено")))}).catch(function(t){e.props.dispatch(Object(ht.h)(e.props.i18n.t("Ошибка при сохранении")))})}},{key:"render",value:function(){var e=this;return Object(we.headOption)(this.props.accessZones.list.filter(function(t){return t.id.value===e.props.params.accessZoneId})).map(function(t){return f.createElement(A.a,{className:"FormsPage__paper",style:{display:"flex",flex:1,flexDirection:"column",minHeight:"0",overflowY:"auto"}},f.createElement(G.a,null,e.props.accessZone.terminals.map(function(t){return f.createElement(q.a,{style:{paddingTop:7,paddingBottom:7},key:t.value},f.createElement(oe.a,{primary:e.getTerminalListName(t)}),f.createElement(se.a,null,f.createElement(R.a,{onClick:function(){return e.handleTerminalDelete(t)},style:vt.f},f.createElement(ke.a,{style:vt.g}))))}),f.createElement(q.a,{style:{paddingTop:0,paddingBottom:0,display:"flex",alignItems:"center"}},f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,e.props.i18n.t("Терминал")),f.createElement(Q.a,{native:!0,value:e.props.accessZone.currentTerminal.map(function(e){return e.id.value}).getOrElse(function(){return""}),onChange:e.selectCurrentTerminalChange},f.createElement("option",{value:"!empty"}),e.props.terminals.list.filter(function(t){return e.props.accessZone.terminals.filter(function(e){return e.value===t.id.value}).length<1}).map(function(t){return f.createElement("option",{key:t.id.value,value:t.id.value},e.getTerminalSelectName(t))}))),f.createElement(T.a,{style:{marginLeft:10},variant:"raised",onClick:e.handleTerminalAdd,disabled:0===e.props.terminals.list.filter(function(t){return e.props.accessZone.terminals.filter(function(e){return e.value===t.id.value}).length<1}).length},e.props.i18n.t("Добавить"))),f.createElement(q.a,null,f.createElement(T.a,{variant:"raised",onClick:e.onSaveRequested,color:"primary"},e.props.i18n.t("Сохранить")))))}).getOrNull()}}]),t}(f.Component);It=jt([m.autobind],It);var Ct=Object(h.connect)(function(e){return{accessZones:e.accessZones,accessZone:e.accessZone,terminals:e.terminals,organisation:e.organisation,i18n:e.i18n}})(It),Ft=n(156),Tt=n.n(Ft),wt=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Rt=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Dt=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={blocksFormId:new we.None},n}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.fields.blockId.value&&this.getFormIdFromBlockId(new je.Id(this.props.fields.blockId.value)).then(function(t){e.setBlocksFormId(t),e.props.dispatch(Object(Ge.b)(t))})}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.fields.blockId.value&&e.fields.blockId.value!==this.props.fields.blockId.value&&this.getFormIdFromBlockId(new je.Id(e.fields.blockId.value)).then(function(e){t.setBlocksFormId(e)})}},{key:"setBlocksFormId",value:function(e){var t=this;this.setState(O(this.state,{blocksFormId:{$set:Object(we.toOption)(e)}}),function(){t.props.dispatch(Object(Ge.b)(e))})}},{key:"getFormIdFromBlockId",value:function(e){return this.props.dispatch(Object(Ge.a)(e)).then(function(e){return e.entity.relatedForm})}},{key:"onActionTypeChanged",value:function(e){this.props.fields.actionType.onChange(e.target.value)}},{key:"onNameChange",value:function(e){this.props.fields.name.onChange(e.target.value)}},{key:"onTypeChange",value:function(e){this.props.fields.terminalAddressType.onChange(e.target.value)}},{key:"onMonitorChange",value:function(e){this.props.fields.monitorName.onChange(e.target.value)}},{key:"onBlockIdChange",value:function(e){this.props.fields.blockId.onChange(e.target.value)}},{key:"onTerminalIdChange",value:function(e){this.props.fields.terminalId.onChange(e.target.value)}},{key:"render",value:function(){var e=this,t=this.props.fields.name,n=this.props.fields.actionType,r=this.props.fields.terminalAddressType,a=this.props.fields.terminalId,i=this.props.fields.monitorName,o=this.props.fields.blockId;return f.createElement("form",null,f.createElement(ee.a,{fullWidth:!0,autoFocus:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Название"),error:t.touched&&t.error,helperText:t.touched&&Object(we.toOption)(t.error).map(function(e){return f.createElement(Tt.a,null,e)}).getOrNull()}),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Тип")),f.createElement(Q.a,{value:n.value,onChange:this.onActionTypeChanged},f.createElement(J.a,{value:je.AccessTerminalNotFoundPush.$Type.value},Object(We.i)(je.AccessTerminalNotFoundPush.$Type,this.props.i18n.t)))),n.value===je.AccessTerminalNotFoundPush.$Type.value&&f.createElement("div",null,f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Выбор терминала")),f.createElement(Q.a,{value:r.value,onChange:this.onTypeChange},f.createElement(J.a,{value:je.TerminalAddressTerminalSender.$Type.value},this.props.i18n.t("Соответствует источнику")),f.createElement(J.a,{value:je.TerminalAddressTerminalTarget.$Type.value},this.props.i18n.t("Соответствует выбранному")))),r.value===je.TerminalAddressTerminalTarget.$Type.value&&f.createElement(Q.a,{fullWidth:!0,value:a.value,onChange:this.onTerminalIdChange},this.props.terminals.list.map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.value},e.entity.name)})),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Монитор")),f.createElement(Q.a,{value:i.value,onChange:this.onMonitorChange},je.monitors.map(function(e,t){return f.createElement(J.a,{key:t,value:e.name},e.name)}))),this.props.forms.fetching?f.createElement(z.a,null):f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Форма")),f.createElement(Q.a,{value:this.state.blocksFormId.map(function(e){return e.value}).getOrElse(function(){return""}),onChange:function(t){return e.setBlocksFormId(new je.Id(t.target.value))}},Object(we.headOption)(this.props.eventLines.list.filter(function(t){return t.id.value===e.props.params.eventLineId})).map(function(t){return je.EventLine.getOwnForms(e.props.forms.list,t.id).map(function(e){return f.createElement(J.a,{key:e.id.value,value:e.id.value},e.entity.name)})}).getOrElse(function(){return[]}))),f.createElement(de.a,{fullWidth:!0},f.createElement(ue.a,null,this.props.i18n.t("Блок вывода")),f.createElement(Q.a,{value:o.value,onChange:this.onBlockIdChange},this.state.blocksFormId.flatMap(function(t){return Object(Ne.c)(e.props.blocks,t)}).getOrElse(function(){return[]}).map(function(e,t){return f.createElement(J.a,{key:t,value:e.id.toString()},e.name)})))))}}]),t}(f.Component);Dt=wt([m.autobind,Rt("design:paramtypes",[Object])],Dt);var At=Object(h.connect)(function(e){return{i18n:e.i18n,forms:e.forms,blocks:e.blocks,terminals:e.terminals,filtersForm:e.filtersForm,eventLines:e.eventLines}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(_e.reduxForm)({form:"AccessControlNotFoundActionForm",fields:["name","actionType","filterFormId","filter","terminalAddressType","terminalId","monitorName","blockId"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(Dt)),Pt=n(871),xt=n.n(Pt),_t=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Nt=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},St=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dialog:{open:!1,title:new we.None,body:new we.None,actions:[]}},n}return u()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.initNotFoundAction(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(C.a)(this.props.accessZones,e.accessZones)||this.initNotFoundAction(e)}},{key:"initNotFoundAction",value:function(e){var t=this;Object(we.headOption)(e.accessZones.list.filter(function(t){return t.id.value===e.params.accessZoneId})).map(function(e){return t.props.dispatch(Object(mt.z)(e.entity.notFoundActions))})}},{key:"openDialog",value:function(e,t,n){this.setState(O(this.state,{dialog:{open:{$set:!0},title:{$set:new we.Some(e)},body:{$set:new we.Some(t)},actions:{$set:n}}}))}},{key:"handleDialogClose",value:function(){this.setState(O(this.state,{dialog:{open:{$set:!1},title:{$set:new we.None},body:{$set:new we.None},actions:{$set:[]}}}))}},{key:"openActionForm",value:function(e,t,n){var r=this,a=void 0;this.openDialog(e,f.createElement(At,{ref:function(e){return a=Object(we.toOption)(e).flatMap(function(e){return Object(we.toOption)(e.wrappedInstance)})},initialValues:n,onSubmit:t,params:this.props.params}),[f.createElement(T.a,{variant:"raised",onClick:function(){return r.handleDialogClose()},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),f.createElement(T.a,{variant:"raised",onClick:function(){return a.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onActionDelete",value:function(e){this.props.dispatch(Object(mt.y)(e))}},{key:"onActionEdit",value:function(e,t){var n=this;this.openActionForm(this.props.i18n.t("Редактирование действия"),function(e){return new Promise(function(r,a){try{n.props.dispatch(Object(mt.x)({idx:t,action:n.getAction(e)})),n.handleDialogClose(),r()}catch(e){a(e)}})},this.getActionInitialValues(e))}},{key:"getActionInitialValues",value:function(e){var t={actionType:e.tpe.value};switch(e.tpe.value){case je.AccessTerminalNotFoundPush.$Type.value:var n=e;t=Object.assign(t,{name:n.name,terminalAddressType:n.terminal.tpe.value,monitorName:Object(we.headOption)(n.monitor).map(function(e){return e.name}).getOrElse(function(){return""}),terminalId:n.terminal instanceof je.TerminalAddressTerminalTarget?n.terminal.id.value:"",blockId:n.blockId.value});break;default:throw"Unknown action type"}return t}},{key:"getAction",value:function(e){switch(new we.TypeId(e.actionType).value){case je.AccessTerminalNotFoundPush.$Type.value:return new je.AccessTerminalNotFoundPush(e.name,new we.None,new we.None,function(e,t){switch(e.value){case je.TerminalAddressTerminalSender.$Type.value:return new je.TerminalAddressTerminalSender;case je.TerminalAddressTerminalTarget.$Type.value:return new je.TerminalAddressTerminalTarget(new je.Id(t.terminalId));default:throw"Unknown terminal address type"}}(new we.TypeId(e.terminalAddressType||je.TerminalAddressTerminalSender.$Type.value),{terminalId:e.terminalId}),[new je.Monitor(e.monitorName)],new je.Id(e.blockId));default:throw"ActionBlockType has not beet found"}}},{key:"onActionCreate",value:function(){var e=this;this.openActionForm(this.props.i18n.t("Добавление действия"),function(t){return new Promise(function(n,r){try{e.props.dispatch(Object(mt.w)(e.getAction(t))),e.handleDialogClose(),n()}catch(e){r(e)}})},{})}},{key:"onSaveRequest",value:function(){var e=this;this.props.dispatch(Object(mt.m)(function(){e.props.dispatch(Object(ht.h)(e.props.i18n.t("Сохранено")))},this.props.params))}},{key:"render",value:function(){var e=this;return f.createElement(xt.a,{style:{display:"flex",flex:1,flexDirection:"column",minHeight:"0",overflowY:"auto",padding:10}},f.createElement("div",null,this.props.accessZone.notFoundActions.map(function(t,n){return f.createElement("div",{style:{display:"flex",alignItems:"center"}},f.createElement("div",{style:{flex:1}},t.name),f.createElement(R.a,{style:{alignSelf:"center",flexShrink:0},onClick:function(){return e.onActionEdit(t,n)}},f.createElement(x.a,null)),f.createElement(R.a,{style:{alignSelf:"center",flexShrink:0},onClick:function(){return e.onActionDelete(n)}},f.createElement(ke.a,null)))})),f.createElement("div",null,f.createElement(T.a,{variant:"raised",onClick:this.onActionCreate},this.props.i18n.t("Добавить")),f.createElement(T.a,{variant:"raised",style:{marginLeft:"5px"},color:"primary",onClick:this.onSaveRequest},this.props.i18n.t("Сохранить"))),f.createElement(me.a,{fullWidth:!0,open:this.state.dialog.open},f.createElement(ve.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),f.createElement(ye.a,null,this.state.dialog.body.getOrElse(function(){return f.createElement("div",null)})),f.createElement(Oe.a,{style:{borderTop:"none"}},this.state.dialog.actions)))}}]),t}(f.Component);St=_t([m.autobind,Nt("design:paramtypes",[Object])],St);var Bt,$t=Object(h.connect)(function(e){return{i18n:e.i18n,accessZone:e.accessZone,accessZones:e.accessZones,actionConfigs:e.actionConfigs,filtersForm:e.filtersForm}})(St),Wt=n(1590),Lt=n(79),Mt=n(1461),Zt=n(1478),Vt=n(23),zt=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Ht=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Gt=Bt=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(k.a.screenInitialState(),{selectedIndex:Bt.selectedIndex()})))}return u()(t,e),o()(t,[{key:"onSelected",value:function(e){switch(e){case 0:this.props.dispatch(Object(Lt.c)(new je.Id(this.props.params.eventLineId),new je.Id(this.props.params.accessZoneId)));break;case 1:this.props.dispatch(Object(Lt.e)(new je.Id(this.props.params.eventLineId),new je.Id(this.props.params.accessZoneId)));break;case 2:this.props.dispatch(Object(Lt.b)(new je.Id(this.props.params.eventLineId),new je.Id(this.props.params.accessZoneId)))}this.setState(O(this.state,{selectedIndex:{$set:e}}))}},{key:"renderTabContents",value:function(){switch(this.state.selectedIndex){case 0:return f.createElement(Ot,{handleDialogClose:this.handleDialogClose,openDialog:this.openDialog,params:this.props.params});case 1:return f.createElement(Ct,{handleDialogClose:this.handleDialogClose,openDialog:this.openDialog,params:this.props.params});case 2:return f.createElement($t,{params:this.props.params});default:return f.createElement("div",null,"unknown content")}}},{key:"renderNavigation",value:function(){return f.createElement(b.a,null)}},{key:"onGoBackRequested",value:function(){this.props.dispatch(Object(Lt.a)(new je.Id(this.props.params.eventLineId)))}},{key:"render",value:function(){var e=this,t=Object(Vt.headOption)(this.props.accessZones.list.filter(function(t){return t.id.value===e.props.params.accessZoneId})).map(function(e){return e.entity.name}).getOrElse(function(){return""});return this.renderScreenBody({className:""},f.createElement(f.Fragment,null,f.createElement(Zt.a,{title:this.props.i18n.t("Взаимодействие - "+t),onGoBackRequested:this.onGoBackRequested,rightButtonGroup:[f.createElement("div",null)]}),f.createElement(g.a,{value:this.state.selectedIndex,onChange:function(t,n){return e.onSelected(n)},indicatorColor:"primary",textColor:"primary",fullWidth:!0},f.createElement(E.a,{value:0,label:this.props.i18n.t("Правила")}),f.createElement(E.a,{value:1,label:this.props.i18n.t("Терминалы")}),f.createElement(E.a,{value:2,label:this.props.i18n.t("Не найдено")})),this.renderTabContents()))}}],[{key:"selectedIndex",value:function(){return-1!==location.href.indexOf("/rules")?0:-1!==location.href.indexOf("/terminals")?1:-1!==location.href.indexOf("/notFoundAction")?2:0}}]),t}(k.a);Gt=Bt=zt([m.autobind,Ht("design:paramtypes",[Object])],Gt);t.default=Object(h.connect)(function(e){return{eventLines:e.eventLines,i18n:e.i18n,accessZones:e.accessZones}})(Object(Mt.a)(Object(Me.a)(function(e){e.isTokenChecked&&(e.dispatch(Object(gt.d)(new je.Id(e.params.eventLineId))),e.dispatch(Object(Wt.c)(new je.Id(e.params.eventLineId))))},function(){},function(e,t){e.isTokenChecked&&!t.isTokenChecked&&(e.dispatch(Object(gt.d)(new je.Id(e.params.eventLineId))),e.dispatch(Object(Wt.c)(new je.Id(e.params.eventLineId))))})(Gt)))}}]);