(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[27],{1452:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(1),d=n(0),h=n(50),m=n(1456),y=n(173),b=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return e.display!==this.props.display||e.style!==this.props.style||!Object(d.isEqual)(e.blockStyle,this.props.blockStyle)||e.children!==this.props.children}},{key:"render",value:function(){var e=this.props.display,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.fonts}).getOrElse(function(){return new f.ElementFonts}),r=t.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),o=t.map(function(e){return e.enableStyles.map(function(e){return e.titleStyleChecked})}).flatMap(function(e){return e}),i=Object(m.c)(n.textFont,r,new d.None),a=Object(m.c)(n.titleFont,o,new d.None),u=e.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new f.ElementTitle}),l="FormRecordDisplay__row-title-"+u.position.toString(),c=this.props.blockStyle.flatMap(function(e){return e.fonts}).flatMap(function(e){return e.titleFont}).map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){}),s=this.props.blockStyle.flatMap(function(e){return e.fonts}).flatMap(function(e){return e.textFont}).map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){});return p.createElement("div",{className:l,key:e.id.value,style:this.props.style},u.show&&p.createElement("div",{className:"FormRecordDisplay__label-row "+Object(h.B)(this.props.display,"FormRecordDisplay__label-row")+"\n            "},p.createElement("div",{className:"FormRecordDisplay__label "+Object(h.B)(this.props.display,"FormRecordDisplay__label"),style:o.getOrElse(function(){return!1})?a:c},Object(y.c)(e.label.text))),p.createElement("div",{className:"FormRecordDisplay__input "+Object(h.B)(this.props.display,"FormRecordDisplay__input"),style:r.getOrElse(function(){return!1})?i:s},this.props.children))}}]),t}(p.Component);t.a=b},1453:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(1),d=n(1498),h=n(11),m=n.n(h),y=n(14),b=n(13),g=n(416),O=n.n(g),v=n(33),k=n.n(v),E=n(319),j=n.n(E),C=n(0),R=n(658),I=n(1535),S=(n(1551),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),w=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},T=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return s()(t,e),a()(t,[{key:"onChange",value:function(){var e=this;this.props.output.foreach(function(t){e.props.dispatch(Object(I.a)(t,e.props.blockRendererId,e.props.display.id))})}},{key:"render",value:function(){return p.createElement("div",{style:{display:"flex"}},p.createElement("div",{style:{flex:1}},this.props.children),p.createElement("div",{style:{flexShrink:0,margin:"5px"}},p.createElement(O.a,{name:"fetchType",onChange:this.onChange,value:this.props.mergingDataOutputBlockRendererId.getOrElse(function(){return""})},p.createElement(k.a,{control:p.createElement(j.a,null),label:"",value:this.props.blockRendererId}))))}}]),t}(p.Component);T=S([b.autobind,w("design:paramtypes",[Object])],T);var P=Object(y.connect)(function(e,t){return{mergingDataOutputBlockRendererId:t.output.flatMap(function(t){return Object(R.b)(e.duplicateMerging,t.formField)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.duplicateMerging.dataOutputMap===t.duplicateMerging.dataOutputMap},areStatePropsEqual:function(e,t){return Object(C.isEqual)(e.mergingDataOutputBlockRendererId,t.mergingDataOutputBlockRendererId)}})(T),x=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderMergingControl",value:function(){return p.createElement(P,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.display.dataOutput},this.renderDisplayControl())}},{key:"renderDisplayControlByBlockSchemaType",value:function(){switch(this.props.blockType.tpe.value){case f.WebRegistrationBlockTypeDisplay.$Type.value:return this.renderDisplayControl();case f.WebRegistrationBlockTypeEdit.$Type.value:return this.renderEditControl();case f.WebRegistrationBlockTypeMerging.$Type.value:return this.renderMergingControl();default:throw"Unknown block type"}}},{key:"renderEditConditional",value:function(){var e=this;return function(t){switch(t){case f.DisplayTypeByBlockSchemaType.$Type.value:return e.renderDisplayControlByBlockSchemaType();case f.DisplayTypeDisplay.$Type.value:return e.renderDisplayControl();case f.DisplayTypeEdit.$Type.value:return e.renderEditControl();case f.DisplayTypeEditByClick.$Type.value:return e.renderEditByClickControl();default:return e.renderDisplayControlByBlockSchemaType()}}(this.props.dispatch(Object(d.b)(this.props.display.conditionalValues,this.props.blockRendererId)))}},{key:"render",value:function(){switch(this.props.control.displayType.tpe.value){case f.DisplayTypeByBlockSchemaType.$Type.value:return this.renderDisplayControlByBlockSchemaType();case f.DisplayTypeDisplay.$Type.value:return this.renderDisplayControl();case f.DisplayTypeEdit.$Type.value:return this.renderEditControl();case f.DisplayTypeEditByClick.$Type.value:return this.renderEditByClickControl();case f.DisplayTypeConditional.$Type.value:return this.renderEditConditional();default:throw"Unknown element control display type"}}}]),t}(p.Component);t.a=x},1454:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(156),d=n.n(f),h=n(1),m=n(1456),y=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new h.ElementFonts}),t=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.errorStyleChecked})}).flatMap(function(e){return e}),n=Object(m.c)(e.errorFont,t,this.props.error),r=this.props.blockStyle.flatMap(function(e){return e.fonts}).flatMap(function(e){return e.errorFont}).map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment,textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){return{color:"red"}});return this.props.formHelper?this.props.error.map(function(e){return p.createElement(d.a,{style:t.getOrElse(function(){return!1})?n:r},e)}).getOrNull():this.props.error.map(function(e){return p.createElement("p",{style:t.getOrElse(function(){return!1})?n:r},e)}).getOrNull()}}]),t}(p.Component);t.a=y},1455:function(e,t,n){"use strict";var r,o=n(6),i=n.n(o),a=n(10),u=n.n(a),l=n(7),c=n.n(l),s=n(8),p=n.n(s),f=n(11),d=n.n(f),h=n(2),m=n(14),y=n(13),b=n(3),g=n(25),O=n.n(g),v=n(72),k=n.n(v),E=n(554),j=n.n(E),C=n(100),R=n(1),I=n(1508),S=(n(1553),n(375)),w=n.n(S),T=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},P=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e[e.Display=0]="Display",e[e.Edit=1]="Edit"}(r||(r={}));var x=function(e){function t(e){i()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={wrapperState:r.Display},n}return p()(t,e),u()(t,[{key:"onChange",value:function(e,t){this.props.dispatch(Object(C.L)({blockRendererId:this.props.blockRendererId,output:t,value:e,displayId:this.props.display.id})),this.isClickAwayAllowed()&&this.onDoneClick()}},{key:"onDoneClick",value:function(){var e=this;this.props.dispatch(Object(I.b)(this.props.display,this.props.blockRendererId)).foreach(function(t){t.then(function(t){e.wrapperStateToggle()})})}},{key:"isClickAwayAllowed",value:function(){return this.props.display.control.map(function(e){switch(e.tpe.value){case R.ElementControlSelect.$Type.value:return!0;default:return!1}}).getOrElse(function(){return!1})}},{key:"onCancelClick",value:function(){var e=this;this.wrapperStateToggle(function(){e.props.dispatch(Object(C.K)({blockRendererId:e.props.blockRendererId,output:e.props.output,displayId:e.props.display.id}))})}},{key:"onEditClick",value:function(){var e=this;this.setState(b(this.state,{wrapperState:{$set:this.state.wrapperState===r.Display?r.Edit:r.Display}}),function(){e.props.dispatch(Object(C.N)({blockRendererId:e.props.blockRendererId,output:e.props.output,displayId:e.props.display.id}))})}},{key:"wrapperStateToggle",value:function(e){this.setState(b(this.state,{wrapperState:{$set:this.state.wrapperState===r.Display?r.Edit:r.Display}}),e)}},{key:"renderEditModeControlButtons",value:function(){switch(this.props.display.control.map(function(e){return e.tpe.value}).getOrElse(function(){return R.ElementControlTextField.$Type.value})){case R.ElementControlSelect.$Type.value:return h.createElement(h.Fragment,null);default:return h.createElement(h.Fragment,null,h.createElement(O.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onDoneClick},h.createElement(j.a,null)),h.createElement(O.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onCancelClick},h.createElement(k.a,null)))}}},{key:"handleClickAway",value:function(){this.isClickAwayAllowed()&&this.onDoneClick()}},{key:"render",value:function(){return this.state.wrapperState===r.Display?h.createElement("div",{className:"ControlEditByClickWrapper__container",onClick:this.onEditClick},h.createElement("div",{className:"ControlEditByClickWrapper__cover"},this.props.displayComponent)):h.createElement("div",{style:{display:"flex",alignItems:"center"}},h.createElement("div",{style:{flex:1,alignSelf:"center"}},h.createElement(w.a,{onClickAway:this.handleClickAway},h.cloneElement(this.props.editComponent,{onChange:this.onChange}))),this.renderEditModeControlButtons())}}]),t}(h.Component);x=T([y.autobind,P("design:paramtypes",[Object])],x),t.a=Object(m.connect)(function(){return{}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)})(x)},1456:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l});var r=n(1),o=n(0),i=n(56),a=function(e,t,n){return t.getOrElse(function(){return!1})?e.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){return{}}):{}},u=function(e){return Object(i.a)(a(e,Object(o.toOption)(!0),new o.None))},l=function(e,t){var n=e.flatMap(function(e){return e.fonts}).getOrElse(function(){return new r.ElementFonts}).textFont,o=e.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1});return t.nonEmpty()?"red":o?n.map(function(e){return e.color}).getOrElse(function(){return"inherit"}):"inherit"}},1457:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return u});var r=n(1),o=function(e,t){switch((e.tpe.value===r.ElementThemeInherit.$Type.value?t:e).tpe.value){case r.ElementThemeMaterial.$Type.value:return"standard";case r.ElementThemeMaterialOutlined.$Type.value:return"outlined";case r.ElementThemeMaterialFilled.$Type.value:return"filled";default:return"standard"}},i=function(e,t){switch((e.tpe.value===r.ElementThemeInherit.$Type.value?t:e).tpe.value){case r.ElementThemeMaterial.$Type.value:return"contained";case r.ElementThemeMaterialOutlined.$Type.value:return"outlined";default:return"contained"}},a=function e(t,n){switch(t.tpe.value){case r.ElementThemeMaterial.$Type.value:case r.ElementThemeMaterialOutlined.$Type.value:case r.ElementThemeMaterialFilled.$Type.value:return!0;case r.ElementThemeInherit.$Type.value:return e(n,n);default:return!1}},u=function(e){return e.map(function(e){return e.elementTheme}).getOrElse(function(){return new r.ElementThemeMaterial})}},1458:function(e,t,n){"use strict";n.d(t,"d",function(){return v}),n.d(t,"i",function(){return k}),n.d(t,"g",function(){return E}),n.d(t,"f",function(){return j}),n.d(t,"e",function(){return C}),n.d(t,"j",function(){return R}),n.d(t,"b",function(){return I}),n.d(t,"h",function(){return S}),n.d(t,"a",function(){return w}),n.d(t,"c",function(){return T}),n.d(t,"k",function(){return P});var r=n(421),o=n(1),i=n(84),a=n(99),u=n(1533),l=n(323),c=n(264),s=n(1504),p=n(100),f=n(29),d=n(215),h=n(148),m=n(372),y=n(0),b=n(174),g=function(e,t){return Object(y.toOption)(t).flatMap(function(t){return Object(y.toOption)(t[e.value])}).map(function(e){return e.value})},O=function(e){return e.control.filter(function(e){return e.tpe.value===o.ElementControlCheckBoxes.$Type.value||e.tpe.value===o.ElementControlAdvancedCheckBoxes.$Type.value||e.tpe.value===o.ElementControlRadioBoxes.$Type.value||e.tpe.value===o.ElementControlSelect.$Type.value||e.tpe.value===o.ElementControlCalendar.$Type.value||e.tpe.value===o.ElementControlSelect.$Type.value}).map(function(e){return e.filter}).getOrElse(function(){return new y.None})},v=function(e,t,n,r,i){return function(a,u){r.dataOutput.flatMap(function(e){return Object(f.b)(u().fields,t,e.formField)}).foreach(function(l){x(r,l,u(),a).then(function(u){return a(Object(s.a)(new o.DataPageRequest(0,20,l.entity.valueType.family,new y.None),new o.ParentFormData(t,i,l.id),n,r.id,e))})})}},k=function(e,t,n){return function(r,i){r(Object(b.b)(t.parentsForm)).then(function(){r(Object(s.b)(new o.RelationsPagedListRequest(0,20,n,t.parentsForm,t.parentsField,new y.None,[],new y.None,new o.RelsTypeSearchParents),t,e))})}},E=function(e,t){return function(n,r){return e.dataInput.foreach(function(i){Object(f.b)(r().fields,t,i.formField).foreach(function(a){x(e,a,r(),n).then(function(l){return Object(c.d)(new o.DataPageRequest(0,20,a.entity.valueType.family,O(e))).then(function(o){n(Object(u.a)(e,i,t,a,o.page.records,o.page.total,r().i18n.t))}).catch(function(e){return console.error("Failed to resolve input data",e)})})})})}},j=function(e,t,n,r){return function(o,i){var a=O(n),l=Object(m.f)(i().blockRendererContext,e).flatMap(function(e){return Object(y.toOption)(e[t.entity.valueType.family.value])}),c=function(e){return o(Object(u.a)(n,r,t.entity.formId,t,e||[],e.length,i().i18n.t))};l.matchWith(function(e){return Object(y.toOption)(e)},function(){return Object(h.b)(i().dictionaries,t.entity.valueType.family)}).foreach(function(e){a.matchWith(function(t){c(e.filter(function(e){return t.check(function(t){return e.entity.getFormFieldValue(t).map(function(e){return e.value})})}))},function(){c(e)})})}},C=function(e,t,n){return function(r,i,a){t.dataInput.foreach(function(a){Object(f.b)(i().fields,n,a.formField).foreach(function(n){switch(n.entity.valueType.tpe.value){case o.ValueTypeBool.$Type.value:return r(Object(u.a)(t,a,n.entity.formId,n,[],0,i().i18n.t));case o.ValueTypeObjectRefs.$Type.value:return Object(y.headOption)(i().forms.list.filter(function(e){return e.id.value===n.entity.valueType.family.value})).foreach(function(i){o.FormType.isAnyDictionary(i.entity.formType)?r(j(e,n,t,a)):r(function(e,t,n,r){return function(i,a){return i(Object(c.b)(t.entity.valueType.family,g(t.id,Object(m.h)(a().blockRendererContext,e).getOrElse(function(){return{}})).filter(function(e){return e.tpe.value===o.ValueObjectRefs.$Type.value}).map(function(e){return e.id}).getOrElse(function(){return[]}),O(n))).then(function(e){i(Object(u.a)(n,r,t.entity.formId,t,e.list,e.list.length,a().i18n.t))}).catch(function(e){return console.error("Failed to resolve input data",e)})}}(e,n,t,a))})}})})}},R=function(e,t){return function(n,r){Object(m.d)(r().blockRendererContext,e).isEmpty()&&r().user.id.foreach(function(r){n(Object(p.G)({output:t,value:new o.ValueUserRefs([new o.EntityRef(r,o.User.$Type.value)]),blockRendererId:e}))})}},I=function(e,t,n){return function(r,i){g(t.formField,Object(m.h)(i().blockRendererContext,e).getOrElse(function(){return{}})).isEmpty()&&r(Object(p.G)({output:t,value:new o.ValueStr(n.color),blockRendererId:e}))}},S=function(e,t,n){return function(r,i){return Object(y.toOption)(t).filter(function(e){return!(e.control instanceof o.ElementControlColor||e.control instanceof o.ElementControlUsersField)}).flatMap(function(e){return e.dataOutput}).foreach(function(t){Object(f.b)(i().fields,n,t.formField).foreach(function(n){r(Object(p.G)({output:t,value:g(t.formField,Object(m.h)(i().blockRendererContext,e).getOrElse(function(){return{}})).matchWith(function(e){return e},function(){return n.entity.valueType.getDefaultValue()}),blockRendererId:e}))})})}},w=function(e,t){return function(n,r){return t.dataOutput.foreach(function(o){!t.displayRule.map(function(t){return t.isVisible(function(t){return Object(d.e)(r().dataOutput,e,t).matchWith(function(e){return Object(y.toOption)(e.value)},function(){return Object(m.g)(r().blockRendererContext,e,t)})})}).getOrElse(function(){return!0})&&n(Object(p.E)({blockRendererId:e,output:o,displayId:t.id}))})}},T=function(e,t){return function(n,r){Object(m.d)(r().blockRendererContext,e).foreach(function(e){t.dataOutput.foreach(function(t){n(Object(a.g)(e.entity.formId,e.id,t.formField))})})}},P=function(e,t,n){return function(n,r){return r().currentFormRecord.data.matchWith(function(n){return Object(l.i)(e,t.eventId,n.id,t.linkEnabled?t.linkedField:new y.None)},function(){throw"FormData Id hasn't been provided"})}},x=function(e,t,n,a){var u=Object(r.a)(e.control.map(function(e){return e.displayFields}).getOrElse(function(){return[]}).concat(e.control.map(function(e){return e.displayFieldsForAdding}).getOrElse(function(){return[]})).filter(function(e){return e.tpe.value===o.DisplayFieldByField.$Type.value}).map(function(e){return e.objRefDisplayFieldId.nonEmpty()?Object(f.b)(n.fields,t.entity.valueType.family,e.fieldId).map(function(e){return e.entity.valueType.family.value}).getOrElse(function(){return""}):""}),function(e){return e}).filter(function(e){return""!==e});return Promise.all(u.map(function(e){return a(Object(c.c)(new o.Id(e),new y.None)).then(function(t){return a(Object(i.c)(new o.Id(e)))})}))}},1459:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return u});var r=n(79),o=n(104),i=n(82),a=function(){return function(e,t){return e(i.default.isA5000?Object(r.Mb)():Object(r.h)())}},u=function(e,t){return function(n,i){return i().eventLine.data.foreach(function(a){Object(o.e)(i().forms,e).foreach(function(o){n(Object(r.H)(a.id,o.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(14),d=n(1469),h=n(1459),m=n(320),y=n(69),b=n(0),g=n(624);t.a=function(e){return Object(f.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return o()(this,n),l()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return s()(n,t),a()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(b.toOption)(this.props.routing.location).map(function(t){Object(b.liftKey)(Object(g.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(d.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(d.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(d.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(y.r)()),this.props.dispatch(Object(m.c)()),this.props.dispatch(Object(h.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?p.createElement(e,this.props):p.createElement("div",null)}}]),n}(p.Component)}(e))}},1466:function(e,t,n){"use strict";var r=n(4),o=n.n(r),i=n(5),a=Object(i.createAction)("Registration.Begin"),u=Object(i.createAction)("Registration.Complete"),l=Object(i.createAction)("Registration.Failed"),c=n(17),s=n(210),p=n(142),f=n(1471),d=n(634),h=n(143),m=n(1807),y=n(1),b=n(111),g=n(0),O=n(21),v=n(100),k=n(222),E=n(147),j=n(323),C=n(29),R=n(215),I=n(372),S=n(3);n.d(t,"b",function(){return T}),n.d(t,"i",function(){return P}),n.d(t,"f",function(){return x}),n.d(t,"e",function(){return _}),n.d(t,"g",function(){return F}),n.d(t,"h",function(){return D}),n.d(t,"a",function(){return M}),n.d(t,"c",function(){return V}),n.d(t,"d",function(){return L});var w=function(e,t,n){return Object(g.headOption)(Object(C.e)(n().fields,t).map(function(t){return t.filter(function(t){return t.id.value===e.formField.value})}).getOrElse(function(){return[]})).flatMap(function(e){return Object(g.toOption)(e.entity.valueType.getDefaultValue())})},T=function(e,t){return function(n,r){return Object(R.f)(r().dataOutput,t).getOrElse(function(){return[]}).filter(function(e){var t=e.value;return!!t&&t.tpe!==y.ValueGenerated.$Type}).map(function(t){return w(t.output,e,r).filter(function(e){return Object(p.a)(e,t.value)}).nonEmpty()?function(e){return S(e,{value:{$set:new y.ValueEmpty}})}(t):t})}},P=function(e,t,n){return c.a.send(new s.d(e,t,n),Object(O.i)())},x=function(e,t,n,r,o){return function(n,i){n(a());var f=Object(R.f)(i().dataOutput,r).getOrElse(function(){return[]}).filter(function(e){var t=e.value;return!!t&&t.tpe!==y.ValueGenerated.$Type}).map(function(e){return w(e.output,t,i).filter(function(t){return Object(p.a)(t,e.value)}).nonEmpty()?function(e){return S(e,{value:{$set:new y.ValueEmpty}})}(e):e});return c.a.send(new s.d(e,[o],f),Object(O.i)()).then(function(e){return Object(g.headOption)(e.updated).matchWith(function(e){return n(u(e)),e},function(){throw"empty result"})}).catch(function(e){throw n(l(e)),e})}},_=function(e,t,n,r,o){return function(n,i){n(a());var f=Object(R.f)(i().dataOutput,r).getOrElse(function(){return[]}).filter(function(e){return!!e.value&&e.value.tpe.value!==y.ValueGenerated.$Type.value}).filter(function(e){return w(e.output,t,i).filter(function(t){return!Object(p.a)(t,e.value)}).nonEmpty()}).filter(function(e){return e.value.tpe.value!==y.ValueEmpty.$Type.value});return c.a.send(new s.d(e,o,f),Object(O.f)()).then(function(e){return n(u(e.id)),e}).catch(function(e){throw n(l(e)),e})}},F=function(e,t,n){return function(r,i){return new Promise(function(a,u){var l=i();Object(g.liftKey)(l.block.record,e.value).flatMap(function(e){return e}).foreach(function(e){var c=function(e){return Object(R.j)(i().dataOutput,t,e).matchWith(function(e){return Object(g.toOption)(e.value)},function(){return Object(R.e)(i().dataOutput,t,e).matchWith(function(e){return Object(g.toOption)(e.value)},function(){return Object(I.g)(i().blockRendererContext,t,e)})})},s=n.matchWith(function(t){return Object(k.i)(e.entity.display,c).filter(function(e){return e.id.value===t.value})},function(){return Object(k.i)(e.entity.display,c)}),p=Object(k.g)(e.entity.display);Object(g.toOption)(p).filter(function(e){return e.length>0}).foreach(function(e){return e.map(function(e){return e.validationRules.map(function(n){Object(R.p)(l.dataOutput,t,e.id)||(r(Object(v.F)({blockRendererId:t,displayId:e.id,error:n.message})),u())})})});var f=Object(d.default)(s.map(function(e){return e.validationRules.map(function(e){return e.validate(c)}).map(function(t){return t.map(function(t){return new b.b(e,t)})})})).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),h=f.reduce(function(e,t){if(e.hasOwnProperty(t.display.id.value)){var n=Object(g.liftKey)(e,t.display.id.value).getOrElse(function(){return""});return Object.assign({},e,o()({},t.display.id.value,n+"; "+t.message))}return Object.assign({},e,o()({},t.display.id.value,t.message))},{});Object.keys(h).map(function(e){return n.matchWith(function(n){if(n.value===new y.DisplayElementId(e).value)return r(Object(v.F)({blockRendererId:t,displayId:new y.DisplayElementId(e),error:Object(g.liftKey)(h,e).getOrElse(function(){return""})}))},function(){return r(Object(v.F)({blockRendererId:t,displayId:new y.DisplayElementId(e),error:Object(g.liftKey)(h,e).getOrElse(function(){return""})}))})}),0===f.length?a():u(new b.c(f)),r(function(e,t){return function(n,r){var o=r().blockRendererContext,i=Object(k.b)(e.entity.display),a=Object.keys(o);return i.map(function(e){var r=Object(g.headOption)(a.filter(function(t){return Object(g.liftKey)(o,t).map(function(t){return t.blockId.value===e.blockId.value}).getOrElse(function(){return!1})})).getOrElse(function(){return t});return n(F(e.blockId,r,new g.None))})}}(e,t))})})}},D=function(e,t,n,r){return function(o,i){return new Promise(function(a,u){var l=i();Object(g.liftKey)(l.block.record,e.value).flatMap(function(e){return e}).foreach(function(e){var l=function(e){return Object(R.e)(i().dataOutput,t,e).matchWith(function(e){return Object(g.toOption)(e.value)},function(){return Object(I.g)(i().blockRendererContext,t,e)})},c=Object(k.i)(e.entity.display,l);Object(g.headOption)(c.filter(function(e){return n.children[r].children.filter(function(t){return t.id.value===e.id.value}).length>0}).map(function(e){return Object(g.headOption)(e.validationRules.map(function(e){return e.validate(l)}).filter(function(e){return e.nonEmpty()})).flatMap(function(n){return n.map(function(n){return o(Object(v.F)({blockRendererId:t,displayId:e.id,error:n}))})})}).filter(function(e){return e.nonEmpty()})).map(function(){return u("validation error")}).getOrElse(function(){return a()})}),a()})}},M=function(e,t,n){return function(r,o){return new Promise(function(i,a){var u=o();Object(g.liftKey)(u.block.record,e.value).flatMap(function(e){return e}).foreach(function(e){var o=e.entity.duplicateCheckValues;if(o.isEmpty())return i();var l=Object(k.d)(e.entity.display),c=Object(k.c)(e.entity.display),s=Object(k.i)(e.entity.display,function(e){return Object(k.k)(l,t,e,u.dataOutput)}),p=o.map(function(e){return e.filter.predicate}).getOrElse(function(){return new y.FilterPredicateAnd}),f=o.map(function(e){return e.count}).getOrElse(function(){return 0}),d=o.map(function(e){return e.filter.conditions.map(function(e){return e.field.value})}).getOrElse(function(){return[]});Object(g.headOption)(Object(g.liftKey)(u.blockRendererContext,t).map(function(e){return s.map(function(e){return e.dataOutput.map(function(e){return Object(R.d)(u.dataOutput,t,e)}).flatMap(function(e){return e})}).filter(function(e){return e.map(function(e){return Object(h.a)(d,e.output.formField.value)}).getOrElse(function(){return!1})}).map(function(t){return t.map(function(t){return t.value.toString()===e.initialValues.flatMap(function(e){return Object(g.liftKey)(e,t.output.formField.value).map(function(e){return e.value.toString()})}).getOrElse(function(){return""})}).getOrElse(function(){return!1})})}).getOrElse(function(){return[]})).getOrElse(function(){return!1})&&i();var O=s.map(function(e){return e.dataOutput.map(function(e){return Object(R.d)(u.dataOutput,t,e)}).flatMap(function(e){return e})}).filter(function(e){return e.map(function(e){return Object(h.a)(d,e.output.formField.value)}).getOrElse(function(){return!1})}).map(function(e){return Object(m.a)(e,function(e){return[e.output.formField,e.value]})}).map(function(e){return new y.FilterCondition(e[0],new y.FilterExpressionEq,e[1])});0===O.length&&i(),Object(E.e)(n,Object(g.toOption)(new y.FilterGroupCondition(O,p))).then(function(e){var n=Object(g.headOption)(c).map(function(e){return e.errorTypes.map(function(e){return e.duplicateError.map(function(e){return e.enabled})})}).flatMap(function(e){return e}).flatMap(function(e){return e}).getOrElse(function(){return!1});e.value>=f&&(n&&r(Object(v.x)({blockRendererId:t,displayErrorElement:!0})),a(new b.d)),i()})})})}},B=function(e,t){return function(n,r){return Object(R.f)(r().dataOutput,t).getOrElse(function(){return[]}).filter(function(e){return!!e.value&&e.value.tpe.value!==y.ValueGenerated.$Type.value}).filter(function(t){return w(t.output,e,r).filter(function(e){return!Object(p.a)(e,t.value)}).nonEmpty()}).map(function(e){return e.value instanceof y.ValueStr?S(e,{value:{$set:new y.ValueStr(Object(f.a)(e.value.toString()))}}):e}).filter(function(e){return e.value.tpe.value!==y.ValueEmpty.$Type.value})}},V=function(e,t,n){return function(r,o){r(a());var i=o(),p=Object(g.liftKey)(i.block.record,e.value).getOrElse(function(){return new g.None}),f=Object(k.j)(p.map(function(e){return e.entity.display}).getOrElse(function(){return[]})).filter(function(e){return e instanceof y.EmbeddedBlockElement});return Promise.all(f.map(function(e){return Object(R.l)(o().dataOutput,n,e.id).map(function(t){return Promise.all(t.map(function(t){return r(F(e.blockId,t,new g.None))}))}).getOrElse(function(){return new Promise(function(e,t){return t()})})})).then(function(){var i=new y.BlockValues(e,r(B(t,n))),a=f.map(function(e){return Object(R.l)(o().dataOutput,n,e.id).map(function(t){return t.map(function(t){return new y.BlockValues(e.blockId,r(B(e.formId,t)))})})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]);return c.a.send(new s.g([i].concat(a)),function(e){return new O.b(e)}).then(function(e){return Object(g.headOption)(e.updated).matchWith(function(e){return new O.a(e)},function(){throw new Error})}).then(function(e){return r(u(e.id)),e})}).catch(function(e){throw r(l(e)),e})}},L=function(e,t,n,r,o,i){return function(i,u){i(a());var l=function(e,t,n,r){var o=r();Object(g.liftKey)(o.block.record,e.value).getOrElse(function(){return new g.None});return Object(R.f)(r().dataOutput,n).getOrElse(function(){return[]}).filter(function(e){return!!e.value&&e.value.tpe.value!==y.ValueGenerated.$Type.value}).filter(function(e){return w(e.output,t,r).filter(function(t){return!Object(p.a)(t,e.value)}).nonEmpty()}).filter(function(e){return e.value.tpe.value!==y.ValueEmpty.$Type.value})}(e,r,o,u);return Object(j.h)(e,l,t,n,r)}}},1468:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(1),y=(n(1555),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),b=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getRootStyle",value:function(){return{display:this.props.titlePosition instanceof m.ElementPlacementLeft?"flex":"block"}}},{key:"getLabelContainerStyle",value:function(){return this.props.titlePosition instanceof m.ElementPlacementLeft?{flex:0,paddingRight:"5px",flexShrink:0}:{}}},{key:"getInputContainerStyle",value:function(){return this.props.titlePosition instanceof m.ElementPlacementLeft?{flex:1,paddingLeft:"5px"}:{}}},{key:"render",value:function(){return d.createElement("div",{className:"form-group",style:this.getRootStyle()},d.createElement("div",{style:this.getLabelContainerStyle()},d.createElement("label",null,this.props.label)),d.createElement("div",{style:this.getInputContainerStyle()},d.createElement("div",null,d.createElement("input",{type:this.props.type||"text",className:"form-control",style:this.props.error?{borderColor:"#dc3545"}:this.props.style,placeholder:this.props.placeholder||"",value:this.props.value,onChange:this.props.onChange})),d.createElement("div",{style:this.props.error?{color:"#dc3545"}:{display:"none"}},this.props.error)))}}]),t}(d.Component);b=y([h.autobind],b),t.a=b},1470:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return u});var r=n(623),o=n(109),i=function(e){return function(t,n){return n().auth.token.foreach(function(t){Object(r.b)(e,t,n().config.cdnAddress)})}},a=function(e){return function(t,n){return Object(o.a)(n().auth,e,n().config.cdnAddress)}},u=function(e){return function(t){return e.settings.ui.defaultImg.map(function(e){return t(a(e)).getOrElse(function(){return n(622)})})}}},1475:function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return f});var r=n(106),o=n(62),i=n.n(o),a=n(50),u=n(0),l=function(e){var t=Object(r.q)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new u.None:Object(u.toOption)(t+"px "+n+" "+o)},c=function(e){var t=Object(r.h)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new u.None:Object(u.toOption)(t+"px "+n+" "+o)},s=function(e){var t=Object(r.d)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new u.None:Object(u.toOption)(t+"px "+n+" "+o)},p=function(e){var t=Object(r.f)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(r.c)(e)).getOrElse(function(){return"dashed"}),o=Object(r.b)(e).getOrElse(function(){return i.a[600]});return 0===t?new u.None:Object(u.toOption)(t+"px "+n+" "+o)},f=function(e){return"\n    "+Object(r.l)(e).map(function(e){return e?"inset":""}).getOrElse(function(){return""})+" \n    "+Object(r.k)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.n)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.i)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.m)(e).getOrElse(function(){return 0})+"px\n    "+Object(r.j)(e).getOrElse(function(){return i.a[600]})+"\n"}},1476:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})),"ArrowBack");t.default=i},1477:function(e,t,n){"use strict";var r=n(17),o=n(21),i=n(6),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(18),f=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Create",{document:e}))}return s()(t,e),t}(p.a),d=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Update",{document:e}))}return s()(t,e),t}(p.a),h=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","Delete",{id:e}))}return s()(t,e),t}(p.a),m=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","List",{form:e}))}return s()(t,e),t}(p.a),y=function(e){function t(e,n){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListFormData",{formId:e,formDataId:n}))}return s()(t,e),t}(p.a),b=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Documents","ListIds",{ids:e}))}return s()(t,e),t}(p.a),g=n(193);n.d(t,"c",function(){return O}),n.d(t,"d",function(){return v}),n.d(t,"e",function(){return k}),n.d(t,"f",function(){return E}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return C});var O=function(e){return function(t){return t(Object(g.q)(e)),r.a.send(new m(e),Object(o.g)()).then(function(n){return t(Object(g.r)({formId:e,documents:n.list})),n}).catch(function(n){throw t(Object(g.p)({formId:e,error:n})),n})}},v=function(e){return function(t){return t(Object(g.k)()),r.a.send(new b(e),Object(o.g)()).then(function(e){return t(Object(g.l)(e.list)),e}).catch(function(e){throw t(Object(g.j)(e)),e})}},k=function(e,t){return function(n){return n(Object(g.n)(t)),r.a.send(new y(e,t),Object(o.g)()).then(function(e){return n(Object(g.o)({formDataId:t,documents:e.list})),e}).catch(function(e){throw n(Object(g.m)({formDataId:t,error:e})),e})}},E=function(e){return r.a.send(new d(e),Object(o.f)())},j=function(e){return r.a.send(new f(e),Object(o.f)())},C=function(e){return r.a.send(new h(e),Object(o.f)())}},1479:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(52),d=n.n(f),h=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return p.createElement(d.a,{component:"div",style:Object.assign({overflowY:"auto"},this.props.style)},this.props.children)}}]),t}(p.PureComponent);t.a=h},1483:function(e,t,n){"use strict";var r=n(17),o=n(21),i=n(6),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(18),f=function(e){function t(e,n,r,o,i,u){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Create",{name:e,organisationId:n,roleId:r,eventLineId:o,appType:i,active:u}))}return s()(t,e),t}(p.a),d=function(e){function t(e,n,r,o,i){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Update",{id:e,name:n,roleId:r,appType:o,active:i}))}return s()(t,e),t}(p.a),h=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Delete",{appId:e}))}return s()(t,e),t}(p.a),m=(function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Request",{appId:e}))}s()(t,e)}(p.a),function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListEventLine",{eventLineId:e}))}return s()(t,e),t}(p.a)),y=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListOrganisation",{organisationId:e}))}return s()(t,e),t}(p.a),b=function(e){function t(e,n){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","EnrichContext",{loginValues:e,formId:n}))}return s()(t,e),t}(p.a),g=n(427),O=n(5);Object(O.createAction)("Application.Fetching"),Object(O.createAction)("Application.Resolve"),Object(O.createAction)("Application.Error"),Object(O.createAction)("Auth.SetBlockId",function(e){return e});n.d(t,"d",function(){return v}),n.d(t,"e",function(){return k}),n.d(t,"f",function(){return E}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return C}),n.d(t,"c",function(){return R});var v=function(e){return function(t){return t(Object(g.e)()),r.a.send(new m(e),Object(o.g)()).then(function(e){return t(Object(g.f)(e.list)),e}).catch(function(e){throw t(Object(g.d)(e)),e})}},k=function(e){return function(t){return t(Object(g.e)()),r.a.send(new y(e),Object(o.g)()).then(function(e){return t(Object(g.f)(e.list)),e}).catch(function(e){throw t(Object(g.d)(e)),e})}},E=function(e,t,n,i,a){return r.a.send(new d(e,t,n,i,a),Object(o.f)())},j=function(e,t,n,i,a,u){return r.a.send(new f(e,t,n,i,a,u),Object(o.f)())},C=function(e){return r.a.send(new h(e),Object(o.f)())},R=function(e,t){return r.a.send(new b(e,t),function(e){return e})}},1486:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return s});var r=n(1),o=n(29),i=n(148),a=n(0),u=n(291),l=function(e,t){return function(n){return Object(a.toOption)(e.match(/\$id\d+/gi)).map(function(r){return r.reduce(function(e,r){var o=Object(a.toOption)(t.entity.values[r.slice("$id".length)]).map(function(e){return e.value.toString()}).getOrElse(function(){return n.i18n.t("")});return e.replace(r,o)},e)})}},c=function(e,t){return function(n){return t.flatMap(function(t){return Object(a.liftKey)(e.entity.values,t.value).flatMap(function(l){return Object(o.b)(n.fields,e.entity.formId,t).map(function(e){return(t=e,o=l.value,function(e){switch(o.tpe){case r.ValueStr.$Type:return o.value.toString();case r.ValueDate.$Type:switch(t.entity.valueType.dateType.tpe.value){case r.DateTypeDate.$Type.value:return o.value.toLocaleDateString();case r.DateTypeTime.$Type.value:return o.value.getHours()>9?(""+o.value.toLocaleTimeString()).slice(0,5):(""+o.value.toLocaleTimeString()).slice(0,4);case r.DateTypeDateTime.$Type.value:return o.value.toLocaleString();default:return e.i18n.t("Неизвестный тип значения")}case r.ValueObjectRefs.$Type:var n=t.entity.valueType;return o.id.map(function(t){return Object(i.d)(e.dictionaries,n.family,t).matchWith(function(t){return n.displayFields.map(function(n){return Object(a.toOption)(t.entity.values[n.value]).map(function(t){switch(t.value.tpe){case r.ValueStr.$Type:return t.value.value;case r.ValueObjectRefs.$Type:return"Ref#"+t.value.id.join(", ");default:return e.i18n.t("-- Не поддерживаемое значение --")}}).getOrElse(function(){return""})}).join("-")},function(){return Object(u.b)(e.formRecords,n.family,t).map(function(t){return n.displayFields.map(function(n){return Object(a.toOption)(t.entity.values[n.value]).map(function(t){switch(t.value.tpe){case r.ValueStr.$Type:return t.value.value;case r.ValueObjectRefs.$Type:return"Ref#"+t.value.id.join(", ");default:return e.i18n.t("-- Не поддерживаемое значение --")}}).getOrElse(function(){return""})}).join("-")}).getOrElse(function(){return""})})}).join(", ");default:return o.toString()}})(n);var t,o})})})}},s=function(e,t,n){return function(r){return n.matchWith(function(t){return function(e,t){return function(n){return l(t,e)(n)}}(e,t)(r)},function(){return c(e,t)(r)})}}},1487:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(4),f=n.n(p),d=n(2),h=n(24),m=n.n(h),y=n(38),b=n.n(y),g=n(1),O=n(46),v=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};function k(e){var t=e.selected?f()({},function(e){if(!e.tabsPosition)return"borderRight";switch(e.tabsPosition.tpe.value){case g.TabsPositionLeft.$Type.value:return"borderRight";case g.TabsPositionRight.$Type.value:return"borderLeft";default:return"borderRight"}}(e),"2px solid"):{};return{root:Object.assign({},t)}}var E=function(e){function t(){o()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleClick=function(t){t.preventDefault(),t.stopPropagation(),e.props.onClick&&e.props.onClick(e.props.value,t,e)},e.getColorByMuiTheme=function(e){var t=e.flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),n=e.flatMap(function(e){return e.palette}),r=e.flatMap(function(e){return e.selectable});switch(t){case"secondary":return[{color:n.map(function(e){return e.secondaryColor}).getOrElse(function(){return O.c})},{color:O.b}];case"custom":return[{color:r.map(function(e){return e.afterSelect}).getOrElse(function(){return O.a})},{color:r.map(function(e){return e.beforeSelect}).getOrElse(function(){return O.c})}];case"primary":default:return[{color:n.map(function(e){return e.primaryColor}).getOrElse(function(){return O.a})},{color:O.b}]}},e}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.icon,n=(e.index,e.onActive,e.onClick,e.selected),r=e.label,o=e.buttonStyle,i=e.style,a=(e.value,e.width,e.classes),u=(e.tabsPosition,e.elementMuiTheme),l=v(e,["icon","index","onActive","onClick","selected","label","buttonStyle","style","value","width","classes","tabsPosition","elementMuiTheme"]),c=k(this.props),s=void 0;if(t&&d.isValidElement(t)&&(s=d.cloneElement(t,{style:{fontSize:24,color:t.props&&t.props.style&&t.props.style.color?t.props.style.color:"#fff",marginBottom:r?5:0}})),u){var p=this.getColorByMuiTheme(u),f=n?p[0]:p[1];return d.createElement(m.a,Object.assign({},l,{style:Object.assign(c.root,i,f),onClick:this.handleClick}),d.createElement("div",{style:Object.assign({},o,f)},s,r))}return d.createElement(m.a,Object.assign({},l,{style:Object.assign(c.root,i),onClick:this.handleClick}),d.createElement("div",{style:o,className:n?a.root:a.default},s,r))}}]),t}(d.Component);E.muiName="Tab",E.propTypes={},E.contextTypes={},t.a=b()(function(e){return{default:{color:e.palette.text.secondary},root:{color:e.palette.primary.main}}})(E)},1488:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(4),f=n.n(p),d=n(2),h=n(62),m=n.n(h),y=n(1),b=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};function g(e){if(!e.tabsPosition)return"borderRight";switch(e.tabsPosition.tpe.value){case y.TabsPositionLeft.$Type.value:return"borderRight";case y.TabsPositionRight.$Type.value:return"borderLeft";default:return"borderRight"}}var O=function(e){function t(){o()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={selectedIndex:0},e.handleTabClick=function(t,n,r){n.preventDefault();var o=e.getValueLink(e.props),i=r.props.index;(o.value&&o.value!==t||e.state.selectedIndex!==i)&&o.requestChange(t,n,r),e.setState({selectedIndex:i}),r.props.onActive&&r.props.onActive(r)},e}return s()(t,e),a()(t,[{key:"componentWillMount",value:function(){var e=this.getValueLink(this.props),t=this.props.initialSelectedIndex||0;this.setState({selectedIndex:void 0!==e.value?this.getSelectedIndex(this.props):t<this.getTabCount()?t:0})}},{key:"componentWillReceiveProps",value:function(e,t){}},{key:"getTabs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=[];return d.Children.forEach(e.children,function(e){d.isValidElement(e)&&t.push(e)}),t}},{key:"getTabCount",value:function(){return this.getTabs().length}},{key:"getValueLink",value:function(e){return e.valueLink||{value:e.value,requestChange:e.onChange}}},{key:"getSelectedIndex",value:function(e){var t=this.getValueLink(e),n=-1;return this.getTabs(e).forEach(function(e,r){t.value===e.props.value&&(n=r)}),n}},{key:"getSelected",value:function(e,t){var n=this.getValueLink(this.props);return n.value?n.value===e.props.value:this.state.selectedIndex===t}},{key:"getTabContent",value:function(e,t,n,r){return t.push(e.props.children?d.createElement(n||v,{key:r,selected:this.getSelected(e,r)},e.props.children):void 0)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.contentContainerClassName,o=n.contentContainerStyle,i=(n.initialSelectedIndex,n.onChange,n.style),a=n.tabItemContainerStyle,u=n.tabTemplate,l=n.prerenderTabContainers,c=n.menuTopChildren,s=n.menuBottomChildren,p=(n.tabsPosition,b(n,["contentContainerClassName","contentContainerStyle","initialSelectedIndex","onChange","style","tabItemContainerStyle","tabTemplate","prerenderTabContainers","menuTopChildren","menuBottomChildren","tabsPosition"])),h=(e=this.props,{wrapper:{display:"flex",height:"100%",width:"100%"},tabItemContainer:f()({display:"flex",flexDirection:"column",flex:"0 0 150px",margin:"4px 4px 4px 0"},g(e),"1px solid ".concat(m.a[300])),tabMenuItemContainer:{display:"flex",flexDirection:"column",flex:"0 0 150px",margin:"4px 4px 4px 0"},tabContentContainer:{flex:1,margin:"4px 0 4px 4px"}}),y=(this.getValueLink(this.props).value,[]),O=100/this.getTabCount(),v=this.getTabs().map(function(e,n){return l?t.getTabContent(e,y,u,n):t.getSelected(e,n)&&t.getTabContent(e,y,u,n),d.cloneElement(e,{key:n,index:n,selected:t.getSelected(e,n),width:O+"%",onClick:t.handleTabClick})});return d.createElement("div",Object.assign({style:Object.assign(h.wrapper,i)},p),!this.props.tabItemContainerOnRight&&d.createElement("div",{style:Object.assign(h.tabItemContainer,a)},d.createElement("div",null,c),v,d.createElement("div",null,s)),d.createElement("div",{style:Object.assign(h.tabContentContainer,o),className:r},y),this.props.tabItemContainerOnRight&&d.createElement("div",{style:Object.assign(h.tabItemContainer,a)},d.createElement("div",null,c),v,d.createElement("div",null,s)))}}]),t}(d.Component);O.defaultProps={initialSelectedIndex:0,onChange:function(){}},O.contextTypes={};var v=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.selected,r=e.style,o=Object.assign({},r,{display:"flex",height:"100%"});return n||(o.height=0,o.overflow="hidden"),d.createElement("div",{style:o},t)}}]),t}(d.PureComponent);t.a=O},1491:function(e,t,n){"use strict";var r=n(21),o=(n(221),n(6)),i=n.n(o),a=n(7),u=n.n(a),l=n(8),c=n.n(l),s=n(18),p=(function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","List",{form:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","ListDescriptions",{form:e}))}return c()(t,e),t}(s.a)),f=(function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","ListEventLineDescriptions",{id:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","ListEventLine",{id:e}))}c()(t,e)}(s.a),function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Create",{pipeline:e}))}return c()(t,e),t}(s.a)),d=function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Update",{pipeline:e}))}return c()(t,e),t}(s.a),h=function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Request",{id:e}))}return c()(t,e),t}(s.a),m=function(e){function t(e){return i()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Import.Pipelines","Delete",{id:e}))}return c()(t,e),t}(s.a),y=n(17),b=n(644),g=n(82),O=n(428);n.d(t,"a",function(){return v}),n.d(t,"h",function(){return k}),n.d(t,"b",function(){return E}),n.d(t,"e",function(){return j}),n.d(t,"c",function(){return C}),n.d(t,"d",function(){return R}),n.d(t,"g",function(){return I}),n.d(t,"f",function(){return S});var v=function(e){return y.a.send(new f(e),Object(r.f)())},k=function(e){return y.a.send(new d(e),Object(r.f)())},E=function(e){return y.a.send(new m(e),Object(r.f)())},j=function(e){return y.a.send(new h(e),Object(r.e)())},C=function(e){return function(t){return t(Object(O.e)()),y.a.send(new h(e),Object(r.e)()).then(function(e){return t(Object(O.f)(e.record)),e}).catch(function(e){throw t(Object(O.d)(e)),e})}},R=function(e){return y.a.send(new p(e),function(e){return e})},I=function(e,t,n){var r=new FormData;return r.append("file",e),r.append("config",n),b.b(r,g.default.server_address+"/api/app/files/import",t,function(e){return e})},S=function(e,t,n){var r=new FormData;return r.append("file",e),b.b(r,g.default.server_address+"/api/app/files/import/"+n.value,t,function(e){return e})}},1492:function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return b}),n.d(t,"d",function(){return g});var r,o=n(1),i=n(142),a=n(143),u=n(0),l=function(e,t){return t.map(function(t){return t instanceof o.FilterCondition?c(e,t):s(e,t)}).getOrElse(function(){return!0})},c=function(e,t){return Object(u.toOption)(e.entity.values[t.field.value]).map(function(e){return e.value}).map(function(e){return d(e,t.value,t.expression)}).getOrElse(function(){return!0})},s=function e(t,n){return 0===n.conditions.length||n.conditions.map(function(n){return n instanceof o.FilterCondition?c(t,n):e(t,n)}).reduce(function(e,t){return p(e,t,n.predicate)})},p=function(e,t,n){return n.tpe.value===o.FilterPredicateAnd.$Type.value?e&&t:e||t},f=function(e){switch(e.tpe){case o.ValueStr.$Type:var t=e.value;return""!==t&&void 0!==t;case o.ValueObjectRefs.$Type:return e.id.length>0;case o.ValueList.$Type:return e.values.length>0;case o.ValueFileList.$Type:return e.files.length>0;case o.ValueNumber.$Type:case o.ValueBool.$Type:return void 0!==e.value;default:return!0}},d=function(e,t,n){var r=e.tpe.value===o.ValueObjectRefs.$Type.value,u=!isNaN(parseInt(t.toString(),10));switch(n.tpe.value){case o.FilterExpressionEq.$Type.value:return r?h(e,t,i.a):e.toString()===t.toString();case o.FilterExpressionNotEq.$Type.value:return r?!h(e,t,i.a):e.toString()!==t.toString();case o.FilterExpressionContains.$Type.value:return r?h(e,t,a.a,!0):e.toString().includes(t.toString());case o.FilterExpressionGt.$Type.value:return e.toString().length>(u?parseInt(t.toString(),10):t.toString().length);case o.FilterExpressionLt.$Type.value:return e.toString().length<(u?parseInt(t.toString(),10):t.toString().length);case o.FilterExpressionMissing.$Type.value:case o.FilterExpressionPresent.$Type.value:return f(e);default:return!0}},h=function(e,t,n,r){var o=e.id.map(function(e){return e.value});return Object(u.headOption)(t.id.map(function(e){return e.value})).map(function(e){return n(o,r?e:[e])}).getOrElse(function(){return!0})};!function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(r||(r={}));var m=function(e,t,n,i){var l=i.flatMap(function(e){return Object(u.headOption)(e.entity.permissions.filter(function(e){return e.operation instanceof o.PermissionOperationFormProperties&&e.operation.formId.value===t.map(function(e){return e.value}).getOrElse(function(){return""})}))}).map(function(e){var t=e.operation.restricted.fields;switch(n){case r.view:return t.view;case r.edit:return t.edit;default:return[]}}).getOrElse(function(){return[]}).map(function(e){return e.value});return e.filter(function(e){return!Object(a.a)(l,e.value)})},y=function(e,t,n){return e.map(function(e){return m([e],t,r.view,n).length>0})},b=function(e,t,n){return e.map(function(e){return m([e],t,r.edit,n).length>0})},g=function(e,t,n){return m(e,t,r.view,n)}},1493:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(3),y=n(1620),b=n.n(y),g=n(1621),O=n.n(g),v=n(1622),k=n.n(v),E=n(93),j=n.n(E),C=n(24),R=n.n(C),I=n(38),S=n.n(I),w=n(163),T=n.n(w),P=n(548),x=n.n(P),_=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},F=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},M=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={suggestions:[]},n}return s()(t,e),a()(t,[{key:"escapeRegexCharacters",value:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},{key:"getSuggestionsOnFocus",value:function(e){var t=this.escapeRegexCharacters(e.trim()),n=new RegExp("^"+t,"i");return this.props.suggestions.filter(function(e){return n.test(e)})}},{key:"getSuggestions",value:function(e){var t=e.trim().toLowerCase(),n=t.length,r=0;return 0===n?[]:this.props.suggestions.filter(function(e){var o=r<5&&e.toLowerCase().slice(0,n)===t;return o&&(r+=1),o})}},{key:"handleSuggestionsFetchRequested",value:function(e){var t=e.value;this.setState(m(this.state,{suggestions:{$set:this.props.showSuggestionsOnFocus?this.getSuggestionsOnFocus(t):this.getSuggestions(t)}}))}},{key:"handleSuggestionsClearRequested",value:function(){this.setState(m(this.state,{suggestions:{$set:[]}}))}},{key:"renderInput",value:function(e){e.classes,e.ref;var t=D(e,["classes","ref"]);return d.Children.map(this.props.children,function(e){return d.cloneElement(e,Object.assign({},t,{inputProps:Object.assign({},t)}))})}},{key:"shouldRenderSuggestions",value:function(){return!0}},{key:"renderSuggestion",value:function(e,t){var n=t.query,r=t.isHighlighted,o=O()(e,n),i=k()(e,o);return d.createElement(R.a,{selected:r,component:"div"},d.createElement("div",null,i.map(function(e,t){return e.highlight?d.createElement("span",{key:String(t),style:{fontWeight:500}},e.text):d.createElement("strong",{key:String(t),style:{fontWeight:300}},e.text)})))}},{key:"getSuggestionValue",value:function(e){return e}},{key:"render",value:function(){var e=this,t=this.props.classes,n={suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.handleSuggestionsFetchRequested,onSuggestionsClearRequested:this.handleSuggestionsClearRequested,getSuggestionValue:this.getSuggestionValue,renderSuggestion:this.renderSuggestion};return d.createElement(b.a,Object.assign({},n,{inputProps:{classes:t,placeholder:"",value:this.props.value,onChange:function(t,n){var r=n.newValue;return e.props.onChange(r)},onBlur:this.props.onBlur,inputRef:function(t){return e.popperNode=t},InputLabelProps:{shrink:!0}},shouldRenderSuggestions:this.shouldRenderSuggestions,renderInputComponent:this.renderInput,theme:{suggestionsList:t.suggestionsList,suggestion:t.suggestion},renderSuggestionsContainer:function(t){return d.createElement(x.a,{anchorEl:e.popperNode,open:Boolean(t.children),style:{zIndex:5e3}},d.createElement(j.a,Object.assign({square:!0},t.containerProps,{style:{width:e.popperNode?e.popperNode.clientWidth:null}}),t.children))}}))}}]),t}(d.Component);M=_([h.autobind,F("design:paramtypes",[Object])],M),t.a=S()(function(e){return T()({root:{height:250,flexGrow:1},container:{position:"relative"},suggestionsContainerOpen:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:2*e.spacing.unit}})})(M)},1494:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l});var r=n(221),o=n(1491),i=n(87),a=function(e){return function(t,n){return t(Object(r.k)(e)),o.d(e).then(function(n){return t(Object(r.l)({form:e,result:n})),n}).catch(function(n){throw t(Object(r.j)({form:e,error:n})),n})}},u=function(e){return function(t,n){return t(Object(i.b)(function(e){return!e.importPipelines.descriptionsFetching&&e.importPipelines.descriptionsFetching},a(e)))}},l=function(e){return function(t,n){return t(Object(i.b)(function(e){return!e.importPipelines.eventLineDescriptionsFetching&&e.importPipelines.eventLineDescriptionsFetching},function(e){return function(t,n){return t(Object(r.n)(e)),o.d(e).then(function(n){return t(Object(r.o)({eventLineId:e,result:n})),n}).catch(function(n){throw t(Object(r.m)({eventLineId:e,error:n})),n})}}(e)))}}},1495:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(542),y=n.n(m),b=n(38),g=n.n(b),O=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},v=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement(y.a,{style:{margin:0},classes:this.props.classes,variant:this.props.variant,color:this.props.color,disabled:this.props.disabled,onClick:this.props.onClick,type:this.props.type,size:this.props.size},this.props.children)}}]),t}(d.Component);v=O([h.autobind],v),t.a=g()(function(e){return{sizeSmall:{minWidth:32,minHeight:16,fontSize:e.typography.pxToRem(8)}}})(v)},1496:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),y=n(1523),b=n(104),g=n(240),O=n(188),v=n(1497),k=n(1),E=n(0),j=(n(1549),n(133)),C=n(50),R=n(215),I=n(372),S=n(1453),w=n(1452),T=n(1455),P=n(621),x=function(e,t,n,r){var o=t.id,i=e.displayValues.map(function(e){return e.id.value});return 0===o.length?[]:o.sort(function(e,t){return i.indexOf(e.value)-i.indexOf(t.value)}).reduce(function(t,o,i){return t.concat(n(Object(E.headOption)(e.displayValues.filter(function(e){return e.id.value===o.value})).map(function(e){return e.value.toString()}).getOrElse(function(){return r("Значения не найдены")}),i))},[])},_=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",null,this.props.dataInput.flatMap(function(t){return t.valueType.tpe===k.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(E.toOption)([]):e.props.value.map(function(n){switch(n.tpe.value){case k.ValueObjectRefs.$Type.value:return x(t,n,function(e,t){return d.createElement("div",{key:t},e)},e.props.i18n.t);case k.ValueList.$Type.value:return[d.createElement("div",{key:k.ValueList.$Type.value},n.values.map(function(e){return e.toString()}).join(", "))];case k.ValueBool.$Type.value:return[d.createElement("div",{key:k.ValueBool.$Type.value},n.toString())];default:return[d.createElement("div",{key:"unknown"},e.props.i18n.t("Неизвестный тип значения"))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]}))}}]),t}(d.Component),F=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueList||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(_),D=n(43),M=n.n(D),B=n(26),V=n.n(B),L=n(19),q=n.n(L),$=n(30),A=n.n($),N=n(1485),W=n.n(N),z=n(1538),U=n(29),H=n(100),K=n(3),G=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},J=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"focusNameInputField",value:function(e){this.inputRef=Object(E.toOption)(e)}},{key:"render",value:function(){return d.createElement("div",{style:{padding:"0px 0px 10px",boxSizing:"border-box"}},d.createElement(V.a,{placeholder:this.props.label,fullWidth:!0,inputRef:this.focusNameInputField,value:this.props.value,onChange:this.props.onChange}))}}]),t}(d.Component),Y=J=G([m.autobind],J),Z=n(1454),X=n(83),Q=n(174),ee=n(147),te=n(1501),ne=n(1524),re=n(1457),oe=n(173),ie=n(322),ae=n(201),ue=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},le=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ce={flex:"1"},se=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={search:new E.None,open:!1},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.selectInput=document.getElementById("selectInput - "+this.props.display.id.value),this.selectInput.style.overflow="visible"}},{key:"onSearchChange",value:function(e){var t=this;this.setState(K(this.state,{search:{$set:""!==e.target.value?Object(E.toOption)(e.target.value):new E.None}}),function(){t.selectInput.size=t.selectInput.options.length})}},{key:"displayValue",value:function(e){switch(e.tpe.value){case k.ValueStr.$Type.value:return e.value.toString();case k.ValueBool.$Type.value:return e.toString();default:throw"Unknown value type "+e.tpe.value}}},{key:"getField",value:function(){return this.props.field}},{key:"getValueType",value:function(){return this.getField().map(function(e){return e.entity.valueType})}},{key:"isValueTypeBool",value:function(){return this.getValueType().filter(function(e){return e.tpe.value===k.ValueTypeBool.$Type.value}).nonEmpty()}},{key:"onSelectChange",value:function(e){this.selectInput.size=0;var t=this.isValueTypeBool(),n=e.target.value;if(!n&&t)return this.props.onChange(new k.ValueEmpty,this.props.output);t?this.onBoolSelected("true"===n):this.onObjectRefSelected(n)}},{key:"onBoolSelected",value:function(e){this.props.onChange(new k.ValueBool(e),this.props.output)}},{key:"onObjectRefSelected",value:function(e){var t=this;this.props.dataInput.map(function(n){switch(n.valueType.tpe.value){case k.ValueTypeValuesList.$Type.value:t.props.onChange(new k.ValueStr(e),t.props.output);break;case k.ValueTypeBool.$Type.value:t.props.onChange(new k.ValueBool("true"===e),t.props.output);break;case k.ValueTypeObjectRefs.$Type.value:t.props.onChange(new k.ValueObjectRefs(""===e?[]:[new k.Id(e)]),t.props.output);break;default:throw"Unknown value type"}})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getMenuItem",value:function(e,t,n){return d.createElement("option",{key:(t+1).toString(),value:Object(E.headOption)(e.id).map(function(e){return e.value}).getOrElse(function(){return""})},this.getDisplayString(n,e))}},{key:"getOption",value:function(e,t){return{value:Object(E.headOption)(e.id).map(function(e){return e.value}).getOrElse(function(){return""}),label:this.getDisplayString(t,e)}}},{key:"getDisplayObjRefsValues",value:function(e){return this.props.control.valuesLimitEnabled?this.props.control.values:e.displayValues.map(function(e){return new k.ValueObjectRefs([e.id])})}},{key:"filterDisplayValues",value:function(e){var t=this;return this.props.control.searchSettings.flatMap(function(n){return t.state.search.map(function(r){return t.getDisplayObjRefsValues(e).filter(function(o){return n.strongSearch?t.getDisplayString(e,o).toLowerCase().trim()===r.toLowerCase():0===t.getDisplayString(e,o).toLowerCase().trim().indexOf(r.toLowerCase())})})}).getOrElse(function(){return t.getDisplayObjRefsValues(e)})}},{key:"getDisplayString",value:function(e,t){return Object(E.headOption)(t.id).flatMap(function(t){return e.getDisplayValue(t)}).map(function(e){return e.toString()}).getOrElse(function(){return"Значение отсутствует"})}},{key:"renderBoolMenuItems",value:function(){var e=[new k.ValueBool(!0),new k.ValueBool(!1)].map(function(e,t){return d.createElement("option",{key:t+1,value:e.toString()},e.toString())});return[d.createElement("option",{value:"",key:0}," ")].concat(e)}},{key:"renderListMenuItems",value:function(e){var t=this;this.props.dataInput.map(function(e){return e.displayValues}).getOrElse(function(){return[]});return[d.createElement("option",{value:"",key:0}," ")].concat(this.filterDisplayValues(e).map(function(n,r){return t.getMenuItem(n,r,e)}))}},{key:"getOptions",value:function(e){var t=this;return this.filterDisplayValues(e).map(function(n,r){return t.getOption(n,e)})}},{key:"getValue",value:function(){return this.isValueTypeBool()?this.props.value.filter(function(e){return e.tpe.value===k.ValueBool.$Type.value}).map(function(e){return e.toString()}).getOrElse(function(){return""}):this.props.value.filter(function(e){return e.tpe.value===k.ValueObjectRefs.$Type.value}).flatMap(function(e){return Object(E.headOption)(e.id)}).map(function(e){return e.value}).getOrElse(function(){return""})}},{key:"renderMenuItems",value:function(){var e=this;return this.props.dataInput.matchWith(function(t){return e.isValueTypeBool()?e.renderBoolMenuItems():e.renderListMenuItems(t)},function(){return[d.createElement("option",{value:"",key:0},e.props.i18n.t("Идет загрузка значений"))]})}},{key:"getSelectOptions",value:function(){var e=this;return this.props.dataInput.matchWith(function(t){return e.getOptions(t)},function(){return[{value:"",label:e.props.i18n.t("Идет загрузка значений")}]})}},{key:"renderWithFloatingTitle",value:function(){var e=this;return d.createElement("div",null,this.props.control.searchSettings.map(function(t){return d.createElement(Y,{label:e.props.i18n.t("Поиск"),value:e.state.search.getOrElse(function(){return""}),onChange:e.onSearchChange})}).getOrElse(function(){return d.createElement("div",null)}),d.createElement(V.a,{fullWidth:!0,select:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),id:"selectInput - "+this.props.display.id.value,label:Object(oe.e)(this.props.display.label.text),SelectProps:{native:!0,open:this.state.open},disabled:this.props.control.disabled,value:this.getValue(),onChange:this.onSelectChange,error:this.props.error.nonEmpty(),onBlur:this.onBlur},this.renderMenuItems()),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}),this.props.control.searchSettings.map(function(t){return d.createElement(Y,{label:e.props.i18n.t("Поиск"),value:e.state.search.getOrElse(function(){return""}),onChange:e.onSearchChange})}).getOrElse(function(){return d.createElement("div",null)}))}},{key:"renderWithFixTitle",value:function(){var e=this;return d.createElement(w.a,{display:this.props.display,style:ce,blockStyle:this.props.blockStyle},this.props.control.searchSettings.map(function(t){return d.createElement(Y,{label:e.props.i18n.t("Поиск"),value:e.state.search.getOrElse(function(){return""}),onChange:e.onSearchChange})}).getOrElse(function(){return d.createElement("div",null)}),d.createElement(V.a,{fullWidth:!0,select:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),id:"selectInput - "+this.props.display.id.value,SelectProps:{native:!0},disabled:this.props.control.disabled,value:this.getValue(),onChange:this.onSelectChange,error:this.props.error.nonEmpty(),onBlur:this.onBlur},this.renderMenuItems()),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderClassicSelect",value:function(e){return d.createElement(z.a,{id:"selectInput - "+this.props.display.id.value,titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),options:this.getSelectOptions(),onChange:this.onObjectRefSelected,value:this.getValue(),error:this.props.error.getOrElse(function(){return""})})}},{key:"renderMaterialSelect",value:function(e){return e.floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}},{key:"onAddClick",value:function(){var e=this;this.props.formId.foreach(function(t){return e.props.dispatch(Object(Q.c)(t,e.props.output.formField)).foreach(function(r){var o=e.props.openDialog(e.props.i18n.t("Добавление записи"),d.createElement(ie.a,{params:{},componentProps:{childFormId:r.entity.valueType.family,parentFormId:t,objRefsField:r,displayFields:[].concat(M()(e.props.dataInput.map(function(e){return e.valueType.displayFields}).getOrElse(function(){return[]}).map(function(t){return e.props.dispatch(Object(Q.c)(r.entity.valueType.family,t)).map(function(e){return new k.DisplayFieldByField(e.id,e.entity.caption)}).getOrElse(function(){return new k.DisplayFieldByField(t,"")})}))),displayFieldsForAdding:[],blockRendererId:e.props.blockRendererId,display:e.props.display,output:e.props.output,value:e.props.value.getOrElse(function(){return new k.ValueObjectRefs([])}),input:e.props.input,onlyOneChoice:!0,onObjRefAdd:function(t){return e.onAddValue(t,o)},onObjRefsAdd:e.onAddValues,onObjRefDelete:e.onDeleteValue},load:function(){return n.e(8).then(n.bind(null,2753))}}),[d.createElement(q.a,{variant:"raised",key:"close",onClick:function(t){return e.props.handleDialogClose(o)},style:{marginRight:"10px"}},e.props.i18n.t("Закрыть"))])})})}},{key:"onAddValue",value:function(e,t){return this.props.handleDialogClose(t),this.onAddValues([e])}},{key:"onDeleteValue",value:function(e){return this.deleteObjRef(e)}},{key:"deleteObjRef",value:function(e){var t=this;return this.props.formId.map(function(n){return t.props.dispatch(Object(Q.c)(n,t.props.output.formField)).map(function(r){return t.props.parentRecordId.matchWith(function(o){return Object(ee.p)([o],n,t.props.output.formField,r.entity.valueType.family,[e.id])},function(){return new Promise(function(e,t){return e()})}).then(function(){t.props.onChange(new k.ValueEmpty,t.props.output);t.props.dataInput.map(function(e){return e.formRecords}).getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.id.value});t.props.dispatch(Object(ne.a)(t.props.blockRendererId,t.props.display.id)).foreach(function(n){t.props.dispatch(Object(H.w)({id:t.props.display.id,blockRendererId:t.props.blockRendererId,display:n.filter(function(t){return t.id.value!==e.id.value})}))}),t.fetchFormRecordLimits()})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}},{key:"onAddValues",value:function(e){var t=this;return this.props.formId.map(function(n){return t.props.dispatch(Object(Q.c)(n,t.props.output.formField)).map(function(r){return t.props.parentRecordId.matchWith(function(o){return Object(ee.a)([o],n,t.props.output.formField,r.entity.valueType.family,e.map(function(e){return e.id}))},function(){return new Promise(function(e,t){return e()})}).then(function(){Object(E.headOption)(e).map(function(e){return e.id}).foreach(function(e){return t.props.onChange(new k.ValueObjectRefs([e]),t.props.output)}),t.props.dispatch(Object(ne.a)(t.props.blockRendererId,t.props.display.id)).foreach(function(n){t.props.dispatch(Object(H.w)({id:t.props.display.id,blockRendererId:t.props.blockRendererId,display:n.concat(e)}))}),t.fetchFormRecordLimits()}).catch(function(e){t.props.dispatch(Object(ae.a)(e))})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}).getOrElse(function(){return new Promise(function(e,t){return e()})})}},{key:"fetchFormRecordLimits",value:function(){var e=this;return this.props.formId.map(function(t){return e.props.parentRecordId.map(function(n){return e.props.dispatch(Object(te.b)(t,n,e.props.blockRendererId))})})}},{key:"renderOneChoiceSelect",value:function(){return d.createElement(w.a,{display:this.props.display,style:ce,blockStyle:this.props.blockStyle},d.createElement(A.a,{id:"selectInput - "+this.props.display.id.value,fullWidth:!0,IconComponent:W.a,open:!1,onOpen:function(){},onClick:this.onAddClick,value:this.getValue()},this.renderMenuItems()))}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return this.props.display.control.map(function(e){return e.openSelectDialog}).getOrElse(function(){return!1})?this.renderOneChoiceSelect():Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialSelect(e):this.renderClassicSelect(e)}}]),t}(d.Component);se=ue([m.autobind,le("design:paramtypes",[Object])],se);var pe=Object(h.connect)(function(e,t){return{field:t.formId.flatMap(function(n){return Object(U.d)(e,n,t.input.formField)}),value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataInputs.input===t.dataInputs.input&&e.dataOutput===t.dataOutput&&e.fields.list===t.fields.list},areOwnPropsEqual:function(e,t){return Object(E.isEqual)(e.formId,t.formId)&&e.display===t.display&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.input===t.input&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.field,t.field)&&Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&Object(E.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Object(X.a)(se)),fe=n(620),de=n(1458),he=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(F,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(pe,{display:e.props.display,blockRendererId:e.props.blockRendererId,blockId:e.props.blockId,parentRecordId:e.props.parentRecordId,control:e.props.control,input:t,output:e.props.output,formId:e.props.formId,onControlBlur:e.props.onControlBlur,onChange:e.props.onChange,blockStyle:e.props.blockStyle})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),me=function(e){e.formId.foreach(function(t){e.dispatch(Object(de.e)(e.blockRendererId,e.display,t))})},ye=function(e,t){return Object(E.isEqual)(e.formId,t.formId)&&Object(E.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur},be=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(I.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:function(t){return e(t)}}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areOwnPropsEqual:ye})(Object(fe.a)([me],[function(e,t){Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)||me(e),Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)&&e.isTokenChecked&&!t.isTokenChecked&&me(e)}],[],[],function(e,t){return!ye(e,t)&&e.i18n!==t.i18n})(he)),ge=n(1539),Oe=n(142),ve=n(1471),ke=n(862),Ee=n.n(ke),je=n(32),Ce=n.n(je),Re=n(549),Ie=n.n(Re),Se=n(1468),we=n(374),Te=n(1456),Pe=n(546),xe=n.n(Pe),_e=n(1493),Fe=n(1498),De=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Me=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Be=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},Ve={flex:"1"},Le=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.areValuesEqual=function(e,t){return e.flatMap(function(e){return t.map(function(t){return Object(Oe.a)(e,t)})}).getOrElse(function(){return!1})},n.state={textFieldTouched:!1,suggestions:[],value:new E.None},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.dispatch(Object(Fe.a)(this.props.display.elementAttributes)).then(function(t){return e.setState(K(e.state,{suggestions:{$set:t}}))}),this.setState(K(this.state,{value:{$set:Object(E.toOption)(this.props.value.map(function(e){return e.value}).getOrElse(function(){return""}))}}))}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});!this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})&&n.checked&&(this.state.textFieldTouched||(this.props.onChange(new k.ValueStr(n.value.getOrElse(function(){return""})),this.props.output),this.setState(K(this.state,{$set:{textFieldTouched:!0}})))),this.props.control.t13n.filter(function(e){return e.enabled}).foreach(function(n){if(t.areValuesEqual(t.props.value,e.value)){var r=e.sourceValue;if(!t.areValuesEqual(t.props.value,r)){var o=t.props.sourceValue;t.areValuesEqual(r,o)||r.foreach(function(r){t.setState(K(t.state,{value:{$set:Object(E.toOption)(Object(we.d)(r.toString(),n.direction))}}),function(){e.onChange(new k.ValueStr(Object(we.d)(r.toString(),n.direction)),t.props.output)})})}}})}},{key:"onChange",value:function(e){var t=this;this.setState(K(this.state,{value:{$set:Object(E.toOption)(e)}}),function(){return t.props.onChange(new k.ValueStr(e),t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0,style:{marginTop:0}},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"getElementFormattedInput",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new k.ElementFormattedInput})}},{key:"renderWithFloatingTitle",value:function(e,t){return this.getElementFormattedInput().checked?this.renderTextFieldWithFormattedInput():this.renderTextField(t)}},{key:"renderTextFieldWithFormattedInput",value:function(){return d.createElement(Ce.a,{fullWidth:!0},d.createElement(xe.a,null,Object(oe.e)(this.props.display.label.text)),this.renderFormattedInput())}},{key:"renderTextField",value:function(e){var t=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(this.wrapToAutoSuggest(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),label:Object(oe.e)(this.props.display.label.text),helperText:e.checked&&e.value,disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),inputProps:{style:{color:t}}})),this.props.error)}},{key:"renderWithFixTitle",value:function(e,t){var n=Object(Te.b)(this.props.display.elementCss,this.props.error);return d.createElement(w.a,{display:this.props.display,style:Ve,blockStyle:this.props.blockStyle},this.getElementFormattedInput().checked?this.wrapControl(this.renderFormattedInput(),this.props.error):this.wrapControl(this.wrapToAutoSuggest(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),helperText:t.checked&&t.value,disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),style:{marginTop:0},InputProps:{style:{color:n}}})),this.props.error))}},{key:"renderClassicTheme",value:function(e){var t=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(Se.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,style:{color:t},value:this.state.value.getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}),this.props.error)}},{key:"onTextMaskChange",value:function(e){this.onChange(e.target.value)}},{key:"textMaskPipe",value:function(e,t){return Object(E.toOption)(t).filter(function(t){return e===t.placeholder&&t.previousConformedValue}).matchWith(function(){return""},function(){return e})}},{key:"textMaskCustom",value:function(e){var t=this,n=e,r=n.inputRef,o=n.style,i=Be(n,["inputRef","style"]),a=this.getElementFormattedInput(),u=a.mask.getOrElse(function(){return""}),l=a.placeholderChar.getOrElse(function(){return" "}),c=Object(Te.b)(this.props.display.elementCss,this.props.error),s=u.split(",").map(function(e){var t=Object(ve.a)(e),n=Object(E.headOption)(t).getOrElse(function(){return""}),r=Object(E.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return d.createElement(Ee.a,Object.assign({},i,{style:o,ref:r,mask:s,showMask:!0,placeholderChar:l,pipe:this.textMaskPipe,value:this.state.value.getOrElse(function(){return""}),onChange:this.onTextMaskChange,render:function(e,n){n.value;var r=Be(n,["value"]);return d.createElement(V.a,Object.assign({fullWidth:!0,inputRef:e,variant:Object(re.c)(t.props.display.elementTheme,Object(re.a)(t.props.blockStyle)),disabled:t.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||t.props.control.disabled,error:t.props.error.nonEmpty(),InputProps:{style:{color:c}}},r))}}))}},{key:"wrapToAutoSuggest",value:function(e){return d.createElement(_e.a,{value:this.state.value.getOrElse(function(){return""}),onChange:this.onChange,suggestions:this.state.suggestions,onBlur:this.onBlur},e)}},{key:"renderFormattedInput",value:function(){return d.createElement(Ie.a,{fullWidth:!0,inputComponent:this.textMaskCustom})}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new k.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);Le=De([m.autobind,Me("design:paramtypes",[Object])],Le);var qe=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueStr}),sourceValue:t.control.t13n.filter(function(e){return e.enabled}).flatMap(function(n){return Object(R.e)(e.dataOutput,t.blockRendererId,n.sourceElementId).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueStr})}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.sourceValue,t.sourceValue)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(Le),$e=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(ge.a,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(qe,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),Ae=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})($e),Ne=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return this.props.control.inputMode.map(function(e){return e.tpe.value===k.ValueListInputModeBySeparator.$Type.value}).getOrElse(function(){return!1})?d.createElement("span",null,this.props.value.map(function(t){return t.toStringBySeparator(e.props.control.inputMode.map(function(e){return e.separator}).getOrElse(function(){return","})).replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull()):d.createElement("span",null,this.props.value.map(function(e){return e.toString().replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull())}}]),t}(d.Component),We=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof k.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(Ne),ze=n(542),Ue=n.n(ze),He=n(72),Ke=n.n(He),Ge=n(866),Je=n.n(Ge),Ye=n(140),Ze=n.n(Ye),Xe=n(46),Qe=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},et=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},nt={flex:"1"},rt=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.areValuesEqual=function(e,t){return e.flatMap(function(e){return t.map(function(t){return Object(Oe.a)(e,t)})}).getOrElse(function(){return!1})},n.state={textFieldTouched:!1,valuesList:e.control.inputMode.map(function(e){return e.tpe.value===k.ValueListInputModeSeparate.$Type.value?n.props.value.map(function(e){return e.values}).getOrElse(function(){return[]}):[]}).getOrElse(function(){return[]}),valueList:e.control.inputMode.map(function(t){return t.tpe.value===k.ValueListInputModeBySeparator.$Type.value?new k.ValueStr(e.value.map(function(e){return e.values.map(function(e){return e.toString()}).join(t.separator+" ")}).getOrElse(function(){return""})):new k.ValueStr("")}).getOrElse(function(){return new k.ValueStr("")})},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});!this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})&&n.checked&&(this.state.textFieldTouched||this.props.control.inputMode.foreach(function(e){var r=e.separator;t.props.onChange(new k.ValueList(n.value.getOrElse(function(){return""}).split(r).map(function(e){return new k.ValueStr(e)})),t.props.output),t.setState(K(t.state,{$set:{textFieldTouched:!0}}))}))}},{key:"onChange",value:function(e){var t=this;this.setState(K(this.state,{valueList:{$set:new k.ValueStr(e.target.value)}}),function(){return t.props.control.inputMode.foreach(function(e){var n=e.separator;t.props.onChange(new k.ValueList(t.state.valueList.toString().split(n).map(function(e){return new k.ValueStr(e.trim())}).filter(function(e){return""!==e.value})),t.props.output)})})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0,style:{marginTop:0}},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){return this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new k.ElementFormattedInput}).checked?this.renderTextFieldWithFormattedInput():this.renderTextField(t)}},{key:"renderTextFieldWithFormattedInput",value:function(){return d.createElement(Ce.a,{fullWidth:!0},d.createElement(xe.a,null,Object(oe.e)(this.props.display.label.text)),this.renderFormattedInput())}},{key:"renderTextField",value:function(e){var t=this,n=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.props.control.inputMode.map(function(r){return d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(t.props.display.elementTheme,Object(re.a)(t.props.blockStyle)),onChange:t.onChange,label:Object(oe.e)(t.props.display.label.text),helperText:e.checked&&e.value,value:t.state.valueList.toString(),disabled:t.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||t.props.control.disabled,error:t.props.error.nonEmpty(),onBlur:t.onBlur,inputProps:{style:{color:n}}})}).getOrElse(function(){return d.createElement("div",null)})}},{key:"renderWithFixTitle",value:function(e,t){var n=this,r=Object(Te.b)(this.props.display.elementCss,this.props.error),o=this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new k.ElementFormattedInput});return this.props.control.inputMode.map(function(e){return d.createElement(w.a,{display:n.props.display,style:nt,blockStyle:n.props.blockStyle},o.checked?n.wrapControl(n.renderFormattedInput(),n.props.error):n.wrapControl(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(n.props.display.elementTheme,Object(re.a)(n.props.blockStyle)),onChange:n.onChange,helperText:t.checked&&t.value,value:n.state.valueList.toString(),disabled:n.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||n.props.control.disabled,error:n.props.error.nonEmpty(),onBlur:n.onBlur,style:{marginTop:0},InputProps:{style:{color:r}}}),n.props.error))}).getOrElse(function(){return d.createElement("div",null)})}},{key:"renderClassicTheme",value:function(e){var t=this,n=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.props.control.inputMode.map(function(r){return t.wrapControl(d.createElement(Se.a,{titlePosition:e.position,label:Object(oe.e)(t.props.display.label.text),onChange:t.onChange,style:{color:n},value:t.state.valueList.toString(),error:t.props.error.getOrElse(function(){return""})}),t.props.error)}).getOrElse(function(){return d.createElement("div",null)})}},{key:"textMaskCustom",value:function(e){var t=e.inputRef,n=tt(e,["inputRef"]),r=this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new k.ElementFormattedInput}),o=r.mask.getOrElse(function(){return""}),i=r.placeholderChar.getOrElse(function(){return" "}),a=o.split(",").map(function(e){var t=Object(ve.a)(e),n=Object(E.headOption)(t).getOrElse(function(){return""}),r=Object(E.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return d.createElement(Ee.a,Object.assign({},n,{ref:t,mask:a,placeholderChar:i,showMask:!0}))}},{key:"renderFormattedInput",value:function(){var e=this,t=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.props.control.inputMode.map(function(n){n.separator;return d.createElement(Je.a,{id:"formatted-text-mask-input",value:e.state.valueList.toString(),onChange:e.onChange,inputComponent:e.textMaskCustom,disabled:e.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||e.props.control.disabled,error:e.props.error.nonEmpty(),onBlur:e.onBlur,inputProps:{style:{color:t}}})}).getOrElse(function(){return d.createElement("div",null)})}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new k.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});this.props.display.elementAttributes.flatMap(function(e){return e.formattedInput}).getOrElse(function(){return new k.ElementFormattedInput});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"handleValueAdd",value:function(){var e=this;""!==this.state.valueList.value&&(this.setState(K(this.state,{valuesList:{$set:[].concat(M()(this.state.valuesList),[this.state.valueList])},valueList:{$set:new k.ValueStr("")}}),function(){return e.props.onChange(new k.ValueList(e.state.valuesList),e.props.output)}),this.inputRef.foreach(function(e){return e.focus()}))}},{key:"handleValueListChange",value:function(e){this.setState(K(this.state,{valueList:{$set:new k.ValueStr(e.target.value.trim())}}))}},{key:"onSeparateValueRemove",value:function(e){var t=this;this.setState(K(this.state,{valuesList:{$set:[].concat(M()(this.state.valuesList.slice(0,e)),M()(this.state.valuesList.slice(e+1)))}}),function(){return t.props.onChange(new k.ValueList(t.state.valuesList),t.props.output)}),this.inputRef.foreach(function(e){return e.focus()})}},{key:"renderSeparateAddingItem",value:function(e,t){var n=this;return d.createElement("div",{key:t},e.value,d.createElement(Ze.a,{style:Xe.f,onClick:function(){return n.onSeparateValueRemove(t)}},d.createElement(Ke.a,{style:Xe.g})))}},{key:"handleInputRef",value:function(e){this.inputRef=Object(E.toOption)(e)}},{key:"renderSeparateAdding",value:function(){var e=this;return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},this.state.valuesList.map(function(t,n){return e.renderSeparateAddingItem(t,n)}),d.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",marginTop:"15px",marginBottom:"15px"}},this.wrapControl(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),style:{marginTop:0},label:this.props.i18n.t("Новое значение"),value:this.state.valueList.value,onChange:this.handleValueListChange,inputRef:this.handleInputRef,error:this.props.error.nonEmpty()}),this.props.error),d.createElement(Ue.a,{color:"primary",onClick:this.handleValueAdd},this.props.i18n.t("Добавить"))))}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return this.props.control.inputMode.map(function(e){return e.tpe.value}).getOrElse(function(){return k.ValueListInputModeBySeparator.$Type.value})===k.ValueListInputModeSeparate.$Type.value?this.renderSeparateAdding():Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);rt=Qe([m.autobind,et("design:paramtypes",[Object])],rt);var ot=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueList}).map(function(e){return e}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(rt),it=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(We,{output:this.props.output,blockRendererId:this.props.blockRendererId,control:this.props.control}))}},{key:"renderEditControl",value:function(){return d.createElement(ot,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),at=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(it),ut=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("span",null,this.props.value.map(function(e){return e.toString().replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull())}}]),t}(d.Component),lt=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof k.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(ut),ct=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},st=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pt={flex:1},ft=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:new E.None},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.setState(K(this.state,{value:{$set:this.props.value}}))}},{key:"onChange",value:function(e){var t=this;""!==e.target.value?this.props.organisation.map(function(e){return e.entity.currency}).foreach(function(n){var r=new k.ValueMoney(parseFloat(e.target.value).toString(),n);t.setState(K(t.state,{value:{$set:Object(E.toOption)(r)}}),function(){return t.props.onChange(r,t.props.output)})}):this.setState(K(this.state,{value:{$set:Object(E.toOption)(new k.ValueEmpty)}}),function(){return t.props.onChange(new k.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){var n=Object(Te.b)(this.props.display.elementCss,this.props.error);return d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),helperText:t.checked&&t.value,value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:n}}})}},{key:"renderWithFixTitle",value:function(e,t){var n=Object(Te.b)(this.props.display.elementCss,this.props.error);return d.createElement(w.a,{display:this.props.display,style:pt,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,helperText:t.checked&&t.value,value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:n}}})))}},{key:"renderClassicTheme",value:function(e){var t=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(Se.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,style:{color:t},value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}))}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new k.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);ft=ct([m.autobind,st("design:paramtypes",[Object])],ft);var dt=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueMoney}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),organisation:e.organisation.data}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)&&Object(E.isEqual)(e.organisation,t.organisation)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(ft),ht=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(lt,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(dt,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),mt=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(ht),yt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("span",null,this.props.value.map(function(e){return e.toString()}).getOrNull())}}]),t}(d.Component),bt=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueNumber})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(yt),gt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ot=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vt={flex:"1"},kt=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={sign:"",value:new E.None},n}return s()(t,e),a()(t,[{key:"changeValue",value:function(e){var t=this;if(""!==e){var n=this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""});Object(C.b)(e,n,!0,function(e){return t.setState(K(t.state,{value:{$set:Object(E.toOption)(new k.ValueNumber(e))}}),function(){t.props.onChange(new k.ValueNumber(e),t.props.output)})})}else this.setState(K(this.state,{value:{$set:Object(E.toOption)(new k.ValueEmpty)}}),function(){t.props.onChange(new k.ValueEmpty,t.props.output)})}},{key:"onChange",value:function(e){var t=this,n=e.target.value;"-"===n?this.setState(K(this.state,{sign:{$set:"-"}}),function(){return t.changeValue(n)}):this.setState(K(this.state,{sign:{$set:""}}),function(){return t.changeValue(n)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){var n=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),helperText:t.checked&&t.value,value:this.state.sign+this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,style:{marginTop:0},inputProps:{style:{color:n}}}))}},{key:"renderWithFixTitle",value:function(e,t){var n=Object(Te.b)(this.props.display.elementCss,this.props.error);return d.createElement(w.a,{display:this.props.display,style:vt,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,helperText:t.checked&&t.value,value:this.state.sign+this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,style:{marginTop:0},inputProps:{style:{color:n}}})))}},{key:"renderClassicTheme",value:function(e){var t=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(Se.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,style:{color:t},value:this.state.sign+this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}))}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new k.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);kt=gt([m.autobind,Ot("design:paramtypes",[Object])],kt);var Et=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueNumber}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(kt),jt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(bt,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(Et,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),Ct=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(jt),Rt={whiteSpace:"pre-wrap"},It=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return!Object(E.isEqual)(e.value,this.props.value)}},{key:"render",value:function(){return d.createElement("div",{style:Rt},this.props.value.map(function(e){return e.toString()}).getOrNull())}}]),t}(d.Component),St=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof k.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(It),wt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Tt=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Pt={flex:"1"},xt=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:new E.None},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.setState(K(this.state,{value:{$set:this.props.value}}))}},{key:"onChange",value:function(e){var t=this,n=new k.ValueStr(e.target.value);this.setState(K(this.state,{value:{$set:Object(E.toOption)(n)}}),function(){return t.props.onChange(n,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(){var e=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(V.a,{fullWidth:!0,multiline:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),rows:this.props.control.displayRows,rowsMax:this.props.control.rowsMax,onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:e}}}),this.props.error)}},{key:"renderWithFixTitle",value:function(){var e=Object(Te.b)(this.props.display.elementCss,this.props.error);return d.createElement(w.a,{display:this.props.display,style:Pt,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(V.a,{fullWidth:!0,multiline:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),rows:this.props.control.displayRows,rowsMax:this.props.control.rowsMax,onChange:this.onChange,value:this.state.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,inputProps:{style:{color:e}}}),this.props.error))}},{key:"renderMaterialTheme",value:function(e){return e.floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return this.renderMaterialTheme(e)}}]),t}(d.Component);xt=wt([m.autobind,Tt("design:paramtypes",[Object])],xt);var _t=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueStr}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(xt),Ft=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(St,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(_t,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),Dt=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(Ft),Mt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",null,this.props.dataInput.flatMap(function(t){return t.valueType.tpe===k.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(E.toOption)([]):e.props.value.map(function(n){switch(n.tpe.value){case k.ValueObjectRefs.$Type.value:return x(t,n,function(e,t){return d.createElement("div",{key:t},e)},e.props.i18n.t);case k.ValueList.$Type.value:return[d.createElement("div",{key:k.ValueList.$Type.value},n.values.map(function(e){return e.toString()}).join(", "))];case k.ValueBool.$Type.value:return[d.createElement("div",{key:k.ValueBool.$Type.value},n.toString())];default:return[d.createElement("div",{key:"unknown"},e.props.i18n.t("Неизвестный тип значения"))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]}))}}]),t}(d.Component),Bt=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueList||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(Mt),Vt=n(319),Lt=n.n(Vt),qt=n(33),$t=n.n(qt),At=n(416),Nt=n.n(At),Wt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},zt={flex:"1"},Ut=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"onChange",value:function(e,t){var n=this;this.props.dataInput.map(function(e){switch(e.valueType.tpe.value){case k.ValueTypeValuesList.$Type.value:n.props.onChange(new k.ValueStr(t),n.props.output);break;case k.ValueTypeBool.$Type.value:n.props.onChange(new k.ValueBool("true"===t),n.props.output);break;case k.ValueTypeObjectRefs.$Type.value:n.props.onChange(new k.ValueObjectRefs([new k.Id(t)]),n.props.output);break;default:throw"Unknown value type"}})}},{key:"getMuiColorType",value:function(e){switch(e){case"primary":return"primary";case"secondary":return"secondary";case"custom":default:return"primary"}}},{key:"getSpaceBetweenRadioBoxes",value:function(){return this.props.display.control.flatMap(function(e){return e.spaceBetween}).getOrElse(function(){return 12})}},{key:"renderRadioBoxes",value:function(){var e=this,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.fonts}).getOrElse(function(){return new k.ElementFonts}),r=t.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),o=t.map(function(e){return e.enableStyles.map(function(e){return e.titleStyleChecked})}).flatMap(function(e){return e}),i=Object(Te.c)(n.textFont,r,this.props.error),a=Object(Te.c)(n.titleFont,o,this.props.error),u=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.muiThemeChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),l=this.props.display.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}).flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),c={paddingBottom:this.getSpaceBetweenRadioBoxes(),paddingTop:this.getSpaceBetweenRadioBoxes()};return this.props.dataInput.map(function(t){switch(t.valueType.tpe.value){case k.ValueTypeValuesList.$Type.value:return t.value.values.map(function(t,n){return d.createElement($t.a,{key:n,control:d.createElement(Lt.a,Object.assign({style:Object.assign({},i,c)},u?{color:e.getMuiColorType(l)}:{color:"primary"})),value:t.toString(),label:d.createElement("span",{style:a},t.toString())})});case k.ValueTypeBool.$Type.value:return[new k.ValueBool(!0),new k.ValueBool(!1)].map(function(t,n){return d.createElement($t.a,{key:n,control:d.createElement(Lt.a,Object.assign({style:Object.assign({},i,c)},u?{color:e.getMuiColorType(l)}:{color:"primary"})),label:d.createElement("span",{style:a},t.toString()),value:t.toString(),style:i})});case k.ValueTypeObjectRefs.$Type.value:return t.displayValues.map(function(t,n){return d.createElement($t.a,{key:n,label:d.createElement("span",{style:a},t.value.value.toString()),control:d.createElement(Lt.a,Object.assign({style:Object.assign({},i,c)},u?{color:e.getMuiColorType(l)}:{color:"primary"})),value:t.id.value,style:i})});default:throw"Unknown value type"}}).getOrElse(function(){return[]})}},{key:"getSelectedValue",value:function(){var e=this;return this.props.dataInput.map(function(t){switch(t.valueType.tpe.value){case k.ValueTypeValuesList.$Type.value:return e.props.value.flatMap(function(e){return Object(E.headOption)(e.values).map(function(e){return e.toString()})}).getOrElse(function(){return"empty"});case k.ValueTypeBool.$Type.value:return e.props.value.map(function(e){return e.toString()}).getOrElse(function(){return"empty"});case k.ValueTypeObjectRefs.$Type.value:return e.props.value.flatMap(function(e){return Object(E.headOption)(t.displayValues.filter(function(t){return Object(E.headOption)(e.id).map(function(e){return t.id.value===e.value}).getOrElse(function(){return!1})}))}).map(function(e){return e.id.value}).getOrElse(function(){return""});default:throw"Unknown value type"}}).getOrElse(function(){return""})}},{key:"render",value:function(){var e=this.props.display,t=this.props.display.control.map(function(e){return e.placementRow}).getOrElse(function(){return!1});return d.createElement("div",null,d.createElement(w.a,{display:this.props.display,style:zt,blockStyle:this.props.blockStyle},d.createElement(Ce.a,{error:this.props.error.nonEmpty()},d.createElement(Nt.a,{name:Object(oe.e)(e.label.text),onChange:this.onChange,value:this.getSelectedValue(),style:{flexDirection:t?"row":"column"}},this.renderRadioBoxes()),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))))}}]),t}(d.Component);Ut=Wt([m.autobind],Ut);var Ht=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataInputs.input===t.dataInputs.input&&e.dataOutput===t.dataOutput&&e.fields.list===t.fields.list},areOwnPropsEqual:function(e,t){return e.display===t.display&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.input===t.input&&e.onChange===t.onChange},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&Object(E.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Ut),Kt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Bt,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(Ht,{display:e.props.display,blockRendererId:e.props.blockRendererId,control:e.props.control,input:t,output:e.props.output,blockStyle:e.props.blockStyle,onChange:e.props.onChange})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),Gt=function(e){e.formId.foreach(function(t){e.dispatch(Object(de.e)(e.blockRendererId,e.display,t))})},Jt=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(I.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([Gt],[function(e,t){Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)||Gt(e),Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)&&e.isTokenChecked&&!t.isTokenChecked&&Gt(e)}],[],[],function(e,t){return!function(e,t){return Object(E.isEqual)(e.formId,t.formId)&&Object(E.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur}(e,t)&&e.i18n!==t.i18n})(Kt)),Yt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",null,this.props.dataInput.flatMap(function(t){return t.valueType.tpe===k.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(E.toOption)([]):e.props.value.map(function(n){switch(n.tpe.value){case k.ValueObjectRefs.$Type.value:return x(t,n,function(e,t){return d.createElement("div",{key:t},e)},e.props.i18n.t);case k.ValueList.$Type.value:return[d.createElement("div",{key:k.ValueList.$Type.value},n.values.map(function(e){return e.toString()}).join(", "))];case k.ValueBool.$Type.value:return[d.createElement("div",{key:k.ValueBool.$Type.value},n.toString())];default:return[d.createElement("div",{key:"unknown"},e.props.i18n.t("Неизвестный тип значения"))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]}))}}]),t}(d.Component),Zt=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueList||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(Yt),Xt=n(45),Qt=n.n(Xt),en=n(98),tn=n.n(en),nn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},rn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},on=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={search:new E.None},n}return s()(t,e),a()(t,[{key:"onChange",value:function(e,t){var n=this;this.props.dataInput.map(function(e){switch(e.value.tpe.value){case k.ValueList.$Type.value:n.props.onChange(new k.ValueStr(t),n.props.output);break;case k.ValueObjectRefs.$Type.value:n.props.onChange(new k.ValueObjectRefs([new k.Id(t)]),n.props.output);break;default:throw"Unknown value type"}})}},{key:"onValueObjectRefCheckBoxChange",value:function(e){var t=this.props.value.map(function(e){return e.id}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.value===e.value}).length>0;return new k.ValueObjectRefs(n?[].concat(M()(t.filter(function(t){return t.value!==e.value}))):[].concat(M()(t),[e]))}},{key:"onValueListChange",value:function(e){var t=this.props.value.map(function(e){return e.values}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.toString()===e.toString()}).length>0;return new k.ValueList(n?[].concat(M()(t.filter(function(t){return t!==e}))):[].concat(M()(t),[e]))}},{key:"onValueBoolChange",value:function(){return this.props.value.map(function(e){return e.value}).getOrElse(function(){return!1})?new k.ValueEmpty:new k.ValueBool(!0)}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getMuiColorType",value:function(e){switch(e){case"primary":return"primary";case"secondary":return"secondary";case"custom":default:return"primary"}}},{key:"getSpaceBetweenCheckBoxes",value:function(){return this.props.display.control.flatMap(function(e){return e.spaceBetween}).getOrElse(function(){return 12})}},{key:"renderCheckBoxes",value:function(){var e=this,t=Object(Te.b)(this.props.display.elementCss,this.props.error),n=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.muiThemeChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),r=this.props.display.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}).flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),o={paddingBottom:this.getSpaceBetweenCheckBoxes(),paddingTop:this.getSpaceBetweenCheckBoxes()};return this.props.dataInput.map(function(i){switch(i.valueType.tpe.value){case k.ValueTypeValuesList.$Type.value:return i.value.values.map(function(i){return d.createElement($t.a,{label:d.createElement("span",{style:{color:t}},i.toString()),control:d.createElement(Qt.a,Object.assign({},n?{color:e.getMuiColorType(r)}:{color:"primary"},{style:o,onChange:function(){return e.props.onChange(e.onValueListChange(i),e.props.output)},checked:Object(E.headOption)(e.props.value.map(function(e){return e instanceof k.ValueList?e.values:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof k.ValueStr&&e.value===i.value})).nonEmpty(),onBlur:e.onBlur}))})});case k.ValueTypeObjectRefs.$Type.value:return i.displayValues.map(function(i){return d.createElement($t.a,{label:d.createElement("span",{style:{color:t}},i.value.toString()),control:d.createElement(Qt.a,Object.assign({},n?{color:e.getMuiColorType(r)}:{color:"primary"},{style:o,onChange:function(){return e.props.onChange(e.onValueObjectRefCheckBoxChange(i.id),e.props.output)},checked:Object(E.headOption)(e.props.value.map(function(e){return e instanceof k.ValueObjectRefs?e.id:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof k.Id&&e.value===i.id.value})).nonEmpty(),onBlur:e.onBlur}))})});case k.ValueTypeBool.$Type.value:return[d.createElement($t.a,{label:d.createElement("span",{style:{color:t}},e.props.i18n.t("Значение")),control:d.createElement(Qt.a,Object.assign({},n?{color:e.getMuiColorType(r)}:{color:"primary"},{style:o,onChange:function(){return e.props.onChange(e.onValueBoolChange(),e.props.output)},checked:e.props.value.map(function(e){return e instanceof k.ValueBool&&e.value}).getOrElse(function(){return!1}),onBlur:e.onBlur}))})];default:throw"Unknown value type"}}).getOrElse(function(){return[d.createElement("div",null,e.props.i18n.t("Значения отсутствуют"))]})}},{key:"render",value:function(){var e=this.props.display.control.map(function(e){return e.placementRow}).getOrElse(function(){return!1});return d.createElement("div",null,d.createElement(tn.a,null,d.createElement(w.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{error:this.props.error.nonEmpty()},d.createElement("div",{style:{display:"flex",flexDirection:e?"row":"column"}},this.renderCheckBoxes()),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))))}}]),t}(d.Component);on=nn([m.autobind,rn("design:paramtypes",[Object])],on);var an=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueList||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&Object(E.isEqual)(e.error,t.error)&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(on),un=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Zt,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(an,{display:e.props.display,blockRendererId:e.props.blockRendererId,control:e.props.control,input:t,output:e.props.output,onControlBlur:e.props.onControlBlur,blockStyle:e.props.blockStyle,onChange:e.props.onChange})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),ln=function(e){e.formId.foreach(function(t){e.dispatch(Object(de.e)(e.blockRendererId,e.display,t))})},cn=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(I.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([ln],[function(e,t){Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)||ln(e),Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)&&e.isTokenChecked&&!t.isTokenChecked&&ln(e)}],[],[],function(e,t){return!function(e,t){return Object(E.isEqual)(e.formId,t.formId)&&Object(E.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur}(e,t)&&e.i18n!==t.i18n})(un)),sn=n(160),pn=n.n(sn),fn=n(623),dn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},hn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"onSaveFile",value:function(e){var t=this;this.props.authToken.map(function(n){return Object(fn.b)(e,n,t.props.cdnAddress)})}},{key:"render",value:function(){var e=this;return d.createElement(tn.a,null,this.props.fileMetas.fetching||this.props.fileMetas.error.nonEmpty()?d.createElement(pn.a,null):this.props.value.map(function(t){return t.files.map(function(t,n){return Object(E.toOption)(e.props.fileMetas.list.find(function(e){return e.id.value===t.value})).map(function(n){return d.createElement("div",{key:t.value,onClick:function(){return e.onSaveFile(n.id)},style:{cursor:"pointer"}},n.entity.originalName)}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Описание файла не было загружено"))})})}).getOrElse(function(){return[]}))}}]),t}(d.Component);hn=dn([m.autobind],hn);var mn=Object(h.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueFileList}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.fileMetas===t.fileMetas&&Object(E.isEqual)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.authToken,t.authToken)&&e.i18n===t.i18n&&e.fileMetas===t.fileMetas}})(hn),yn=n(189),bn=n.n(yn),gn=n(54),On=n.n(gn),vn=n(107),kn=n.n(vn),En=n(25),jn=n.n(En),Cn=n(99),Rn=(n(1557),n(417)),In=n(71),Sn=n(139),wn=n(419),Tn=n(385),Pn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},xn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_n=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.props.value;return n.updateMetas(r),n.state={value:r},n}return s()(t,e),a()(t,[{key:"getValue",value:function(){return this.state.value.map(function(e){return e.tpe===k.ValueFileList.$Type?e:new k.ValueFileList([])}).getOrElse(function(){return new k.ValueFileList([])})}},{key:"componentWillReceiveProps",value:function(e){if(!Object(E.isEqual)(this.state.value,e.value)){var t=e.value;this.updateMetas(t),this.setState(K(this.state,{value:{$set:t}}))}}},{key:"updateMetas",value:function(e){this.props.dispatch(Object(de.c)(this.props.blockRendererId,this.props.display))}},{key:"onFilesDrop",value:function(e){var t=this;if(Object(Tn.b)(Object(E.toOption)(this.props.control))){if(0===e.length)throw"There are not files to process";var n=e[e.length-1];Object(Cn.h)(n,this.props.cdnAddress,this.props.authToken,this.props.organisation.organisationId,this.props.eventLine.eventLineId,this.props.formRecordId,new E.None,"false",!0,Object(E.toOption)(this.props.output.formField),Object(E.toOption)(this.props.formId)).then(function(e){t.props.formRecordId.matchWith(function(e){Object(Cn.f)(t.props.formId,e,t.props.output.formField).then(function(e){t.props.onChange(new k.ValueFileList(e.list.map(function(e){return e.id})),t.props.output)})},function(){Object(Cn.b)(e).then(function(n){t.props.dispatch(Object(Sn.h)([n.record])),t.props.onChange(K(t.getValue(),{files:{$push:[e]}}),t.props.output)})})}).catch(function(e){t.showNotification("Во время загрузки файла произошла ошибка")})}}},{key:"onFileDelete",value:function(e){var t=this;if(Object(Tn.a)(Object(E.toOption)(this.props.control)).getOrElse(function(){return!1})){var n=this.getValue();Object(Cn.a)(e).then(function(r){t.showNotification("Файл успешно удален"),t.props.onChange(K(n,{files:{$set:n.files.filter(function(t){return t.value!==e.value})}}),t.props.output)}).catch(function(e){return t.showNotification("Во время удаления файла произошла ошибка")})}}},{key:"showNotification",value:function(e){this.props.dispatch(Object(In.h)(this.props.i18n.t(e)))}},{key:"onSaveFile",value:function(e){var t=this;this.props.authToken.map(function(n){return Object(fn.b)(e,n,t.props.cdnAddress)})}},{key:"render",value:function(){var e=this,t=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new k.ElementFonts}),n=t.textFont.map(function(e){return{borderColor:e.color}}).getOrElse(function(){return{}}),r=t.textFont.map(function(e){return{borderColor:e.color}}).getOrElse(function(){return{}}),o=Object(Tn.a)(Object(E.toOption)(this.props.control)).getOrElse(function(){return!1})?t.textFont.map(function(e){return e.color}).getOrElse(function(){return""}):"#ccc",i=this.props.display.control.getOrElse(function(){return new k.ElementControlFileList});return d.createElement("div",null,d.createElement("p",null,this.props.i18n.t("Файлов загружено")+": "+this.getValue().files.length),d.createElement(tn.a,null,this.props.fileMetas.fetching&&this.props.fileMetas.error.isEmpty()&&d.createElement(pn.a,null),!this.props.fileMetas.fetching&&this.props.fileMetas.error.nonEmpty()&&d.createElement("p",null,this.props.i18n.t("При запросе списка файлов произошла ошибка")),!this.props.fileMetas.fetching&&this.props.fileMetas.error.isEmpty()&&this.getValue().files.map(function(t){return Object(E.headOption)(e.props.fileMetas.list.filter(function(e){return e.id.value===t.value})).map(function(n){return d.createElement(kn.a,{style:r,key:t.value},d.createElement(bn.a,null,d.createElement(jn.a,{disabled:!Object(Tn.a)(Object(E.toOption)(e.props.control)).getOrElse(function(){return!1}),onClick:function(){return e.onFileDelete(t)},style:{alignSelf:"center",flexShrink:0}},d.createElement(Ke.a,{style:{fill:o}}))),d.createElement(On.a,{primary:n.entity.originalName,onClick:function(){return e.onSaveFile(t)},style:{cursor:"pointer"}}))}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Описание файла не было загружено"))})})),Object(Tn.b)(Object(E.toOption)(this.props.control)).getOrElse(function(){return!1})&&d.createElement(Rn,{onDrop:this.onFilesDrop,disableClick:i.disabled,className:"FileListControlEditor__dropzone",style:n,accept:Object(wn.a)(Object(E.toOption)(this.props.control)).getOrElse(function(){return""})},function(t){var n=t.isDragActive;return d.createElement("div",{className:n?"FileListControlEditor__dropzone-wrapper":""},d.createElement("div",{className:"FileListControlEditor__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),d.createElement(Z.a,{display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}}]),t}(d.Component);_n=Pn([m.autobind,xn("design:paramtypes",[Object])],_n);var Fn=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueFileList}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,fileMetas:e.fileMetas,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.fileMetas===t.fileMetas},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)&&Object(E.isEqual)(e.authToken,t.authToken)&&e.fileMetas===t.fileMetas&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.formRecordId,t.formRecordId)}})(_n),Dn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(mn,{output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Fn,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,formId:this.props.formId,output:this.props.output,control:this.props.control,onChange:this.props.onChange,blockStyle:this.props.blockStyle}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(S.a),Mn=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)&&Object(E.isEqual)(e.formRecordId,e.formRecordId)}})(Object(fe.a)([function(e){e.dispatch(Object(de.c)(e.blockRendererId,e.display))}],[],[],[])(Dn)),Bn=n(4),Vn=n.n(Bn),Ln=n(1605),qn=n.n(Ln),$n=n(1606),An=n.n($n),Nn=n(1766),Wn=n.n(Nn),zn=n(1765),Un=n.n(zn),Hn=n(109),Kn=n(379),Gn=(n(1559),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Jn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Yn=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r={};return e.value.getOrElse(function(){return new k.ValueFileList([])}).files.forEach(function(e){return r[e.value]=!1}),n.state={imageFetching:r,currentImageIdx:0},n}return s()(t,e),a()(t,[{key:"getImageSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Hn.b)(n,e,t.props.cdnAddress)}).getOrElse(function(){return n(622)})}},{key:"onImageLoad",value:function(e){this.setState(K(this.state,{imageFetching:Vn()({},e.value,{$set:!1})}))}},{key:"getValue",value:function(){return this.props.value.getOrElse(function(){return new k.ValueFileList([])})}},{key:"openFullScreenMode",value:function(e){var t=this,n=this.props.openDialog("",d.createElement("div",{className:"ImageControlEditor__imageDialog-wrapper",onClick:function(){return t.props.handleDialogClose(n)}},d.createElement("div",{className:"ImageControlEditor__imageDialog-container"},d.createElement("img",{className:"ImageControlEditor__imageDialog-image",src:this.getImageSrc(e)}))),[],{fullScreen:!0})}},{key:"renderGrid",value:function(){var e=this,t=this.props.display.control.map(function(e){return e}),n=Object(Kn.a)(t),r=Object(Kn.b)(n),o=Object(Kn.c)(n);return d.createElement("div",{className:"ImageListControlDisplay__root"},d.createElement(qn.a,{cellHeight:o.getOrElse(function(){return 160}),cols:r.getOrElse(function(){return 3})},this.getValue().files.map(function(t,n){return d.createElement(An.a,{key:n,cols:1},e.state.imageFetching[t.value]?d.createElement(pn.a,null):d.createElement("img",{style:{display:e.state.imageFetching[t.value]?"none":""},src:e.getImageSrc(t),onLoad:function(){return e.onImageLoad(t)},onClick:function(){return e.openFullScreenMode(t)}}))})))}},{key:"getCurrentSliderImage",value:function(){return Object(E.lift)(this.getValue().files,this.state.currentImageIdx)}},{key:"onNextImage",value:function(){this.setState(K(this.state,{currentImageIdx:{$set:this.state.currentImageIdx+1}}))}},{key:"onPreviousImage",value:function(){this.setState(K(this.state,{currentImageIdx:{$set:this.state.currentImageIdx-1}}))}},{key:"renderSlider",value:function(){var e=this,t=this.props.display.elementCss.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}).getOrElse(function(){return"inherit"});return d.createElement("div",{className:"ImageListControlDisplay__silder-root"},d.createElement("div",{className:"ImageListControlDisplay__silder-button"},d.createElement(jn.a,{onClick:this.onPreviousImage,disabled:0===this.state.currentImageIdx},d.createElement(Un.a,null))),d.createElement(qn.a,{className:"ImageListControlDisplay__slider-gridList",cols:1},d.createElement(An.a,{key:0,cols:1,style:{height:t}},this.getCurrentSliderImage().map(function(t){return e.state.imageFetching[t.value]?d.createElement(pn.a,null):d.createElement("img",{style:{display:e.state.imageFetching[t.value]?"none":""},src:e.getImageSrc(t),onLoad:function(){return e.onImageLoad(t)},onClick:function(){return e.openFullScreenMode(t)}})}).getOrNull())),d.createElement("div",{className:"ImageListControlDisplay__silder-button"},d.createElement(jn.a,{onClick:this.onNextImage,disabled:this.state.currentImageIdx>=this.getValue().files.length-1},d.createElement(Wn.a,null))))}},{key:"render",value:function(){var e=this.props.display.control.map(function(e){return e});return Object(Kn.d)(e).getOrElse(function(){return!1})?this.renderGrid():this.renderSlider()}}]),t}(d.Component);Yn=Gn([m.autobind,Jn("design:paramtypes",[Object])],Yn);var Zn=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueFileList}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(E.isEqual)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.authToken,t.authToken)}})(Object(X.a)(Yn)),Xn=n(1516),Qn=n(241),er=n.n(Qn),tr=n(243),nr=n.n(tr),rr=n(242),or=n.n(rr),ir=n(261),ar=n.n(ir),ur=n(324),lr=n.n(ur),cr=n(420),sr=(n(1561),n(1808)),pr=n.n(sr),fr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hr={color:lr.a[500]},mr=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r={};return n.props.value.getOrElse(function(){return new k.ValueFileList([])}).files.forEach(function(e){return r[e.value]=!1}),n.state={imageFetching:r,dialog:{open:!1,actions:[],title:new E.None,body:new E.None}},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.value,n=Object(Xn.a)(t.getOrElse(function(){return new k.ValueFileList([])}).files.map(function(e){return[e.value,!1]}));this.setState(K(this.state,{imageFetching:{$set:n}}))}},{key:"handleDialogClose",value:function(){this.setState(K(this.state,{dialog:{$set:K(this.state.dialog,{open:{$set:!1}})}}))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.setState(K(this.state,{dialog:{$set:{open:!0,title:new E.Some(e),body:new E.Some(t),actions:n||[]}}}))}},{key:"getImageSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Hn.b)(n,e,t.props.cdnAddress)}).getOrElse(function(){throw"token has not been provided"})}},{key:"onImageLoad",value:function(e){var t=this.state.imageFetching;t[e.value]=!1,this.setState(K(this.state,{imageFetching:{$set:t}}))}},{key:"uploadImage",value:function(e,t){var n=this;Object(Cn.h)(e,this.props.cdnAddress,this.props.authToken,this.props.organisation.organisationId,this.props.eventLine.eventLineId,this.props.formRecordId,new E.None,"false",!0,Object(E.toOption)(this.props.output.formField),Object(E.toOption)(this.props.formId),t).then(function(e){n.props.formRecordId.matchWith(function(e){Object(Cn.f)(n.props.formId,e,n.props.output.formField).then(function(e){n.props.onChange(new k.ValueFileList(e.list.map(function(e){return e.id})),n.props.output),n.handleDialogClose()})},function(){var r=n.props.value.getOrElse(function(){return new k.ValueFileList([])}),o=r;t.map(function(t){var n=r.files.indexOf(t);o=K(r,{files:{$splice:[[n,1],[n,0,e]]}})}).getOrElse(function(){o.files.push(e)}),n.props.onChange(o,n.props.output),n.handleDialogClose()})}).catch(function(e){n.props.dispatch(Object(In.h)(n.props.i18n.t("Во время загрузки файла произошла ошибка")))})}},{key:"onPhotoEditRequested",value:function(e){var t=this,n=this.props.value.getOrElse(function(){return new k.ValueFileList([])});this.openDialog(this.props.i18n.t("Редактирование фотографии"),d.createElement(cr.b,{src:e.flatMap(function(e){return Object(E.toOption)(t.getImageSrc(e))}),onClose:this.handleDialogClose,onFileChange:function(e){},onFileCreate:function(e){},onSave:function(n){t.uploadImage(n,e)},onDelete:function(){e.foreach(function(e){Object(Cn.a)(e).then(function(r){t.showNotification("Файл успешно удален"),t.props.onChange(K(n,{files:{$set:n.files.filter(function(t){return t.value!==e.value})}}),t.props.output)}).catch(function(e){return t.showNotification("Во время удаления файла произошла ошибка")}),t.handleDialogClose()})},defaultSrc:new E.None,recommendedAspectRatios:[],recommendedSizes:[],allowedFormats:Object(wn.a)(this.props.display.control).getOrElse(function(){return"image/*"})}),[])}},{key:"showNotification",value:function(e){this.props.dispatch(Object(In.h)(this.props.i18n.t(e)))}},{key:"render",value:function(){var e=this,t=this.props.value.getOrElse(function(){return new k.ValueFileList([])}),n=this.props.display.control.map(function(e){return e.disabled}).getOrElse(function(){return!1});return d.createElement("div",{className:"ImageListControlEditor__container"},t.files.map(function(t){return d.createElement("div",{key:t.value},e.state.imageFetching[t.value]&&d.createElement("div",{className:"ImageListControlEditor__image-loader"},d.createElement(pn.a,{style:{position:"absolute",top:"50%",left:"50%"}})),d.createElement("div",{className:"ImageListControlEditor__imageContainer"},d.createElement("img",{className:"ImageListControlEditor__image",style:{display:e.state.imageFetching[t.value]?"none":""},src:e.getImageSrc(t),onLoad:function(){return e.onImageLoad(t)},onClick:function(){return e.onPhotoEditRequested(Object(E.toOption)(t))}})))}),0===t.files.length&&d.createElement("p",null,this.props.i18n.t("Галерея пуста")),d.createElement("div",{className:"ImageListControlEditor__imageContainer",key:"new",onClick:function(){return e.onPhotoEditRequested(new E.None)}},d.createElement(jn.a,{disabled:n},d.createElement(pr.a,{className:"ImageListControlEditor__image-addButton"}))),this.props.error.map(function(e){return d.createElement("p",{style:hr},e)}).getOrNull(),d.createElement(er.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose},d.createElement(ar.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),d.createElement(nr.a,{style:{borderTop:"none"}},this.state.dialog.actions),d.createElement(or.a,null,this.state.dialog.body.getOrElse(function(){return d.createElement("div",null)}))))}}]),t}(d.Component);mr=fr([m.autobind,dr("design:paramtypes",[Object])],mr);var yr=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueFileList}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.fileMetas===t.fileMetas},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)&&Object(E.isEqual)(e.authToken,t.authToken)&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&Object(E.isEqual)(e.formRecordId,t.formRecordId)}})(mr),br=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Zn,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(yr,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,formId:this.props.formId,output:this.props.output,onChange:this.props.onChange}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(S.a),gr=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)&&Object(E.isEqual)(e.formRecordId,e.formRecordId)}})(br),Or=n(52),vr=n.n(Or),kr=(n(1563),n(1470)),Er=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},jr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Cr=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={imageFetching:!0,photoHeight:0,photoWidth:0},n}return s()(t,e),a()(t,[{key:"getImageSrc",value:function(){var e=this;return this.props.value.flatMap(function(e){return Object(E.headOption)(e.files)}).flatMap(function(t){return e.props.authToken.map(function(n){return Object(Hn.b)(n,t,e.props.cdnAddress)})}).getOrElse(function(){return e.isPhotoDisplayElement()?e.props.display.control.map(function(t){return e.props.dispatch(Object(kr.b)(t))}).getOrElse(function(){return n(622)}):n(854)})}},{key:"isValueEmpty",value:function(){return this.props.value.flatMap(function(e){return Object(E.headOption)(e.files)}).isEmpty()}},{key:"onImageLoad",value:function(e){this.setState(K(this.state,{imageFetching:{$set:!1},photoHeight:{$set:e.target.naturalHeight},photoWidth:{$set:e.target.naturalWidth}}))}},{key:"isRightAspectRatio",value:function(){var e=this;return this.props.display.control.filter(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.enabled}).map(function(e){return e.settings.aspectRatio.width/e.settings.aspectRatio.height}).matchWith(function(t){var n=e.state.photoWidth/e.state.photoHeight-t;return n<=.01&&n>=-.01},function(){return!0})}},{key:"isHighlightError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.highlightError}).nonEmpty()}},{key:"isShowError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.showError}).nonEmpty()}},{key:"isPhotoDisplayElement",value:function(){return this.props.display.control.map(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this.props.display.elementCss,t=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),n=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),r=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxWidth})}),o=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minWidth})}),i=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxHeight})}),a=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minHeight})});return d.createElement("div",{className:"ImageControlDisplay__container"},this.state.imageFetching&&d.createElement("div",{className:"ImageControlDisplay__image-loader"},d.createElement(pn.a,{style:{position:"absolute",top:"50%",left:"50%"}})),d.createElement("div",{className:"ImageControlDisplay__imageWrapper"},d.createElement("img",{className:"ImageControlDisplay__image",style:{display:this.state.imageFetching?"none":"inline-block",width:t.getOrElse(function(){return"auto"}),height:n.getOrElse(function(){return"auto"}),maxWidth:r.getOrElse(function(){return"none"}),minWidth:o.getOrElse(function(){return"none"}),maxHeight:i.getOrElse(function(){return"none"}),minHeight:a.getOrElse(function(){return"none"})},src:this.getImageSrc(),onLoad:this.onImageLoad}),!this.state.imageFetching&&!this.isValueEmpty()&&!this.isRightAspectRatio()&&this.isHighlightError()&&d.createElement("div",{className:"ImageControlDisplay__highlightError"})),!this.state.imageFetching&&!this.isValueEmpty()&&!this.isRightAspectRatio()&&this.isShowError()&&d.createElement(vr.a,{color:"error",align:"center"},this.props.i18n.t("Неверное соотношение")))}}]),t}(d.Component);Cr=Er([m.autobind,jr("design:paramtypes",[Object])],Cr);var Rr=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueFileList}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(E.isEqual)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.authToken,t.authToken)}})(Cr),Ir=n(86),Sr=n.n(Ir),wr=n(631),Tr=n.n(wr),Pr=n(414),xr=n.n(Pr),_r=n(1623),Fr=n.n(_r),Dr=(n(1565),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Mr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Br=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={imageError:!1,imageFetching:n.getLoadingInitialState(e.value),value:e.value,src:n.getImageSrc(e.value),photoHeight:0,photoWidth:0,windowWidth:window.innerWidth,windowHeight:window.innerHeight},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onWindowResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"onWindowResize",value:function(){this.setState(K(this.state,{windowWidth:{$set:window.innerWidth},windowHeight:{$set:window.innerHeight}}))}},{key:"componentWillReceiveProps",value:function(e){if(!Object(E.isEqual)(this.state.value,e.value)){var t=e.value;this.state.value.flatMap(function(e){return Object(E.headOption)(e.files)}).flatMap(function(e){return t.flatMap(function(e){return Object(E.headOption)(e.files)}).map(function(t){return t.value!==e.value})}).getOrElse(function(){return!0})&&this.setState(K(this.state,{imageFetching:{$set:this.getLoadingInitialState(t)},imageError:{$set:!1},value:{$set:t},src:{$set:this.getImageSrc(t)}}))}}},{key:"getImageSrc",value:function(e){var t=this;return e.flatMap(function(e){switch(e.tpe){case k.ValueFileList.$Type:return Object(E.headOption)(e.files).flatMap(function(e){return t.props.authToken.map(function(n){return Object(Hn.b)(n,e,t.props.cdnAddress)})});default:return new E.None}})}},{key:"getLoadingInitialState",value:function(e){return e.map(function(e){switch(e.tpe){case k.ValueFileList.$Type:return 0!==e.files.length;default:return!1}}).getOrElse(function(){return!1})}},{key:"onChange",value:function(e){var t=this;this.props.formRecordId.matchWith(function(e){Object(Cn.f)(t.props.formId,e,t.props.output.formField).then(function(e){return Object(E.headOption)(e.list).matchWith(function(e){var n=new k.ValueFileList([e.id]);t.props.onChange(n,t.props.output),t.props.dispatch(Object(H.I)({blockRendererId:t.props.blockRendererId,value:n}))},function(){t.props.onChange(new k.ValueFileList([]),t.props.output),t.props.dispatch(Object(H.I)({blockRendererId:t.props.blockRendererId,value:new k.ValueFileList([])}))})})},function(){t.props.onChange(e,t.props.output)})}},{key:"onImageLoad",value:function(e){this.setState(K(this.state,{imageFetching:{$set:!1},photoHeight:{$set:e.target.naturalHeight},photoWidth:{$set:e.target.naturalWidth}}))}},{key:"onImageError",value:function(){this.setState(K(this.state,{imageError:{$set:!0},imageFetching:{$set:!1}}))}},{key:"uploadImage",value:function(e,t){var n=this;Object(Cn.h)(e,this.props.cdnAddress,this.props.authToken,this.props.organisation.organisationId,this.props.eventLine.eventLineId,this.props.formRecordId,new E.None,"false",!1,Object(E.toOption)(this.props.output.formField),Object(E.toOption)(this.props.formId)).then(function(e){n.onChange(new k.ValueFileList([e])),n.props.handleDialogClose(t)}).catch(function(e){n.props.dispatch(Object(In.h)(n.props.i18n.t("Во время загрузки файла произошла ошибка")))})}},{key:"onPhotoEditRequested",value:function(){var e=this;this.props.value;if(this.props.control.settings.operations.edtitng)var t=this.props.openDialog("",d.createElement(cr.b,{src:this.state.src.filter(function(t){return!e.state.imageError}),onClose:function(){return e.props.handleDialogClose(t)},onFileChange:function(e){},onFileCreate:function(e){},onSave:function(n){return function(t,n){e.uploadImage(t,n)}(n,t)},onDelete:function(){return function(t){e.handleDelete(),e.props.handleDialogClose(t)}(t)},aspectRatio:this.props.control.settings.aspectRatio.enabled?this.props.control.settings.aspectRatio.width/this.props.control.settings.aspectRatio.height:void 0,cropAndSave:this.props.control.settings.operations.cropAndSave,reduceSize:this.props.control.settings.reduceSize,defaultSrc:this.props.dispatch(Object(kr.b)(this.props.control)),recommendedAspectRatios:[],recommendedSizes:[],allowedFormats:Object(wn.a)(Object(E.toOption)(this.props.control)).getOrElse(function(){return"image/*"})}),[],{fullScreen:this.state.windowWidth<cr.a,hideTitle:!0})}},{key:"onUploadFileRequested",value:function(){var e=this;if(this.props.control.settings.operations.edtitng)var t=this.props.openDialog(this.props.i18n.t("Загрузка фотографии"),d.createElement(Rn,{onDrop:function(n){return function(t,n){if(0===t.length)throw"There are not files to process";var r=t[t.length-1];Object(Cn.h)(r,e.props.cdnAddress,e.props.authToken,e.props.organisation.organisationId,e.props.eventLine.eventLineId,e.props.formRecordId,new E.None,"false",!1,Object(E.toOption)(e.props.output.formField),Object(E.toOption)(e.props.formId)).then(function(t){e.props.value.flatMap(function(e){return Object(E.headOption)(e.files)}).foreach(function(t){return e.deleteFile(t)}),e.onChange(new k.ValueFileList([t]))}).catch(function(t){e.props.dispatch(Object(In.h)(e.props.i18n.t("Во время загрузки файла произошла ошибка")))}),e.props.handleDialogClose(n)}(n,t)},multiple:!0,accept:Object(wn.a)(Object(E.toOption)(this.props.control)).getOrElse(function(){return"image/*"}),className:"FileListControlEditor__dropzone"},function(t){var n=t.isDragActive;return d.createElement("div",{className:n?"FileListControlEditor__dropzone-wrapper":""},d.createElement("div",{className:"FileListControlEditor__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))}),[])}},{key:"handleDelete",value:function(){var e=this;this.props.control.settings.operations.deleting&&this.props.value.flatMap(function(e){return Object(E.headOption)(e.files)}).foreach(function(t){return e.deleteFile(t).then(function(t){return e.onChange(new k.ValueFileList([]))})})}},{key:"handleImageModalClosed",value:function(){this.setState(K(this.state,{modalDialogOpen:{$set:!1}}))}},{key:"deleteFile",value:function(e){var t=this;return Object(Cn.a)(e).then(function(e){t.showNotification("Фото успешно удалено")}).catch(function(e){return t.showNotification("Во время удаления фото произошла ошибка")})}},{key:"showNotification",value:function(e){this.props.dispatch(Object(In.h)(this.props.i18n.t(e)))}},{key:"openFullScreenDialog",value:function(){var e=this,t=this.props.openDialog("",d.createElement("div",{className:"ImageControlEditor__imageDialog-wrapper",onClick:function(){return e.props.handleDialogClose(t)}},d.createElement("div",{className:"ImageControlEditor__imageDialog-container"},d.createElement("img",{className:"ImageControlEditor__imageDialog-image",src:this.state.src.getOrElse(function(){return e.props.dispatch(Object(kr.b)(e.props.control)).getOrElse(function(){return n(622)})})}))),[],{fullScreen:!0})}},{key:"openFullScreenMode",value:function(){var e=this;this.props.display.control.filter(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).matchWith(function(t){return Object(E.toOption)(t.settings.ui.fullScreen).filter(function(e){return e}).foreach(function(){return e.openFullScreenDialog()})},function(){return e.openFullScreenDialog()})}},{key:"isRightAspectRatio",value:function(){var e=this;return this.props.display.control.filter(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.enabled}).map(function(e){return e.settings.aspectRatio.width/e.settings.aspectRatio.height}).matchWith(function(t){var n=e.state.photoWidth/e.state.photoHeight-t;return n<=.01&&n>=-.01},function(){return!0})}},{key:"isHighlightError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.highlightError}).nonEmpty()}},{key:"isShowError",value:function(){return this.props.display.control.filter(function(e){return e.tpe.value===k.ElementControlPhoto.$Type.value}).filter(function(e){return e.settings.aspectRatio.showError}).nonEmpty()}},{key:"render",value:function(){var e=this,t=this.props.control.settings.operations.edtitng,r=this.state.src.nonEmpty()&&this.props.control.settings.operations.deleting,o=this.props.display.elementCss,i=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),a=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),u=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxWidth})}),l=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minWidth})}),c=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxHeight})}),s=o.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minHeight})}),p=this.props.display.control.map(function(e){return e.disabled}).getOrElse(function(){return!1}),f=this.props.display.control.flatMap(function(e){return e.settings.ui.editButtonColor}).getOrElse(function(){return"#fff"});return d.createElement("div",{className:"ImageControlEditor__container"},d.createElement("div",{className:"ImageControlEditor__wrapper"},this.state.imageFetching&&d.createElement("div",{className:"ImageControlEditor__image-loader"},d.createElement(pn.a,{style:{position:"absolute",top:"50%",left:"50%"}})),this.state.imageError&&d.createElement("div",{className:"ImageControlEditor__imageWrapper"},d.createElement("div",{className:"ImageControlEditor__image-error"},d.createElement("div",{style:{position:"absolute",display:"inline-block",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"red",textAlign:"center"}},this.props.i18n.t("При загрузке произошла ошибка")))),(t||r)&&d.createElement("div",{className:"ImageControlEditor__image-buttonsBar"},t&&d.createElement(Fr.a,{style:{width:40,height:40,backgroundColor:f},disabled:p,onClick:this.props.control.settings.operations.simpleEditing?this.onUploadFileRequested:this.onPhotoEditRequested},this.state.src.isEmpty()?d.createElement(Tr.a,null):d.createElement(Sr.a,null)),r&&d.createElement(Fr.a,{style:{width:40,height:40,marginLeft:10,backgroundColor:f},disabled:p,onClick:this.handleDelete},d.createElement(xr.a,null))),!this.state.imageError&&d.createElement("div",{className:"ImageControlEditor__imageWrapper",onClick:this.openFullScreenMode},d.createElement("img",{className:"ImageControlEditor__image",style:{display:this.state.imageFetching?"none":"inline-block",width:i.getOrElse(function(){return"auto"}),height:a.getOrElse(function(){return"auto"}),maxWidth:u.getOrElse(function(){return"none"}),minWidth:l.getOrElse(function(){return"none"}),maxHeight:c.getOrElse(function(){return"none"}),minHeight:s.getOrElse(function(){return"none"})},src:this.state.src.getOrElse(function(){return e.props.dispatch(Object(kr.b)(e.props.control)).getOrElse(function(){return n(622)})}),onLoad:this.onImageLoad,onError:this.onImageError}),!this.state.imageFetching&&this.state.src.nonEmpty()&&!this.isRightAspectRatio()&&this.isHighlightError()&&d.createElement("div",{className:"ImageControlEditor__highlightError"})),(t||r)&&d.createElement("div",{className:"ImageControlEditor__image-buttonsBar"},t&&d.createElement(Fr.a,{style:{width:40,height:40,backgroundColor:f},disabled:p,onClick:this.props.control.settings.operations.simpleEditing?this.onUploadFileRequested:this.onPhotoEditRequested},this.state.src.isEmpty()?d.createElement(Tr.a,null):d.createElement(Sr.a,null)),r&&d.createElement(Fr.a,{style:{width:40,height:40,marginLeft:10,backgroundColor:f},disabled:p,onClick:this.handleDelete},d.createElement(xr.a,null))),!this.state.imageFetching&&this.state.src.nonEmpty()&&!this.isRightAspectRatio()&&this.isShowError()&&d.createElement(vr.a,{color:"error",align:"center"},this.props.i18n.t("Неверное соотношение"))),d.createElement(Z.a,{display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}}]),t}(d.Component);Br=Dr([m.autobind,Mr("design:paramtypes",[Object])],Br);var Vr=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueFileList}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n,authToken:e.auth.token,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.auth.token===t.auth.token&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.fileMetas===t.fileMetas},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)&&Object(E.isEqual)(e.authToken,t.authToken)&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.formRecordId,t.formRecordId)}})(Object(X.a)(Br)),Lr=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Rr,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Vr,{display:this.props.display,blockRendererId:this.props.blockRendererId,formRecordId:this.props.formRecordId,output:this.props.output,formId:this.props.formId,control:this.props.control,blockStyle:this.props.blockStyle,onChange:this.props.onChange}))}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(S.a),qr=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)&&Object(E.isEqual)(e.formRecordId,e.formRecordId)}})(Lr),$r=n(1472),Ar=n.n($r),Nr=n(538),Wr=n.n(Nr),zr=n(545),Ur=n.n(zr),Hr=n(541),Kr=(n(1567),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Gr=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Jr=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fetching:!0,result:{}},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.fetchUsers(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(Oe.a)(this.props.value,e.value)||this.fetchUsers(e)}},{key:"fetchUsers",value:function(e){var t=this;e.value.map(function(n){t.setState(K(t.state,{fetching:{$set:!0}})),e.dispatch(Object(Hr.a)()).then(function(e){t.setState(K(t.state,{fetching:{$set:!1},result:{$set:Object(Xn.a)(e.map(function(e){return[e.id.toString(),e]}))}}))})}).getOrElse(function(){return t.setState(K(t.state,{fetching:{$set:!1}}))})}},{key:"render",value:function(){var e=this;if(this.state.fetching)return d.createElement(pn.a,null);var t=this.props.value.getOrElse(function(){return new k.ValueUserRefs([])});return d.createElement("div",{className:"UsersControlDisplay__container"},t.refs.map(function(t){return Object(E.toOption)(e.state.result[t.id.value]).map(function(n){return d.createElement(Ar.a,{key:t.id.value,label:n.name,className:"UsersControlDisplay__chip",avatar:n.avatarId.flatMap(function(t){return e.props.authToken.map(function(n){return d.createElement(Wr.a,{src:Object(Hn.b)(n,new k.Id(t.toString()),e.props.cdnAddress)})})}).getOrElse(function(){return d.createElement(Wr.a,null,d.createElement(Ur.a,null))})})}).getOrNull()}))}}]),t}(d.Component);Jr=Kr([m.autobind,Gr("design:paramtypes",[Object])],Jr);var Yr=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueUserRefs}),authToken:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(Oe.a)(e.auth.token,t.auth.token)},areStatePropsEqual:function(e,t){return Object(Oe.a)(e.value,t.value)&&Object(Oe.a)(e.authToken,t.authToken)}})(Jr),Zr=n(34),Xr=n.n(Zr),Qr=n(24),eo=n.n(Qr),to=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},no=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ro={flex:"1"},oo={smallAvatar:{width:30,height:30}},io=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fetching:!1,error:new E.None,userDescriptions:[]},n}return s()(t,e),a()(t,[{key:"onChange",value:function(e){this.props.onChange(new k.ValueUserRefs("EMPTY"===e.target.value?[]:[new k.EntityRef(k.Id.createId(e.target.value).getOrElse(function(){throw"wrong user id"}),k.User.$Type.value)]),this.props.output)}},{key:"onMultipleChange",value:function(e){var t=this;Object(E.toOption)(e.target.value).filter(function(e){return e instanceof Array}).matchWith(function(e){t.props.onChange(new k.ValueUserRefs(e.map(function(e){return new k.EntityRef(k.Id.createId(e).getOrElse(function(){throw"wrong user id"}),k.User.$Type.value)})),t.props.output)},function(){throw"wrong user refs value type"})}},{key:"componentDidMount",value:function(){this.fetchUsers(this.props)}},{key:"componentWillReceiveProps",value:function(e){Object(E.isEqual)(this.props.value,e.value)||this.fetchUsers(e)}},{key:"fetchUsers",value:function(e){var t=this;this.setState(K(this.state,{fetching:{$set:!0},error:{$set:new E.None},userDescriptions:{$set:[]}}),function(){e.dispatch(Object(Hr.a)()).then(function(e){t.setState(K(t.state,{fetching:{$set:!1},error:{$set:new E.None},userDescriptions:{$set:e}}))}).catch(function(e){t.setState(K(t.state,{fetching:{$set:!1},error:{$set:Object(E.toOption)(e)},userDescriptions:{$set:[]}}))})})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(){Object(Te.b)(this.props.display.elementCss,this.props.error);return this.wrapControl(d.createElement(d.Fragment,null,d.createElement(Xr.a,null,Object(oe.e)(this.props.display.label.text)),this.renderSelect()),this.props.error)}},{key:"renderWithFixTitle",value:function(){Object(Te.b)(this.props.display.elementCss,this.props.error);return d.createElement(w.a,{display:this.props.display,style:ro,blockStyle:this.props.blockStyle},this.wrapControl(this.renderSelect(),this.props.error))}},{key:"renderMaterialTheme",value:function(e){return e.floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}},{key:"renderSelect",value:function(){return this.props.control.multiple?this.renderMultipleSelect():this.renderSingleSelect()}},{key:"renderSingleSelect",value:function(){var e=this;return d.createElement(A.a,{fullWidth:!0,value:this.props.value.flatMap(function(e){return Object(E.headOption)(e.refs)}).map(function(e){return e.id.value}).getOrElse(function(){return""}),onChange:this.onChange,onBlur:this.onBlur,SelectDisplayProps:{style:{display:"flex",alignItems:"center"}}},d.createElement(eo.a,{value:"EMPTY",key:"empty"}),this.state.userDescriptions.map(function(t){return d.createElement(eo.a,{value:t.id,key:t.id},t.avatarId.flatMap(function(e){return k.Id.createId(e.toString())}).flatMap(function(t){return e.props.token.map(function(n){return Object(Hn.b)(n,t,e.props.cdnAddress)})}).matchWith(function(e){return d.createElement(Wr.a,{style:oo.smallAvatar,alt:t.name,src:e})},function(){return d.createElement(Wr.a,{style:oo.smallAvatar},d.createElement(Ur.a,null))}),d.createElement(On.a,{primary:t.name,secondary:null}))}))}},{key:"renderMultipleSelected",value:function(e){var t=this;return Object(E.toOption)(e).filter(function(e){return e instanceof Array}).matchWith(function(e){return d.createElement("div",null,t.state.userDescriptions.filter(function(t){return e.filter(function(e){return e===t.id}).length>0}).map(function(e){return d.createElement(Ar.a,{key:e.id,label:e.name,style:{marginRight:"5px"},avatar:e.avatarId.flatMap(function(e){return k.Id.createId(e.toString())}).flatMap(function(e){return t.props.token.map(function(n){return Object(Hn.b)(n,e,t.props.cdnAddress)})}).matchWith(function(t){return d.createElement(Wr.a,{alt:e.name,src:t})},function(){return d.createElement(Wr.a,null,d.createElement(Ur.a,null))})})}))},function(){return d.createElement(d.Fragment,null)})}},{key:"renderMultipleSelect",value:function(){var e=this;return d.createElement(A.a,{fullWidth:!0,multiple:!0,value:this.props.value.map(function(e){return e.refs.map(function(e){return e.id.value})}).getOrElse(function(){return[]}),onChange:this.onMultipleChange,onBlur:this.onBlur,SelectDisplayProps:{style:{display:"flex",alignItems:"center"}},renderValue:this.renderMultipleSelected},this.state.userDescriptions.map(function(t){return d.createElement(eo.a,{value:t.id,key:t.id},t.avatarId.flatMap(function(e){return k.Id.createId(e.toString())}).flatMap(function(t){return e.props.token.map(function(n){return Object(Hn.b)(n,t,e.props.cdnAddress)})}).matchWith(function(e){return d.createElement(Wr.a,{style:oo.smallAvatar,alt:t.name,src:e})},function(){return d.createElement(Wr.a,{style:oo.smallAvatar},d.createElement(Ur.a,null))}),d.createElement(On.a,{primary:t.name,secondary:null}))}))}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return this.renderMaterialTheme(e)}}]),t}(d.Component);io=to([m.autobind,no("design:paramtypes",[Object])],io);var ao=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueUserRefs}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),token:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&Object(E.isEqual)(e.auth.token,e.auth.token)},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)&&Object(E.isEqual)(e.token,t.token)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(io),uo=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Yr,{blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return this.props.control.usersSource instanceof k.UsersSourceTypeUserState?d.createElement("div",null):d.createElement(ao,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement("div",null,this.props.i18n.t("Компонент для редактирования по клику не задан"))}}]),t}(S.a),lo=function(e){e.dispatch(Object(de.j)(e.blockRendererId,e.output))},co=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialValues:Object(I.h)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([lo],[function(e,t){Object(E.isEqual)(e.initialValues,t.initialValues)||lo(e)}])(uo)),so=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},po=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fo={flex:"1"},ho=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.areValuesEqual=function(e,t){return e.flatMap(function(e){return t.map(function(t){return Object(Oe.a)(e,t)})}).getOrElse(function(){return!1})},n.state={textFieldTouched:!1},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});!this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})&&t.checked&&(this.state.textFieldTouched||(this.props.onChange(new k.ValueStr(t.value.getOrElse(function(){return""})),this.props.output),this.setState(K(this.state,{$set:{textFieldTouched:!0}}))))}},{key:"onChange",value:function(e){this.props.onChange(new k.ValueStr(e.target.value),this.props.output)}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControl",value:function(e,t){return d.createElement(Ce.a,{fullWidth:!0,style:{marginTop:0}},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFloatingTitle",value:function(e,t){return d.createElement(V.a,{type:"password",fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),onChange:this.onChange,label:Object(oe.e)(this.props.display.label.text),helperText:t.checked&&t.value,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,InputProps:{style:{color:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})===e.value.map(function(e){return e}).getOrElse(function(){return""})&&e.checked?"#757575":"black"}}})}},{key:"renderWithFixTitle",value:function(e,t){return d.createElement(w.a,{display:this.props.display,style:fo,blockStyle:this.props.blockStyle},this.wrapControl(d.createElement(V.a,{fullWidth:!0,variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),type:"password",onChange:this.onChange,helperText:t.checked&&t.value,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,InputProps:{style:{color:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})===e.value.map(function(e){return e}).getOrElse(function(){return""})&&e.checked?"#757575":"black"}}}),this.props.error))}},{key:"renderClassicTheme",value:function(e){return this.wrapControl(d.createElement(Se.a,{type:"password",titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}),this.props.error)}},{key:"renderMaterialTheme",value:function(e){var t=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new k.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue});return e.floating?this.renderWithFloatingTitle(n,t):this.renderWithFixTitle(n,t)}},{key:"render",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme(e):Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme(e)}}]),t}(d.Component);ho=so([m.autobind,po("design:paramtypes",[Object])],ho);var mo=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueStr}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(ho),yo=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement("div",null)}},{key:"renderEditControl",value:function(){return d.createElement(mo,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,blockStyle:this.props.blockStyle,onChange:this.props.onChange})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),bo=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(yo),go=n(1514),Oo=n.n(go),vo=n(1515),ko=n.n(vo),Eo=n(1525),jo=n.n(Eo),Co=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display,r=this.props.display.elementCss,o=r.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),i=r.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),a=t.control.getOrElse(function(){return new k.ElementControlTextField}),u=Object(Te.b)(t.elementCss,new E.None);return d.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:"white"}},d.createElement(Oo.a,{cellHeight:245,style:{width:o.getOrElse(function(){return"auto"}),height:i.getOrElse(function(){return"500px"})},cols:a.columns},this.props.dataInput.flatMap(function(t){return t.valueType.tpe===k.ValueTypeBool.$Type&&e.props.value.isEmpty()?Object(E.toOption)([]):e.props.value.map(function(r){var o=function(e,t,n){return t.id.map(function(t){return Object(E.headOption)(e.formRecords.filter(function(e){return e.id.value===t.value})).flatMap(function(e){return n.flatMap(function(t){return Object(E.liftKey)(e.entity.values,t.value).flatMap(function(e){return Object(E.headOption)(e.value.files)})})})})}(t,r,a.imageFieldId).map(function(t){return t.map(function(t){return e.props.dispatch(Object(kr.a)(t)).getOrElse(function(){return n(854)})}).getOrElse(function(){return n(854)})});switch(r.tpe.value){case k.ValueObjectRefs.$Type.value:return x(t,r,function(e,t){return d.createElement(ko.a,{key:t},d.createElement("img",{src:Object(E.lift)(o,t).getOrElse(function(){return n(854)}),alt:e}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:u}},e)}))},e.props.i18n.t);case k.ValueList.$Type.value:return r.values.map(function(e,t){return d.createElement(ko.a,{key:t},d.createElement("img",{src:Object(E.lift)(o,t).getOrElse(function(){return n(854)}),alt:e.toString()}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:u}},e.toString())}))});case k.ValueBool.$Type.value:return[d.createElement(ko.a,null,d.createElement("img",{src:n(854)}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:u}},r.toString())}))];default:return[d.createElement(ko.a,null,d.createElement("img",{src:n(854),alt:e.props.i18n.t("Неизвестный тип значения")}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:u}},e.props.i18n.t("Неизвестный тип значения"))}))]}})}).getOrElse(function(){return[d.createElement("p",{key:"0"},e.props.i18n.t("Идет загрузка значений"))]})))}}]),t}(d.Component),Ro=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueList||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&e.i18n===t.i18n}})(Co),Io=n(1809),So=n.n(Io),wo=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},To=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Po=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={search:new E.None},n}return s()(t,e),a()(t,[{key:"onValueObjectRefCheckBoxChange",value:function(e){var t=this.props.value.map(function(e){return e.id}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.value===e.value}).length>0;return new k.ValueObjectRefs(n?[].concat(M()(t.filter(function(t){return t.value!==e.value}))):[].concat(M()(t),[e]))}},{key:"onValueListChange",value:function(e){var t=this.props.value.map(function(e){return e.values}).getOrElse(function(){return[]}),n=t.filter(function(t){return t.toString()===e.toString()}).length>0;return new k.ValueList(n?[].concat(M()(t.filter(function(t){return t!==e}))):[].concat(M()(t),[e]))}},{key:"onValueBoolChange",value:function(){return this.props.value.map(function(e){return e.value}).getOrElse(function(){return!1})?new k.ValueEmpty:new k.ValueBool(!0)}},{key:"renderCheckBoxes",value:function(){var e=this,t=Object(Te.b)(this.props.display.elementCss,this.props.error);return this.props.dataInput.map(function(r){var o=e.props.display.control.getOrElse(function(){return new k.ElementControlTextField}).imageFieldId.map(function(t){return r.formRecords.map(function(r){return Object(E.liftKey)(r.entity.values,t.value).filter(function(e){return e.value instanceof k.ValueFileList}).flatMap(function(t){return Object(E.headOption)(t.value.files).map(function(t){return e.props.dispatch(Object(kr.a)(t)).getOrElse(function(){return n(854)})})}).getOrElse(function(){return n(854)})})}).getOrElse(function(){return[]});switch(r.valueType.tpe.value){case k.ValueTypeValuesList.$Type.value:return r.value.values.map(function(r,i){return d.createElement(ko.a,{key:i,style:{cursor:"pointer"},onClick:function(t){return e.props.onChange(e.onValueListChange(r),e.props.output)}},Object(E.headOption)(e.props.value.map(function(e){return e instanceof k.ValueList?e.values:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof k.ValueStr&&e.value===r.value})).nonEmpty()&&d.createElement(So.a,{style:{fill:"#4285f4",position:"absolute",right:0}}),"}",d.createElement("img",{src:Object(E.lift)(o,i).getOrElse(function(){return n(854)}),alt:r.toString()}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:t}},r.toString())}))});case k.ValueTypeObjectRefs.$Type.value:return r.displayValues.map(function(r,i){return d.createElement(ko.a,{key:i,style:{cursor:"pointer"},onClick:function(t){return e.props.onChange(e.onValueObjectRefCheckBoxChange(r.id),e.props.output)}},Object(E.headOption)(e.props.value.map(function(e){return e instanceof k.ValueObjectRefs?e.id:[]}).getOrElse(function(){return[]}).filter(function(e){return e instanceof k.Id&&e.value===r.id.value})).nonEmpty()&&d.createElement(So.a,{style:{fill:"#4285f4",position:"absolute",right:0,zIndex:10}}),d.createElement("img",{src:Object(E.lift)(o,i).getOrElse(function(){return n(854)}),alt:r.value.toString()}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:t}},r.value.toString())}))});case k.ValueTypeBool.$Type.value:return[d.createElement(ko.a,{style:{cursor:"pointer"},onClick:function(t){return e.props.onChange(e.onValueBoolChange(),e.props.output)}},e.props.value.map(function(e){return e instanceof k.ValueBool&&e.value}).getOrElse(function(){return!1})&&d.createElement(So.a,{style:{fill:"#4285f4",position:"absolute",right:0}}),d.createElement("img",{src:n(854),alt:e.props.i18n.t("Значение")}),d.createElement(jo.a,{title:d.createElement("span",{style:{color:t}},e.props.i18n.t("Значение"))}))];default:throw"Unknown value type"}}).getOrElse(function(){return[d.createElement("div",null,e.props.i18n.t("Значения отсутствуют"))]})}},{key:"render",value:function(){var e=this.props.display,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),r=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),o=e.control.getOrElse(function(){return new k.ElementControlTextField});return d.createElement(w.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:"white"}},d.createElement(Oo.a,{cellHeight:245,style:{width:n.getOrElse(function(){return"auto"}),height:r.getOrElse(function(){return"500px"})},cols:o.columns},this.renderCheckBoxes())),d.createElement(Z.a,{display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}}]),t}(d.Component);Po=wo([m.autobind,To("design:paramtypes",[Object])],Po);var xo=Object(h.connect)(function(e,t){return{value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueList||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.display.id),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&Object(E.isEqual)(e.error,t.error)&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(Po),_o=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Ro,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){var e=this;return this.props.display.dataInput.map(function(t){return d.createElement(xo,{display:e.props.display,blockRendererId:e.props.blockRendererId,control:e.props.control,input:t,output:e.props.output,onControlBlur:e.props.onControlBlur,blockStyle:e.props.blockStyle,onChange:e.props.onChange})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Не задано поле поставщик данных"))})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),Fo=function(e){e.dispatch(Object(de.e)(e.blockRendererId,e.display,e.formId))},Do=Object(h.connect)(function(e,t){return{i18n:e.i18n,initialDictionaries:Object(I.f)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(Object(fe.a)([Fo],[function(e,t){Object(E.isEqual)(e.initialDictionaries,t.initialDictionaries)&&Fo(e)}],[],[],function(e,t){return!function(e,t){return e.formId.value===t.formId.value&&Object(E.isEqual)(e.blockStyle,t.blockStyle)&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId&&e.blockStyle===t.blockStyle&&e.output===t.output&&e.onChange===t.onChange&&e.onControlBlur===t.onControlBlur}(e,t)&&e.i18n!==t.i18n})(_o)),Mo=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.control.timeZoneOffset;return this.props.value.map(function(t){var n=new Date(t.value.getTime()-6e4*(e-t.value.getTimezoneOffset()));return d.createElement("span",null,n.toLocaleTimeString().slice(0,5))}).getOrElse(function(){return d.createElement("span",null)})}}]),t}(d.Component),Bo=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueDate})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(Mo),Vo=n(657),Lo=n.n(Vo),qo=n(1810),$o=n.n(qo),Ao=n(162),No=n.n(Ao),Wo=n(23),zo=function(e){return d.createElement("div",{style:{display:"flex",alignItems:"center"}},d.createElement("div",{style:{flex:1}},d.cloneElement(e.children,{InputProps:{endAdornment:d.createElement(No.a,{position:"end"},d.createElement(jn.a,{style:{flexShrink:0},onClick:function(t){t.stopPropagation(),Object(Wo.toOption)(e.displayType).filter(function(e){return e instanceof k.DisplayTypeEditByClick}).matchWith(function(){return e.dispatch(Object(H.L)({blockRendererId:e.blockRendererId,output:e.output,value:new k.ValueEmpty,displayId:e.displayId}))},function(){return e.dispatch(Object(H.D)({blockRendererId:e.blockRendererId,output:e.output,value:new k.ValueEmpty,displayId:e.displayId}))})}},d.createElement($o.a,null)))}})))},Uo=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ho=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getControl",value:function(){return this.props.display.control.map(function(e){return e})}},{key:"onChange",value:function(e){this.props.onChange(new k.ValueDate(e.getTime()+6e4*(this.props.control.timeZoneOffset-e.getTimezoneOffset())),this.props.output)}},{key:"onInputChange",value:function(e){var t=this;Object(E.toOption)(e.target.value).filter(function(e){return""===e}).foreach(function(){return t.props.onChange(new k.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getDate",value:function(){var e=this;return this.props.value.map(function(t){return new Date(t.value.getTime()-6e4*(e.props.control.timeZoneOffset-t.value.getTimezoneOffset()))}).getOrNull()}},{key:"getViews",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.views}).getOrElse(function(){return[]})}},{key:"getViewsAttr",value:function(){return this.getViews().length>0?{views:this.getViews()}:{}}},{key:"getOpenTo",value:function(){return this.getViews().length>0?{openTo:Object(E.headOption)(this.getViews()).getOrElse(function(){return"year"})}:{}}},{key:"isMaskEnabled",value:function(){return this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.map(function(e){return e.checked})}).getOrElse(function(){return!1})}},{key:"getMask",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.mask})}).getOrElse(function(){return""}).split(",").map(function(e){var t=Object(ve.a)(e),n=Object(E.headOption)(t).getOrElse(function(){return""}),r=Object(E.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return this.isMaskEnabled()?{mask:e}:{}}},{key:"getPlaceholder",value:function(){return this.isMaskEnabled()?{placeholder:this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.placeholderChar})}).getOrElse(function(){return""})}:{}}},{key:"getFormat",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.format});return e.isEmpty()?{}:{format:e.getOrElse(function(){return"HH:mm"})}}},{key:"getTimePicker",value:function(e){var t=this.getControl().map(function(e){return e.pickerAttributes.inline}).getOrElse(function(){return!1})?Vo.InlineTimePicker:Lo.a;return d.createElement(t,Object.assign({fullWidth:!0,error:this.props.error.nonEmpty(),variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),keyboard:this.getControl().map(function(e){return e.pickerAttributes.keyboard}).getOrElse(function(){return!1}),ampm:this.getControl().map(function(e){return e.pickerAttributes.ampm}).getOrElse(function(){return!1}),minutesStep:this.getControl().flatMap(function(e){return e.pickerAttributes.minutesStep}).getOrElse(function(){return 5}),value:this.getDate(),onChange:this.onChange,onInputChange:this.onInputChange,onBlur:this.onBlur},this.getMask(),this.getPlaceholder(),this.getFormat(),e?{label:Object(oe.e)(this.props.display.label.text)}:{},{invalidDateMessage:this.props.i18n.t("Неверный формат даты")}))}},{key:"getClearButtonStatus",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.hideClearButton}).getOrElse(function(){return!1})}},{key:"wrapByClearButton",value:function(e){return d.createElement(zo,{dispatch:this.props.dispatch,output:this.props.output,displayId:this.props.display.id,blockRendererId:this.props.blockRendererId,displayType:this.props.control.displayType},e)}},{key:"renderWithFloatingTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getTimePicker(!0);return d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFixTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getTimePicker(!1);return d.createElement(w.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))}},{key:"render",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle}).floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}}]),t}(d.Component);Ho=Uo([m.autobind],Ho);var Ko=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueDate}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(Ho),Go=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Bo,{control:this.props.control,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(Ko,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),Jo=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(Go),Yo=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.control.timeZoneOffset;return this.props.value.map(function(t){var n=new Date(t.value.getTime()-6e4*(e-t.value.getTimezoneOffset()));return d.createElement("span",null,n.toLocaleDateString())}).getOrElse(function(){return d.createElement("span",null)})}}]),t}(d.Component),Zo=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueDate})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(Yo),Xo=n(165),Qo=n(378),ei=n.n(Qo),ti=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ni=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getControl",value:function(){return this.props.display.control.map(function(e){return e})}},{key:"onChange",value:function(e){this.props.onChange(new k.ValueDate(e.getTime()+6e4*(this.props.control.timeZoneOffset-e.getTimezoneOffset())),this.props.output)}},{key:"onInputChange",value:function(e){var t=this;Object(E.toOption)(e.target.value).filter(function(e){return""===e}).foreach(function(){return t.props.onChange(new k.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getDate",value:function(){var e=this;return this.props.value.map(function(t){return new Date(t.value.getTime()-6e4*(e.props.control.timeZoneOffset-t.value.getTimezoneOffset()))}).getOrNull()}},{key:"getMinMaxDateValue",value:function(e){return e.map(function(e){return new Date(e.value.getTime())}).getOrNull()}},{key:"getMaxDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.maxDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{maxDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getMinDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.minDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{minDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getViews",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.views}).getOrElse(function(){return[]})}},{key:"getViewsAttr",value:function(){return this.getViews().length>0?{views:this.getViews()}:{}}},{key:"getOpenTo",value:function(){return this.getViews().length>0?{openTo:Object(E.headOption)(this.getViews()).getOrElse(function(){return"year"})}:{}}},{key:"isMaskEnabled",value:function(){return this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.map(function(e){return e.checked})}).getOrElse(function(){return!1})}},{key:"getMask",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.mask})}).getOrElse(function(){return""}).split(",").map(function(e){var t=Object(ve.a)(e),n=Object(E.headOption)(t).getOrElse(function(){return""}),r=Object(E.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return this.isMaskEnabled()?{mask:e}:{}}},{key:"getPlaceholder",value:function(){return this.isMaskEnabled()?{placeholder:this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.placeholderChar})}).getOrElse(function(){return""})}:{}}},{key:"getFormat",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.format});return e.isEmpty()?{}:{format:e.getOrElse(function(){return"YYYY/MM/DD"})}}},{key:"getMaxDateForMessage",value:function(){return this.getDisableFuture()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.maxDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getMinDateForMessage",value:function(){return this.getDisablePast()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.minDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getDisableFuture",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disableFuture}).getOrElse(function(){return!1})}},{key:"getDisablePast",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disablePast}).getOrElse(function(){return!1})}},{key:"getDatePicker",value:function(e){var t=this.getControl().map(function(e){return e.pickerAttributes.inline}).getOrElse(function(){return!1})?Qo.InlineDatePicker:ei.a;return d.createElement(t,Object.assign({fullWidth:!0,error:this.props.error.nonEmpty(),variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),keyboard:this.getControl().map(function(e){return e.pickerAttributes.keyboard}).getOrElse(function(){return!1}),disableFuture:this.getDisableFuture(),disablePast:this.getDisablePast(),value:this.getDate(),onChange:this.onChange,onInputChange:this.onInputChange,onBlur:this.onBlur},this.getMaxDate(),this.getMinDate(),this.getViewsAttr(),this.getOpenTo(),this.getFormat(),this.getMask(),this.getPlaceholder(),e?{label:Object(oe.e)(this.props.display.label.text)}:{},{invalidDateMessage:this.props.i18n.t("Неверный формат даты"),maxDateMessage:this.props.i18n.t("Дата должна быть не более")+" "+this.getMaxDateForMessage(),minDateMessage:this.props.i18n.t("Дата должна быть не менее")+" "+this.getMinDateForMessage()}))}},{key:"getClearButtonStatus",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.hideClearButton}).getOrElse(function(){return!1})}},{key:"wrapByClearButton",value:function(e){return d.createElement(zo,{dispatch:this.props.dispatch,output:this.props.output,displayId:this.props.display.id,blockRendererId:this.props.blockRendererId,displayType:this.props.control.displayType},e)}},{key:"renderWithFloatingTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDatePicker(!0);return d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFixTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDatePicker(!1);return d.createElement(w.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))}},{key:"render",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle}).floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}}]),t}(d.Component);ni=ti([m.autobind],ni);var ri=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueDate}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(ni),oi=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(Zo,{control:this.props.control,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(ri,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),ii=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(oi),ai=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.control.timeZoneOffset;return this.props.value.map(function(t){var n=new Date(t.value.getTime()-6e4*(e-t.value.getTimezoneOffset()));return d.createElement("span",null,n.toLocaleDateString()+" "+n.toLocaleTimeString())}).getOrElse(function(){return d.createElement("span",null)})}}]),t}(d.Component),ui=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueDate})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(ai),li=n(656),ci=n.n(li),si=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},pi=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getControl",value:function(){return this.props.display.control.map(function(e){return e})}},{key:"onChange",value:function(e){this.props.onChange(new k.ValueDate(e.getTime()+6e4*(this.props.control.timeZoneOffset-e.getTimezoneOffset())),this.props.output)}},{key:"onInputChange",value:function(e){var t=this;Object(E.toOption)(e.target.value).filter(function(e){return""===e}).foreach(function(){return t.props.onChange(new k.ValueEmpty,t.props.output)})}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"getDate",value:function(){var e=this;return this.props.value.map(function(t){return new Date(t.value.getTime()-6e4*(e.props.control.timeZoneOffset-t.value.getTimezoneOffset()))}).getOrNull()}},{key:"getMinMaxDateValue",value:function(e){return e.map(function(e){return new Date(e.value.getTime())}).getOrNull()}},{key:"getMaxDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.maxDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{maxDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getMinDate",value:function(){var e=this;return this.getControl().map(function(e){return e.pickerAttributes.minDate}).matchWith(function(t){return e.getMinMaxDateValue(t)?{minDate:e.getMinMaxDateValue(t)}:{}},function(){return{}})}},{key:"getViews",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.views}).getOrElse(function(){return[]})}},{key:"getViewsAttr",value:function(){return this.getViews().length>0?{views:this.getViews()}:{}}},{key:"getOpenTo",value:function(){return this.getViews().length>0?{openTo:Object(E.headOption)(this.getViews()).getOrElse(function(){return"year"})}:{}}},{key:"isMaskEnabled",value:function(){return this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.map(function(e){return e.checked})}).getOrElse(function(){return!1})}},{key:"getMask",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.mask})}).getOrElse(function(){return""}).split(",").map(function(e){var t=Object(ve.a)(e),n=Object(E.headOption)(t).getOrElse(function(){return""}),r=Object(E.lift)(t,t.length-1).getOrElse(function(){return""});return"/"===n&&"/"===r?Object(C.ab)(t):t});return this.isMaskEnabled()?{mask:e}:{}}},{key:"getPlaceholder",value:function(){return this.isMaskEnabled()?{placeholder:this.getControl().flatMap(function(e){return e.pickerAttributes.formattedInput.flatMap(function(e){return e.placeholderChar})}).getOrElse(function(){return""})}:{}}},{key:"getFormat",value:function(){var e=this.getControl().flatMap(function(e){return e.pickerAttributes.format});return e.isEmpty()?{}:{format:e.getOrElse(function(){return"YYYY/MM/DD HH:mm"})}}},{key:"getMaxDateForMessage",value:function(){return this.getDisableFuture()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.maxDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getMinDateForMessage",value:function(){return this.getDisablePast()?this.props.i18n.t("текущей"):this.getControl().map(function(e){return e.pickerAttributes.minDate}).flatMap(function(e){return e.map(function(e){return Object(Xo.a)(e.value,"dd.MM.yyyy")})}).getOrElse(function(){return""})}},{key:"getDisableFuture",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disableFuture}).getOrElse(function(){return!1})}},{key:"getDisablePast",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.disablePast}).getOrElse(function(){return!1})}},{key:"getDateTimePicker",value:function(e){var t=this.getControl().map(function(e){return e.pickerAttributes.inline}).getOrElse(function(){return!1})?li.InlineDateTimePicker:ci.a;return d.createElement(t,Object.assign({fullWidth:!0,error:this.props.error.nonEmpty(),variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),keyboard:this.getControl().map(function(e){return e.pickerAttributes.keyboard}).getOrElse(function(){return!1}),disableFuture:this.getDisableFuture(),disablePast:this.getDisablePast(),ampm:this.getControl().map(function(e){return e.pickerAttributes.ampm}).getOrElse(function(){return!1}),minutesStep:this.getControl().flatMap(function(e){return e.pickerAttributes.minutesStep}).getOrElse(function(){return 5}),value:this.getDate(),onChange:this.onChange,onInputChange:this.onInputChange,onBlur:this.onBlur},this.getMaxDate(),this.getMinDate(),this.getViewsAttr(),this.getOpenTo(),this.getMask(),this.getPlaceholder(),this.getFormat(),e?{label:Object(oe.e)(this.props.display.label.text)}:{},{invalidDateMessage:this.props.i18n.t("Неверный формат даты"),maxDateMessage:this.props.i18n.t("Дата должна быть не более")+" "+this.getMaxDateForMessage(),minDateMessage:this.props.i18n.t("Дата должна быть не менее")+" "+this.getMinDateForMessage()}))}},{key:"getClearButtonStatus",value:function(){return this.getControl().map(function(e){return e.pickerAttributes.hideClearButton}).getOrElse(function(){return!1})}},{key:"wrapByClearButton",value:function(e){return d.createElement(zo,{dispatch:this.props.dispatch,output:this.props.output,displayId:this.props.display.id,blockRendererId:this.props.blockRendererId,displayType:this.props.control.displayType},e)}},{key:"renderWithFloatingTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDateTimePicker(!0);return d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"renderWithFixTitle",value:function(){var e=this.getClearButtonStatus(),t=this.getDateTimePicker(!1);return d.createElement(w.a,{display:this.props.display,style:{flex:"1"},blockStyle:this.props.blockStyle},d.createElement(Ce.a,{fullWidth:!0},e?t:this.wrapByClearButton(t),d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle})))}},{key:"render",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle}).floating?this.renderWithFloatingTitle():this.renderWithFixTitle()}}]),t}(d.Component);pi=si([m.autobind],pi);var fi=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueDate}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(pi),di=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(ui,{control:this.props.control,blockRendererId:this.props.blockRendererId,output:this.props.output}))}},{key:"renderEditControl",value:function(){return d.createElement(fi,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),hi=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(di),mi=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getValue",value:function(e){var t=this.props.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new k.IntervalInputTypeUnitType(new k.TimeUnitMinutes)});switch(t.tpe.value){case k.IntervalInputTypeUnitType.$Type.value:var n=t.timeUnit;return d.createElement("span",null,e.map(function(e){return Object(C.V)(e,n)}).getOrNull());case k.IntervalInputTypeStringType.$Type.value:return d.createElement("span",null,e.map(function(e){return Object(C.R)(e.value.getMilliseconds())}).getOrNull())}}},{key:"render",value:function(){return this.getValue(this.props.value)}}]),t}(d.Component),yi=Object(h.connect)(function(e,t){return{value:Object(R.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueInterval})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)}})(mi),bi=n(1811),gi=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Oi=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vi={flex:"1"},ki=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:n.initiateStateValue(e)},n}return s()(t,e),a()(t,[{key:"initiateStateValue",value:function(e){var t=e.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new k.IntervalInputTypeUnitType(new k.TimeUnitMinutes)});switch(t.tpe.value){case k.IntervalInputTypeUnitType.$Type.value:var n=t.timeUnit;return e.value.map(function(e){return Object(C.V)(e,n)});case k.IntervalInputTypeStringType.$Type.value:return e.value.map(function(e){return Object(C.R)(e.value.getMilliseconds())})}}},{key:"onValueChange",value:function(e){var t=this;this.setState(K(this.state,{value:{$set:Object(E.toOption)(e.target.value)}}),function(){return t.onChange(t.state.value)})}},{key:"onChange",value:function(e){if(e.isEmpty()||e.map(function(e){return""===e}).getOrElse(function(){return!1}))return this.props.onChange(new k.ValueEmpty,this.props.output);var t=this.props.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new k.IntervalInputTypeUnitType(new k.TimeUnitMinutes)});switch(t.tpe.value){case k.IntervalInputTypeUnitType.$Type.value:var n=t.timeUnit;this.props.onChange(new k.ValueInterval(new k.Duration(parseInt(e.getOrElse(function(){return""})),Object(C.Z)(n)).duration),this.props.output);break;case k.IntervalInputTypeStringType.$Type.value:this.props.onChange(new k.ValueInterval(1e6*bi(e.getOrElse(function(){return"0ms"}))),this.props.output)}}},{key:"onBlur",value:function(){this.props.onControlBlur()}},{key:"wrapControlError",value:function(e){return d.createElement(Ce.a,{fullWidth:!0},e,d.createElement(Z.a,{formHelper:!0,display:this.props.display,error:this.props.error,blockStyle:this.props.blockStyle}))}},{key:"wrapControlTitle",value:function(e){return d.createElement(w.a,{display:this.props.display,style:vi,blockStyle:this.props.blockStyle},e)}},{key:"getTextField",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.placeholder}).getOrElse(function(){return new k.ElementOptionalValue}),t=this.props.display.elementAttributes.flatMap(function(e){return e.initialValue}).getOrElse(function(){return new k.ElementOptionalValue}),n=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle}),r=this.props.display.control.map(function(e){return e.inputType}).getOrElse(function(){return new k.IntervalInputTypeUnitType(new k.TimeUnitMinutes)});return d.createElement(V.a,Object.assign({fullWidth:!0,onChange:this.onValueChange},n.floating?{label:Object(oe.e)(this.props.display.label.text)}:{},{variant:Object(re.c)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),helperText:e.checked&&e.value,value:this.state.value.getOrElse(function(){return""}),disabled:this.props.value.map(function(e){return e.tpe.value===k.ValueGenerated.$Type.value}).getOrElse(function(){return!1})||this.props.control.disabled,error:this.props.error.nonEmpty(),onBlur:this.onBlur,InputProps:{style:{color:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""})===t.value.map(function(e){return e}).getOrElse(function(){return""})&&t.checked?"#757575":"black"},endAdornment:d.createElement(No.a,{position:"end"},r instanceof k.IntervalInputTypeUnitType?Object(C.U)(r.timeUnit.tpe.value,this.props.i18n.t):"")}}))}},{key:"renderClassicTheme",value:function(){var e=this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle});return this.wrapControlError(d.createElement(Se.a,{titlePosition:e.position,label:Object(oe.e)(this.props.display.label.text),onChange:this.onChange,value:this.props.value.map(function(e){return e.toString()}).getOrElse(function(){return""}),error:this.props.error.getOrElse(function(){return""})}))}},{key:"renderMaterialTheme",value:function(){return this.props.display.elementAttributes.flatMap(function(e){return e.title}).getOrElse(function(){return new k.ElementTitle}).floating?this.wrapControlError(this.getTextField()):this.wrapControlTitle(this.wrapControlError(this.getTextField()))}},{key:"render",value:function(){return Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?this.renderMaterialTheme():Object(re.d)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle))?null:this.renderClassicTheme()}}]),t}(d.Component);ki=gi([m.autobind,Oi("design:paramtypes",[Object])],ki);var Ei=Object(h.connect)(function(e,t){return{i18n:e.i18n,value:Object(R.k)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return e instanceof k.ValueInterval}),error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.error,t.error)},areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.output===t.output&&e.display===t.display&&e.control===t.control&&Object(E.isEqual)(e.blockStyle,t.blockStyle)}})(ki),ji=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderDisplayControl",value:function(){return d.createElement(w.a,{display:this.props.display,blockStyle:this.props.blockStyle},d.createElement(yi,{display:this.props.display,output:this.props.output,blockRendererId:this.props.blockRendererId}))}},{key:"renderEditControl",value:function(){return d.createElement(Ei,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,control:this.props.control,onControlBlur:this.props.onControlBlur,onChange:this.props.onChange,blockStyle:this.props.blockStyle})}},{key:"renderEditByClickControl",value:function(){return d.createElement(T.a,{display:this.props.display,blockRendererId:this.props.blockRendererId,output:this.props.output,displayComponent:this.renderDisplayControl(),editComponent:this.renderEditControl(),onChange:this.props.onChange})}}]),t}(S.a),Ci=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.blockRendererId===t.blockRendererId&&e.display===t.display&&e.control===t.control&&e.output===t.output&&e.blockType===t.blockType&&Object(E.isEqual)(e.blockStyle,e.blockStyle)}})(ji),Ri=n(1492),Ii=n(1508),Si=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},wi=function(e){function t(){o()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.temp=new k.ValueEmpty,e}return s()(t,e),a()(t,[{key:"onChange",value:function(e,t){var n=this;this.temp=e,setTimeout(function(){e===n.temp&&n.props.onChange(e,t)},100)}},{key:"renderControlElement",value:function(e,t){this.props.isDisabled&&(e=Object.assign({},e,{disabled:!0}));var r=this.props.block.flatMap(function(e){return e.entity.ui.blockStyle});switch(e.tpe.value){case k.ElementControlTextField.$Type.value:return d.createElement(Ae,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlValueListField.$Type.value:return d.createElement(at,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlMoneyField.$Type.value:return d.createElement(mt,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlNumberField.$Type.value:return d.createElement(Ct,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlHtmlField.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onChange:this.onChange,onControlBlur:this.props.onControlBlur,blockStyle:r},load:function(){return n.e(69).then(n.bind(null,2736))}});case k.ElementControlIntervalField.$Type.value:return d.createElement(Ci,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlTextArea.$Type.value:return d.createElement(Dt,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlSelect.$Type.value:return d.createElement(be,{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,parentRecordId:this.props.parentRecordId,blockRendererId:this.props.blockRendererId,control:e,output:t,formId:Object(E.toOption)(this.props.formId),onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlRadioBoxes.$Type.value:return d.createElement(Jt,{display:this.props.display,blockType:this.props.blockType,formId:Object(E.toOption)(this.props.formId),blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlCheckBoxes.$Type.value:return d.createElement(cn,{display:this.props.display,blockType:this.props.blockType,formId:Object(E.toOption)(this.props.formId),blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlTime.$Type.value:return d.createElement(Jo,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlDate.$Type.value:return d.createElement(ii,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlDateTime.$Type.value:return d.createElement(hi,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlGeoLocation.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onChange:this.onChange,onControlBlur:this.props.onControlBlur,blockStyle:r},load:function(){return Promise.all([n.e(38),n.e(65)]).then(n.bind(null,2730))}});case k.ElementControlPhoto.$Type.value:return d.createElement(qr,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,control:e,output:t,formId:this.props.formId,onChange:this.onChange,blockStyle:r});case k.ElementControlImageList.$Type.value:return d.createElement(gr,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,formId:this.props.formId,control:e,onChange:this.onChange,output:t,blockStyle:r});case k.ElementControlUsersField.$Type.value:return d.createElement(co,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,onControlBlur:this.props.onControlBlur,onChange:this.onChange,control:e,output:t,blockStyle:r});case k.ElementControlFileList.$Type.value:return d.createElement(Mn,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,formId:this.props.formId,onChange:this.onChange,control:e,output:t,blockStyle:r});case k.ElementControlObjRefsTable.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,formId:this.props.formId,parentRecordId:this.props.parentRecordId,getBlockComponent:this.props.getBlockComponent,blockStyle:r},load:function(){return n.e(49).then(n.bind(null,2729))}});case k.ElementControlColor.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onChange:this.onChange,onControlBlur:this.props.onControlBlur,blockStyle:r},load:function(){return n.e(67).then(n.bind(null,2749))}});case k.ElementControlTagsList.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,formId:this.props.formId,parentRecordId:this.props.parentRecordId,getBlockComponent:this.props.getBlockComponent,blockStyle:r},load:function(){return n.e(60).then(n.bind(null,2739))}});case k.ElementControlPasswordField.$Type.value:return d.createElement(bo,{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlAdvancedCheckBoxes.$Type.value:return d.createElement(Do,{display:this.props.display,blockType:this.props.blockType,formId:this.props.formId,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r});case k.ElementControlPdf.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,formRecordId:this.props.parentRecordId,control:e,output:t,formId:this.props.formId,onChange:this.onChange,blockStyle:r},load:function(){return Promise.all([n.e(15),n.e(52)]).then(n.bind(null,2738))}});case k.ElementControlRatingField.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,control:e,output:t,onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r},load:function(){return Promise.all([n.e(9),n.e(10)]).then(n.bind(null,2737))}});case k.ElementControlCalendar.$Type.value:return d.createElement(ie.a,{params:{},componentProps:{display:this.props.display,blockType:this.props.blockType,blockId:this.props.blockId,parentRecordId:this.props.parentRecordId,blockRendererId:this.props.blockRendererId,control:e,output:t,formId:Object(E.toOption)(this.props.formId),onControlBlur:this.props.onControlBlur,onChange:this.onChange,blockStyle:r},load:function(){return Promise.all([n.e(9),n.e(10)]).then(n.bind(null,2737))}});default:throw"Unknown element control display type"}}},{key:"getStyleByControl",value:function(e){var t=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new k.ElementProportions});switch(e.map(function(e){return e.tpe.value}).getOrElse(function(){return""})){case k.ElementControlPhoto.$Type.value:case k.ElementControlPdf.$Type.value:return{flex:t.width.map(function(e){return"auto"===e?"0 0 auto":"0 0 "+e}).getOrElse(function(){return"0 0 auto"})};default:return{flex:t.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}}}},{key:"render",value:function(){var e=this;if(!this.props.isVisible)return null;var t=this.props.display.control,n=this.props.display.dataOutput;return d.createElement("div",{id:this.props.display.id.value,className:Object(C.B)(this.props.display,"container"),style:Object.assign({},this.props.style,this.getStyleByControl(t))},t.map(function(t){return n.map(function(n){return e.renderControlElement(t,n)}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Поле данных не указано"))})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Контрол не указан"))}))}}]),t}(d.Component);wi=Si([m.autobind],wi);var Ti=Object(h.connect)(function(e,t){return{block:Object(g.b)(e.block,t.blockId),isVisible:!t.display.hidden&&t.display.control.filter(function(e){return e.displayType.tpe.value===k.DisplayTypeByBlockSchemaType.$Type.value&&t.blockType.tpe.value===k.WebRegistrationBlockTypeDisplay.$Type.value}).flatMap(function(n){return Object(g.b)(e.block,t.blockId).filter(function(e){return e.entity.hideEmpty}).flatMap(function(n){return t.display.dataOutput.flatMap(function(n){var r=Object(I.g)(e.blockRendererContext,t.blockRendererId,n.formField);return r.isEmpty()?Object(E.toOption)(new k.ValueStr("")):r})}).map(function(e){return Object(Ri.b)(e)})}).getOrElse(function(){return!0})&&Object(Ri.c)(t.fieldId,Object(E.toOption)(t.formId),e.user.userRole).getOrElse(function(){return!1}),isDisabled:!Object(Ri.a)(t.fieldId,Object(E.toOption)(t.formId),e.user.userRole).getOrElse(function(){return!0}),i18n:e.i18n,initialValues:Object(I.h)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{onControlBlur:function(){setTimeout(function(){e(Object(Ii.a)(t.display,t.blockRendererId,t.blockId))},100)},onChange:function(n,r){e(Object(H.D)({output:r,value:n,blockRendererId:t.blockRendererId,displayId:t.display.id}))},dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.isVisible===t.isVisible&&e.isDisabled===t.isDisabled&&e.i18n===t.i18n&&Object(E.isEqual)(e.block,t.block)&&Object(E.isEqual)(e.initialValues,t.initialValues)}})(Object(fe.a)([function(e){return e.dispatch(Object(de.h)(e.blockRendererId,e.display,e.formId))}],[function(e,t){Object(E.isEqual)(e.initialValues,t.initialValues)||e.dispatch(Object(de.h)(e.blockRendererId,e.display,e.formId))}],[],[function(e){e.dispatch(Object(de.a)(e.blockRendererId,e.display))}])(wi)),Pi=n(856),xi=n.n(Pi),_i=n(857),Fi=n.n(_i),Di=n(1487),Mi=n(1488),Bi=n(1479),Vi=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={selectedIndex:0},n}return s()(t,e),a()(t,[{key:"onSelected",value:function(e){this.setState(K(this.state,{selectedIndex:{$set:e}}))}},{key:"getMuiColorType",value:function(e){switch(e){case"primary":return{indicatorColor:"primary",textColor:"primary"};case"secondary":return{indicatorColor:"secondary",textColor:"secondary"};case"custom":default:return{indicatorColor:"primary",textColor:"primary"}}}},{key:"render",value:function(){var e=this,t=Object(C.n)(this.props.display),n=this.props.display.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}),r=n.flatMap(function(e){return e.color}).getOrElse(function(){return"primary"});return this.props.display.tabsPosition.tpe.value===k.TabsPositionTop.$Type.value?d.createElement("div",{className:"TabsWidget__container "+t+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(Fi.a,Object.assign({fullWidth:!0,onChange:function(t,n){return e.onSelected(n)},value:this.state.selectedIndex},this.getMuiColorType(r)),this.props.components.filter(function(e){return e.position>=0}).map(function(e,t){return d.createElement(xi.a,{key:e.id.value,value:t,label:e.label.text})})),d.createElement(Bi.a,null,Object(E.lift)(this.props.children,this.state.selectedIndex).getOrElse(function(){return[]}))):this.props.display.tabsPosition.tpe.value!==k.TabsPositionTop.$Type.value?d.createElement("div",{className:"TabsWidget__container "+t+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(Mi.a,Object.assign({tabsPosition:this.props.display.tabsPosition},this.props.display.tabsPosition.tpe.value===k.TabsPositionRight.$Type.value?{tabItemContainerOnRight:!0}:{},this.props.display.tabsPosition.tpe.value===k.TabsPositionRight.$Type.value||this.props.display.tabsPosition.tpe.value===k.TabsPositionLeft.$Type.value?{tabItemContainerStyle:{flex:"0 0 auto",width:this.props.display.tabsPosition.tabsWidth.getOrElse(function(){return"auto"})}}:{},{menuTopChildren:this.props.menuTopChildren,menuBottomChildren:this.props.menuBottomChildren}),this.props.components.map(function(t,r){return d.createElement(Di.a,{key:t.id.value,value:r,label:t.label.text,tabsPosition:e.props.display.tabsPosition,elementMuiTheme:n},Object(E.lift)(e.props.children,r).getOrElse(function(){return[]}))}))):d.createElement("div",null,"Tabs loading error")}}]),t}(d.Component),Li=Object(h.connect)(function(e,t){return{}})(Vi),qi=n(1607),$i=n.n(qi),Ai=n(1608),Ni=n.n(Ai),Wi=n(1609),zi=n.n(Wi),Ui=n(1466),Hi=n(143),Ki=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Gi=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ji=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={stepIndex:0,completedSteps:[0]},n}return s()(t,e),a()(t,[{key:"onStepChange",value:function(e){if(this.props.display.validationRules.length>0&&!Object(Hi.a)(this.state.completedSteps,e)){var t=this.state.completedSteps.concat(e);this.props.components.length===t.length&&this.props.dispatch(Object(H.A)({displayId:this.props.display.id,blockRendererId:this.props.blockRendererId})),this.setState(K(this.state,{completedSteps:{$set:t}}))}this.setState(K(this.state,{stepIndex:{$set:e}}))}},{key:"onPrevStep",value:function(){this.state.stepIndex>0&&this.onStepChange(this.state.stepIndex-1)}},{key:"onNextStep",value:function(){var e=this,t=this.props.blockRendererId;this.props.dispatch(Object(H.F)({blockRendererId:t,displayId:this.props.display.id,error:""})),this.props.dispatch(Object(Ui.h)(this.props.blockId,t,this.props.display,this.state.stepIndex)).then(function(){e.state.stepIndex<e.props.components.length-1&&e.onStepChange(e.state.stepIndex+1)}).catch(function(n){e.props.dispatch(Object(H.F)({blockRendererId:t,displayId:e.props.display.id,error:Object(E.headOption)(e.props.display.validationRules).map(function(e){return e.message}).getOrElse(function(){return e.props.i18n.t("Ошибка валидации в одном из элементов")})}))})}},{key:"render",value:function(){var e=this,t=Object(j.a)(this.props.components,"position"),n=Object(E.toOption)(this.props.children[this.state.stepIndex]),r=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new k.ElementFonts}).titleFont.map(function(e){return e.color}).getOrElse(function(){return"#000"}),o=this.props.error,i=Object(C.n)(this.props.display);return d.createElement("div",{className:"StepperWidget__container "+i+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement($i.a,{activeStep:this.state.stepIndex},t.map(function(t,n){return d.createElement(Ni.a,null,d.createElement(zi.a,{onClick:function(){return e.onStepChange(n)}},d.createElement("p",{style:{color:r}},t.label.text)))})),n.getOrNull(),d.createElement("div",{style:{marginTop:12}},d.createElement(q.a,{disabled:0===this.state.stepIndex,onClick:this.onPrevStep,style:{marginRight:12}},this.props.i18n.t("Назад")),d.createElement(q.a,{disabled:this.state.stepIndex===this.props.components.length-1,color:"primary",onClick:this.onNextStep},this.props.i18n.t("Далее")),o.nonEmpty()&&d.createElement("span",{style:{color:"red",padding:"5px"}},o.getOrElse(function(){return""}))))}}]),t}(d.Component);Ji=Ki([m.autobind,Gi("design:paramtypes",[Object])],Ji);var Yi=Object(h.connect)(function(e,t){return{i18n:e.i18n,error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Ji),Zi=n(640),Xi=n(639),Qi=n(1502),ea=n(1541),ta=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getBarcodeElements",value:function(e){return e.map(function(e){return e.pages.map(function(e){return e.elements.filter(function(e){return e.display instanceof k.DocumentElementDisplayBarcode})}).reduce(function(e,t){return e.concat(t)},[])}).getOrElse(function(){return[]})}},{key:"getAssignBarcodeElements",value:function(e){return this.getBarcodeElements(e).filter(function(e){return e.display.config.filter(function(e){return e.barcodeProviderType.tpe.value===k.BarcodeProviderTypeAssignment.$Type.value}).nonEmpty()})}},{key:"onDocumentPrintClick",value:function(e){var t=this;this.props.formRecord.map(function(n){return t.props.dispatch(Object(Qi.a)(t.props,n.id,e,!0))}).foreach(function(n){n.then(function(n){n.foreach(function(n){t.props.dispatch(function(e,t){return function(n,r){return Object(E.toOption)(e.entity.issueType).filter(function(e){return e.tpe.value===k.IssueTypePrint.$Type.value}).foreach(function(){r().user.terminal.foreach(function(e){return Object(E.headOption)(r().terminals.list.filter(function(t){return t.id.value===e.value})).filter(function(e){return"WEB"===e.entity.name||e.entity.printer.isEmpty()||!!e.entity.savePdf}).foreach(function(e){t.fileId.foreach(function(e){return r().auth.token.map(function(t){return Object(fn.b)(e,t,r().config.cdnAddress)})})})})})}}(e,n)),t.fetchFormDataDocumentRecords(n)})})})}},{key:"fetchFormDataDocumentRecords",value:function(e){var t=this;this.props.formRecord.foreach(function(n){t.props.documentLogFormField.foreach(function(r){t.props.dispatch(Object(ea.b)(r.entity.valueType.family,t.props.document.id,n.id,Object(E.liftKey)(n.entity.values,r.id.value).matchWith(function(t){return t.value.id.concat([e.docId])},function(){return[e.docId]})))})})}},{key:"getDocumentIssueStatus",value:function(e){switch(e.issueType.tpe){case k.IssueTypeEmail.$Type:return this.props.i18n.t("Уже отправлен");case k.IssueTypePrint.$Type:return this.props.i18n.t("Уже распечатан");case k.IssueTypeVirtual.$Type:return this.props.i18n.t("Уже выдан");default:return this.props.i18n.t("Статус выдачи неизвестен")}}},{key:"getDocumentActionName",value:function(e){switch(e.issueType.tpe){case k.IssueTypeEmail.$Type:return this.props.i18n.t("Выслать");case k.IssueTypePrint.$Type:return this.props.i18n.t("Распечатать");case k.IssueTypeVirtual.$Type:return this.props.i18n.t("Выдать");default:return this.props.i18n.t("Действие неизвестно")}}},{key:"getStatusElement",value:function(e){var t=this;return this.props.documentRecords.flatMap(function(n){return t.props.documentFormField.map(function(t){return n.filter(function(n){return Object(E.liftKey)(n.entity.values,t.id.value).filter(function(t){return t.value.toString()===e.id.value}).nonEmpty()}).length})}).filter(function(e){return e>0}).map(function(n){return d.createElement("div",{style:{padding:"5px 15px 5px 15px"}},d.createElement(q.a,{variant:"raised",fullWidth:!0,color:"secondary",style:{backgroundColor:"#f44336"}},t.getDocumentIssueStatus(e.entity)+" ("+n+")"))})}},{key:"render",value:function(){var e=this,t=this.props.document,n=this.getStatusElement(t);return d.createElement("div",{style:{padding:"5px"},key:t.id.value},d.createElement("div",{style:{backgroundColor:t.entity.color,padding:"5px"}},d.createElement("div",{style:{textAlign:"center",textTransform:"uppercase",color:t.entity.fontColor}},t.entity.name),n.getOrNull(),d.createElement("div",{style:{padding:"5px 15px 5px 15px"}},d.createElement(q.a,{variant:"raised",fullWidth:!0,disabled:this.props.secondPrintDisabled&&n.nonEmpty(),onClick:function(){return e.onDocumentPrintClick(t)}},this.getDocumentActionName(t.entity)))))}}]),t}(d.Component),na=function(e){e.formRecord.foreach(function(t){e.documentLogFormField.foreach(function(n){Object(E.liftKey)(t.entity.values,n.id.value).foreach(function(r){e.dispatch(Object(ea.a)(n.entity.valueType.family,e.document.id,t.id,r.value.id))})})})},ra=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(I.d)(e.blockRendererContext,t.blockRendererId),documentFormField:t.document.entity.logParams.refId.filter(function(e){return t.document.entity.logParams.enabled}).flatMap(function(n){return Object(U.d)(e,t.document.entity.form,n)}).filter(function(e){return e.entity.valueType.tpe.value===k.ValueTypeObjectRefs.$Type.value}).flatMap(function(t){return Object(U.g)(e,t.entity.valueType.family)}).flatMap(function(e){return Object(E.headOption)(e.filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===k.ValueTagDocumentId.$Type.value}).getOrElse(function(){return!1})}))}),documentLogFormField:t.document.entity.logParams.refId.filter(function(e){return t.document.entity.logParams.enabled}).flatMap(function(n){return Object(U.d)(e,t.document.entity.form,n)}).filter(function(e){return e.entity.valueType.tpe.value===k.ValueTypeObjectRefs.$Type.value}),documentRecords:Object(I.d)(e.blockRendererContext,t.blockRendererId).flatMap(function(n){return Object(Xi.b)(e.documentRecords,n.id,t.document.id)}),secondPrintDisabled:e.user.userRole.flatMap(function(n){return Object(I.d)(e.blockRendererContext,t.blockRendererId).map(function(e){return n.entity.getSecondDocumentPrintDisallow(e.entity.formId,t.document.id)})}).getOrElse(function(){return!1})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.user===t.user&&e.documentRecords===t.documentRecords&&e.fields===t.fields},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(E.isEqual)(e.documentFormField,t.documentFormField)&&Object(E.isEqual)(e.documentLogFormField,t.documentLogFormField)&&Object(E.isEqual)(e.documentRecords,t.documentRecords)&&e.secondPrintDisabled===t.secondPrintDisabled}})(Object(fe.a)([na],[function(e,t){Object(E.isEqual)(e.formRecord,t.formRecord)||na(e),Object(E.isEqual)(e.formRecord,t.formRecord)&&e.isTokenChecked&&!e.isTokenChecked&&na(e)}])(Object(X.a)(ta))),oa=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("div",{style:this.props.style},d.createElement(tn.a,null,this.props.documents.map(function(t){return d.createElement(ra,{key:t.id.value,blockRendererId:e.props.blockRendererId,document:t})})))}}]),t}(d.Component),ia=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(oa),aa=n(1477),ua=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},la=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:{display:"flex",flex:"1"}},this.props.isDocumentsFetching?d.createElement(pn.a,null):d.createElement(ia,{blockRendererId:this.props.blockRendererId,style:this.props.style,documents:this.props.documents.getOrElse(function(){return[]})}))}}]),t}(d.Component);la=ua([m.autobind],la);var ca=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(aa.e)(t.entity.formId,t.id))})},sa=Object(h.connect)(function(e,t){var n=Object(I.d)(e.blockRendererContext,t.blockRendererId);return{i18n:e.i18n,formRecord:n,documents:n.flatMap(function(t){return Object(Zi.b)(e.formDataDocuments,t.id).map(function(n){return n.filter(function(n){return e.user.userRole.map(function(e){return!e.entity.isDocumentRestricted(t.entity.formId,n.id)}).getOrElse(function(){return!1})})})}),isDocumentsFetching:n.map(function(t){return Object(Zi.e)(e.formDataDocuments,t.id)}).getOrElse(function(){return!1}),isDocumentsFetched:n.map(function(t){return Object(Zi.d)(e.formDataDocuments,t.id)}).getOrElse(function(){return!1}),dataOutput:e.dataOutput}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext&&e.formDataDocuments===t.formDataDocuments},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.documents,t.documents)&&e.isDocumentsFetching===t.isDocumentsFetching&&e.i18n===t.i18n&&e.isDocumentsFetched===t.isDocumentsFetched}})(Object(fe.a)([function(e){e.formRecord.foreach(function(t){e.dispatch(Object(Qi.b)(t.entity.formId,t.id))})}],[function(e,t){var n=Object(E.liftKey)(e.dataOutput,e.blockRendererId),r=Object(E.liftKey)(t.dataOutput,t.blockRendererId);Object(E.isEqual)(n.flatMap(function(e){return e.lastSilentSavedValue}),r.flatMap(function(e){return e.lastSilentSavedValue}))||ca(e),Object(E.isEqual)(e.formRecord,t.formRecord)||ca(e),Object(E.isEqual)(e.formRecord,t.formRecord)&&e.isTokenChecked&&!t.isTokenChecked&&ca(e)}])(la)),pa=n(1475),fa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},da=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getStyle",value:function(){var e=this,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.background}).getOrElse(function(){return new k.ElementBackground}),r=n.file.enabled?n.file.fileId.flatMap(function(t){return e.props.authToken.map(function(n){return Object(Hn.b)(n,t,e.props.cdnAddress)})}).map(function(e){return'url("'+e+'")'}).getOrElse(function(){return"none"}):"none";return Object.assign({},{backgroundColor:n.color,backgroundImage:r,backgroundSize:"cover",display:"flex",flexDirection:"column",borderTop:Object(pa.d)(t).getOrElse(function(){return"0"}),borderRight:Object(pa.c)(t).getOrElse(function(){return"0"}),borderBottom:Object(pa.a)(t).getOrElse(function(){return"0"}),borderLeft:Object(pa.b)(t).getOrElse(function(){return"0"}),boxShadow:Object(pa.e)(t)},this.props.style)}},{key:"render",value:function(){var e=Object(C.n)(this.props.display);return d.createElement("div",{className:e,style:this.getStyle()},this.props.components)}}]),t}(d.Component);da=fa([m.autobind],da);var ha=Object(h.connect)(function(e,t){return{authToken:e.auth.token,cdnAddress:e.config.cdnAddress}})(da),ma=(n(1569),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),ya=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getStyle",value:function(){var e=this,t=this.props.display.elementCss,n=t.flatMap(function(e){return e.background}).getOrElse(function(){return new k.ElementBackground}),r=n.file.enabled?n.file.fileId.flatMap(function(t){return e.props.authToken.map(function(n){return Object(Hn.b)(n,t,e.props.cdnAddress)})}).map(function(e){return'url("'+e+'")'}).getOrElse(function(){return"none"}):"none";return Object.assign({},this.props.style,{display:"flex",flexDirection:"row",backgroundColor:n.color,backgroundImage:r,backgroundSize:"cover",borderTop:Object(pa.d)(t).getOrElse(function(){return"0"}),borderRight:Object(pa.c)(t).getOrElse(function(){return"0"}),borderBottom:Object(pa.a)(t).getOrElse(function(){return"0"}),borderLeft:Object(pa.b)(t).getOrElse(function(){return"0"}),boxShadow:Object(pa.e)(t)})}},{key:"render",value:function(){return d.createElement("div",{style:this.getStyle(),className:"GroupDisplay__container "+Object(C.n)(this.props.display)},this.props.components)}}]),t}(d.Component);ya=ma([m.autobind],ya);var ba=Object(h.connect)(function(e){return{authToken:e.auth.token,cdnAddress:e.config.cdnAddress}})(ya),ga=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display.elementCss,r=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}),o=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}),i=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxWidth})}),a=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minWidth})}),u=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.maxHeight})}),l=t.flatMap(function(e){return e.proportions.flatMap(function(e){return e.minHeight})});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("img",{style:{width:r.getOrElse(function(){return"auto"}),height:o.getOrElse(function(){return"auto"}),maxWidth:i.getOrElse(function(){return"none"}),minWidth:a.getOrElse(function(){return"none"}),maxHeight:u.getOrElse(function(){return"none"}),minHeight:l.getOrElse(function(){return"none"})},src:this.props.display.fileId.flatMap(function(t){return e.props.authToken.map(function(n){return Object(Hn.b)(n,t,e.props.cdnAddress)})}).getOrElse(function(){return n(854)})}))}}]),t}(d.Component),Oa=Object(h.connect)(function(e,t){return{authToken:e.auth.token,cdnAddress:e.config.cdnAddress}})(ga),va=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=Object(C.cb)(this.props.formRecord,this.props.display.valueCaptionTemplate).getOrElse(function(){return""}),t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%",margin:0}}).getOrElse(function(){});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("p",{style:t},e||Object(oe.c)(this.props.display.label.text)||this.props.i18n.t("Надпись")))}}]),t}(d.Component),ka=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(I.d)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.formRecord,t.formRecord)&&e.i18n===t.i18n}})(va),Ea=n(540),ja=n.n(Ea),Ca=n(629),Ra=n.n(Ca),Ia=n(628),Sa=n.n(Ia),wa=n(175),Ta=n.n(wa),Pa=n(318),xa=n.n(Pa),_a=n(148),Fa=n(1486),Da=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement(xa.a,null,d.createElement(Ta.a,{style:{width:"1px",whiteSpace:"nowrap"}},this.props.idx+1),d.createElement(Ta.a,{style:{width:"60%"}},this.props.categoryName.getOrElse(function(){return e.props.i18n.t("Значение не найдено")})),d.createElement(Ta.a,null,this.props.limitValues.limitPresent?this.props.limitValues.avail:"..."),d.createElement(Ta.a,null,this.props.limitValues.occupied),d.createElement(Ta.a,null,this.props.limitValues.limitPresent?this.props.limitValues.all:"..."))}}]),t}(d.Component),Ma=Object(h.connect)(function(e,t){return{i18n:e.i18n,categoryName:Object(_a.d)(e.dictionaries,t.limitFormId,t.dictId).flatMap(function(n){return t.displayField.filter(function(e){return e.tpe.value===k.DisplayFieldByTemplate.$Type.value}).map(function(e){return e.template}).matchWith(function(t){return Object(Fa.b)(t,n)(e)},function(){return Object(E.liftKey)(n.entity.values,t.displayCategoryFieldId.value).map(function(e){return e.value.toString()})})})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.dictionaries.list===t.dictionaries.list&&e.fields.list===t.fields.list},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.categoryName,t.categoryName)}})(Da),Ba=n(636),Va=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement(d.Fragment,{key:this.props.rowsData.cfgId},this.props.linkedField.flatMap(function(t){var n=t.entity,r=n.valueType,o=(n.formId,n.caption);return Object(E.headOption)(r.displayFields).map(function(t){return[d.createElement(xa.a,null,d.createElement(Ta.a,{colSpan:5,style:{width:"100%",textAlign:"center"}},e.props.displayField.matchWith(function(e){return e.caption},function(){return o})))].concat([].concat(M()(e.props.rowsData.limitValuesMap.keys())).map(function(n,o){return Object(E.toOption)(e.props.rowsData.limitValuesMap.get(n)).filter(function(t){return t.limitPresent||!t.limitPresent&&e.props.showUnlimited}).matchWith(function(i){return d.createElement(Ma,{idx:o,dictId:new k.Id(n),blockRendererId:e.props.blockRendererId,limitValues:i,limitFormId:r.family,displayField:e.props.displayField,displayCategoryFieldId:e.props.displayField.flatMap(function(e){return e.objRefDisplayFieldId}).matchWith(function(e){return e},function(){return t})})},function(){return d.createElement("div",null)})}))})}).getOrElse(function(){return[]}))}}]),t}(d.Component),La=function(e){e.linkedField.foreach(function(t){e.dispatch(Object(Ba.a)(t.entity.valueType.family,new E.None)),e.dispatch(Object(Q.e)(t.entity.valueType.family))})},qa=Object(h.connect)(function(e,t){return{i18n:e.i18n,linkedField:Object(U.d)(e,t.formId,t.rowsData.fieldId).filter(function(e){return e.entity.valueType instanceof k.ValueTypeObjectRefs}).flatMap(function(n){return Object(U.d)(e,n.entity.valueType.family,t.rowsData.linkedFieldId)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return!0}})(Object(fe.a)([La],[function(e,t){Object(E.isEqual)(e.linkedField,t.linkedField)||La(e),Object(E.isEqual)(e.linkedField,t.linkedField)&&e.isTokenChecked&&!t.isTokenChecked&&La(e)}])(Va)),$a=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement(xa.a,null,d.createElement(Ta.a,{style:{width:"1px",whiteSpace:"nowrap"}},this.props.idx+1),d.createElement(Ta.a,{style:{width:"60%"}},this.props.i18n.t("Общий лимит")),d.createElement(Ta.a,null,this.props.rowData.limitValues.limitPresent?this.props.rowData.limitValues.avail:"..."),d.createElement(Ta.a,null,this.props.rowData.limitValues.occupied),d.createElement(Ta.a,null,this.props.rowData.limitValues.limitPresent?this.props.rowData.limitValues.all:"..."))}}]),t}(d.Component),Aa=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})($a),Na=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Wa=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.font.getName(),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},!!this.props.display.label.text&&d.createElement("div",{className:"FormRecordDisplay__label-row"},d.createElement("div",{className:"FormRecordDisplay__label",style:t},Object(oe.c)(this.props.display.label.text))),d.createElement(ja.a,null,d.createElement(Sa.a,null,d.createElement(xa.a,null,d.createElement(Ta.a,{style:{width:"1px",whiteSpace:"nowrap"}},this.props.i18n.t("№")),d.createElement(Ta.a,{style:{width:"60%"}},this.props.i18n.t("Категория")),d.createElement(Ta.a,null,this.props.i18n.t("Свободно")),d.createElement(Ta.a,null,this.props.i18n.t("Занято")),d.createElement(Ta.a,null,this.props.i18n.t("Всего")))),d.createElement(Ra.a,null,this.props.linkedFieldLimitRowDatas.map(function(t){return d.createElement(qa,{key:t.cfgId+" - "+t.fieldId,blockRendererId:e.props.blockRendererId,formId:e.props.formId,rowsData:t,showUnlimited:e.props.display.showUnlimited,displayField:Object(E.headOption)(e.props.display.displayFields.filter(function(e){return e.tpe.value===k.DisplayFieldByField.$Type.value}).filter(function(e){return e.fieldId.value===t.linkedFieldId.value}))})}),this.props.totalLimitRowDatas.filter(function(t,n){return t.limitValues.limitPresent||!t.limitValues.limitPresent&&e.props.display.showUnlimited}).map(function(t,n){return d.createElement(Aa,{key:n,idx:e.props.linkedFieldLimitRowDatas.reduce(function(e,t){return t.limitValuesMap.size+e},0),blockRendererId:e.props.blockRendererId,rowData:t})}))))}}]),t}(d.Component);Wa=Na([m.autobind],Wa);var za=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(te.a)(e.formId,t.id,e.blockRendererId))})},Ua=Object(h.connect)(function(e,t){var n=Object(I.d)(e.blockRendererContext,t.blockRendererId),r=n.map(function(e){return e.entity.formId}).flatMap(function(t){return Object(b.e)(e.forms,t)}).map(function(e){return e.entity.limits.filter(function(e){return t.display.memberFormField.map(function(t){return t.value===e.memberFieldId.value}).getOrElse(function(){return!0})})}).getOrElse(function(){return[]}),o=Object(I.i)(e.blockRendererContext,t.blockRendererId).getOrElse(function(){return[]});return{i18n:e.i18n,formRecord:n,dictionaries:e.dictionaries,linkedFieldLimitRowDatas:o.filter(function(e){return e.data.tpe.value===k.LimitDataLinkedValues.$Type.value}).map(function(e){return Object(E.headOption)(r.filter(function(t){return t.limitType.id===e.cfgId})).map(function(t){return{cfgId:e.cfgId,limitValuesMap:new Map([].concat(M()(e.data.values))),fieldId:t.memberFieldId,linkedFieldId:t.limitType.memberTypeId}})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),totalLimitRowDatas:o.filter(function(e){return e.data.tpe.value===k.LimitDataTotal.$Type.value}).map(function(e){return Object(E.headOption)(r.filter(function(t){return t.limitType.id===e.cfgId})).map(function(t){return{limitValues:e.data.values}})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),linkFormFieldsMap:t.display.memberFormField.flatMap(function(n){return Object(U.d)(e,t.formId,n)}).flatMap(function(t){return Object(U.h)(e,t.entity.valueType.family)})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.fields.map===t.fields.map},areStatePropsEqual:function(e,t){return(e.linkedFieldLimitRowDatas===t.linkedFieldLimitRowDatas||0===e.linkedFieldLimitRowDatas.length&&0===t.linkedFieldLimitRowDatas.length)&&(e.totalLimitRowDatas===t.totalLimitRowDatas||0===e.totalLimitRowDatas.length&&0===t.totalLimitRowDatas.length)&&Object(E.isEqual)(e.linkFormFieldsMap,t.linkFormFieldsMap)&&e.i18n===t.i18n}})(Object(fe.a)([za],[function(e,t){Object(E.isEqual)(e.formRecord,t.formRecord)||za(e),Object(E.isEqual)(e.formRecord,t.formRecord)&&e.isTokenChecked&&!t.isTokenChecked&&za(e)}])(Wa)),Ha=n(106),Ka=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ga=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ja=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1},n}return s()(t,e),a()(t,[{key:"getButtonStyle",value:function(){var e=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new k.ElementProportions}),t=this.props.display.elementCss.flatMap(function(e){return e.background}).getOrElse(function(){return new k.ElementBackground}),n=this.props.display.elementCss.flatMap(function(e){return e.fonts.map(function(e){return e.textFont})}).flatMap(function(e){return e}),r=this.props.display.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),o=Object(Te.c)(n,r,new E.None),i=Object(Ha.e)(this.props.display.elementCss).getOrElse(function(){return Ha.a}),a=i.borderRadius.getOrElse(function(){return i.getDefaultBorderRadius()}),u=e.width,l=e.height,c=t.color,s="#fff"===c,p=l.filter(function(e){return""!==e}).nonEmpty();return{buttonStyle:Object.assign({width:u.getOrElse(function(){return"auto"}),height:l.getOrElse(function(){return"auto"}),borderRadius:a},s?{transition:"none"}:{backgroundColor:c}),textStyle:Object.assign(o,p?{lineHeight:l.map(function(e){return e+"px"}).getOrElse(function(){return"auto"})}:{}),width:u}}},{key:"onClick",value:function(){var e=this;this.state.loading||this.setState({loading:!0},function(){e.props.handleButtonPress(e.props.display).then(function(){e.setState({loading:!1})}).catch(function(t){e.setState({loading:!1})})})}},{key:"componentWillMount",value:function(){document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function(e){e.key===this.props.display.activationKey.getOrElse(function(){return""})&&this.button.click()}},{key:"render",value:function(){var e=this,t=this.props.display.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new k.ElementProportions});return d.createElement("div",{style:Object.assign({flex:t.width.map(function(e){return"auto"===e?"0 0 1":"0 0 "+e}).getOrElse(function(){return"0 0 auto"})},this.props.style)},d.createElement(q.a,{className:"Button",variant:Object(re.b)(this.props.display.elementTheme,Object(re.a)(this.props.blockStyle)),disabled:this.state.loading,fullWidth:t.width.filter(function(e){return"auto"==e}).isEmpty(),color:Object(Ha.g)(this.props.display.elementCss),style:this.getButtonStyle().buttonStyle,onClick:this.onClick,buttonRef:function(t){return e.button=t}},d.createElement(d.Fragment,null,this.state.loading?d.createElement(pn.a,{style:{color:"white",marginRight:"10px"}}):null,d.createElement("div",{style:this.getButtonStyle().textStyle},Object(oe.c)(this.props.display.label.text)))))}}]),t}(d.Component);Ja=Ka([m.autobind,Ga("design:paramtypes",[Object])],Ja);var Ya=Object(h.connect)(function(e,t){return{i18n:e.i18n}})(Ja),Za=n(1812),Xa=n(634),Qa=n(421),eu=n(415),tu=n(17),nu=n(18),ru=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"EventStore","FormDataFilter",{request:e}))}return s()(t,e),t}(nu.a),ou=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"EventStore","VisitedUrlsList",{request:e}))}return s()(t,e),t}(nu.a),iu=n(21),au=n(326),uu=n(327),lu=n(216),cu=n(1495),su=n(1494),pu=n(294),fu=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},du=function(e){function t(){o()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.headers=["Дата","Пользователь/Событие","Подробнее"].map(function(t,n){return{id:n.toString(),title:e.props.i18n.t(t)}}),e}return s()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){var t=e.logPage.getOrElse(function(){return[]}),n=this.props.logPage.getOrElse(function(){return[]});t.length!==n.length&&this.fetchRequiredFormData()}},{key:"fetchRequiredFormData",value:function(){var e=this,t=Object(Xa.default)(this.props.logPage.getOrElse(function(){return[]}).filter(function(e){return e instanceof k.FormDataUpdated}).map(function(e){return[].concat(M()(e.newData),M()(e.oldData))})).filter(function(e){return e.value instanceof k.ValueObjectRefs}).reduce(function(t,n){return Object(E.headOption)(e.props.fields.getOrElse(function(){return[]}).filter(function(e){return e.id.value===n.formFieldId.value})).map(function(e){return e.entity.valueType}).map(function(e){return Object(E.liftKey)(t,e.family.value).matchWith(function(r){return Object.assign({},t,Vn()({},e.family.value,Object(Qa.a)([].concat(M()(r),M()(n.value.id)),function(e){return e.value})))},function(){return Object.assign({},t,Vn()({},e.family.value,n.value.id))})}).getOrElse(function(){return{}})},{});Object.keys(t).forEach(function(n){return k.Id.createId(n).foreach(function(n){return Object(E.liftKey)(t,n.value).foreach(function(t){return e.props.dispatch(Object(pu.b)(n,t,new E.None,t.length))})})})}},{key:"getRows",value:function(){var e=this;return this.props.logPage.getOrElse(function(){return[]}).map(function(t,n){return{payload:"",id:n.toString(),fields:e.getFields(t)}})}},{key:"getEventUserType",value:function(e){var t=this;switch(e.src.tpe){case k.EventSourceSystem.$Type:return this.props.i18n.t("Система");case k.EventSourceOrganizer.$Type:return Object(E.headOption)(this.props.usersDescriptionsList.filter(function(t){return e.userId.map(function(e){return e.value===t.id}).getOrElse(function(){return!1})})).map(function(e){return e.name}).getOrElse(function(){return t.props.i18n.t("Значение не найдено")});case k.EventSourceSite.$Type:return this.props.i18n.t("Сайт");default:return""}}},{key:"getEventType",value:function(e){var t=this.props.i18n.t;switch(e.tpe){case k.FormDataCreated.$Type:return t("Создание");case k.FormDataUpdated.$Type:return t("Редактирование");case k.FormDataDeleted.$Type:return t("Удаление");default:return""}}},{key:"getBlockName",value:function(e){var t=this;return Object(E.liftKey)(this.props.blocksDescriptionsList,this.props.formId.value).flatMap(function(t){return Object(E.headOption)(t.filter(function(t){return t.id===e.blockId.value}))}).map(function(e){return e.name}).getOrElse(function(){return t.props.i18n.t("Значение не найдено")})}},{key:"getAttributes",value:function(e){var t=this.props.i18n.t;switch(e.tpe){case k.EventAttributesBlock.$Type:return t("Блок")+' "'+this.getBlockName(e)+'"';case k.EventAttributesImport.$Type:var n=Object(E.headOption)(this.props.importPipelines.descriptionsList.filter(function(t){return t.id.toString()===e.pipeline.value})).map(function(e){return e.name}).getOrElse(function(){return""});return t("Импорт")+' "'+n+'"';default:return""}}},{key:"getFieldName",value:function(e){return this.props.fields.flatMap(function(t){return Object(E.headOption)(t.filter(function(t){return t.id.value===e.value}))}).map(function(e){return e.entity.caption}).getOrElse(function(){return""})}},{key:"getEventStr",value:function(e,t){var n=this;return Object(E.headOption)(e.filter(function(e){return e.formFieldId.value===t.value})).map(function(e){return Object(E.toOption)(e.value instanceof k.ValueObjectRefs).filter(function(e){return e}).matchWith(function(){return Object(E.headOption)(n.props.fields.getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.formFieldId.value})).map(function(e){return e.entity.valueType}).flatMap(function(t){return Object(E.liftKey)(n.props.formRecords.result,t.family.value).flatMap(function(e){return e}).map(function(n){return Object(E.headOption)(t.displayFields).map(function(t){return n.records.filter(function(t){return e.value.id.filter(function(e){return t.id.value===e.value}).length>0}).map(function(e){return Object(E.liftKey)(e.entity.values,t.value).map(function(e){return e.value.toString()}).getOrElse(function(){return""})})}).getOrElse(function(){return[]}).join("; ")})}).getOrElse(function(){return""})},function(){return e.value.toString()})}).getOrElse(function(){return""})}},{key:"openDetailsDialog",value:function(e,t,n){var r=this,o=this.props.openDialog(this.props.i18n.t("Подробнее"),n.map(function(e){return e}).getOrElse(function(){return d.createElement(d.Fragment,null,t.map(function(t){var n=r.getEventStr(e.oldData,t)+" -> "+r.getEventStr(e.newData,t);return d.createElement("div",null,d.createElement("b",null,r.getFieldName(t)),": ",n)}))}),[d.createElement(q.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return r.props.handleDialogClose(o)}},this.props.i18n.t("Закрыть"))])}},{key:"getInfo",value:function(e){var t=this;if(!(e instanceof k.FormDataUpdated))return d.createElement("span",null);var n=Object(Za.a)(e.oldData.map(function(e){return e.formFieldId}),e.newData.map(function(e){return e.formFieldId}),function(e,t){return e.value===t.value});return n.length>2?d.createElement(cu.a,{onClick:function(){return t.openDetailsDialog(e,n,new E.None)},variant:"outlined",color:"secondary",size:"small"},this.props.i18n.t("Подробнее")):n.map(function(r){var o=t.getEventStr(e.oldData,r)+" -> "+t.getEventStr(e.newData,r),i=d.createElement("div",null,d.createElement("b",null,t.getFieldName(r)),": ",o);return o.length>30?d.createElement(cu.a,{onClick:function(){return t.openDetailsDialog(e,n,Object(E.toOption)(i))},variant:"outlined",color:"secondary",size:"small"},t.props.i18n.t("Подробнее")):i})}},{key:"getFields",value:function(e){var t=new Date(e.meta.time),n=d.createElement("span",null,t.toLocaleDateString()," ",t.toLocaleTimeString()),r=this.getEventUserType(e.meta);return[n,d.createElement("span",null,r,"/",this.getEventType(e),", ",this.getAttributes(e.meta.attrs)),this.getInfo(e)]}},{key:"onNextPage",value:function(){this.props.dispatch(Object(au.h)(this.props.formRecordsLog.currentPage+1))}},{key:"onPrevPage",value:function(){this.props.dispatch(Object(au.h)(this.props.formRecordsLog.currentPage-1))}},{key:"onFirstPage",value:function(){this.props.dispatch(Object(au.h)(0))}},{key:"onLastPage",value:function(){this.props.dispatch(Object(au.h)(Math.floor(this.getTotalRecords()/this.props.formRecordsLog.pageSize)))}},{key:"onPageSizeChanged",value:function(e){this.props.dispatch(Object(au.i)(e)),this.onFirstPage()}},{key:"getTotalRecords",value:function(){var e=this;return this.props.currentFormRecord.flatMap(function(t){return Object(E.liftKey)(e.props.formRecordsLog.result,t.id.value).flatMap(function(e){return e.map(function(e){return e.total})})}).getOrElse(function(){return 0})}},{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(eu.a,{fetching:this.props.logsFetching,showId:!1,error:this.props.logsFetchingError,headers:this.headers,rows:this.getRows(),columnStyles:[{flex:1},{flex:3},{flex:4}]}),d.createElement(lu.a,{pageSizes:[5,10,20,40,60],nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,changePageSize:this.onPageSizeChanged,currentPage:this.props.formRecordsLog.currentPage,rowPerPage:this.props.formRecordsLog.pageSize,totalRecords:this.getTotalRecords()}))}}]),t}(d.Component);du=fu([m.autobind],du);var hu=function(e){e.currentFormRecord.foreach(function(t){var n,r,o,i;e.dispatch((n=e.formId,r=t.id,o=e.formRecordsLog.currentPage,i=e.formRecordsLog.pageSize,function(e){e(Object(au.g)({formDataId:r}));var t=new k.FormDataLogRequest(n,r,o,i,Object(E.toOption)(new k.Interval));return tu.a.send(new ru(t),Object(iu.h)()).then(function(t){return e(Object(au.j)({formDataId:r,resolved:t.page})),t}).catch(function(t){throw e(Object(au.f)({formDataId:r,error:t})),t})}))})},mu=Object(h.connect)(function(e,t){var n=Object(I.d)(e.blockRendererContext,t.blockRendererId);return{formRecords:e.formRecords,currentFormRecord:n,importPipelines:e.importPipelines,formRecordsLog:e.formRecordsLog,currentForm:Object(b.e)(e.forms,t.formId),block:Object(g.b)(e.block,t.blockId),fields:Object(U.e)(e.fields,t.formId),i18n:e.i18n,logPage:n.flatMap(function(t){return Object(E.liftKey)(e.formRecordsLog.result,t.id.value)}).flatMap(function(e){return e.map(function(e){return e.records})}),logsFetching:n.flatMap(function(t){return Object(E.liftKey)(e.formRecordsLog.fetching,t.id.value)}).getOrElse(function(){return!1}),logsFetchingError:n.flatMap(function(t){return Object(E.liftKey)(e.formRecordsLog.error,t.id.value)}).getOrElse(function(){return new E.None}),blocksDescriptionsList:e.blocks.descriptionsList,usersDescriptionsList:e.users.descriptionsList}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext&&e.fields.list===t.fields.list&&e.formRecordsLog===t.formRecordsLog&&e.blocks===t.blocks&&e.users===t.users&&e.importPipelines===t.importPipelines&&e.formRecords===t.formRecords},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.currentFormRecord,t.currentFormRecord)&&Object(E.isEqual)(e.currentForm,t.currentForm)&&Object(E.isEqual)(e.block,t.block)&&Object(E.isEqual)(e.logPage,t.logPage)&&Object(E.isEqual)(e.logsFetchingError,t.logsFetchingError)&&Object(E.isEqual)(e.fields,t.fields)&&e.logsFetching===t.logsFetching&&e.i18n===t.i18n&&e.formRecordsLog===t.formRecordsLog&&e.importPipelines===t.importPipelines&&e.blocksDescriptionsList===t.blocksDescriptionsList&&e.usersDescriptionsList===t.usersDescriptionsList&&e.formRecords===t.formRecords}})(Object(fe.a)([hu,function(e){e.dispatch(Object(O.b)(e.formId))},function(e){e.dispatch(Object(Hr.a)())},function(e){e.dispatch(Object(su.b)(e.formId))}],[function(e,t){Object(E.isEqual)(e.currentFormRecord,t.currentFormRecord)||e.dispatch(Object(au.h)(0))},function(e,t){if(e.isTokenChecked)if(!e.isTokenChecked||t.isTokenChecked){var n=e.formRecordsLog,r=n.currentPage,o=n.pageSize,i=t.formRecordsLog,a=i.currentPage,u=i.pageSize;a===r&&u===o||hu(e)}else hu(e)}])(Object(X.a)(du))),yu=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=Object(C.cb)(this.props.formRecord,Object(Wo.toOption)(this.props.display.htmlCode)).getOrElse(function(){return""});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("div",{dangerouslySetInnerHTML:{__html:e||this.props.display.htmlCode}}))}}]),t}(d.Component),bu=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(I.d)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return Object(Wo.isEqual)(e.formRecord,t.formRecord)&&e.i18n===t.i18n}})(yu),gu=n(195),Ou=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},vu=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderLangs",value:function(e){return this.props.currentBlock.map(function(e){return e.entity.languageConfig.langs}).getOrElse(function(){return[]}).sort(function(e,t){return e.order-t.order}).map(function(t){return e(t.label,t.order)})}},{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(A.a,{value:this.props.currentLangIndex,onChange:this.props.handleLangChange},this.renderLangs(function(e,t){return d.createElement(eo.a,{value:t},e)})))}}]),t}(d.Component);vu=Ou([m.autobind],vu);var ku=Object(h.connect)(function(e,t){return{currentBlock:Object(g.b)(e.block,t.blockId),currentLangIndex:e.block.settings.selectedLangOrderIndex,i18n:e.i18n}},function(e){return{handleLangChange:function(t){return e(Object(gu.g)(t.target.value))}}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.block.settings.selectedLangOrderIndex===t.block.settings.selectedLangOrderIndex},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.currentBlock,t.currentBlock)&&e.i18n===t.i18n&&e.currentLangIndex===t.currentLangIndex}})(vu),Eu=n(1542),ju=n(59),Cu=n(1518),Ru=n.n(Cu),Iu=n(1767),Su=n.n(Iu),wu=n(1504),Tu=n(1459),Pu=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={saveBlock:!1,markedFormRecords:[],processedFormRecords:[],currentPage:0,rowPerPage:20,searchValue:"",requestedCloseEnabled:!0,sorting:[]},n}return s()(t,e),a()(t,[{key:"fetchParentRecords",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new E.None;return this.props.formRecord.map(function(e){return e.id}).map(function(n){return e.props.dispatch(Object(wu.b)(new k.RelationsPagedListRequest(e.state.currentPage,e.state.rowPerPage,n,e.props.display.parentsForm,e.props.display.parentsField,t,e.state.sorting.map(function(e){return e.sortType}),new E.None,new k.RelsTypeSearchParents),e.props.display,e.props.blockRendererId))})}},{key:"getFormSortType",value:function(e){return this.props.dispatch(Object(Q.d)(this.props.display.parentsForm,e))}},{key:"sortRecords",value:function(e,t,n){var r=this;this.setState(update(this.state,e.matchWith(function(e){var o=r.state.sorting.findIndex(function(e){return e.fieldId.value===t.value});return-1===o?{sorting:{$push:[{fieldId:t,asc:n,sortType:e}]}}:{sorting:{$splice:[[o,1,{fieldId:t,asc:n,sortType:e}]]}}},function(){return{sorting:{$set:r.state.sorting.filter(function(e){return e.fieldId.value!==t.value})}}})),function(){r.fetchParentRecords()})}},{key:"onSortRequest",value:function(e){var t=this;Object(E.toOption)(this.state.sorting.find(function(t){return t.fieldId.value===e.value})).map(function(n){n.asc?t.sortRecords(Object(E.toOption)(update(n.sortType,{asc:{$set:!1}})),e,!1):t.sortRecords(new E.None,e,!0)}).getOrElse(function(){t.sortRecords(t.getFormSortType(e),e,!0)})}},{key:"onSearchValueChanged",value:function(e){this.setState(update(this.state,{searchValue:{$set:e.target.value}}))}},{key:"onSearchRecords",value:function(){var e=this,t=this.props.display.searchSettings.filter(function(t){return!!e.state.searchValue&&t.enabled}).map(function(t){return new k.FilterCondition(t.field,new k.FilterExpressionContains,new k.ValueStr(e.state.searchValue))});this.setState(update(this.state,{currentPage:{$set:0},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords(t)})}},{key:"onRecordSelected",value:function(e){}},{key:"onSelectAll",value:function(){this.state.markedFormRecords.length===this.props.displayValues.getOrElse(function(){return[]}).length?this.setState(update(this.state,{markedFormRecords:{$set:[]}})):this.setState(update(this.state,{markedFormRecords:{$set:this.props.displayValues.getOrElse(function(){return[]}).map(function(e){return e.id})}}))}},{key:"onRecordMarked",value:function(e){var t=this.state.markedFormRecords.findIndex(function(t){return t.value===e});t>=0?this.setState(update(this.state,{markedFormRecords:{$splice:[[t,1]]}})):this.setState(update(this.state,{markedFormRecords:{$push:[new k.Id(e)]}}))}},{key:"onFirstPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:0},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onLastPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:Math.ceil(this.props.total/this.state.rowPerPage)-1},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onNextPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:this.state.currentPage+1},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onPrevPage",value:function(){var e=this;this.setState(update(this.state,{currentPage:{$set:this.state.currentPage-1},markedFormRecords:{$set:[]}}),function(){return e.fetchParentRecords()})}},{key:"onPageSizeChanged",value:function(e){var t=this;this.setState(update(this.state,{rowPerPage:{$set:e},markedFormRecords:{$set:this.state.rowPerPage<=e?this.state.markedFormRecords:[]}}),function(){return t.fetchParentRecords()})}},{key:"onOpenClick",value:function(e,t){var n=this,r=ju.v4();t.block.map(function(t){return n.props.getBlockComponent&&n.props.getBlockComponent(n.props.display.parentsForm,Object(E.toOption)(e.formRecord),t,r,k.webRegistrationBlockTypeDisplay,n.props.rootBlockRendererId.matchWith(function(e){return Object(E.toOption)(e)},function(){return Object(E.toOption)(n.props.blockRendererId)}),function(e){var t=n.props.openDialog(n.props.i18n.t("Просмотр"),e,[d.createElement(q.a,{onClick:function(e){return n.props.handleDialogClose(t)},style:{marginRight:"10px"}},n.props.i18n.t("Закрыть"))])})}).getOrElse(function(){n.props.dispatch(Object(In.h)(n.props.i18n.t("Ошибка - не выбран блок просмотра анкеты")))})}},{key:"onViewValue",value:function(e){this.props.dispatch(Object(Tu.a)(this.props.display.parentsForm,e.id))}},{key:"onDeleteValue",value:function(e){return this.deleteParentRef(e)}},{key:"deleteParentRef",value:function(e){var t=this;this.props.formRecord.foreach(function(n){return Object(ee.p)([e.id],t.props.display.parentsForm,t.props.display.parentsField,n.entity.formId,[n.id]).then(function(){t.fetchParentRecords()})})}},{key:"getActionButton",value:function(e,t){var n=this,r=e.display.enabled,o=e.display.value.getOrElse(function(){return""}),i=function(e){return d.createElement(vr.a,{className:"ObjRefsTableEditor__button",variant:"caption",align:"center",onClick:e},o)};switch(e.tpe.value){case k.ElementControlActionOpen.$Type.value:return r?i(function(){return n.onOpenClick(t,e)}):d.createElement(jn.a,{style:Xe.f,key:"open",onClick:function(){return n.onOpenClick(t,e)}},d.createElement(Su.a,{style:Xe.g}));case k.ElementControlActionView.$Type.value:return r?i(function(){return n.onViewValue(t)}):d.createElement(jn.a,{style:Xe.f,key:"view",onClick:function(){return n.onViewValue(t)}},d.createElement(Ru.a,{style:Xe.g}));case k.ElementControlActionDelete.$Type.value:return r?i(function(){return n.onDeleteValue(t)}):d.createElement(jn.a,{style:Xe.f,key:"delete",onClick:function(){return n.onDeleteValue(t)}},d.createElement(xr.a,{style:Xe.g}));default:throw"Unknown element control action type"}}},{key:"render",value:function(){var e=this,t=(this.props.objRefFormFields.getOrElse(function(){return[]}),this.props.display.displayFields.map(function(e,t){return{id:t.toString(),title:e.caption}}));return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(eu.a,{showId:!1,error:new E.None,onSelectAll:this.onSelectAll,onRecordMarked:this.onRecordMarked,onRecordSelected:this.onRecordSelected,markedRecords:this.state.markedFormRecords.map(function(e){return e.value}),fetching:this.props.displayValuesFetching.getOrElse(function(){return!1}),empty:this.props.displayValues.isEmpty(),withActions:!0,headers:t,onSort:this.onSortRequest,sortedFieldIds:this.state.sorting,rows:this.props.displayValues.getOrElse(function(){return[]}).map(function(t,n){var r=t.formRecord.entity.attributes.status.tpe.value===k.FormDataStatusDeleted.$Type.value||t.formRecord.entity.attributes.status.tpe.value===k.FormDataStatusNominalDeleted.$Type.value;return{payload:t.id.value,id:t.id.value,deleted:r,fields:t.values,buttons:e.props.display.actions.map(function(n){return e.getActionButton(n,t)})}})}),d.createElement(lu.a,{blockTableSearch:!1,nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,changePageSize:this.onPageSizeChanged,currentPage:this.state.currentPage,rowPerPage:this.state.rowPerPage,totalRecords:this.props.total,shouldShowMassActions:!1,massActionsComponents:[],searchValue:this.state.searchValue,onSearchValueChange:this.onSearchValueChanged,onSearchRecords:this.onSearchRecords}))}}]),t}(d.PureComponent),xu=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(de.i)(e.blockRendererId,e.display,t.id))})},_u=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(I.d)(e.blockRendererContext,t.blockRendererId),total:Object(R.g)(e.dataOutput,t.blockRendererId,t.display.id).getOrElse(function(){return 0}),displayValues:Object(R.h)(e.dataOutput,t.blockRendererId,t.display.id),displayValuesFetching:Object(R.i)(e.dataOutput,t.blockRendererId,t.display.id),objRefFormFields:Object(U.e)(e.fields,t.display.parentsForm),rootBlockRendererId:Object(I.j)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.formRecord,t.formRecord)&&Object(E.isEqual)(e.rootBlockRendererId,t.rootBlockRendererId)&&Object(E.isEqual)(e.displayValues,t.displayValues)&&Object(E.isEqual)(e.displayValuesFetching,t.displayValuesFetching)&&e.i18n===t.i18n&&e.total===t.total}})(Object(fe.a)([xu],[function(e,t){Object(E.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))||xu(e),Object(E.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))&&e.isTokenChecked&&!t.isTokenChecked&&xu(e)}])(Object(X.a)(Pu))),Fu=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.display.elementCss.flatMap(function(e){return e.fonts}).getOrElse(function(){return new k.ElementFonts}).textFont.map(function(e){return{color:e.color,fontFamily:e.font.getName(),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%"}}).getOrElse(function(){}),t=this.props.display.errorTypes,n=t.map(function(e){return e.duplicateError.map(function(e){return e.enabled})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),r=t.map(function(e){return e.duplicateError.map(function(e){return e.text})}).flatMap(function(e){return e}).getOrElse(function(){return""}),o=t.map(function(e){return e.loginError.map(function(e){return e.enabled})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),i=t.map(function(e){return e.loginError.map(function(e){return e.text})}).flatMap(function(e){return e}).getOrElse(function(){return""});return this.props.displayErrorElement.getOrElse(function(){return!1})?d.createElement("div",{style:this.props.style},n?d.createElement("p",{style:e},r):d.createElement("p",null),o?d.createElement("p",{style:e},i):d.createElement("p",null)):null}}]),t}(d.Component),Du=Object(h.connect)(function(e,t){return{i18n:e.i18n,displayErrorElement:Object(E.liftKey)(e.dataOutput,t.blockRendererId).map(function(e){return e.displayErrorElement})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.displayErrorElement,t.displayErrorElement)&&e.i18n===t.i18n}})(Fu),Mu=n(62),Bu=n.n(Mu),Vu=n(646),Lu=n.n(Vu),qu=n(1814),$u=n.n(qu),Au=n(115),Nu=n.n(Au),Wu=n(1625),zu=n.n(Wu),Uu=n(1624),Hu=n.n(Uu),Ku=n(1813),Gu=n.n(Ku),Ju=n(1519),Yu=n.n(Ju),Zu=n(1626),Xu=n.n(Zu),Qu=n(1526),el=n(637),tl=n(626),nl=n(262),rl=n(1532),ol=n(1500),il=n(275),al=n(633),ul=n(1527),ll=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},cl=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},sl=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={currentPage:0,rowPerPage:20,emailStatus:n.props.display.operations.statusFilter?Object(E.toOption)(k.EmailStatusInbox.$Type):new E.None,searchExpr:new E.None},n}return s()(t,e),a()(t,[{key:"fetchEmailDataObjects",value:function(){var e=this;this.props.formRecord.foreach(function(t){e.props.dispatch(Object(Qu.b)(t.id,e.state.currentPage,e.state.rowPerPage,Object(E.toOption)(new k.EmailFilterGroup([].concat(e.state.emailStatus.matchWith(function(e){return[new k.EmailFilterCondition(new k.EmailFilterExpressionStatus(Object(il.a)(e)),new k.EmailFilterOperatorEq)]},function(){return[]})).concat(e.state.searchExpr.matchWith(function(e){return[new k.EmailFilterCondition(e,new k.EmailFilterOperatorContains)]},function(){return[]})),new k.EmailFilterPredicateAnd))))})}},{key:"onSearch",value:function(e){var t=this;this.setState(K(this.state,{searchExpr:{$set:e}}),function(){t.fetchEmailDataObjects()})}},{key:"onRenewClick",value:function(){this.onFirstPage()}},{key:"onFirstPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:0}}),function(){return e.fetchEmailDataObjects()})}},{key:"onLastPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:Math.ceil(this.props.emailService.total.getOrElse(function(){return 0})/this.state.rowPerPage)-1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onNextPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:this.state.currentPage+1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onPrevPage",value:function(){var e=this;this.setState(K(this.state,{currentPage:{$set:this.state.currentPage-1}}),function(){return e.fetchEmailDataObjects()})}},{key:"onPageSizeChanged",value:function(e){var t=this;this.setState(K(this.state,{rowPerPage:{$set:e}}),function(){return t.fetchEmailDataObjects()})}},{key:"getEmailDataObjectViewDialogButtons",value:function(e,t){var n=this,r=e.entity.msgBody;return[d.createElement(q.a,{key:"cancel",variant:"raised",onClick:t,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))].concat(e.entity.meta.emailStatus.tpe.value===k.EmailStatusDraft.$Type.value?[d.createElement(q.a,{key:"send",variant:"raised",onClick:function(o){return n.onSendClick(e,r,t)},color:"primary"},this.props.i18n.t("Отправить"))]:[d.createElement(q.a,{key:"reply",variant:"raised",onClick:function(t){return n.onReplyToClick(e)},color:"primary"},this.props.i18n.t("Ответить"))])}},{key:"openEmailDataObjectView",value:function(e){var t=this;e.entity.msgBody;Object(E.toOption)(e).filter(function(e){return!e.entity.meta.readStatus}).foreach(function(e){Object(el.f)(e.id).then(function(){pl(t.props)})});var n=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),d.createElement(rl.a,{email:e}),this.getEmailDataObjectViewDialogButtons(e,function(){return t.props.handleDialogClose(n)}),{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onSendClick",value:function(e,t,n){var r=this;Object(E.toOption)(t).filter(function(t){return e.entity.msgBody!==t}).matchWith(function(t){return Object(el.d)(e.id,t).then(function(){return Object(el.k)(e.id)})},function(){return Object(el.k)(e.id)}).then(function(){n(),r.fetchEmailDataObjects(),r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Сообщение отправлено")),new E.None)}).catch(function(e){r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Ошибка при отправке сообщения")),new E.None)})}},{key:"onReplyToSubmit",value:function(e,t,n){var r=this;return Object(el.j)(t.id,this.props.display.mailBoxId,new k.MessageSubject(Object(E.toOption)(e.subject).filter(function(e){return""!==e})),new k.MessageBody(e.body||""),new k.MessageHtml(e.html||""),e.attachments||[],(e.replyTo||"").split(",").map(function(e){return new k.MessageAddress("",e.trim())}),t.entity.meta.msgUid,(e.cc||"").split(",").map(function(e){return new k.MessageAddress("",e.trim())}),(e.bcc||"").split(",").map(function(e){return new k.MessageAddress("",e.trim())})).then(function(e){n(),r.fetchEmailDataObjects(),r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Письмо отправлено")),new E.None)}).catch(function(e){r.props.openSnackbar(d.createElement("span",null,r.props.i18n.t("Ошибка при отправлении письма")),new E.None)})}},{key:"onReplyToClick",value:function(e){var t=this,n=function(){return t.props.handleDialogClose(o)},r=void 0,o=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),d.createElement(ol.b,{ref:function(e){return r=Object(E.toOption)(e).flatMap(function(e){return Object(E.toOption)(e.wrappedInstance)})},initialValues:{replyTo:e.entity.msgBody.from.email,subject:e.entity.msgBody.subject.text.getOrElse(function(){return""}),cc:e.entity.msgBody.cc.map(function(e){return e.email}).join(", "),bcc:e.entity.msgBody.bcc.map(function(e){return e.email}).join(", ")},organisationId:this.props.organisation.organisationId,onSubmit:function(r){return t.onReplyToSubmit(r,e,n)}}),[d.createElement(q.a,{key:"cancel",variant:"raised",onClick:n,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(q.a,{key:"send",variant:"raised",onClick:function(){return r.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onDeleteRequested",value:function(e){throw"onDeleteRequested unimplemented"}},{key:"onSelectAll",value:function(){}},{key:"onRecordMarked",value:function(e){}},{key:"getReadStatusIcon",value:function(e){return e.entity.meta.readStatus?d.createElement(Hu.a,{style:Xe.g}):d.createElement(zu.a,{style:Xe.g})}},{key:"onReadStatusToggle",value:function(e){var t=this;(e.entity.meta.readStatus?Object(el.e)(e.id):Object(el.f)(e.id)).then(function(){pl(t.props)})}},{key:"getEmailDate",value:function(e){var t=new Date(e.entity.created),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?t.toLocaleTimeString():t.toLocaleDateString()}},{key:"wrapBySpan",value:function(e,t){return d.createElement("span",{style:e.entity.meta.readStatus?{}:{fontWeight:600}},t)}},{key:"createDraftFromValues",value:function(e){var t=this;return Object(E.headOption)(this.props.mailBoxConfigs.list.filter(function(e){return e.id.value===t.props.display.mailBoxId.value})).matchWith(function(n){return Object(el.a)(n.id,new E.None,t.getEmailMessageBody(e,n),[]).then(function(e){return e.id})},function(){return new Promise(function(e,t){return t()})})}},{key:"onCreateDraftClick",value:function(e,t){var n=this;return this.createDraftFromValues(e).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо сохранено")),new E.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при сохранении письма")),new E.None)})}},{key:"onSendDraftClick",value:function(e,t){var n=this;return this.createDraftFromValues(e).then(function(e){return Object(el.k)(e)}).then(function(){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо отправлено")),new E.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при отправке письма")),new E.None)})}},{key:"onCreateRequested",value:function(){this.openDraftEditForm(this.props.i18n.t("Новое сообщение"),!1,this.onCreateDraftClick,this.onSendDraftClick)}},{key:"openDraftEditForm",value:function(e,t,n,r,o){var i=this,a=function(){return i.props.handleDialogClose(s)},u=!1,l=!1,c=void 0,s=this.props.openDialog(e,d.createElement(ol.b,{ref:function(e){return c=Object(E.toOption)(e).flatMap(function(e){return Object(E.toOption)(e.wrappedInstance)})},showMailBoxSelector:t,initialValues:o,organisationId:this.props.organisation.organisationId,onSubmit:function(e){if(u)return n(e,a);if(l)return r(e,a);throw"unknown butoon clicked"}}),[d.createElement(q.a,{key:"cancel",variant:"raised",onClick:a,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(al.a,{key:"save",style:{marginRight:"10px"},formName:ol.a,variant:"raised",onClick:function(){return c.foreach(function(e){u=!0,e.submit()})}},this.props.i18n.t("Сохранить как черновик")),d.createElement(al.a,{key:"send",formName:ol.a,variant:"raised",onClick:function(){return c.foreach(function(e){l=!0,e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"getEmailMessageBody",value:function(e,t){return new k.EmailMessageBody(new k.MessageSubject(Object(E.toOption)(e.subject).filter(function(e){return""!==e})),new k.MessageBody(e.body||""),new k.MessageHtml(e.html),(e.replyTo||"").split(",").filter(function(e){return""!==e}).map(function(e){return new k.MessageAddress("",e.trim())}),t.entity.address,e.attachments||[],[],new E.None,(e.cc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new k.MessageAddress("",e.trim())}),(e.bcc||"").split(",").filter(function(e){return""!==e}).map(function(e){return new k.MessageAddress("",e.trim())}))}},{key:"editDraftFromValues",value:function(e){var t=this;return Object(E.headOption)(this.props.mailBoxConfigs.list.filter(function(t){return t.id.value===e.mailBoxId})).matchWith(function(n){return Object(el.d)(k.Id.createId(e.emailId).getOrElse(function(){throw"wrong email data object id"}),t.getEmailMessageBody(e,n)).then(function(e){return e.id})},function(){return new Promise(function(e,t){return t()})})}},{key:"onSaveDraftClick",value:function(e,t){var n=this;return this.editDraftFromValues(e).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо сохранено")),new E.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при сохранении письма")),new E.None)})}},{key:"onSendEditedDraftClick",value:function(e,t){var n=this;return this.editDraftFromValues(e).then(function(e){return Object(el.k)(e)}).then(function(e){t(),n.fetchEmailDataObjects(),n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Письмо отправлено")),new E.None)}).catch(function(e){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Ошибка при отправлении письма")),new E.None)})}},{key:"onDraftEdit",value:function(e){var t=this;this.openDraftEditForm(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),!1,this.onSaveDraftClick,this.onSendEditedDraftClick,{emailId:e.id.value,replyTo:e.entity.msgBody.to.map(function(e){return e.email}).join(", "),subject:e.entity.msgBody.subject.text.getOrElse(function(){return""}),html:e.entity.msgBody.html.text,cc:e.entity.msgBody.cc.map(function(e){return e.email}).join(", "),bcc:e.entity.msgBody.bcc.map(function(e){return e.email}).join(", "),mailBoxId:e.entity.rels.mailBoxId.map(function(e){return e.value}).getOrUndefined()})}},{key:"onInboxOrSentView",value:function(e){var t=this;Object(E.toOption)(e).filter(function(e){return!e.entity.meta.readStatus}).foreach(function(e){Object(el.f)(e.id).then(function(){t.fetchEmailDataObjects()})});var n=this.props.openDialog(e.entity.msgBody.subject.text.getOrElse(function(){return t.props.i18n.t("Без темы")}),d.createElement(rl.a,{email:e}),[d.createElement(q.a,{key:"cancel",variant:"raised",onClick:function(){return t.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(q.a,{key:"reply",variant:"raised",onClick:function(n){return t.onReplyToClick(e)},color:"primary"},this.props.i18n.t("Ответить"))],{contentStyle:{display:"flex"},disableBackdropClick:!0,disableEscapeKeyDown:!0})}},{key:"onViewClick",value:function(e){e.entity.meta.emailStatus instanceof k.EmailStatusDraft?this.onDraftEdit(e):this.onInboxOrSentView(e)}},{key:"onEmailStatusChanged",value:function(e){var t=this;this.setState(K(this.state,{emailStatus:{$set:Object(E.toOption)(e)}}),function(){t.fetchEmailDataObjects(),t.props.closeMenu()})}},{key:"onEmailStatusMenuClick",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[d.createElement(eo.a,{key:k.EmailStatusInbox.$Type.value,value:k.EmailStatusInbox.$Type.value,onClick:function(){return t.onEmailStatusChanged(k.EmailStatusInbox.$Type)}},Object(il.b)(k.EmailStatusInbox.$Type,this.props.i18n.t)),d.createElement(eo.a,{key:k.EmailStatusSent.$Type.value,value:k.EmailStatusSent.$Type.value,onClick:function(){return t.onEmailStatusChanged(k.EmailStatusSent.$Type)}},Object(il.b)(k.EmailStatusSent.$Type,this.props.i18n.t)),d.createElement(eo.a,{key:k.EmailStatusDraft.$Type.value,value:k.EmailStatusDraft.$Type.value,onClick:function(){return t.onEmailStatusChanged(k.EmailStatusDraft.$Type)}},Object(il.b)(k.EmailStatusDraft.$Type,this.props.i18n.t))])}},{key:"getEmailStatusIcon",value:function(e){switch(e.entity.meta.emailStatus.tpe.value){case k.EmailStatusInbox.$Type.value:return d.createElement(Gu.a,{style:{fill:Lu.a[500],transform:"rotate(180deg)"}});case k.EmailStatusDraft.$Type.value:return d.createElement(Gu.a,{style:{fill:Bu.a[500],transform:"rotate(180deg)"}});case k.EmailStatusSent.$Type.value:return d.createElement(Gu.a,{style:{fill:$u.a[500]}});default:return null}}},{key:"getEmailReadStatusIcon",value:function(e){var t=this;return e.entity.meta.opened.map(function(e){return d.createElement(Nu.a,{title:t.props.i18n.t("Просмотрено получателем")},d.createElement(Xu.a,{style:{fill:Bu.a[500],fontSize:"10px"}}))}).getOrNull()}},{key:"render",value:function(){var e=this,t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%",margin:"0px"}}).getOrElse(function(){return{margin:"0px"}});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("h4",{style:t},this.props.display.label.text||this.props.i18n.t("Письма")),d.createElement(lu.b,null,this.props.display.operations.create&&d.createElement(q.a,{style:{marginTop:0,flexShrink:0,marginRight:"10px"},variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать")),d.createElement(jn.a,{style:{marginRight:"10px",flexShrink:0},onClick:this.onRenewClick},d.createElement(Yu.a,null)),d.createElement(ul.a,{onSearch:this.onSearch}),this.props.display.operations.statusFilter&&d.createElement(q.a,{style:{marginLeft:"10px",marginTop:0,flexShrink:0},onClick:this.onEmailStatusMenuClick},this.state.emailStatus.matchWith(function(t){return Object(il.b)(t,e.props.i18n.t)},function(){return e.props.i18n.t("Статус не задан")}))),d.createElement(eu.a,{showId:!1,error:this.props.emailService.error,fetching:this.props.emailService.fetching,onSelectAll:this.onSelectAll,onSort:function(){},onRecordMarked:this.onRecordMarked,onRecordSelected:this.openEmailDataObjectView,empty:!this.props.emailService.fetching&&0===this.props.emailService.list.length,withActions:!0,headers:[{id:"emailStatus",title:""},{id:"senderName",title:this.props.i18n.t("Отправитель")},{id:"emailSubject",title:this.props.i18n.t("Тема")},{id:"emailReadStatus",title:""},{id:"emailDate",title:this.props.i18n.t("Время отправки")}],columnStyles:[{flex:"0 0 24px"},{flex:1},{flex:8},{flex:"0 0 10px"},{flex:1}],rows:this.props.emailService.list.map(function(t,n){return{id:t.id.value,payload:t,fields:[d.createElement("div",{style:{display:"flex",alignItems:"center"}},e.getEmailStatusIcon(t)),e.wrapBySpan(t,t.entity.msgBody.from.name),e.wrapBySpan(t,t.entity.msgBody.subject.text.getOrElse(function(){return""})),d.createElement("div",{style:{display:"flex",alignItems:"center"}},e.getEmailReadStatusIcon(t)),e.wrapBySpan(t,e.getEmailDate(t))],buttons:[d.createElement(jn.a,{key:"readStatus",style:Xe.f,onClick:function(n){n.stopPropagation(),e.onReadStatusToggle(t)}},e.getReadStatusIcon(t)),d.createElement(jn.a,{key:"edit",style:Xe.f,onClick:function(n){n.stopPropagation(),e.openEmailDataObjectView(t)}},d.createElement(Sr.a,{style:Xe.g}))].concat(e.props.display.operations.remove?[d.createElement(jn.a,{key:"delete",style:Xe.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},d.createElement(xr.a,{style:Xe.g}))]:[])}})}),d.createElement(lu.a,{nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,fromToEnd:!0,changePageSize:this.onPageSizeChanged,currentPage:this.state.currentPage,rowPerPage:this.state.rowPerPage,totalRecords:this.props.emailService.total.getOrElse(function(){return 0}),shouldShowMassActions:!1,formSearchEnabled:!1}))}}]),t}(d.Component);sl=ll([m.autobind,cl("design:paramtypes",[Object])],sl);var pl=function(e){e.formRecord.foreach(function(t){e.dispatch(Object(Qu.b)(t.id,0,20,new E.None))})},fl=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(I.d)(e.blockRendererContext,t.blockRendererId),emailService:e.emailService,organisation:e.organisation,mailBoxConfigs:e.mailBoxConfigs}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.emailService===t.emailService&&e.mailBoxConfigs===t.mailBoxConfigs},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.formRecord,t.formRecord)&&e.i18n===t.i18n&&e.emailService===t.emailService&&e.mailBoxConfigs===t.mailBoxConfigs}})(Object(fe.a)([pl],[function(e,t){Object(E.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))||pl(e),Object(E.isEqual)(e.formRecord.map(function(e){return e.id}),t.formRecord.map(function(e){return e.id}))&&e.isTokenChecked&&!t.isTokenChecked&&pl(e)}])(Object(X.a)(Object(tl.a)(Object(nl.a)(sl))))),dl=n(551),hl=n.n(dl),ml=n(293),yl=n.n(ml),bl=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e,t=this.props.elementCss.map(function(e){return e.muiTheme}).flatMap(function(e){return e}),n=this.props.block.flatMap(function(e){return e.entity.ui.blockStyle}).map(function(e){return e.muiTheme}).flatMap(function(e){return e}),r=t,o=n.flatMap(function(e){return e.palette.map(function(e){return e.primaryColor})}).getOrElse(function(){return Xe.a}),i=n.flatMap(function(e){return e.palette.map(function(e){return e.secondaryColor})}).getOrElse(function(){return Xe.c}),a=r.flatMap(function(e){return e.input.map(function(e){return e.beforeColor})}).getOrElse(function(){return Bu.a[300]}),u=r.flatMap(function(e){return e.input.map(function(e){return e.hoverColor})}).getOrElse(function(){return Xe.a}),l=r.flatMap(function(e){return e.selectable.map(function(e){return e.beforeSelect})}).getOrElse(function(){return Bu.a[600]}),c=r.flatMap(function(e){return e.selectable.map(function(e){return e.afterSelect})}).getOrElse(function(){return Xe.a}),s=this.props.elementCss.flatMap(function(e){return e.fonts.map(function(e){return e.textFont.map(function(e){return e.fontSize})})}).flatMap(function(e){return e}).getOrElse(function(){return 16}),p=this.props.elementCss.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}).getOrElse(function(){return!1}),f=r.flatMap(function(e){return e.color}).getOrElse(function(){return"primary"}),h={primary:{main:o},secondary:{main:i}},m=yl()({palette:h,overrides:Object.assign({MuiButton:{root:{fontSize:p?s:"14px"},outlined:{color:l,border:"1px solid ".concat(l)}},MuiInput:{root:{fontSize:p?s:"16px"},underline:{"&:after":{borderBottom:"1px solid ".concat(u)},"&:before":{borderBottom:"1px solid ".concat(a)},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:"2px solid ".concat(u)}}},MuiOutlinedInput:{input:{padding:"12.5px 14px"}},MuiInputLabel:{outlined:{transform:"translate(14px, 16px) scale(1)"}}},"custom"===f?{MuiCheckbox:{root:{color:l},colorPrimary:{"&$checked":{color:c}}},MuiRadio:{root:{color:l},colorPrimary:{"&$checked":{color:c}}},MuiTab:{textColorPrimary:{color:l,"&$selected":{color:c}}},MuiTabs:{indicator:{backgroundColor:c}}}:{})});return d.createElement(hl.a,{theme:(e=this.props.organisationTheme,Object(E.toOption)(e.enabled).filter(function(e){return e}).matchWith(function(){return K(m,{palette:{$merge:e.value.map(function(e){return JSON.parse(e)}).map(function(e){return e.palette}).getOrElse(function(){return h})}})},function(){return m}))},this.props.children)}}]),t}(d.Component),gl=Object(h.connect)(function(e,t){return{organisationTheme:e.organisation.data.flatMap(function(e){return e.entity.uiConfig.map(function(e){return e.muiTheme})}).getOrElse(function(){return new k.OptionalValue(!1,new E.None)}),block:Object(E.liftKey)(e.block.record,t.blockId.value).flatMap(function(e){return e})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return Object(E.isEqual)(e.organisation.data,t.organisation.data)&&e.block===t.block},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.organisationTheme.value,t.organisationTheme.value)&&e.organisationTheme.enabled===t.organisationTheme.enabled&&Object(E.isEqual)(e.block,t.block)},areOwnPropsEqual:function(e,t){return e.blockId.value===t.blockId.value&&Object(E.isEqual)(e.elementCss,t.elementCss)}})(bl),Ol=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.display.elementCss,t=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}).getOrElse(function(){return"100%"}),n=e.flatMap(function(e){return e.align}).getOrElse(function(){return new k.ElementAlign}).justifySelf.getOrElse(function(){return"0 0 0 0"});return d.createElement("p",{style:{padding:"10px",margin:n,width:t,borderBottom:"\n                    "+Object(Ha.d)(e).getOrElse(function(){return 1})+"px \n                    "+Object(C.g)(Object(Ha.c)(e)).getOrElse(function(){return"solid"})+" \n                    "+Object(Ha.b)(e).getOrElse(function(){return Bu.a[600]})+"\n                "}})}}]),t}(d.Component),vl=Object(h.connect)(function(e,t){return{i18n:e.i18n}})(Ol),kl=n(1543),El=n(223),jl=n.n(El),Cl=n(224),Rl=n.n(Cl),Il=n(225),Sl=n.n(Il),wl=n(191),Tl=n.n(wl),Pl=n(96),xl=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_l=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"handleExpansionPanelClick",value:function(){var e=this.props.expanded.getOrElse(function(){return!1});this.props.dispatch(e?Object(Pl.i)(this.props.display.id):Object(Pl.k)(this.props.display.id))}},{key:"render",value:function(){var e=Object(C.n)(this.props.display);return d.createElement("div",{className:"TabsWidget__container "+e+" "+Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(jl.a,{expanded:this.props.expanded.getOrElse(function(){return!1})},d.createElement(Rl.a,{expandIcon:d.createElement(Tl.a,null),onClick:this.handleExpansionPanelClick},d.createElement(vr.a,null,Object(oe.c)(this.props.display.label.text))),d.createElement(Sl.a,null,this.props.children)))}}]),t}(d.Component);_l=xl([m.autobind],_l);var Fl=Object(h.connect)(function(e,t){return{expanded:Object(Wo.liftKey)(e.userUi.expansionPanel.expanded,t.display.id.value)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatePropsEqual:function(e,t){return Object(Wo.isEqual)(e.expanded,t.expanded)}})(_l),Dl=n(204),Ml=n(632),Bl=function(e){function t(e,n,r,i){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Create",{ownerId:e,parentId:n,body:r,tags:i}))}return s()(t,e),t}(nu.a),Vl=function(e){function t(e,n){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Update",{commentId:e,body:n}))}return s()(t,e),t}(nu.a),Ll=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Request",{commentId:e}))}return s()(t,e),t}(nu.a),ql=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","Delete",{commentId:e}))}return s()(t,e),t}(nu.a),$l=function(e){function t(e,n){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Comments","ListFormData",{ownerId:e,fields:n}))}return s()(t,e),t}(nu.a),Al=function(e){return tu.a.send(new Ll(e),Object(iu.e)())},Nl=function(e,t,n,r,o,i,a){return function(u,l){return function(e,t,n,r){return tu.a.send(new Bl(e,t,n,r),Object(iu.c)())}(e,r,t,n).then(function(e){return Al(e.id)}).then(function(t){var n=t.record;return u(Object(Dl.o)({formDataId:e,comment:new Dl.a(n.id,n.entity.created,n.entity.body,o,i,n.entity.eventLineId,n.entity.ownerId,n.entity.authorId,n.entity.parentId,[],n.entity.userId,n.entity.tags),sorting:a})),n})}},Wl=function(e,t,n,r){return function(o,i){return function(e,t){return tu.a.send(new Vl(e,t),Object(iu.f)())}(t.commentId,n).then(function(e){return Al(e.id)}).then(function(i){return o(Object(Dl.q)({formDataId:e,comment:K(t,{body:{$set:n},tags:{$set:r}})})),i.record})}},zl=function(e,t){return function(n,r){return function(e){return tu.a.send(new ql(e),iu.d)}(t).then(function(r){return n(Object(Dl.p)({formDataId:e,commentId:t})),r})}},Ul=function(e,t,n){return function(r,o){return r(Object(Dl.s)({formDataId:e})),(i=e,a=t.reduce(function(e,t){return e.concat([t.nameFieldId]).concat(t.avatarFieldId.matchWith(function(e){return[e]},function(){return[]}))},[]),tu.a.send(new $l(i,a),function(e){return e})).then(function(o){var i=t.reduce(function(e,t){return e.concat(t.avatarFieldId.matchWith(function(e){return[e]},function(){return[]}))},[]),a=t.reduce(function(e,t){return e.concat([t.nameFieldId])},[]),u=Object(j.a)(o.comments,[function(e){return e.entity.created}],n.byCreatedDateAsc?"asc":"desc"),l=u.map(function(e){return function(e,t,n,r,o){var i=Object(E.liftKey)(t.authorsMap,e.entity.authorId.map(function(e){return e.value}).getOrElse(function(){return""})),a=Object(E.liftKey)(t.usersMap,e.entity.userId.map(function(e){return e.value}).getOrElse(function(){return""}));Object(E.headOption)(r.filter(function(e){return i.flatMap(function(t){return Object(E.liftKey)(t,e.value)}).nonEmpty()})).flatMap(function(e){return i.flatMap(function(t){return Object(E.liftKey)(t,e.value)})}).map(function(e){return e.toString()}).getOrElse(function(){return""}),Object(E.headOption)(o.filter(function(e){return i.flatMap(function(t){return Object(E.liftKey)(t,e.value)}).nonEmpty()})).flatMap(function(e){return i.flatMap(function(t){return Object(E.liftKey)(t,e.value)})}).flatMap(function(e){return Object(E.headOption)(e.files)}).matchWith(function(e){return Object(E.toOption)(e)},function(){return a.flatMap(function(e){return e.avatarId})});var u=i.flatMap(function(e){return Object(E.headOption)(r.filter(function(t){return Object(E.liftKey)(e,t.value).nonEmpty()})).flatMap(function(t){return Object(E.liftKey)(e,t.value)}).map(function(e){return e.toString()})}).matchWith(function(e){return Object(E.toOption)(e)},function(){return a.map(function(e){return e.name})}),l=i.flatMap(function(e){return Object(E.headOption)(o.filter(function(t){return Object(E.liftKey)(e,t.value).nonEmpty()})).flatMap(function(t){return Object(E.liftKey)(e,t.value)}).flatMap(function(e){return Object(E.headOption)(e.files)})}).matchWith(function(e){return Object(E.toOption)(e)},function(){return a.flatMap(function(e){return e.avatarId})});return new Dl.a(e.id,e.entity.created,e.entity.body,u,l,e.entity.eventLineId,e.entity.ownerId,e.entity.authorId,e.entity.parentId,n.filter(function(t){return t.entity.parentId.filter(function(t){return e.id.value===t.value}).nonEmpty()}).map(function(e){return e.id}),e.entity.userId,e.entity.tags)}(e,o,u,a,i)});r(Object(Dl.u)({formDataId:e,list:l}))}).catch(function(t){throw r(Object(Dl.r)({formDataId:e,error:t})),t});var i,a}},Hl=n(544),Kl=n.n(Hl),Gl=(n(1571),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),Jl=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getAvatarSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Hn.b)(n,e,t.props.cdnAddress)})}},{key:"getAvatar",value:function(){var e=this;return this.props.currentAuthorAvatar.flatMap(function(t){return e.getAvatarSrc(t)}).matchWith(function(e){return d.createElement(Wr.a,{src:e})},function(){return e.props.currentAuthorName.filter(function(e){return""!==e}).matchWith(function(e){return d.createElement(Wr.a,null,Object(E.head)(e.toUpperCase().split("")))},function(){return d.createElement(Wr.a,{src:n(622)})})})}},{key:"render",value:function(){return d.createElement(kn.a,{style:{padding:0}},d.createElement(Kl.a,{style:{alignSelf:"flex-start"}},this.getAvatar()),this.props.children)}}]),t}(d.Component);Jl=Gl([m.autobind],Jl);var Yl=Object(h.connect)(function(e,t){return{i18n:e.i18n,cdnAddress:e.config.cdnAddress,authToken:e.auth.token}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Jl),Zl=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Xl=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ql=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={editedBody:e.body,editedTags:e.tags},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.body!==e.body&&this.setState(K(this.state,{editedBody:{$set:e.body}}))}},{key:"onEditedBodyChanged",value:function(e){this.setState(K(this.state,{editedBody:{$set:e.target.value}}))}},{key:"onSendClick",value:function(){this.props.onSaveClick(this.state.editedBody,this.state.editedTags)}},{key:"renderEditorSection",value:function(){return d.createElement("div",{style:{flex:"1 1 auto",padding:"0 16px",display:"flex",flexDirection:"column"}},d.createElement(V.a,{fullWidth:!0,value:this.state.editedBody,onChange:this.onEditedBodyChanged}),d.createElement("div",{style:{marginTop:"5px",display:"flex",alignSelf:"flex-end"}},d.createElement(q.a,{size:"small",style:{marginRight:"5px"},onClick:this.props.onCancelClick},this.props.i18n.t("Отменить")),d.createElement(q.a,{size:"small",disabled:""===this.state.editedBody,variant:"raised",color:"primary",onClick:this.onSendClick},this.props.saveButtonLabel)))}},{key:"render",value:function(){return this.renderEditorSection()}}]),t}(d.Component);Ql=Zl([m.autobind,Xl("design:paramtypes",[Object])],Ql);var ec=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Ql),tc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},nc=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rc=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showNewCommentEditor:!1,showCommentEditor:!1},n}return s()(t,e),a()(t,[{key:"getCommentDate",value:function(e){var t=new Date(e.created),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?t.toLocaleTimeString():t.toLocaleDateString()}},{key:"getAvatarSrc",value:function(e){var t=this;return this.props.authToken.map(function(n){return Object(Hn.b)(n,e,t.props.cdnAddress)})}},{key:"getAvatar",value:function(e){var t=this;return e.avatarFileId.flatMap(function(e){return t.getAvatarSrc(e)}).matchWith(function(e){return d.createElement(Wr.a,{src:e})},function(){return e.nickname.filter(function(e){return""!==e}).matchWith(function(e){return d.createElement(Wr.a,null,Object(E.head)(e.toUpperCase().split("")))},function(){return d.createElement(Wr.a,{src:n(622)})})})}},{key:"onReplyClick",value:function(){var e=this;this.setState(K(this.state,{showNewCommentEditor:{$set:!0}}),function(){e.props.dispatch(Object(Dl.m)({formDataId:e.props.ownerId,commentId:e.props.commentId}))})}},{key:"onSendClick",value:function(e,t,n){var r=this;this.setState(K(this.state,{showNewCommentEditor:{$set:!1}}),function(){r.props.dispatch(Nl(r.props.ownerId,e,t,Object(E.toOption)(n.commentId),r.props.currentAuthorName,r.props.currentAuthorAvatar,r.props.sorting)).then(function(){r.props.dispatch(Object(Dl.m)({formDataId:r.props.ownerId,commentId:r.props.commentId}))})})}},{key:"onSaveClick",value:function(e,t,n){this.props.dispatch(Wl(this.props.ownerId,n,e,t))}},{key:"onNewCancelClick",value:function(){this.setState(K(this.state,{showNewCommentEditor:{$set:!1}}))}},{key:"onEditorCancelClick",value:function(){this.setState(K(this.state,{showCommentEditor:{$set:!1}}))}},{key:"onShowRepliesClick",value:function(){this.props.dispatch(Object(Dl.m)({formDataId:this.props.ownerId,commentId:this.props.commentId}))}},{key:"onHideRepliesClick",value:function(){this.props.dispatch(Object(Dl.l)({formDataId:this.props.ownerId,commentId:this.props.commentId}))}},{key:"renderReplySection",value:function(e){var t=this;return this.state.showNewCommentEditor&&d.createElement(Yl,{currentAuthorAvatar:this.props.currentAuthorAvatar,currentAuthorName:this.props.currentAuthorName},d.createElement(ec,{body:"",tags:[],saveButtonLabel:this.props.i18n.t("Отправить"),onSaveClick:function(n,r){return t.onSendClick(n,r,e)},onCancelClick:this.onNewCancelClick}))}},{key:"onEditClick",value:function(){this.props.closeMenu(),this.setState(K(this.state,{showCommentEditor:{$set:!0}}))}},{key:"onDeleteClick",value:function(){this.props.closeMenu(),this.props.dispatch(zl(this.props.ownerId,this.props.commentId))}},{key:"onMoreClick",value:function(e){this.props.openMenu(e.currentTarget,[d.createElement(eo.a,{key:"edit",onClick:this.onEditClick},d.createElement(bn.a,null,d.createElement(Sr.a,null)),d.createElement(On.a,null,this.props.i18n.t("Редактировать"))),d.createElement(eo.a,{key:"delete",onClick:this.onDeleteClick},d.createElement(bn.a,null,d.createElement(xr.a,null)),d.createElement(On.a,null,this.props.i18n.t("Удалить")))])}},{key:"renderButtonsSection",value:function(e){return d.createElement("div",null,e.children.length>0&&!this.props.isChildrenShow&&d.createElement(q.a,{size:"small",style:{marginRight:"5px"},onClick:this.onShowRepliesClick},this.props.i18n.t("Показать ответы")),e.children.length>0&&this.props.isChildrenShow&&d.createElement(q.a,{size:"small",style:{marginRight:"5px"},onClick:this.onHideRepliesClick},this.props.i18n.t("Скрыть ответы")),d.createElement(q.a,{size:"small",onClick:this.onReplyClick},this.props.i18n.t("Ответить")))}},{key:"renderChildrenSection",value:function(e){var t=this;return this.props.isChildrenShow&&d.createElement(tn.a,null,e.children.map(function(e){return d.createElement(oc,{key:e.value,commentId:e,ownerId:t.props.ownerId,currentAuthorFormData:t.props.currentAuthorFormData,currentAuthorAvatar:t.props.currentAuthorAvatar,currentAuthorName:t.props.currentAuthorName,viewSettings:t.props.viewSettings,sorting:t.props.sorting})}))}},{key:"renderCommentSection",value:function(e){var t=this;return this.state.showCommentEditor?d.createElement(Yl,{currentAuthorAvatar:e.avatarFileId,currentAuthorName:e.nickname},d.createElement(ec,{body:e.body,tags:e.tags,saveButtonLabel:this.props.i18n.t("Сохранить"),onSaveClick:function(n,r){return t.onSaveClick(n,r,e)},onCancelClick:this.onEditorCancelClick})):e.body}},{key:"canModify",value:function(e){return e.authorId.nonEmpty()&&Object(E.isEqual)(this.props.currentAuthorFormData.map(function(e){return e.id}).map(function(e){return e.value}),e.authorId.map(function(e){return e.value}))||e.authorId.isEmpty()&&Object(E.isEqual)(e.userId.map(function(e){return e.value}),this.props.user.id.map(function(e){return e.value}))}},{key:"renderPrimarySection",value:function(e){var t=this;return d.createElement(d.Fragment,null,d.createElement(vr.a,{inline:!0,component:"span",color:"textPrimary",style:{marginRight:"5px",fontWeight:"bold"}},e.nickname.getOrElse(function(){return t.props.i18n.t("Аноним")})),d.createElement(vr.a,{inline:!0,component:"span",color:"textSecondary"},this.getCommentDate(e)))}},{key:"render",value:function(){var e=this;return this.props.comment.map(function(t){return d.createElement(kn.a,{style:{alignItems:"flex-start",padding:0},className:"CommentsListDisplayItem-root"},d.createElement(Kl.a,null,e.getAvatar(t)),d.createElement(On.a,{style:{paddingRight:0},primary:e.renderPrimarySection(t),secondaryTypographyProps:{component:"div",color:"textPrimary"},secondary:d.createElement(d.Fragment,null,d.createElement("div",{style:{display:"flex"}},e.renderCommentSection(t)),e.renderButtonsSection(t),!e.props.sorting&&e.renderReplySection(t),e.renderChildrenSection(t),e.props.sorting&&e.renderReplySection(t))}),e.canModify(t)&&d.createElement(jn.a,{className:"CommentsListDisplayItem-more",onClick:e.onMoreClick},d.createElement(W.a,null)))}).getOrNull()}}]),t}(d.Component);rc=tc([m.autobind,nc("design:paramtypes",[Object])],rc);var oc=Object(h.connect)(function(e,t){return{i18n:e.i18n,cdnAddress:e.config.cdnAddress,authToken:e.auth.token,user:e.user,comment:Object(Ml.b)(e.comments,t.ownerId,t.commentId),isChildrenShow:Object(Ml.d)(e.comments,t.ownerId,t.commentId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.config.cdnAddress===t.config.cdnAddress&&Object(E.isEqual)(e.auth.token,t.auth.token)&&e.comments===t.comments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.cdnAddress===t.cdnAddress&&Object(E.isEqual)(e.authToken,t.authToken)&&Object(E.isEqual)(e.comment,t.comment)&&e.isChildrenShow===t.isChildrenShow}})(Object(nl.a)(rc)),ic=oc,ac=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},uc=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},lc=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={newCommentText:""},n}return s()(t,e),a()(t,[{key:"onSendClick",value:function(e,t){var n=this;this.props.dispatch(Nl(this.props.formRecordId,e,t,new E.None,this.props.currentAuthorName,this.props.currentAuthorAvatar,this.props.sorting)).then(function(){n.setState(K(n.state,{newCommentText:{$set:""}}))}).catch(function(){n.props.openSnackbar(d.createElement("span",null,n.props.i18n.t("Произошла ошибка")),new E.None)})}},{key:"onCancelClick",value:function(){this.setState(K(this.state,{newCommentText:{$set:""}}))}},{key:"renderNewCommentSection",value:function(){return d.createElement(Yl,{currentAuthorAvatar:this.props.currentAuthorAvatar,currentAuthorName:this.props.currentAuthorName},d.createElement(ec,{body:this.state.newCommentText,tags:[],saveButtonLabel:this.props.i18n.t("Отправить"),onSaveClick:this.onSendClick,onCancelClick:this.onCancelClick}))}},{key:"renderCommentsList",value:function(e){var t=this;return d.createElement(tn.a,null,e.list.filter(function(e){return e.parentId.isEmpty()}).map(function(e){return d.createElement(ic,{key:e.commentId.value,commentId:e.commentId,ownerId:t.props.formRecordId,currentAuthorFormData:t.props.currentAuthorFormData,currentAuthorAvatar:t.props.currentAuthorAvatar,currentAuthorName:t.props.currentAuthorName,viewSettings:t.props.viewSettings,sorting:t.props.sorting})}))}},{key:"render",value:function(){var e=this;return d.createElement("div",null,!this.props.sorting.byCreatedDateAsc&&this.renderNewCommentSection(),this.props.comments.map(function(t){return e.renderCommentsList(t)}).getOrNull(),this.props.sorting.byCreatedDateAsc&&this.renderNewCommentSection())}}]),t}(d.Component);lc=ac([m.autobind,uc("design:paramtypes",[Object])],lc);var cc=Object(h.connect)(function(e,t){return{i18n:e.i18n,comments:Object(Ml.c)(e.comments,t.formRecordId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.comments===t.comments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(E.isEqual)(e.comments,t.comments)}})(Object(tl.a)(lc)),sc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},pc=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=this.props.display.label.font.map(function(e){return{color:e.color,fontFamily:e.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return""}),fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),fontSize:e.fontSize,textAlign:e.horizontalAlignment.toString(),textDecoration:e.isUnderlined?"underline":"none",width:"100%",margin:"0px"}}).getOrElse(function(){return{margin:"0px"}});return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement("h4",{style:t},this.props.display.label.text||this.props.i18n.t("Комментарии")),this.props.formRecord.map(function(t){return d.createElement(cc,{formRecordId:t.id,currentAuthorFormData:e.props.currentAuthorFormData,currentAuthorAvatar:e.props.currentAuthorAvatar,currentAuthorName:e.props.currentAuthorName,viewSettings:e.props.display.viewSettings,sorting:e.props.display.sorting})}).getOrNull())}}]),t}(d.Component);pc=sc([m.autobind],pc);var fc=function(e){return e.formRecord.foreach(function(t){e.dispatch(Ul(t.id,e.display.viewSettings,e.display.sorting))})},dc=function(e){return Object(Wo.toOption)(e).filter(function(e){return e.isTokenChecked}).foreach(function(e){fc(e)})},hc=Object(h.connect)(function(e,t){return{i18n:e.i18n,formRecord:Object(I.d)(e.blockRendererContext,t.blockRendererId),comments:Object(I.d)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(Ml.c)(e.comments,t.id)}),currentAuthorFormData:Object(I.j)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(I.b)(e.blockRendererContext,t)}).filter(function(e){return e.isPrivateCabinet}).flatMap(function(e){return e.formRecord}),currentAuthorName:Object(I.j)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(I.b)(e.blockRendererContext,t)}).flatMap(function(n){return n.isPrivateCabinet?Object(Wo.headOption)(t.display.viewSettings.filter(function(e){return e.formId.value===n.formId.value})).flatMap(function(e){return n.formRecord.flatMap(function(t){return t.entity.getFormFieldValue(e.nameFieldId)})}).map(function(e){return e.value.toString()}):e.user.name}),currentAuthorAvatar:Object(I.j)(e.blockRendererContext,t.blockRendererId).flatMap(function(t){return Object(I.b)(e.blockRendererContext,t)}).flatMap(function(e){return e.isPrivateCabinet?Object(Wo.headOption)(t.display.viewSettings.filter(function(t){return t.formId.value===e.formId.value})).flatMap(function(t){return e.formRecord.flatMap(function(e){return t.avatarFieldId.flatMap(function(t){return e.entity.getFormFieldValue(t)})})}).filter(function(e){return e.value instanceof k.ValueFileList}).map(function(e){return e.value}).flatMap(function(e){return Object(Wo.headOption)(e.files)}):new Wo.None})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext&&e.comments===t.comments},areStatePropsEqual:function(e,t){return Object(Wo.isEqual)(e.comments,t.comments)&&Object(Wo.isEqual)(e.formRecord,t.formRecord)&&Object(Wo.isEqual)(e.currentAuthorFormData,t.currentAuthorFormData)&&Object(Wo.isEqual)(e.currentAuthorName,t.currentAuthorName)&&Object(Wo.isEqual)(e.currentAuthorAvatar,t.currentAuthorAvatar)&&e.i18n===t.i18n}})(Object(fe.a)([function(e){return e.formRecord.foreach(function(t){e.dispatch(Object(Dl.t)({formDataId:t.id})),dc(e)})}],[function(e,t){Object(Wo.isEqual)(e.formRecord.map(function(e){return e.id.value}),t.formRecord.map(function(e){return e.id.value}))||fc(e)}],[],[function(e){return e.formRecord.foreach(function(t){e.dispatch(Object(Dl.n)({formDataId:t.id}))})}])(pc)),mc=n(56),yc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},bc=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getFieldName",value:function(e){var t=this;return e.flatMap(function(e){return Object(E.headOption)(t.props.formFields.getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.value}))}).map(function(e){return e.entity.caption}).getOrElse(function(){return""})}},{key:"getSelectValue",value:function(e){return Object(E.headOption)(this.props.value.map(function(e){return e instanceof k.ValueObjectRefs?e.id:[]}).getOrElse(function(){return[]}).filter(function(t){return t instanceof k.Id&&t.value===e.value})).nonEmpty()}},{key:"onRadioChange",value:function(e,t){this.props.onChange(new k.ValueObjectRefs([e]),t)}},{key:"onCheckboxChange",value:function(e,t){var n=this.props.value.map(function(e){return e.id}).getOrElse(function(){return[]}),r=n.filter(function(t){return t.value===e.value}).length>0;this.props.onChange(new k.ValueObjectRefs(r?[].concat(M()(n.filter(function(t){return t.value!==e.value}))):[].concat(M()(n),[e])),t)}},{key:"renderChildElement",value:function(e,t){var n,r=this;return Object(mc.b)(this.props.display.variant.tpe.value)((n={},Vn()(n,k.SelectionMatrixVariantRadio.$Type.value,d.createElement(Lt.a,{disabled:this.props.blockType instanceof k.WebRegistrationBlockTypeDisplay,checked:this.getSelectValue(e.id),onChange:function(){return r.onRadioChange(e.id,t.dataOutput)}})),Vn()(n,k.SelectionMatrixVariantCheckbox.$Type.value,d.createElement(Qt.a,{disabled:this.props.blockType instanceof k.WebRegistrationBlockTypeDisplay,checked:this.getSelectValue(e.id),onChange:function(){return r.onCheckboxChange(e.id,t.dataOutput)}})),n)).getOrElse(function(){throw"unknow selection matrix type "+r.props.display.variant.tpe.value})}},{key:"render",value:function(){var e=this;return d.createElement(xa.a,null,d.createElement(Ta.a,null,this.getFieldName(this.props.element.dataOutput.map(function(e){return e.formField}))),this.props.dataInput.map(function(t){return t.displayValues.map(function(t,n){return d.createElement(Ta.a,{key:n,style:{textAlign:"center"}},e.renderChildElement(t,e.props.element))})}).getOrNull())}}]),t}(d.Component);bc=yc([m.autobind],bc);var gc=Object(h.connect)(function(e,t){return{i18n:e.i18n,formFields:e.currentForm.data.flatMap(function(t){return Object(U.e)(e.fields,t.id)}),value:t.element.dataOutput.flatMap(function(n){return Object(R.k)(e.dataOutput,t.blockRendererId,n).map(function(e){return e.value})}).filter(function(e){return e instanceof k.ValueObjectRefs||e instanceof k.ValueList||e instanceof k.ValueBool}),dataInput:Object(P.b)(e.dataInputs,t.element.id)}},function(e,t){return{onChange:function(n,r){r.foreach(function(r){return e(Object(H.D)({output:r,value:n,blockRendererId:t.blockRendererId,displayId:t.display.id}))})},dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.dataInputs===t.dataInputs&&e.currentForm===t.currentForm},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(E.isEqual)(e.value,t.value)&&Object(E.isEqual)(e.dataInput,t.dataInput)&&Object(E.isEqual)(e.formFields,t.formFields)}})(bc),Oc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},vc=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getTitleValues",value:function(){return this.props.titleValues.map(function(e){return e.displayValues}).getOrElse(function(){return[]})}},{key:"render",value:function(){return d.createElement(Sa.a,null,d.createElement(xa.a,null,d.createElement(Ta.a,null),this.getTitleValues().map(function(e,t){return d.createElement(Ta.a,{key:t,style:{textAlign:"center"}},e.toString())})))}}]),t}(d.Component);vc=Oc([m.autobind],vc);var kc=Object(h.connect)(function(e,t){return{i18n:e.i18n,titleValues:Object(E.headOption)(t.display.children).flatMap(function(t){return Object(P.b)(e.dataInputs,t.id)})}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataInputs===t.dataInputs},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(E.isEqual)(e.titleValues,t.titleValues)}})(vc),Ec=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},jc=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderTableBody",value:function(){var e=this;return d.createElement(Ra.a,null,this.props.display.children.map(function(t){return d.createElement(gc,{display:e.props.display,element:t,blockRendererId:e.props.blockRendererId,blockType:e.props.blockType})}))}},{key:"render",value:function(){return d.createElement(ja.a,null,d.createElement(kc,{display:this.props.display}),this.renderTableBody())}}]),t}(d.Component);jc=Ec([m.autobind],jc);var Cc=Object(h.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(jc),Rc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ic=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getContainerClassName",value:function(){return"SelectionMatrixDisplay__container \n            "+Object(C.n)(this.props.display)+" \n            "+Object(C.B)(this.props.display,"container")}},{key:"render",value:function(){return d.createElement("div",{className:this.getContainerClassName(),style:this.props.style},d.createElement(Cc,{key:this.props.display.id.value,display:this.props.display,blockRendererId:this.props.blockRendererId,blockId:this.props.blockId,blockType:this.props.blockType,formId:this.props.formId}))}}]),t}(d.Component);Ic=Rc([m.autobind],Ic);var Sc=Object(h.connect)(function(e,t){return{i18n:e.i18n,error:Object(R.m)(e.dataOutput,t.blockRendererId,t.display.id),formFields:e.currentForm.data.flatMap(function(t){return Object(U.e)(e.fields,t.id)}).getOrElse(function(){return[]})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.error,t.error)&&e.i18n===t.i18n}})(Object(fe.a)([function(e){e.display.children.forEach(function(t){return e.dispatch(Object(de.e)(e.blockRendererId,t,e.formId))})},function(e){e.display.children.forEach(function(t){return e.dispatch(Object(de.h)(e.blockRendererId,t,e.formId))})}],[],[],[function(e){e.display.children.forEach(function(t){return e.dispatch(Object(de.a)(e.blockRendererId,t))})}],function(e,t){return!function(e,t){return e.formId===t.formId&&e.display===t.display&&e.blockType.tpe.value===t.blockType.tpe.value&&e.blockRendererId===t.blockRendererId}(e,t)&&e.i18n!==t.i18n})(Ic)),wc=n(194),Tc=n(1544),Pc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},xc=function(e){function t(){o()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.headers=["Дата","Ссылка"].map(function(t,n){return{id:n.toString(),title:e.props.i18n.t(t)}}),e}return s()(t,e),a()(t,[{key:"getRows",value:function(){var e=this;return this.props.logPage.getOrElse(function(){return[]}).map(function(t,n){return{payload:"",id:n.toString(),fields:e.getFields(t)}})}},{key:"getFields",value:function(e){var t=new Date(e.stamp);return[d.createElement("span",null,t.toLocaleDateString()," ",t.toLocaleTimeString()),e.url]}},{key:"onNextPage",value:function(){this.props.dispatch(Object(uu.h)(this.props.visitedUrlsLog.currentPage+1))}},{key:"onPrevPage",value:function(){this.props.dispatch(Object(uu.h)(this.props.visitedUrlsLog.currentPage-1))}},{key:"onFirstPage",value:function(){this.props.dispatch(Object(uu.h)(0))}},{key:"onLastPage",value:function(){this.props.dispatch(Object(uu.h)(Math.floor(this.getTotalRecords()/this.props.visitedUrlsLog.pageSize)))}},{key:"onPageSizeChanged",value:function(e){this.props.dispatch(Object(uu.i)(e)),this.onFirstPage()}},{key:"getTotalRecords",value:function(){var e=this;return this.props.currentFormRecord.flatMap(function(t){return Object(E.liftKey)(e.props.visitedUrlsLog.result,t.id.value).flatMap(function(e){return e.map(function(e){return e.total})})}).getOrElse(function(){return 0})}},{key:"render",value:function(){return d.createElement("div",{className:Object(C.B)(this.props.display,"container"),style:this.props.style},d.createElement(eu.a,{fetching:this.props.logsFetching,showId:!1,error:this.props.logsFetchingError,headers:this.headers,rows:this.getRows(),columnStyles:[{flex:1},{flex:3},{flex:4}]}),d.createElement(lu.a,{pageSizes:[5,10,20,40,60],nextPage:this.onNextPage,prevPage:this.onPrevPage,firstPage:this.onFirstPage,lastPage:this.onLastPage,changePageSize:this.onPageSizeChanged,currentPage:this.props.visitedUrlsLog.currentPage,rowPerPage:this.props.visitedUrlsLog.pageSize,totalRecords:this.getTotalRecords()}))}}]),t}(d.Component);xc=Pc([m.autobind],xc);var _c=function(e){e.currentFormRecord.foreach(function(t){var n,r,o,i;e.dispatch((n=e.formId,r=t.id,o=e.visitedUrlsLog.currentPage,i=e.visitedUrlsLog.pageSize,function(e){e(Object(uu.g)({formDataId:r}));var t=new k.VisitedUrlsListRequest(n,r,o,i,Object(E.toOption)(new k.Interval));return tu.a.send(new ou(t),Object(iu.h)()).then(function(t){return e(Object(uu.j)({formDataId:r,resolved:t.page})),t}).catch(function(t){throw e(Object(uu.f)({formDataId:r,error:t})),t})}))})},Fc=Object(h.connect)(function(e,t){var n=Object(I.d)(e.blockRendererContext,t.blockRendererId);return{currentFormRecord:n,visitedUrlsLog:e.visitedUrlsLog,i18n:e.i18n,logPage:n.flatMap(function(t){return Object(E.liftKey)(e.visitedUrlsLog.result,t.id.value)}).flatMap(function(e){return e.map(function(e){return e.records})}),logsFetching:n.flatMap(function(t){return Object(E.liftKey)(e.visitedUrlsLog.fetching,t.id.value)}).getOrElse(function(){return!1}),logsFetchingError:n.flatMap(function(t){return Object(E.liftKey)(e.visitedUrlsLog.error,t.id.value)}).getOrElse(function(){return new E.None})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.block===t.block&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput&&e.blockRendererContext===t.blockRendererContext&&e.visitedUrlsLog===t.visitedUrlsLog},areStatePropsEqual:function(e,t){return Object(E.isEqual)(e.currentFormRecord,t.currentFormRecord)&&Object(E.isEqual)(e.logPage,t.logPage)&&Object(E.isEqual)(e.logsFetchingError,t.logsFetchingError)&&e.logsFetching===t.logsFetching&&e.i18n===t.i18n&&e.visitedUrlsLog===t.visitedUrlsLog}})(Object(fe.a)([_c],[function(e,t){Object(E.isEqual)(e.currentFormRecord,t.currentFormRecord)||e.dispatch(Object(uu.h)(0))},function(e,t){if(e.isTokenChecked)if(!e.isTokenChecked||t.isTokenChecked){var n=e.visitedUrlsLog,r=n.currentPage,o=n.pageSize,i=t.visitedUrlsLog,a=i.currentPage,u=i.pageSize;a===r&&u===o||_c(e)}else _c(e)}])(Object(X.a)(xc))),Dc=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getLabelByCurrentBlockLang",value:function(e,t){var n=this.props.block.settings.selectedLangOrderIndex;return Object(E.headOption)(t.filter(function(e){return e.order===n})).flatMap(function(t){return Object(E.liftKey)(t.translationMap,e)})}},{key:"getAggregateMargin",value:function(e){var t=e.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new k.ElementProportions}),n=e.elementCss.flatMap(function(e){return e.align}).getOrElse(function(){return new k.ElementAlign}).justifySelf.getOrElse(function(){return"0 0 0 0"}).split(" ");return t.margin.map(function(e){return e.toString()}).getOrElse(function(){return(e.getDefaultMargin()+"px ").repeat(4).replace(/\s+$/,"")}).split(" ").map(function(e,t){return"auto"===n[t]?n[t]:e}).join(" ")}},{key:"getCellJustifyContent",value:function(e,t){return-1!==t.elementCss.flatMap(function(e){return e.align}).getOrElse(function(){return new k.ElementAlign}).justifySelf.getOrElse(function(){return"0 0 0 0"}).indexOf("auto")?void 0:e}},{key:"getDisplayRenderer",value:function(e){return d.createElement(Mc,{key:e.id.value,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,display:e,blockId:this.props.blockId,formId:this.props.formId,getBlockComponent:this.props.getBlockComponent,parentRecordId:this.props.parentRecordId,isRootElement:!1,handleButtonPress:this.props.handleButtonPress})}},{key:"getBlockJustifyContent",value:function(e){return e.map(function(e){return e.entity.ui.justifyContent})}},{key:"renderDisplayElement",value:function(e){var t=this;Object(g.b)(this.props.block,this.props.blockId).filter(function(e){return e.entity.languageConfig.enabled}).flatMap(function(n){return t.getLabelByCurrentBlockLang(Object(oe.e)(e.label.text),n.entity.languageConfig.langs)}).foreach(function(t){e=K(e,{label:{text:{$set:t}}})});var n=e.elementCss.flatMap(function(e){return e.proportions}).getOrElse(function(){return new k.ElementProportions}),r=e.elementCss.flatMap(function(e){return e.align}).getOrElse(function(){return new k.ElementAlign}),o={margin:this.getAggregateMargin(e),padding:n.padding.map(function(e){return e.toString()}).getOrElse(function(){return e.getDefaultPadding()+"px"})};switch(e.tpe.value){case k.FieldElement.$Type.value:return d.createElement(Ti,{key:e.id.value,style:o,blockRendererId:this.props.blockRendererId,display:e,blockType:this.props.blockType,blockId:this.props.blockId,formId:this.props.formId,fieldId:e.dataInput.map(function(e){return e.formField}),parentRecordId:this.props.parentRecordId,getBlockComponent:this.props.getBlockComponent});case k.GroupElement.$Type.value:var i=e;return d.createElement(ba,{key:e.id.value,display:i,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"}),flexWrap:i.columnsWrapping?"wrap":"nowrap"}),components:Object(j.a)(i.children,"position").map(function(e){return t.getDisplayRenderer(e)})});case k.GroupElementCell.$Type.value:var a=e,u=this.props.isRootElement?"1 1 100%":"1 0 0px";return d.createElement(ha,{key:e.id.value,display:a,style:Object.assign({maxWidth:n.maxWidth.getOrElse(function(){return"none"}),minWidth:n.minWidth.getOrElse(function(){return"58px"}),flex:n.width.map(function(e){return"auto"===e?u:"0 0 "+e}).getOrElse(function(){return u})},o),components:Object(j.a)(a.children,"position").map(function(e){return d.createElement("div",{key:e.id.value,className:Object(C.n)(e),style:{display:"flex",flexGrow:0,justifyContent:t.getCellJustifyContent(r.justifyContent,e)}},t.getDisplayRenderer(e))})});case k.TabsDisplayElement.$Type.value:var l=e;return d.createElement(Li,{key:e.id.value,display:l,components:l.children.filter(function(e){return Object(E.toOption)(l.tabsPosition).filter(function(t){return(t instanceof k.TabsPositionRight||t instanceof k.TabsPositionLeft)&&(t.menuBottomContainer.value===e.id.value||t.menuTopContainer.value===e.id.value)}).isEmpty()}).filter(function(e){return e.id.value!==wc.d&&e.id.value!==wc.c}),style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),menuTopChildren:Object(E.toOption)(l.tabsPosition).map(function(e){return e instanceof k.TabsPositionRight||e instanceof k.TabsPositionLeft?l.children.filter(function(t){return e.menuTopContainer.value===t.id.value||t.id.value===wc.d}):[]}).getOrElse(function(){return[]}).map(function(e){return t.getDisplayRenderer(e)}),menuBottomChildren:Object(E.toOption)(l.tabsPosition).map(function(e){return e instanceof k.TabsPositionRight||e instanceof k.TabsPositionLeft?l.children.filter(function(t){return e.menuBottomContainer.value===t.id.value||t.id.value===wc.c}):[]}).getOrElse(function(){return[]}).map(function(e){return t.getDisplayRenderer(e)})},l.children.filter(function(e){return Object(E.toOption)(l.tabsPosition).filter(function(t){return(t instanceof k.TabsPositionRight||t instanceof k.TabsPositionLeft)&&(t.menuBottomContainer.value===e.id.value||t.menuTopContainer.value===e.id.value)}).isEmpty()}).filter(function(e){return e.id.value!==wc.d&&e.id.value!==wc.c}).map(function(e){return t.getDisplayRenderer(e)}));case k.StepperDisplayElement.$Type.value:var c=e,s=c.children;return d.createElement(Yi,{key:e.id.value,blockRendererId:this.props.blockRendererId,blockId:this.props.blockId,components:c.children,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:c},s.map(function(e){return t.getDisplayRenderer(e)}));case k.DocumentsElement.$Type.value:var p=e;return d.createElement(sa,{key:e.id.value,blockRendererId:this.props.blockRendererId,display:p,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})})});case k.ButtonElement.$Type.value:var f=e,h=Object(E.liftKey)(this.props.block.record,this.props.blockId.value).flatMap(function(e){return e.flatMap(function(e){return e.entity.ui.blockStyle})});return d.createElement(Ya,{key:e.id.value,display:f,handleButtonPress:this.props.handleButtonPress,style:Object.assign(o),blockStyle:h});case k.EmbeddedBlockElement.$Type.value:var m=e;return d.createElement(Eu.a,{key:e.id.value,blockType:this.props.blockType,display:m,style:Object.assign(o,{flex:"1"}),blockRendererId:this.props.blockRendererId,getBlockComponent:this.props.getBlockComponent});case k.ParentsRefsElement.$Type.value:var y=e;return d.createElement(_u,{key:e.id.value,display:y,style:Object.assign(o,{flex:"1"}),blockRendererId:this.props.blockRendererId,getBlockComponent:this.props.getBlockComponent});case k.LabelElement.$Type.value:var b=e;return d.createElement(ka,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),blockRendererId:this.props.blockRendererId,display:b});case k.LimitsElement.$Type.value:return d.createElement(Ua,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),blockRendererId:this.props.blockRendererId,display:e,formId:this.props.formId});case k.ImageElement.$Type.value:var O=e;return d.createElement(Oa,{style:Object.assign(o,{display:"flex-inline",margin:r.justifySelf.getOrElse(function(){return"0 0 0 0"})}),key:e.id.value,display:O});case k.LogElement.$Type.value:return d.createElement(mu,{blockRendererId:this.props.blockRendererId,formId:this.props.formId,blockId:this.props.blockId,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e});case k.HTMLElement.$Type.value:return d.createElement(bu,{key:e.id.value,style:o,display:e,blockRendererId:this.props.blockRendererId});case k.LanguageElement.$Type.value:return d.createElement(ku,{key:e.id.value,style:o,display:e,blockId:this.props.blockId});case k.ErrorElement.$Type.value:return d.createElement(Du,{key:e.id.value,style:o,display:e,blockRendererId:this.props.blockRendererId});case k.EmailListElement.$Type.value:return d.createElement(fl,{key:e.id.value,style:o,display:e,blockRendererId:this.props.blockRendererId});case k.DelimiterElement.$Type.value:var v=e;return d.createElement(vl,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:v});case k.IFrameElement.$Type.value:var R=e;return d.createElement(kl.a,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"}),margin:r.justifySelf.getOrElse(function(){return"0 0 0 0"})}),display:R});case k.CommentsListElement.$Type.value:return d.createElement(hc,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e,blockRendererId:this.props.blockRendererId});case k.ExpansionPanelDisplayElement.$Type.value:var I=e;return d.createElement(Fl,{key:e.id.value,display:I,components:I.children,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})})},I.children.map(function(e){return t.getDisplayRenderer(e)}));case k.SelectionMatrixElement.$Type.value:return d.createElement(Sc,{key:e.id.value,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e,blockRendererId:this.props.blockRendererId,blockId:this.props.blockId,blockType:this.props.blockType,formId:this.props.formId});case k.VisitedUrlsLogElement.$Type.value:return d.createElement(Fc,{blockRendererId:this.props.blockRendererId,formId:this.props.formId,blockId:this.props.blockId,style:Object.assign(o,{flex:n.width.map(function(e){return"auto"===e?"1 0 0px":"0 0 "+e}).getOrElse(function(){return"1 0 0px"})}),display:e});default:return d.createElement("div",null,this.props.i18n.t("Неизвестный тип элемента отображения"))}}},{key:"render",value:function(){var e=this.props.display;return this.props.isVisible&&d.createElement(gl,{blockId:this.props.blockId,elementCss:e.elementCss},d.createElement(Tc.a,{component:e},this.renderDisplayElement(e)))}}]),t}(d.Component),Mc=Object(h.connect)(function(e,t){return{block:e.block,i18n:e.i18n,isVisible:t.display.displayRule.map(function(n){return n.isVisible(function(n){return Object(R.e)(e.dataOutput,t.blockRendererId,n).matchWith(function(e){return Object(E.toOption)(e.value)},function(){return Object(I.g)(e.blockRendererContext,t.blockRendererId,n)})})}).getOrElse(function(){return!0})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.block===t.block&&e.blockRendererContext===t.blockRendererContext&&e.i18n===t.i18n&&e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return e.isVisible===t.isVisible&&e.i18n===t.i18n&&e.block===t.block}})(Dc),Bc=Mc,Vc=n(164),Lc=n(1503),qc=n(79),$c=n(624),Ac=function(e){return function(t,n){!function(e,t){t(Object(Lc.a)(e)).foreach(function(n){clearTimeout(n),t(Object(Vc.p)(e))})}(e,t),t(Object(H.H)(e)),t(Object(Vc.n)(e))}},Nc=function(e){switch(e.tpe.value){case k.UrlHandlerAll.$Type.value:return Object(E.toOption)(window.location.href);case k.UrlHandlerParam.$Type.value:return Object(E.headOption)(Object($c.a)(window.location.search)[e.param]);default:return new E.None}},Wc=function(e,t,n){return Object(E.liftKey)(n.getOrElse(function(){return{}}),e.output.formField.value).filter(function(t){return t.value.tpe.value===k.ValueStr.$Type.value&&e.append}).matchWith(function(e){return new k.ValueStr(e.value.toString()+" "+t)},function(){return new k.ValueStr(t)})},zc=function(e,t,n){return function(r){Object(E.toOption)(t.tpe.value===k.UrlHandlerClientInfo.$Type.value).filter(function(e){return e}).matchWith(function(){new Promise(function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&200==this.status?e(JSON.parse(this.responseText).ip):t(new Error("Getting ip error"))},n.onerror=function(e){return t(e)},n.open("GET","//api.ipify.org?format=json",!0),n.send()}).then(function(o){return r(Object(H.G)({output:t.output,value:Wc(t,o+"(;)"+(i=window.navigator,"timeOpened:"+new Date+"(;)timezone:"+(new Date).getTimezoneOffset()/60+"(;)pageon:"+window.location.pathname+"(;)previousSites:"+document.referrer+"(;)referrer:"+history.length+"(;)appName:"+i.appName+"(;)appVersion:"+i.appVersion+"(;)product:"+i.product+"(;)appCodeName:"+i.appCodeName+"(;)onLine:"+i.onLine+"(;)connection:"+JSON.stringify(i.connection)+"(;)cookieEnabled:"+i.cookieEnabled+"(;)cookie:"+document.cookie+"(;)localStorage:"+JSON.stringify(localStorage)+"(;)deviceMemory:"+i.deviceMemory+"(;)language:"+i.language+"(;)languages:"+JSON.stringify(i.languages)+"(;)platform:"+i.platform+"(;)userAgent:"+i.userAgent+"(;)vendor:"+i.vendor+"(;)javaEnabled:"+i.javaEnabled()+"(;)colorDepth:"+window.screen.colorDepth+"(;)pixelDepth:"+window.screen.pixelDepth+"(;)width:"+window.screen.width+"(;)height:"+window.screen.height+"(;)availWidth:"+window.screen.availWidth+"(;)availHeight:"+window.screen.availHeight+"(;)innerWidth:"+innerWidth+"(;)innerHeight:"+innerHeight+"(;)"),n),blockRendererId:e}));var i})},function(){Nc(t).foreach(function(o){return r(Object(H.G)({output:t.output,value:Wc(t,o,n),blockRendererId:e}))})})}},Uc=function(e,t){return Object(E.toOption)(Object.assign({},e.getOrElse(function(){return{}}),t.reduce(function(t,n){return Nc(n).matchWith(function(r){return Object.assign(t,Vn()({},n.output.formField.value,new k.FormFieldValue(n.output.formField,Wc(n,r,e))))},function(){return t})},{})))},Hc=function(e,t,n,r,o,i,a,u,l){return function(c,s){c(Object(H.v)(e)),c(function(e,t,n){return function(r){return t.forEach(function(t){r(zc(e,t,n))})}}(e,o.entity.urlHandlers,u)),c(Object(Vc.s)({blockRendererId:e,rootBlockRendererId:t,formId:r,formRecord:a,blockId:o.id,blockType:i,initialValues:Uc(u,o.entity.urlHandlers),initialDictionaries:l,isPrivateCabinet:n})),function(e){var t="blockCustomCss-"+e.id.value;Object(E.toOption)(e.entity.ui.customCss).filter(function(n){return e.entity.ui.customCss.enabled&&Object(E.toOption)(document.getElementById(t)).isEmpty()}).flatMap(function(e){return e.value}).matchWith(function(e){var n=document.createElement("style");n.type="text/css",n.id=t,n.innerHTML=e,document.body.appendChild(n)},function(){})}(o),function(e){e.entity.externalScriptUrls.filter(function(e){return Object(E.toOption)(document.getElementById(e.id)).isEmpty()}).forEach(function(e){var t=document.createElement("script");t.src=e.url,t.async=!0,t.setAttribute("id",e.id),document.body.appendChild(t)})}(o),function(e,t,n,r){n(Object(Lc.a)(e)).foreach(function(t){clearTimeout(t),n(Object(Vc.p)(e))}),t.entity.ui.resetPage.foreach(function(t){if(t.enabled){var o=setTimeout(function(){n(Object(Vc.p)(e)),r().user.userRole.foreach(function(e){n(Object(qc.p)(e.entity))})},t.interval);n(Object(Vc.o)({blockRendererId:e,timerId:o}))}})}(e,o,c,s),function(e){Object(E.toOption)(e).filter(function(e){return e.entity.payment instanceof k.BlockPaymentConfigDonatePayment&&e.entity.payment.enabled&&Object(E.toOption)(document.getElementById("stripeCheckoutScript")).isEmpty()}).foreach(function(){var e=document.createElement("script");e.src="https://checkout.stripe.com/checkout.js",e.async=!0,e.setAttribute("id","stripeCheckoutScript"),document.body.appendChild(e)})}(o)}},Kc=n(653),Gc=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Jc=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(Kc.e)(this.props.report,this.props.formDataId))}},{key:"onDownloadClick",value:function(){var e=this;this.props.reports.result.filter(function(e){return e.data instanceof k.ReportDataReportFile}).foreach(function(t){e.props.dispatch(Object(kr.c)(t.data.meta.id)),e.props.onDownloadClick()})}},{key:"render",value:function(){return this.props.reports.resultFetching?d.createElement(v.a,null):this.props.reports.result.filter(function(e){return e.data instanceof k.ReportDataReportFile}).nonEmpty()?d.createElement("p",null,d.createElement("span",null,this.props.i18n.t("Отчет сформирован, для загрузки нажмите")+" "),d.createElement(jn.a,{onClick:this.onDownloadClick},d.createElement(Tr.a,null))):(this.props.reports.resultError.nonEmpty()&&d.createElement("p",null,this.props.i18n.t("В процессе формирования отчета произошла ошибка!")),null)}}]),t}(d.Component);Jc=Gc([m.autobind],Jc);var Yc=Object(h.connect)(function(e,t){return{i18n:e.i18n,reports:e.reports}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)})(Jc),Zc=n(1483),Xc=n(192),Qc=n(111),es=n(429),ts=n(48),ns=n(57),rs=n(69),os=n(1511),is=function(){return function(e,t){return t().eventLine.eventLineId.flatMap(function(n){return Object(E.headOption)(Object(b.f)(t().forms,n).filter(function(e){return k.FormType.isDocument(e.entity.formType)})).map(function(t){return e(Object(Q.b)(t.id)).then(function(){return e(function(e,t){return function(n,r){return new Promise(function(o,i){r().user.terminal.matchWith(function(a){Object(U.e)(r().fields,t).flatMap(function(e){return Object(E.headOption)(e.filter(function(e){return e.entity.valueType.tag.filter(function(e){return e.tpe.value===k.ValueTagTerminalId.$Type.value})}))}).matchWith(function(r){var i=Object(E.toOption)(new k.FilterCondition(r.id,new k.FilterExpressionContains,new k.ValueStr(a.value)));n(Object(ts.ab)(i)),n(Object(ns.x)(t)),n(Object(qc.J)(e,new k.Id(k.FormType.ACCESS_ZONE_PASSSES),t)),o()},function(){i()})},function(){i()})})}}(n,t.id))})})}).getOrElse(function(){return new Promise(function(e,t){t()})})}},as=n(176),us=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ls=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"componentWillUnmount",value:function(){this.cancelDefaultPageTimeout()}},{key:"cancelDefaultPageTimeout",value:function(){var e=this;this.props.dispatch(Object(Lc.a)(this.props.blockRendererId)).foreach(function(t){clearTimeout(t),e.props.dispatch(Object(Vc.p)(e.props.blockRendererId))})}},{key:"onListChildren",value:function(e){var t=e.refFieldId;this.props.dispatch(function(e,t,n){return function(r,o){Object(U.d)(o(),n,t).filter(function(e){return e.entity.valueType instanceof k.ValueTypeObjectRefs}).map(function(e){return e.entity.valueType.family}).foreach(function(n){var i=Object(E.headOption)(o().eventLines.list.filter(function(e){return Object(b.e)(o().forms,n).matchWith(function(t){return t.entity.eventLineId.value===e.id.value},function(){return!1})}));Object(R.e)(o().dataOutput,e,t).map(function(e){return e.value.id}).map(function(e){var t=Object(E.toOption)(new k.FilterGroupCondition([new k.RestrictedForm(n,e)].concat([]),new k.FilterPredicateAnd));r(Object(ts.ab)(t)),r(Object(ns.x)(n)),i.foreach(function(e){r(Object(qc.J)(e.id,new k.Id(k.FormType.FORM),n))})})})}}(this.props.blockRendererId,t,this.props.formId))}},{key:"onSearchReferrers",value:function(e){this.props.dispatch(function(e,t){return function(n,r){Object(I.d)(r().blockRendererContext,e).foreach(function(e){var o=Object(E.headOption)(r().eventLines.list.filter(function(e){return Object(b.e)(r().forms,t.formId).matchWith(function(t){return t.entity.eventLineId.value===e.id.value},function(){return!1})})),i=Object(E.toOption)(new k.FilterGroupCondition([new k.FilterCondition(t.fieldId,new k.FilterExpressionContains,new k.ValueObjectRefs([e.id]))],new k.FilterPredicateAnd));t.firstMatch?Object(ee.g)(t.formId,i).then(function(e){return e.foreach(function(e){return o.foreach(function(t){return n(Object(qc.H)(t.id,new k.Id(k.FormType.FORM),e.entity.formId,e.id))})})}):(n(Object(ts.ab)(i)),n(Object(ns.x)(t.formId)),o.foreach(function(e){n(Object(qc.J)(e.id,new k.Id(k.FormType.FORM),t.formId))}))})}}(this.props.blockRendererId,e))}},{key:"sendJourneyEvent",value:function(e){var t=this;return this.props.dispatch(Object(de.k)(this.props.blockId,e,this.props.blockRendererId)).then(function(){t.props.dispatch(Object(In.h)(t.props.i18n.t("Выполнено успешно")))}).catch(function(){t.props.dispatch(Object(In.h)(t.props.i18n.t("Выполнено с ошибкой")))})}},{key:"handleButtonAction",value:function(e){var t,n,r,o=this;switch(e.tpe.value){case k.ButtonActionSave.$Type.value:return this.props.onSave(e.blockId).then(function(e){o.props.dispatch(Object(Vc.r)({formRecordId:Object(E.toOption)(e),blockRendererId:o.props.blockRendererId}))});case k.ButtonActionSaveAndPay.$Type.value:return this.props.onSaveAndPay&&this.props.onSaveAndPay(e.blockId),new Promise(function(e,t){return e()});case k.ButtonActionEdit.$Type.value:return this.props.onEdit(e.blockId),new Promise(function(e,t){return e()});case k.ButtonActionOpenBlock.$Type.value:return this.props.formRecordId.matchWith(function(t){return o.props.dispatch(Object(ee.f)(o.props.formId,t)).then(function(){return o.props.onOpenBlock&&o.props.onOpenBlock(e.blockId,o.props.formId,Object(E.toOption)(t))})},function(){return o.props.onOpenBlock&&o.props.onOpenBlock(e.blockId,o.props.formId,new E.None),new Promise(function(e,t){return e()})});case k.ButtonActionSearchReferrers.$Type.value:return new Promise(function(t,n){try{o.onSearchReferrers(e),t()}catch(e){n(e)}});case k.ButtonActionListChildren.$Type.value:return new Promise(function(t,n){try{o.onListChildren(e),t()}catch(e){n(e)}});case k.ButtonActionListPastPasses.$Type.value:return this.props.dispatch(is());case k.ButtonActionEmpty.$Type.value:return new Promise(function(e,t){return e()});case k.ButtonActionSendJourneyEvent.$Type.value:return this.sendJourneyEvent(e);case k.ButtonActionInvokeJsScript.$Type.value:return this.props.dispatch(function(e,t){return function(n,r){var o=e.args.reduce(function(e,n){return Object(R.e)(r().dataOutput,t,n.fieldId).map(function(t){return e[n.name]=Object(R.o)(t.value),e}).getOrElse(function(){return e})},{}),i=Function("formDataId","actionArgs","authToken",e.body),a=function(e,t,n){try{i(e,t,n)}catch(e){console.log("invokeJsActionError",e)}};Object(I.e)(r().blockRendererContext,t).matchWith(function(e){a(e.value.toString(),o,r().auth.token.getOrElse(function(){return""}))},function(){a("",o,r().auth.token.getOrElse(function(){return""}))})}}(e,this.props.blockRendererId)),new Promise(function(e,t){return e()});case k.ButtonActionLogin.$Type.value:return this.props.dispatch((t=this.props.formId,n=this.props.blockId,r=this.props.blockRendererId,function(e,o){return e(Object(Ui.g)(n,r,new Wo.None)).then(function(){return o().application.info.filter(function(e){return e.appType instanceof k.ApplicationTypePrivateCabinet}).map(function(e){return e.appType}).map(function(n){return Object(Zc.c)(n.credentials.fields.map(function(e){return Object(R.e)(o().dataOutput,r,e).map(function(t){return new k.FormFieldValue(e,t.value)})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]),t).then(function(t){var r=t.context;e(Object(Xc.j)(r)),e(Object(qc.m)(r.entity.formId,r.id,o().application.blockId.matchWith(function(e){return e},function(){return n.cabinetBlockId})))}).catch(function(e){throw new Qc.a})}).getOrElse(function(){return new Promise(function(e,t){return t()})})})}));case k.ButtonActionSearch.$Type.value:return this.props.dispatch(function(e,t,n,r){return function(o,i){return o(Object(Ui.g)(n,r,new Wo.None)).then(function(){return Object(ee.k)(new k.DataPageRequest(0,20,t,Object(E.toOption)(new k.FilterGroupCondition(e.fields.map(function(e){return Object(R.e)(i().dataOutput,r,e).map(function(t){return new k.FormFieldValue(e,t.value)})}).reduce(function(e,t){return t.matchWith(function(t){return e.concat(t)},function(){return e})},[]).map(function(e){return new k.FilterCondition(e.formFieldId,new k.FilterExpressionEq,e.value)}),new k.FilterPredicateAnd))))}).then(function(t){Object(E.headOption)(t.page.records).matchWith(function(t){o(Object(Xc.j)(t)),o(Object(qc.m)(t.entity.formId,t.id,e.block))},function(){throw new Qc.f})})}}(e,this.props.formId,this.props.blockId,this.props.blockRendererId));case k.ButtonActionPause.$Type.value:return new Promise(function(t,n){return setTimeout(function(){return t()},e.timeout.getMilliseconds())});case k.ButtonActionExit.$Type.value:return this.props.dispatch(Object(os.a)()),this.props.dispatch(Object(rs.r)()),window.location.reload(),new Promise(function(e,t){return e()});case k.ButtonActionReport.$Type.value:return this.props.dispatch(function(e,t,n){return function(r,o){return new Promise(function(r,i){Object(I.e)(o().blockRendererContext,t).matchWith(function(t){var i=function(){n.handleDialogClose(a),r()},a=n.openDialog(o().i18n.t("Формирование отчета"),d.createElement(Yc,{report:e.report,formDataId:t,onDownloadClick:i}),[d.createElement(q.a,{variant:"raised",onClick:i,key:"close"},o().i18n.t("Закрыть"))])},function(){return i()})})}}(e,this.props.blockRendererId,this.props));case k.ButtonActionRefresh.$Type.value:return this.props.formRecordId.map(function(e){return o.props.dispatch(Object(ee.f)(o.props.formId,e))}).getOrElse(function(){return new Promise(function(e,t){return e()})});case k.ButtonActionOpenNextFormRecord.$Type.value:var i=e;return Object(ee.h)(new k.FormDataIdsOffsetRequest(this.props.formId,0,1,i.filter,i.sorting,new E.None)).then(function(e){Object(E.headOption)(e).matchWith(function(e){o.props.dispatch(Object(Tu.a)(o.props.formId,e))},function(){o.props.openSnackbar(d.createElement("span",null,o.props.i18n.t("Анкет по заданным параметрам фильтрации нет")),new E.None)})});case k.ButtonActionFollowLink.$Type.value:var a=e;return window.open(a.link,a.newWindow?"_blank":"_self"),new Promise(function(e){return e()});default:throw"unknown button action type"}}},{key:"handleButtonPress",value:function(e){var t=this,n=e.actions.map(function(e){return e});return new Promise(function(e,r){!function o(){0!==n.length?Object(E.toOption)(n.shift()).foreach(function(e){t.handleButtonAction(e).then(function(){return o()}).catch(function(e){t.props.dispatch(Object(ae.c)(e,t.props,t.props.blockRendererId,t.props.blockId)),r()})}):e()}()})}},{key:"renderBlockDisplay",value:function(e){return d.createElement(Bc,{key:e.id.value,blockType:this.props.blockType,blockRendererId:this.props.blockRendererId,display:e,blockId:this.props.blockId,formId:this.props.formId,getBlockComponent:this.props.getBlockComponent,parentRecordId:this.props.formRecordId,handleButtonPress:this.handleButtonPress,isRootElement:!0})}},{key:"getBlockJustifyContent",value:function(e){return e.map(function(e){return e.entity.ui.justifyContent}).getOrElse(function(){return"flex-start"})}},{key:"render",value:function(){var e=this;if(this.props.formAccessoriesError.nonEmpty())return d.createElement("div",null,this.props.i18n.t("Ошибка загрузки полей или словарей формы"));if(this.props.initialValuesError)return d.createElement("div",null,this.props.i18n.t("Ошибка загрузки записи, редактирование или отображение невозможно"));if(this.props.isBlockError)return d.createElement("div",null,this.props.i18n.t("Ошибка загрузки блока отображения"));var t=this.props.isBlockFetching&&!this.props.isBlockError&&this.props.block.isEmpty(),n=this.props.isFormAccessoriesFetching&&!this.props.isFormAccessoriesFetched&&this.props.formAccessoriesError.isEmpty();return t||n?d.createElement(v.a,null):d.createElement("div",{style:{display:"flex",flexGrow:0,justifyContent:this.getBlockJustifyContent(this.props.block)}},this.props.block.map(function(e){return e.entity.display}).getOrElse(function(){return[]}).map(function(t){return e.renderBlockDisplay(t)}))}}]),t}(d.Component);ls=us([m.autobind],ls);var cs=function(e){e.block.isEmpty()&&!e.isBlockFetching&&e.dispatch(Object(O.c)(e.blockId)).then(function(t){return e.dispatch((n=t,function(e,t){t().auth.token.foreach(function(r){Object(C.a)(n.entity.display),e(Object(es.c)(n.entity.display,n.entity.ui.blockStyle,r,t().config.cdnAddress))})}));var n})},ss=function(e){return e.dispatch(Object(as.f)(e.formId))},ps=function(e){e.block.foreach(function(t){e.dispatch(Hc(e.blockRendererId,e.rootBlockRendererId,e.isPrivateCabinet||!1,e.formId,t,e.blockType,e.formRecord,Object(y.default)(e.initialValues)?new E.None:Object(E.toOption)(e.initialValues),Object(y.default)(e.initialDictionares)?new E.None:Object(E.toOption)(e.initialDictionares)))})},fs=function(e){e.dispatch(Object(Vc.u)({blockRendererId:e.blockRendererId,initialValues:Object(y.default)(e.initialValues)?new E.None:Object(E.toOption)(e.initialValues)}))};t.a=Object(h.connect)(function(e,t){return{isFormAccessoriesFetching:e.forms.fetching||Object(b.b)(e.forms,t.formId).getOrElse(function(){return!1}),isFormAccessoriesFetched:Object(b.a)(e.forms,t.formId).getOrElse(function(){return!1}),formAccessoriesError:Object(b.d)(e.forms,t.formId),isBlockFetching:Object(g.d)(e.block,t.blockId).getOrElse(function(){return!1}),isBlockError:Object(g.c)(e.block,t.blockId).nonEmpty(),block:Object(g.b)(e.block,t.blockId),i18n:e.i18n,token:e.auth.token,fonts:e.fonts,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:function(t){return e(t)}}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.block===t.block&&e.forms===t.forms&&e.i18n===t.i18n},areOwnPropsEqual:function(e,t){return e.formId.value===t.formId.value&&e.blockId.value===t.blockId.value&&e.blockType.tpe.value===t.blockType.tpe.value&&Object(E.isEqual)(e.formRecord,t.formRecord)&&Object(E.isEqual)(e.formRecordId,t.formRecordId)&&e.initialValues===t.initialValues&&e.initialDictionares===t.initialDictionares&&e.initialValuesError===t.initialValuesError}})(Object(fe.a)([ss,cs,ps],[function(e,t){e.formId.value!==t.formId.value&&e.isTokenChecked&&ss(e),e.formId.value===t.formId.value&&e.isTokenChecked&&!t.isTokenChecked&&ss(e)},function(e,t){e.blockId.value!==t.blockId.value&&e.isTokenChecked&&cs(e),e.blockId.value===t.blockId.value&&e.isTokenChecked&&!t.isTokenChecked&&cs(e)},function(e,t){Object(E.isEqual)(e.block,t.block)||ps(e)},function(e,t){var n;Object(E.isEqual)(e.formRecord,t.formRecord)||(n=e).dispatch(Object(Vc.q)({blockRendererId:n.blockRendererId,formRecord:n.formRecord}))},function(e,t){return Object(y.default)(e.initialValues)!==Object(y.default)(t.initialValues)?fs(e):e.initialValues!==t.initialValues?fs(e):void 0},function(e,t){var n;Object(y.default)(e.initialDictionares)!==Object(y.default)(t.initialDictionares)&&(n=e).dispatch(Object(Vc.t)({blockRendererId:n.blockRendererId,initialDictionaries:Object(y.default)(n.initialDictionares)?new E.None:Object(E.toOption)(n.initialDictionares)}))}],[],[function(e){e.dispatch(Ac(e.blockRendererId))}])(Object(tl.a)(Object(X.a)(ls))))},1497:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(160),y=n.n(m),b=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},g=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return d.createElement("div",{style:{height:"210px",boxSizing:"border-box",width:"100%",textAlign:"center",padding:"30px",opacity:1}},d.createElement(y.a,{size:150,thickness:2}))}}]),t}(d.Component);g=b([h.autobind],g),t.a=g},1498:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return p});var r=n(1),o=n(372),i=n(148),a=n(0),u=n(1492),l=n(264),c=function(e){return function(t,n){var r=n();return Object(o.d)(r.blockRendererContext,e).map(function(e){return e.entity.permissions.map(function(e){return e.limits}).getOrElse(function(){return[]})}).getOrElse(function(){return[]})}},s=function(e,t){return function(n,i){var l=Object(a.headOption)(e),c=l.map(function(e){return e.defaultSource.value}).getOrElse(function(){return r.DisplayTypeByBlockSchemaType.$Type.value}),s=l.map(function(e){return e.filterActions}).getOrElse(function(){return[]}),p=Object(o.d)(i().blockRendererContext,t).map(function(e){return[e]}).getOrElse(function(){return[]}),f=s.filter(function(e){return 0!=p.filter(function(t){return Object(u.e)(t,Object(a.toOption)(e.filter))}).length});return f.length>0?Object(a.headOption)(f).map(function(e){return e.valueSource.value}).getOrElse(function(){return c}):c}},p=function(e){return function(t,n){return e.flatMap(function(r){return r.autoSuggestRef.map(function(r){return Object(i.f)(n().dictionaries,r.family).getOrElse(function(){return!1})?new Promise(function(t,r){return t(e.flatMap(function(e){return e.autoSuggestRef.flatMap(function(e){return Object(a.lift)(e.displayFields,0).map(function(t){return Object(i.b)(n().dictionaries,e.family).getOrElse(function(){return[]}).map(function(e){return Object(a.liftKey)(e.entity.values,t.value).map(function(e){return e.value.toString()}).getOrElse(function(){return""})})})})}).getOrElse(function(){return[]}))}):t(Object(l.c)(r.family,new a.None)).then(function(e){return Object(a.lift)(r.displayFields,0).map(function(t){return e.list.map(function(e){return Object(a.liftKey)(e.entity.values,t.value).map(function(e){return e.value.toString()}).getOrElse(function(){return""})})}).getOrElse(function(){return[]})})})}).getOrElse(function(){return new Promise(function(e,t){return e([])})})}}},1500:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(95),y=n(13),b=n(26),g=n.n(b),O=n(32),v=n.n(O),k=n(34),E=n.n(k),j=n(30),C=n.n(j),R=n(25),I=n.n(R),S=n(1490),w=n.n(S),T=n(1),P=n(3),x=n(1472),_=n.n(x),F=n(538),D=n.n(F),M=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},B=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"onDeleteClick",value:function(){this.props.onRemove(this.props.idx)}},{key:"render",value:function(){return d.createElement(_.a,{style:{marginRight:"5px"},label:this.props.name,avatar:d.createElement(D.a,null,d.createElement(w.a,null)),onDelete:this.onDeleteClick})}}]),t}(d.Component);B=M([y.autobind],B);var V=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(B),L=n(0),q=n(99),$=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},A=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},N=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={files:[]},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(q.d)(this.props.attachments.map(function(e){return e.fileId})))}},{key:"onAddFileButtonClick",value:function(){this.fileUpload(this.fileChanged)}},{key:"fileUpload",value:function(e){this.fileInput.foreach(function(e){return e.click()})}},{key:"onRemove",value:function(e){this.props.onChange(P(this.props.attachments,{$splice:[[e,1]]}))}},{key:"fileChanged",value:function(e){var t=this,n=e.target.files[0];Object(q.h)(n,this.props.cdnAddress,this.props.auth.token,this.props.organisation.organisationId,this.props.eventLine.eventLineId,new L.None,new L.Some(new T.FileTypeMailAttach),"true").then(function(e){Object(q.b)(e).then(function(e){t.setState(P(t.state,{files:{$push:[e.record]}}))}),t.props.onChange(P(t.props.attachments,{$push:[new T.AttachmentFileAttachment(e)]}))}).catch(function(e){console.error("File uploaded with error",e)})}},{key:"fileInputHandler",value:function(e){this.fileInput=Object(L.toOption)(e)}},{key:"render",value:function(){var e=this;return d.createElement("div",null,d.createElement("input",{ref:this.fileInputHandler,type:"file",onChange:this.fileChanged,style:{display:"none"}}),d.createElement("div",null,this.state.files.map(function(t,n){return d.createElement(V,{key:n,idx:n,name:t.entity.originalName,onRemove:e.onRemove})})),d.createElement("div",null,d.createElement(I.a,{onClick:this.onAddFileButtonClick,style:{marginRight:"10px"}},d.createElement(w.a,null))))}}]),t}(d.Component);N=$([y.autobind,A("design:paramtypes",[Object])],N);var W=Object(h.connect)(function(e,t){return{i18n:e.i18n,cdnAddress:e.config.cdnAddress,auth:e.auth,organisation:e.organisation,eventLine:e.eventLine}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.config.cdnAddress===t.config.cdnAddress},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.eventLine===t.eventLine&&e.organisation===t.organisation&&e.cdnAddress===t.cdnAddress}})(N),z=n(16),U=n(424),H=n(245),K=n(246),G=n(247),J=n(266),Y=n(292),Z=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},X=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Q=new z.CompositeDecorator([{strategy:H.b,component:H.a},{strategy:K.b,component:K.a},{strategy:G.b,component:G.a}]),ee=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=Object(J.a)(n.props.html,Q,[],[],[],n.props.i18n.t);z.EditorState.moveSelectionToEnd(r);return n.state={editorState:r,htmlBody:n.props.html,showHtml:!1},n}return s()(t,e),a()(t,[{key:"onEditorStateChange",value:function(e){var t=this;this.setState(P(this.state,{editorState:{$set:e}}),function(){setTimeout(function(){t.state.editorState===e&&t.props.onChange(Object(Y.a)(Object(z.convertToRaw)(e.getCurrentContent())))},200)})}},{key:"onShowHTMLChange",value:function(e){this.setState(P(this.state,{showHtml:{$set:e}}))}},{key:"onHtmlChange",value:function(e){var t=this;this.setState(P(this.state,{htmlBody:{$set:e}}),function(){t.props.onChange(e)})}},{key:"render",value:function(){return d.createElement(U.a,{showInsertionButtons:!1,formId:new L.None,organisationId:this.props.organisationId,html:this.state.htmlBody,showHtml:this.state.showHtml,editorState:this.state.editorState,onChange:this.onEditorStateChange,onShowHTMLChange:this.onShowHTMLChange,onHtmlChange:this.onHtmlChange,fields:[],insertions:[],attachments:[],urlLinks:[],onAttachmentsChange:function(){},onInsertionsChange:function(){},onUrlLinksChange:function(){}})}}]),t}(d.Component);ee=Z([y.autobind,X("design:paramtypes",[Object])],ee);var te=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(ee),ne=n(136),re=n(648);n.d(t,"a",function(){return ie});var oe=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ie="EmailDataObjectReplyForm",ae=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"renderMailBoxSelect",value:function(){return d.createElement(v.a,{fullWidth:!0},d.createElement(E.a,null,this.props.i18n.t("Ящик отправки")),d.createElement(C.a,{native:!0,value:this.props.fields.mailBoxId.value,onChange:this.props.fields.mailBoxId.onChange},d.createElement("option",{value:""}),this.props.mailBoxConfigs.list.map(function(e){return d.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)})))}},{key:"render",value:function(){var e=this.props,t=e.fields,n=t.subject,r=t.replyTo,o=t.attachments,i=(t.body,t.html),a=t.cc,u=t.bcc,l=e.handleSubmit;return d.createElement("form",{style:{width:"100%"},onSubmit:l},this.props.showMailBoxSelector&&this.renderMailBoxSelect(),d.createElement(g.a,{value:r.value,onChange:r.onChange,fullWidth:!0,label:this.props.i18n.t("Кому")}),d.createElement(g.a,{value:a.value,onChange:a.onChange,fullWidth:!0,label:this.props.i18n.t("Сс")}),d.createElement(g.a,{value:u.value,onChange:u.onChange,fullWidth:!0,label:this.props.i18n.t("Bcc")}),d.createElement(g.a,{value:n.value,onChange:n.onChange,fullWidth:!0,label:this.props.i18n.t("Тема")}),d.createElement(te,{html:i.value||"<div></div>",onChange:i.onChange,organisationId:this.props.organisationId}),d.createElement(W,{attachments:o.value||[],onChange:o.onChange}))}}]),t}(d.Component);ae=oe([y.autobind],ae);t.b=Object(h.connect)(function(e){return{i18n:e.i18n,mailBoxConfigs:e.mailBoxConfigs,eventLineId:e.eventLine.eventLineId}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:ie,fields:["subject","mailBoxId","emailId","attachments","replyTo","html","body","cc","bcc"],validate:function(e,t){return{}}})(Object(ne.a)(function(e){e.isTokenChecked&&e.eventLineId.foreach(function(t){e.dispatch(Object(re.a)(t))})})(ae)))},1501:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return c});var r=n(147),o=n(164),i=n(372),a=n(87),u=n(0),l=function(e,t,n){return function(i){return i(Object(o.w)(n)),r.n(e,t,new u.None).then(function(e){return i(Object(o.x)({blockRendererId:n,limits:e})),e}).catch(function(e){throw i(Object(o.v)({blockRendererId:n,error:e})),e})}},c=function(e,t,n){return Object(a.b)(function(e){return!Object(i.l)(e.blockRendererContext,n)&&Object(i.k)(e.blockRendererContext,n)},l(e,t,n))}},1502:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return g});var r=n(2),o=n(1),i=n(19),a=n.n(i),u=n(1540),l=n(640),c=n(1477),s=n(1517),p=n(1534),f=n(71),d=n(87),h=n(0),m=(n(623),function(e,t){return function(n,r){return n(Object(d.a)(function(e){return Object(l.e)(e.formDataDocuments,t)},function(e){return Object(l.d)(e.formDataDocuments,t)},function(e){return Object(l.c)(e.formDataDocuments,t)},function(e){return Object(l.b)(e.formDataDocuments,t)},Object(c.e)(e,t),function(e){return e.list}))}}),y=function(e){return function(e){return e.map(function(e){return e.pages.map(function(e){return e.elements.filter(function(e){return e.display instanceof o.DocumentElementDisplayBarcode})}).reduce(function(e,t){return e.concat(t)},[])}).getOrElse(function(){return[]})}(e).filter(function(e){return e.display.config.filter(function(e){return e.barcodeProviderType.tpe.value===o.BarcodeProviderTypeAssignment.$Type.value}).nonEmpty()})},b=function(e){return function(t,n){return new Promise(function(n,o){var i="",l=!1,c=t(function(e,t,n,o,i){return function(l,c){var s=e.openDialog(c().i18n.t("Значение штрихкода"),r.createElement(u.a,{onChange:t,onSave:n,withRemoveOldValue:o}),[r.createElement(a.a,{variant:"raised",style:{marginRight:"5px"},onClick:function(){i&&i(),e.handleDialogClose(s)}},c().i18n.t("Отмена")),r.createElement(a.a,{variant:"raised",color:"primary",onClick:n},c().i18n.t("Сохранить"))]);return s}}(e,function(e,t){i=e,l=t},function(){e.handleDialogClose(c),n({assignValue:i,removeOldCodes:l})},!1,function(){return o()}))})}},g=function(e,t,n,r){return function(i){switch(n.entity.rfid.tpe.value){case o.RfidBefore.$Type.value:return i(function(e,t,n,r){return function(i,a){return n.entity.template.matchWith(function(a){return i(b(e)).then(function(e){return Object(s.d)(a).then(function(i){var a=y(i.record.entity.documentSchema.definition);return Object(p.b)(t,n.id,[new o.AssignBarcode(Object(h.headOption)(a).map(function(e){return e.display.id}).matchWith(function(e){return e},function(){return new o.BarcodeId("")}),e.assignValue)],r).then(function(e){return new h.Success(e)}).catch(function(e){return new h.Failure(e)})})},function(e){return new h.Failure(e)})},function(){return i(b(e)).then(function(e){return Object(p.b)(t,n.id,[new o.AssignBarcode(new o.BarcodeId(""),e.assignValue)],r).then(function(e){return new h.Success(e)}).catch(function(e){return new h.Failure(e)})},function(e){return new h.Failure(e)})})}}(e,t,n,r));case o.RfidAfter.$Type.value:return i(function(e,t,n,r){return function(i,a){return Object(p.b)(t,n.id,[],r).then(function(t){return i(b(e)).then(function(e){return Object(p.a)(t.docId,[new o.AssignBarcode(new o.BarcodeId(""),e.assignValue)],e.removeOldCodes).then(function(){return i(Object(f.h)(a().i18n.t("Код записан"))),new h.Success(t)}).catch(function(){return i(Object(f.h)(a().i18n.t("Не удалось записать код"))),new h.Failure(new Error("code was not assigned"))})},function(e){return new h.Failure(new Error("code  reading with error"))})},function(e){return new h.Failure(new Error("document was not printed"))})}}(e,t,n,r));case o.RfidDisabled.$Type.value:return function(e,t,n){return Object(p.b)(e,t.id,[],n).then(function(e){return new h.Success(e)},function(e){return new h.Failure(e)})}(t,n,r);default:return new Promise(function(e,t){return e(new h.Failure(new Error("unknown document rfid type")))})}}}},1503:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(372),o=function(e){return function(t,n){return Object(r.c)(n().blockRendererContext,e)}},i=function(e){return function(t,n){return Object(r.i)(n().blockRendererContext,e)}}},1504:function(e,t,n){"use strict";var r=n(43),o=n.n(r),i=n(1),a=n(100),u=n(131),l=n(0),c=n(264),s=n(147),p=n(29),f=n(104),d=(n(148),n(291)),h=n(636),m=n(1486);n.d(t,"b",function(){return g}),n.d(t,"a",function(){return O});var y=function(e,t,n,r,o,u){return function(c,s){var f=Object(p.e)(s().fields,e).getOrElse(function(){return[]}),d=s().currentForm.data.map(function(e){return i.FormType.isSimpleDictionary(e.entity.formType)}).getOrElse(function(){return!1}),h=Object(l.headOption)(f.filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===i.ValueTagSimpleDictionaryPosition.$Type.value}).getOrElse(function(){return!1})}));c(Object(a.y)({blockRendererId:r,displayId:n})),c(Object(a.J)({id:n,blockRendererId:r,display:(d?h.map(function(e){return o.sort(function(t,n){var r=t.entity.values[e.id.value].value,o=n.entity.values[e.id.value].value;return r.value-o.value})}).getOrElse(function(){return o}):o).map(function(n){return new a.t(n.id,function(e,t,n,r){var o=Object(p.e)(r().fields,n).getOrElse(function(){return[]});return e.map(function(e){switch(e.tpe.value){case i.DisplayFieldByTemplate.$Type.value:var n=e;return Object(m.a)(t,new l.None,new l.Some(n.template))(r()).getOrElse(function(){return r().i18n.t("Значение не  найдено")});case i.DisplayFieldByField.$Type.value:default:var a=e;if(a.objRefDisplayFieldId.nonEmpty()){var u=Object(l.headOption)(o.filter(function(e){return e.id.value===a.fieldId.value})).map(function(e){return e.entity.formId.value}).getOrElse(function(){return""});return Object(l.headOption)(Object(l.liftKey)(r().fields.list,u).getOrElse(function(){return[]}).filter(function(e){return e.id.value===a.fieldId.value})).map(function(e){var n=e.entity.valueType.family,o=Object(l.liftKey)(r().dictionaries.list,n.value).getOrElse(function(){return[]}),i=Object(l.liftKey)(t.entity.values,a.fieldId.value).map(function(e){return e.value.id}).getOrElse(function(){return[]}),u=a.objRefDisplayFieldId.getOrElse(function(){return a.fieldId});return o.filter(function(e){return i.filter(function(t){return t.value===e.id.value}).length>0}).map(function(e){return Object(m.a)(e,Object(l.toOption)(u),new l.None)(r()).getOrElse(function(){return r().i18n.t("Значение не  найдено")})})}).getOrElse(function(){return[]}).join("; ")}return Object(m.a)(t,Object(l.toOption)(a.fieldId),new l.None)(r()).getOrElse(function(){return r().i18n.t("Значение не  найдено")})}})}(t,n,e,s),n)}),total:u}))}},b=function(e,t,n,r,o){return function(a,s,m){var b=Object(p.e)(s().fields,t).getOrElse(function(){return[]}),g=b.filter(function(e){return n.filter(function(e){return e.tpe.value===i.DisplayFieldByField.$Type.value}).filter(function(t){return t.fieldId.value===e.id.value}).length>0}).filter(function(e){return e.entity.valueType.tpe.value===i.ValueTypeObjectRefs.$Type.value}).map(function(e){return e.entity.valueType}).filter(function(e){return Object(f.e)(s().forms,e.family).matchWith(function(e){return i.FormType.isAnyDictionary(e.entity.formType)},function(){return!1})}).map(function(e){return e.family}).reduce(function(e,t){return 0===e.filter(function(e){return e.value===t.value}).length?e.concat([t]):e},[]).map(function(e){return a(Object(h.b)(e,new l.None))}),O=b.filter(function(e){return n.filter(function(e){return e.tpe.value===i.DisplayFieldByField.$Type.value}).filter(function(t){return t.fieldId.value===e.id.value}).length>0}).filter(function(e){return e.entity.valueType instanceof i.ValueTypeObjectRefs&&Object(f.e)(s().forms,e.entity.valueType.family).map(function(e){return i.FormType.isForm(e.entity.formType)}).getOrElse(function(){return!1})}).map(function(t){var n=e.records.map(function(e){return Object(l.toOption)(e.entity.values[t.id.value]).filter(function(e){return e.value instanceof i.ValueObjectRefs}).map(function(e){return e.value.id}).getOrElse(function(){return[]})}).reduce(function(e,t){return e.concat(t.filter(function(t){return 0===e.filter(function(e){return e.value===t.value}).length}))},[]).filter(function(e){return Object(d.b)(s().formRecords,t.entity.valueType.family,e).isEmpty()});return 0===n.length?new Promise(function(e,t){return e()}):a(Object(c.b)(t.entity.valueType.family,n)).then(function(e){a(Object(u.e)({form:t.entity.valueType.family,resolved:e.list}))})});return 0===g.length&&0===O.length?a(y(t,n,r,o,e.records,e.total)):Promise.all(g.concat(O)).then(function(){a(y(t,n,r,o,e.records,e.total))}),e}},g=function(e,t,n){return function(r,o,i){var u=t.displayFields;return r(Object(a.z)({blockRendererId:n,displayId:t.id})),Object(s.m)(e).then(function(e){r(b(e.page,t.parentsForm,u,t.id,n))})}},O=function(e,t,n,r,u){return function(l,c,p){var f=function(e){return e instanceof i.ElementControlObjRefsTable?e.displayFields:e instanceof i.ElementControlTagsList?[].concat(o()(e.colorField.map(function(e){return[new i.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]})),o()(e.valueField.map(function(e){return[new i.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]}))):[]}(n);return l(Object(a.z)({blockRendererId:u,displayId:r})),Object(s.l)(e,t).then(function(t){l(b(t.page,e.formId,f,r,u))})}}},1508:function(e,t,n){"use strict";var r=n(1466),o=n(100),i=n(0),a=n(372),u=n(240),l=n(71);n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});var c=function(e,t,n){return function(o,a){o(Object(r.g)(n,t,Object(i.toOption)(e.id)))}},s=function(e,t){return function(n,c){return Object(a.b)(c().blockRendererContext,t).map(function(e){return e.blockId}).map(function(c){return n(Object(r.g)(c,t,Object(i.toOption)(e.id))).then(function(c){return e.dataOutput.foreach(function(r){n(Object(o.M)({blockRendererId:t,output:r,displayId:e.id}))}),n(function(e){return function(t,n){return Object(a.b)(n().blockRendererContext,e).matchWith(function(o){return t(Object(r.g)(o.blockId,e,new i.None)).then(function(){return t(Object(r.a)(o.blockId,e,o.formId))}).then(function(){return Object(a.e)(n().blockRendererContext,e).matchWith(function(i){return Object(u.b)(n().block,o.blockId).map(function(a){return t(Object(r.f)(o.blockId,o.formId,a.entity,e,i)).then(function(e){return t(Object(l.h)(n().i18n.t("Изменения успешно сохранены"))),e})}).getOrElse(function(){return new Promise(function(e,t){return t()})})},function(){return t(Object(r.c)(o.blockId,o.formId,e)).then(function(e){return e.id})})})},function(){return new Promise(function(e,t){return t()})})}}(t))})})}}},1510:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return d}),n.d(t,"d",function(){return h}),n.d(t,"a",function(){return m});var r=n(6),o=n.n(r),i=n(7),a=n.n(i),u=n(8),l=n.n(u),c=n(18),s=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Request",{id:e}))}return l()(t,e),t}(c.a),p=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Delete",{templateId:e}))}return l()(t,e),t}(c.a),f=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Create",{documentTemplate:e}))}return l()(t,e),t}(c.a),d=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Update",{documentTemplate:e}))}return l()(t,e),t}(c.a),h=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","List",{form:e}))}return l()(t,e),t}(c.a),m=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Templates","Copy",{documentTemplateId:e}))}return l()(t,e),t}(c.a)},1517:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"f",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return f});var r=n(21),o=n(1510),i=n(435),a=n(17),u=function(e){return a.a.send(new o.b(e),Object(r.f)())},l=function(e){return a.a.send(new o.a(e),Object(r.f)())},c=function(e){return a.a.send(new o.f(e),Object(r.f)())},s=function(e){return a.a.send(new o.c(e),Object(r.f)())},p=function(e){return a.a.send(new o.e(e),Object(r.e)())},f=function(e){return function(t){return t(Object(i.e)()),a.a.send(new o.d(e),Object(r.g)()).then(function(e){return t(Object(i.f)(e.list)),e}).catch(function(e){throw t(Object(i.d)(e)),e})}}},1523:function(e,t,n){e.exports=n(49)(224)},1524:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n(215),o=function(e){return function(t,n){return Object(r.c)(n().dataOutput,e)}},i=function(e,t){return function(n,o){return Object(r.h)(o().dataOutput,e,t)}}},1526:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(381),o=n(637),i=function(e,t,n,i){return function(a,u){return a(Object(r.f)()),o.h(e,t,n,i).then(function(e){return a(Object(r.g)({total:e.page.total,list:e.page.records})),e}).catch(function(e){throw a(Object(r.e)(e)),e})}},a=function(e,t,n,i){return function(a,u){return a(Object(r.f)()),o.g(e,t,n,i).then(function(e){return a(Object(r.g)({total:e.page.total,list:e.page.records})),e}).catch(function(e){throw a(Object(r.e)(e)),e})}}},1527:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),y=n(3),b=n(26),g=n.n(b),O=n(162),v=n.n(O),k=n(24),E=n.n(k),j=n(1593),C=n.n(j),R=n(1594),I=n.n(R),S=n(1528),w=n.n(S),T=n(262),P=n(0),x=n(1),_=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},F=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={searchValue:new P.None,searchField:Object(P.toOption)(new x.EmailFieldTypeHtmlText)},n}return s()(t,e),a()(t,[{key:"onSearchFormSubmit",value:function(){var e=this;this.props.onSearch(this.state.searchField.flatMap(function(t){return e.state.searchValue.map(function(e){return new x.EmailFilterExpressionFullTextSearch(e,t)})}))}},{key:"openDataSourceMenu",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[d.createElement(E.a,{key:"byHtmlText",onClick:function(){return t.onSearchFieldChange(new x.EmailFieldTypeHtmlText)}},this.props.i18n.t("Html письма")),d.createElement(E.a,{key:"byPlainText",onClick:function(){return t.onSearchFieldChange(new x.EmailFieldTypePlainText)}},this.props.i18n.t("Текст письма")),d.createElement(E.a,{key:"bySubject",onClick:function(){return t.onSearchFieldChange(new x.EmailFieldTypeSubject)}},this.props.i18n.t("Тема письма"))])}},{key:"onSearchValueChange",value:function(e){this.setState(y(this.state,{searchValue:{$set:Object(P.toOption)(e.target.value).filter(function(e){return""!==e})}}))}},{key:"onSearchFieldChange",value:function(e){var t=this;this.setState(y(this.state,{searchField:{$set:Object(P.toOption)(e)}}),function(){t.props.closeMenu()})}},{key:"onSearchValueClear",value:function(){var e=this;this.setState(y(this.state,{searchValue:{$set:new P.None}}),function(){e.props.onSearch(new P.None)})}},{key:"getPlaceholder",value:function(){var e=this;return this.state.searchField.matchWith(function(t){switch(t.tpe.value){case x.EmailFieldTypeHtmlText.$Type.value:return e.props.i18n.t("html");case x.EmailFieldTypePlainText.$Type.value:return e.props.i18n.t("текст");case x.EmailFieldTypeSubject.$Type.value:return e.props.i18n.t("тема");default:throw"unknown email field type"}},function(){return""})}},{key:"render",value:function(){return d.createElement("form",{onSubmit:this.onSearchFormSubmit,style:{display:"flex",flex:1,flexWrap:"nowrap"}},d.createElement(g.a,{fullWidth:!0,style:{marginRight:28,marginTop:0,marginBottom:0},variant:"outlined",value:this.state.searchValue.getOrElse(function(){return""}),placeholder:this.getPlaceholder(),onChange:this.onSearchValueChange,InputProps:{startAdornment:d.createElement(v.a,{position:"start"},d.createElement(w.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.openDataSourceMenu})),endAdornment:d.createElement(v.a,{position:"end"},d.createElement(C.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.onSearchFormSubmit}),this.state.searchValue.nonEmpty()&&d.createElement(I.a,{style:{cursor:"pointer",fill:"#9E9E9E"},onClick:this.onSearchValueClear}))}}))}}]),t}(d.Component);D=_([m.autobind,F("design:paramtypes",[Object])],D),t.a=Object(h.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(T.a)(D))},1532:function(e,t,n){"use strict";var r,o=n(10),i=n.n(o),a=n(7),u=n.n(a),l=n(8),c=n.n(l),s=n(6),p=n.n(s),f=n(4),d=n.n(f),h=n(11),m=n.n(h),y=n(2),b=n(14),g=n(13),O=n(220),v=n.n(O),k=n(1472),E=n.n(k),j=n(538),C=n.n(j),R=n(1490),I=n.n(R),S=n(1),w=n(0),T=n(623),P=n(3),x=n(25),_=n.n(x),F=n(1610),D=n.n(F),M=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},B=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},V=function(e){function t(e){p()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!1},n}return c()(t,e),i()(t,[{key:"onShowToggle",value:function(){this.setState(P(this.state,{show:{$set:!this.state.show}}))}},{key:"render",value:function(){return y.createElement("div",null,y.createElement(_.a,{onClick:this.onShowToggle},y.createElement(D.a,null)),this.state.show&&y.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.text}}))}}]),t}(y.Component),L=V=M([g.autobind,B("design:paramtypes",[Object])],V),q=n(56),$=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":m()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},A=(r={},d()(r,S.MessageAttachmentFile.$Type.value,function(e,t){return y.createElement(E.a,{key:e.fileId.value,style:{marginRight:"5px"},label:e.name,avatar:y.createElement(C.a,null,y.createElement(I.a,null)),onClick:function(n){return t.onSaveFileClick(e.fileId)}})}),d()(r,S.MessageAttachmentLink.$Type.value,function(e,t){return y.createElement(E.a,{key:e.attachId,style:{marginRight:"5px"},label:e.name,avatar:y.createElement(C.a,null,y.createElement(I.a,null)),onClick:function(n){return t.onSaveAttachLinkClick(e.attachId)}})}),r),N=function e(){p()(this,e)},W=function(e){function t(e){p()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.text=e,n}return c()(t,e),t}(N),z=function(e){function t(e){p()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.text=e,n}return c()(t,e),t}(N),U=function(e){function t(){return p()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),i()(t,[{key:"onSaveFileClick",value:function(e){var t=this;this.props.authToken.map(function(n){return Object(T.b)(e,n,t.props.cdnAddress)})}},{key:"onSaveAttachLinkClick",value:function(e){var t=this;this.props.authToken.foreach(function(n){return Object(T.a)(t.props.email.id.value,e,n,t.props.serverAddress)})}},{key:"getEmailSections",value:function(e){var t=e.indexOf("<blockquote"),n=e.lastIndexOf("</blockquote>")+"</blockquote>".length;return[new W(t>0?e.substring(0,t):e.substring(0))].concat(t<0||n<0?[]:[new z(e.substring(t,n))]).concat(t<0||n<0||n+1===e.length?[]:[new W(e.substring(n))])}},{key:"onEmailSectionClick",value:function(e){e.nativeEvent.preventDefault(),e.nativeEvent.stopImmediatePropagation(),Object(w.toOption)(e.nativeEvent.target.getAttribute("href")).foreach(function(e){window.open(e,"_blank")})}},{key:"renderEmailSection",value:function(e,t){if(e instanceof W)return y.createElement("div",{key:t,contentEditable:this.props.email.entity.meta.emailStatus.tpe.value===S.EmailStatusDraft.$Type.value,onClick:this.onEmailSectionClick,dangerouslySetInnerHTML:{__html:e.text}});if(e instanceof z)return y.createElement(L,{key:t,text:e.text});throw"Unknown section type"}},{key:"renderEmail",value:function(e){var t=this;return this.getEmailSections(e).map(function(e,n){return t.renderEmailSection(e,n)})}},{key:"renderAttachmentComponent",value:function(e){var t=this;return Object(q.b)(e.tpe.value)(A).matchWith(function(n){return n(e,t)},function(){throw"uknown attachment type"})}},{key:"render",value:function(){var e=this,t=this.props.email.entity.msgBody,n=t.attachments;return y.createElement("div",{style:{display:"flex",flex:1,flexDirection:"column"}},y.createElement("div",{style:{display:"flex",flexShrink:0,marginBottom:"10px"}},y.createElement("div",{style:{flexShrink:0}},y.createElement("span",{style:{fontWeight:600,fontSize:"16px"}},t.from.name),y.createElement("span",null," <"+t.from.email+">")),y.createElement("div",{style:{display:"flex",flex:1,justifyContent:"flex-end"}},new Date(this.props.email.entity.created).toLocaleString())),y.createElement("div",{style:{overflow:"auto"}},this.renderEmail(t.html.text)),n.length>0&&y.createElement("div",{style:{marginTop:"10px",flexShrink:0}},y.createElement(v.a,null),y.createElement("div",{style:{marginTop:"10px"}},n.map(function(t,n){return e.renderAttachmentComponent(t)}))))}}]),t}(y.Component);U=$([g.autobind],U);t.a=Object(b.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,cdnAddress:e.config.cdnAddress,serverAddress:e.config.serverAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(U)},1533:function(e,t,n){"use strict";var r=n(43),o=n.n(r),i=n(23),a=n(1),u=n(0),l=n(439),c=n(100),s=n(1486),p=function(e){switch(e.tpe.value){case a.ValueNumber.$Type.value:return e.value;default:return e.toString()}},f=function(e,t,n){return n?e.localeCompare(t):t.localeCompare(e)},d=function(e,t,n){return n?e-t:t-e};n.d(t,"a",function(){return h});var h=function(e,t,n,r,h,m,y){return function(b,g){b(Object(l.d)(e.id));var O=g().fields;switch(r.entity.valueType.tpe){case a.ValueTypeValuesList.$Type:var v=r.entity.valueType.values;b(Object(l.e)({displayId:e.id,input:t,form:n,fields:O,value:new a.ValueList(v),displayValues:[],displayValuesAdding:[],formRecords:[],total:m}));break;case a.ValueTypeBool.$Type:b(Object(l.e)({displayId:e.id,input:t,form:n,fields:O,value:new a.ValueEmpty,displayValues:[],displayValuesAdding:[],formRecords:[],total:m}));break;case a.ValueTypeObjectRefs.$Type:var k=r.entity.valueType.family;e.control.foreach(function(r){if(r instanceof a.ElementControlObjRefsTable)b(Object(l.e)({displayId:e.id,input:t,form:n,fields:O,value:new a.ValueObjectRefs(h.map(function(e){return e.id})),displayValues:h.map(function(e){var t=r.displayFields.map(function(t){switch(t.tpe.value){case a.DisplayFieldByTemplate.$Type.value:var n=t;return Object(s.a)(e,new u.None,new i.Some(n.template))(g()).getOrElse(function(){return g().i18n.t("Значение не  найдено")});case a.DisplayFieldByField.$Type.value:default:var r=t;return r.objRefDisplayFieldId.nonEmpty()?Object(u.headOption)(Object(u.liftKey)(g().fields.list,k.value).getOrElse(function(){return[]}).filter(function(e){return e.id.value===r.fieldId.value})).map(function(t){var n=t.entity.valueType.family,o=Object(u.liftKey)(g().dictionaries.list,n.value).getOrElse(function(){return[]}),i=Object(u.liftKey)(e.entity.values,r.fieldId.value).map(function(e){return e.value.id}).getOrElse(function(){return[]}),a=r.objRefDisplayFieldId.getOrElse(function(){return r.fieldId});return o.filter(function(e){return i.filter(function(t){return t.value===e.id.value}).length>0}).map(function(e){return Object(s.a)(e,Object(u.toOption)(a),new u.None)(g()).getOrElse(function(){return g().i18n.t("Значение не  найдено")})})}).getOrElse(function(){return[]}).join("; "):Object(s.a)(e,Object(u.toOption)(r.fieldId),new u.None)(g()).getOrElse(function(){return g().i18n.t("Значение не  найдено")})}});return new c.t(e.id,t,e)}),displayValuesAdding:h.map(function(e){var t=r.displayFieldsForAdding.map(function(t){switch(t.tpe.value){case a.DisplayFieldByTemplate.$Type.value:var n=t;return Object(s.a)(e,new u.None,new i.Some(n.template))(g()).getOrElse(function(){return g().i18n.t("Значение не  найдено")});case a.DisplayFieldByField.$Type.value:default:var r=t;return r.objRefDisplayFieldId.nonEmpty()?Object(u.headOption)(Object(u.liftKey)(g().fields.list,k.value).getOrElse(function(){return[]}).filter(function(e){return e.id.value===r.fieldId.value})).map(function(t){var n=t.entity.valueType.family,o=Object(u.liftKey)(g().dictionaries.list,n.value).getOrElse(function(){return[]}),i=Object(u.liftKey)(e.entity.values,r.fieldId.value).map(function(e){return e.value.id}).getOrElse(function(){return[]}),a=r.objRefDisplayFieldId.getOrElse(function(){return r.fieldId});return o.filter(function(e){return i.filter(function(t){return t.value===e.id.value}).length>0}).map(function(e){return Object(s.a)(e,Object(u.toOption)(a),new u.None)(g()).getOrElse(function(){return g().i18n.t("Значение не  найдено")})})}).getOrElse(function(){return[]}).join("; "):Object(s.a)(e,Object(u.toOption)(r.fieldId),new u.None)(g()).getOrElse(function(){return g().i18n.t("Значение не  найдено")})}});return new c.t(e.id,t,e)}),formRecords:h,total:m}));else if(r.tpe.value===a.ElementControlTagsList.$Type.value){var v=[].concat(o()(r.colorField.map(function(e){return[new a.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]})),o()(r.valueField.map(function(e){return[new a.DisplayFieldByField(e,"")]}).getOrElse(function(){return[]})));b(Object(l.e)({displayId:e.id,input:t,form:n,fields:O,value:new a.ValueObjectRefs(h.map(function(e){return e.id})),displayValues:h.map(function(e){return new c.t(e.id,v.map(function(t){return Object(s.a)(e,new i.Some(t.fieldId),new u.None)(g()).getOrElse(function(){return g().i18n.t("Значение не  найдено")})}),e)}),displayValuesAdding:[],formRecords:h,total:m}))}else b(Object(l.e)({displayId:e.id,input:t,form:n,fields:O,value:new a.ValueObjectRefs(h.map(function(e){return e.id})),displayValues:r.sortingBy.map(function(e){return h.concat().sort(function(t,n){return function(e,t,n){return"number"==typeof e&&"number"==typeof t?d(e,t,n):f(e.toString(),t.toString(),n)}(Object(u.toOption)(t.entity.values[e.fieldId.value]).map(function(e){return p(e.value)}).getOrElse(function(){return""}),Object(u.toOption)(n.entity.values[e.fieldId.value]).map(function(e){return p(e.value)}).getOrElse(function(){return""}),e.asc)})}).getOrElse(function(){return h}).map(function(e){return new c.u(e.id,new a.ValueStr(r.valueCaptionTemplate.flatMap(function(t){return Object(u.toOption)(t.match(/\$id\d+/gi)).map(function(n){return n.reduce(function(t,n){var r=Object(u.toOption)(e.entity.values[n.slice("$id".length)]).map(function(e){return e.value.toString()}).getOrElse(function(){return y("Значение отсутствует")});return t.replace(n,r)},t)})}).getOrElse(function(){return y("Значение отсутствует")})))}),displayValuesAdding:[],formRecords:h,total:m}))})}}}},1534:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(7),a=n.n(i),u=n(8),l=n.n(u),c=n(18),s=n(0),p=function(e){function t(e,n,r,i){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new s.None;return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","Print",{context:e,document:n,assignBarcodes:r,printPdf:i,terminalCustomId:u}))}return l()(t,e),t}(c.a),f=function(e){function t(e,n,r){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","AssignBarcodes",{record:e,assignBarcodes:n,removeOldCodes:r}))}return l()(t,e),t}(c.a),d=function(e){function t(e,n){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","MassPrint",{context:e,document:n}))}return l()(t,e),t}(c.a),h=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Document.Records","MassPrintAvailable",{context:e}))}return l()(t,e),t}(c.a),m=n(17);n.d(t,"b",function(){return y}),n.d(t,"a",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"d",function(){return O});var y=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new s.None;return m.a.send(new p(e,t,n,r,o),function(e){return e})},b=function(e,t,n){return m.a.send(new f(e,t,n||!1),function(e){return e})},g=function(e,t){return m.a.send(new d(e,t),function(e){return e})},O=function(e){return m.a.send(new h(e),function(e){return e})}},1535:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});var r=n(1),o=n(1466),i=n(147),a=n(100),u=n(268),l=n(215),c=function(e,t,n){return function(r,o){Object(l.d)(o().dataOutput,t,e).map(function(e){return e.value}).foreach(function(i){o().duplicateMerging.destinationBlockRendererId.foreach(function(o){r(Object(a.D)({output:e,value:i,blockRendererId:o,displayId:n})),r(Object(u.k)({output:e,blockRendererId:t,value:i}))})})}},s=function(e,t){return function(n,a){return a().duplicateMerging.destinationFormData.map(function(n){return Object(o.i)(t,[n.id],a().duplicateMerging.mergingResult).then(function(t){return a().duplicateMerging.formDataStatus.filter(function(e){return e.tpe.value!==r.FormDataStatusActive.$Type.value}).matchWith(function(t){return Object(i.w)(e,a().duplicateMerging.formDatas.map(function(e){return e.formData.id}).filter(function(e){return e.value!==n.id.value}),t)},function(){return new Promise(function(e,t){return e()})})})}).getOrElse(function(){return new Promise(function(e,t){return t()})})}}},1536:function(e,t,n){e.exports=n(49)(157)},1537:function(e,t,n){e.exports=n(49)(196)},1538:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(1),d=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getRootStyle",value:function(){return{display:this.props.titlePosition instanceof f.ElementPlacementLeft?"flex":"block"}}},{key:"getLabelContainerStyle",value:function(){return this.props.titlePosition instanceof f.ElementPlacementLeft?{flex:0,paddingRight:"5px",flexShrink:0}:{}}},{key:"getInputContainerStyle",value:function(){return this.props.titlePosition instanceof f.ElementPlacementLeft?{flex:1,paddingLeft:"5px"}:{}}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"form-group",style:this.getRootStyle()},p.createElement("div",{style:this.getLabelContainerStyle()},p.createElement("label",null,this.props.label)),p.createElement("div",{style:this.getInputContainerStyle()},p.createElement("div",null,p.createElement("select",{className:"form-control",id:this.props.id,style:this.props.error?{borderColor:"#dc3545"}:{},value:this.props.value,onChange:function(t){return e.props.onChange(t.target.value)}},this.props.options.map(function(e,t){return p.createElement("option",{key:t,value:e.value},e.label)}))),p.createElement("div",{style:this.props.error?{color:"#dc3545"}:{display:"none"}},this.props.error)))}}]),t}(p.Component);t.a=d},1539:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(14),d=n(1),h=n(215),m=n(0),y=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){return p.createElement("span",null,this.props.value.map(function(e){return e.toString().replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r")}).getOrNull())}}]),t}(p.Component);t.a=Object(f.connect)(function(e,t){return{value:Object(h.d)(e.dataOutput,t.blockRendererId,t.output).map(function(e){return e.value}).filter(function(e){return!(e instanceof d.ValueEmpty)})}},function(e,t){return{}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.dataOutput===t.dataOutput},areStatePropsEqual:function(e,t){return Object(m.isEqual)(e.value,t.value)}})(y)},1540:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),y=n(26),b=n.n(y),g=n(75),O=n.n(g),v=n(33),k=n.n(v),E=n(332),j=n(3),C=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},R=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:"",removeOldCodes:!1},n}return s()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.currentAssignBarcodeValue!==e.currentAssignBarcodeValue&&(e.onChange(e.currentAssignBarcodeValue,this.state.removeOldCodes),e.onSave())}},{key:"componentWillMount",value:function(){this.props.dispatch(Object(E.e)())}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(E.d)())}},{key:"onChange",value:function(e){this.props.onChange(e.target.value,this.state.removeOldCodes),this.setState(j(this.state,{value:{$set:e.target.value}}))}},{key:"onRemoveOldValuesToggled",value:function(e,t){this.props.onChange(this.state.value,t),this.setState(j(this.state,{removeOldCodes:{$set:t}}))}},{key:"render",value:function(){return d.createElement("div",null,d.createElement(b.a,{value:this.state.value,onChange:this.onChange,fullWidth:!0,placeholder:this.props.i18n.t("Значение штрихкода")}),this.props.withRemoveOldValue&&d.createElement(k.a,{label:this.props.i18n.t("Удалять старые значения"),control:d.createElement(O.a,{checked:this.state.removeOldCodes,onChange:this.onRemoveOldValuesToggled})}))}}]),t}(d.Component);I=C([m.autobind,R("design:paramtypes",[Object])],I),t.a=Object(h.connect)(function(e){return{currentAssignBarcodeValue:e.assignBarcodes.currentAssignBarcodeValue.getOrElse(function(){return""}),i18n:e.i18n}})(I)},1541:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return l});var r=n(438),o=n(264),i=n(639),a=n(87),u=function(e,t,n,i){return function(a,u){return a(Object(r.e)({formDataId:n,documentId:t})),a(Object(o.b)(e,i)).then(function(e){return a(Object(r.f)({formDataId:n,documentId:t,records:e.list})),e.list}).catch(function(e){throw a(Object(r.d)({formDataId:n,documentId:t,error:e})),e})}},l=function(e,t,n,r){return function(o,l){return o(Object(a.b)(function(e){return!Object(i.e)(e.documentRecords,n,t)&&Object(i.d)(e.documentRecords,n,t)},u(e,t,n,r)))}}},1542:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(13),y=n(59),b=n(3),g=n(19),O=n.n(g),v=n(25),k=n.n(v),E=n(72),j=n.n(E),C=n(62),R=n.n(C),I=n(1),S=n(100),w=n(0),T=n(50),P=n(1456),x=n(1475),_=n(173),F=n(372),D=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},M=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},B=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={embeddedBlockComponents:[]},n}return s()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.display.displayFirstBlock&&this.addBlockComponent()}},{key:"addBlockComponent",value:function(){var e=this,t=y.v4();this.props.dispatch(Object(S.B)({blockRendererId:this.props.blockRendererId,displayId:this.props.display.id,embeddedBlockRendererId:t})),this.props.getBlockComponent(this.props.display.formId,new w.None,this.props.display.blockId,t,this.props.blockType,this.props.rootBlockRendererId.matchWith(function(e){return Object(w.toOption)(e)},function(){return Object(w.toOption)(e.props.blockRendererId)}),function(n){return e.setState(b(e.state,{embeddedBlockComponents:{$push:[{blockRendererId:t,component:n}]}}))})}},{key:"onAddBlockClick",value:function(){this.addBlockComponent()}},{key:"onDeleteBlockClick",value:function(e){this.setState(b(this.state,{embeddedBlockComponents:{$set:this.state.embeddedBlockComponents.filter(function(t){return t.blockRendererId!==e})}}))}},{key:"getButtonWidgetStyle",value:function(e){var t=e.flatMap(function(e){return e.proportions}).getOrElse(function(){return new I.ElementProportions}),n=e.flatMap(function(e){return e.background}).getOrElse(function(){return new I.ElementBackground}),r=e.flatMap(function(e){return e.fonts.map(function(e){return e.textFont})}).flatMap(function(e){return e}),o=e.map(function(e){return e.enableStyles.map(function(e){return e.textStyleChecked})}).flatMap(function(e){return e}),i=Object(P.c)(r,o,new w.None),a=t.width,u=t.height,l=n.color,c="#fff"===l,s=u.filter(function(e){return""!==e}).nonEmpty();return{buttonStyle:Object.assign({width:a.getOrElse(function(){return"auto"}),height:u.getOrElse(function(){return"auto"})},c?{transition:"none"}:{backgroundColor:l}),textStyle:Object.assign(i,s?{lineHeight:u.map(function(e){return e+"px"}).getOrElse(function(){return"auto"})}:{}),width:a}}},{key:"getStyle",value:function(){var e=this.props.display.elementCss;return{borderTop:Object(x.d)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderRight:Object(x.c)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderBottom:Object(x.a)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderLeft:Object(x.b)(e).getOrElse(function(){return"0px dotted ".concat(R.a[600])}),borderRadius:"5px",marginTop:"10px",position:"relative"}}},{key:"render",value:function(){var e=this,t=this.getButtonWidgetStyle(this.props.display.elementCss);return d.createElement("div",{className:Object(T.B)(this.props.display,"container"),style:this.props.style},d.createElement("p",{style:{fontWeight:"bold"}},Object(_.c)(this.props.display.label.text)||this.props.i18n.t("Надпись")),d.createElement("div",null,this.state.embeddedBlockComponents.map(function(t,n){return d.createElement("div",{key:t.blockRendererId,style:e.getStyle()},t.component,e.props.display.addingEnabled&&(0!==n||!e.props.display.displayFirstBlock)&&d.createElement("div",{style:{textAlign:"right",position:"absolute",right:0,top:0}},d.createElement(k.a,{onClick:function(n){return e.onDeleteBlockClick(t.blockRendererId)}},d.createElement(j.a,null))))})),this.props.display.addingEnabled&&d.createElement("div",{style:{padding:"7px"}},d.createElement(O.a,{variant:"raised",onClick:this.onAddBlockClick,color:"primary",style:t.buttonStyle},d.createElement("div",{style:t.textStyle},this.props.i18n.t(this.props.display.buttonLabel.getOrElse(function(){return"Добавить"}))))))}}]),t}(d.Component);B=D([m.autobind,M("design:paramtypes",[Object])],B),t.a=Object(h.connect)(function(e,t){return{i18n:e.i18n,rootBlockRendererId:Object(F.j)(e.blockRendererContext,t.blockRendererId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areOwnPropsEqual:function(e,t){return e.display===t.display&&e.blockType===t.blockType&&e.blockRendererId===t.blockRendererId},areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.blockRendererContext===t.blockRendererContext},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(w.isEqual)(e.rootBlockRendererId,t.rootBlockRendererId)}})(B)},1543:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(2),f=n(14),d=n(62),h=n.n(d),m=n(1475),y=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"getStyle",value:function(){var e=this.props.display.elementCss;return{borderTop:Object(m.d)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderRight:Object(m.c)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderBottom:Object(m.a)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderLeft:Object(m.b)(e).getOrElse(function(){return"1px solid ".concat(h.a[600])}),borderRadius:"5px"}}},{key:"render",value:function(){var e=this.props.display.elementCss,t=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.width})}).getOrElse(function(){return"100%"}),n=e.flatMap(function(e){return e.proportions.flatMap(function(e){return e.height})}).getOrElse(function(){return"100%"}),r=this.props.display.src.getOrElse(function(){return""});return p.createElement("iframe",{src:r,width:t,height:n,frameBorder:"0",style:this.getStyle()},this.props.i18n.t("Ваш браузер не поддерживает плавающие фреймы"))}}]),t}(p.Component);t.a=Object(f.connect)(function(e,t){return{i18n:e.i18n}})(y)},1544:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(14),y=n(3),b=n(115),g=n.n(b),O=n(25),v=n.n(O),k=n(19),E=n.n(k),j=n(418),C=n(1),R=n(83),I=n(375),S=n.n(I),w=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},T=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:!1},n}return s()(t,e),a()(t,[{key:"getElementTipSettings",value:function(){return this.props.component.tip}},{key:"getElementTipEnabled",value:function(){return this.getElementTipSettings().map(function(e){return e.enabled}).getOrElse(function(){return!1})}},{key:"getElementTipVariant",value:function(){return this.getElementTipSettings().map(function(e){return e.variant}).getOrElse(function(){return new C.ElementTipVariantDialog})}},{key:"getElementTipBody",value:function(){var e=this.getElementTipSettings().flatMap(function(e){return e.body}).getOrElse(function(){return""});return d.createElement("div",{dangerouslySetInnerHTML:{__html:e}})}},{key:"getElementTipTooltipShowOnHover",value:function(){return this.getElementTipSettings().map(function(e){return e.variant}).filter(function(e){return e instanceof C.ElementTipVariantTooltip}).map(function(e){return e.showOnHover})}},{key:"onTipDialogRequest",value:function(){var e=this,t=this.props.openDialog("",d.createElement(d.Fragment,null,this.getElementTipBody()),[d.createElement(E.a,{key:"close",variant:"raised",onClick:function(){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"onTooltipOpen",value:function(){this.setState(y(this.state,{open:{$set:!0}}))}},{key:"handleTooltipClose",value:function(){this.setState(y(this.state,{open:{$set:!1}}))}},{key:"getTooltip",value:function(){var e=this;return this.getElementTipTooltipShowOnHover().filter(function(e){return e}).matchWith(function(){return d.createElement(g.a,{title:e.getElementTipBody()},d.createElement(v.a,null,d.createElement(j.a,null)))},function(){return d.createElement(S.a,{onClickAway:e.handleTooltipClose},d.createElement(g.a,{title:e.getElementTipBody(),onClose:e.handleTooltipClose,open:e.state.open,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},d.createElement(v.a,{onClick:e.onTooltipOpen},d.createElement(j.a,null))))})}},{key:"getTipElement",value:function(){switch(this.getElementTipVariant().tpe.value){case C.ElementTipVariantTooltip.$Type.value:return d.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:5}},this.getTooltip());case C.ElementTipVariantDialog.$Type.value:return d.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:5}},d.createElement(v.a,{onClick:this.onTipDialogRequest},d.createElement(j.a,null)))}}},{key:"render",value:function(){return d.createElement(d.Fragment,null,this.props.children,this.getElementTipEnabled()&&this.getTipElement())}}]),t}(d.Component);P=w([h.autobind,T("design:paramtypes",[Object])],P),t.a=Object(m.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,t,n)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(R.a)(P))},1549:function(e,t,n){var r=n(1550);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1550:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FormRecordDisplay__row-title-top {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column; }\n\n.FormRecordDisplay__row-title-bottom {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column-reverse; }\n\n.FormRecordDisplay__row-title-left {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: row; }\n  .FormRecordDisplay__row-title-left .FormRecordDisplay__label-row {\n    margin-right: 2em; }\n\n.FormRecordDisplay__row-title-right {\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: row-reverse;\n  justify-content: flex-end; }\n  .FormRecordDisplay__row-title-right .FormRecordDisplay__label-row {\n    margin-left: 2em; }\n\n.FormRecordDisplay__label-row {\n  margin-bottom: 5px; }\n\n.FormRecordDisplay__label {\n  font-weight: bold; }\n\n.FormRecordDisplay__image {\n  max-width: 250px;\n  max-height: 350px; }\n  .FormRecordDisplay__image > img {\n    max-height: 100%;\n    max-width: 100%; }\n",""])},1551:function(e,t,n){var r=n(1552);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1552:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},1553:function(e,t,n){var r=n(1554);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1554:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.ControlEditByClickWrapper__cover {\n  position: relative;\n  z-index: 2; }\n\n.ControlEditByClickWrapper__cover:hover {\n  position: relative; }\n  .ControlEditByClickWrapper__cover:hover .ControlEditByClickWrapper__button {\n    display: inline-block !important; }\n\n.ControlEditByClickWrapper__container:hover {\n  background-color: #B3E5FC !important;\n  cursor: pointer; }\n\n.ControlEditByClickWrapper__cover:before {\n  content: "";\n  display: block;\n  background-color: transparent;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 10; }\n\n.ControlEditByClickWrapper__button {\n  display: none !important;\n  position: absolute !important;\n  top: 50% !important;\n  right: 5px !important;\n  transform: translateY(-50%);\n  z-index: 11 !important; }\n',""])},1555:function(e,t,n){var r=n(1556);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1556:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".form-control {\n  display: block;\n  width: 100%;\n  height: 34px;\n  padding: 6px 12px;\n  font-size: 14px;\n  line-height: 1.42857143;\n  color: #555;\n  background-color: #fff;\n  background-image: none;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n  -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;\n  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;\n  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;\n  box-sizing: border-box; }\n\n.form-control.focus, .form-control:focus {\n  border-color: #2196F3;\n  outline: 0; }\n\n.form-group {\n  width: 100%;\n  margin-bottom: 25px; }\n  .form-group .form-control {\n    width: 100%;\n    box-shadow: none !important;\n    border-radius: 3px;\n    box-sizing: border-box; }\n  .form-group button, .form-group input, .form-group select, .form-group a {\n    outline: none !important;\n    box-sizing: border-box; }\n  .form-group label {\n    display: inline-block;\n    max-width: 100%;\n    margin-bottom: 5px;\n    font-weight: 400;\n    box-sizing: border-box; }\n",""])},1557:function(e,t,n){var r=n(1558);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1558:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FileListControlEditor__dropzone {\n  position: relative;\n  width: 100%;\n  height: 100px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.FileListControlEditor__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.FileListControlEditor__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n",""])},1559:function(e,t,n){var r=n(1560);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1560:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageListControlDisplay__root {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n  overflow: hidden; }\n\n.ImageListControlDisplay__silder-root {\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-around;\n  overflow: hidden; }\n\n.ImageListControlDisplay__slider-gridList {\n  flex: 1;\n  flex-wrap: nowrap;\n  transform: translateZ(0);\n  overflow: hidden; }\n\n.ImageListControlDisplay__silder-button {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 5px; }\n",""])},1561:function(e,t,n){var r=n(1562);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1562:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageListControlEditor__container {\n  display: flex;\n  flex-flow: row wrap;\n  align-items: center; }\n\n.ImageListControlEditor__image {\n  max-height: 100%;\n  max-width: 100%;\n  object-fit: contain; }\n\n.ImageListControlEditor__imageContainer {\n  max-height: 150px;\n  width: 150px;\n  margin: 4px;\n  display: flex;\n  justify-content: center; }\n\n.ImageListControlEditor__image-loader {\n  height: 150px;\n  width: 100%;\n  position: relative; }\n\n.ImageListControlEditor__image-addButton {\n  color: #03A9F4 !important;\n  height: 36px !important;\n  width: 36px !important; }\n",""])},1563:function(e,t,n){var r=n(1564);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1564:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageControlDisplay__container {\n  text-align: center; }\n\n.ImageControlDisplay__highlightError {\n  background-color: red;\n  opacity: 0.5;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0; }\n\n.ImageControlDisplay__imageWrapper {\n  position: relative;\n  display: inline-block;\n  font-size: 0; }\n\n.ImageControlDisplay__image {\n  height: 300px;\n  width: 225px; }\n\n.ImageControlDisplay__image-loader {\n  height: 300px;\n  width: 100%;\n  position: relative; }\n",""])},1565:function(e,t,n){var r=n(1566);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1566:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ImageControlEditor__container {\n  text-align: left; }\n\n.ImageControlEditor__wrapper {\n  display: inline-block;\n  position: relative;\n  overflow: hidden; }\n\n.ImageControlEditor__highlightError {\n  background-color: red;\n  opacity: 0.5;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0; }\n\n.ImageControlEditor__imageWrapper {\n  max-height: 100%;\n  max-width: 100%;\n  min-height: 100px;\n  min-width: 150px;\n  position: relative;\n  font-size: 0; }\n\n.ImageControlEditor__image {\n  width: 100%;\n  height: auto; }\n\n.ImageControlEditor__image-loader {\n  height: 300px;\n  width: 100%;\n  margin-bottom: 6px;\n  position: relative; }\n\n.ImageControlEditor__image-error {\n  height: 300px;\n  width: 100%;\n  margin-bottom: 6px;\n  position: relative; }\n\n.ImageControlEditor__image-buttonsBar {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center; }\n\n.ImageControlEditor__imageDialog-wrapper {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 100000;\n  display: flex;\n  background-color: rgba(50, 50, 50, 0.7); }\n\n.ImageControlEditor__imageDialog-container {\n  margin: auto;\n  height: 95%;\n  max-width: 95%;\n  display: flex; }\n\n.ImageControlEditor__imageDialog-image {\n  margin: auto;\n  width: auto;\n  height: auto;\n  max-height: 100%;\n  max-width: 100%; }\n",""])},1567:function(e,t,n){var r=n(1568);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1568:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".UsersControlDisplay__container {\n  display: flex;\n  margin: 4px 0; }\n\n.UsersControlDisplay__chip {\n  margin: 4px !important; }\n",""])},1569:function(e,t,n){var r=n(1570);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1570:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".GroupWidget__container {\n  box-sizing: border-box; }\n",""])},1571:function(e,t,n){var r=n(1572);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1572:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".CommentsListDisplayItem-root {\n  position: relative; }\n  .CommentsListDisplayItem-root:hover > .CommentsListDisplayItem-more {\n    display: inline-block; }\n\n.CommentsListDisplayItem-more {\n  position: absolute;\n  right: 0;\n  top: 0;\n  display: none; }\n\n.CommentsListDisplayItem-more:hover {\n  display: inline-block !important; }\n",""])},1774:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(0),o=function(e,t){return e.map(function(e){return e.filters.filter(function(e){return e.filter.check(function(e){return Object(r.liftKey)(t.entity.values,e.value).map(function(e){return e.value})})})})},i=function(e,t){return Object(r.headOption)(e.flatMap(function(e){return t.flatMap(function(t){return o(e.entity.viewBlock,t)})}).getOrElse(function(){return[]})).map(function(e){return e.id})},a=function(e,t){return Object(r.headOption)(e.flatMap(function(e){return t.flatMap(function(t){return o(e.entity.editBlock,t)})}).getOrElse(function(){return[]})).map(function(e){return e.id})}},1820:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(95),y=n(13),b=n(34),g=n.n(b),O=n(24),v=n.n(O),k=n(32),E=n.n(k),j=n(156),C=n.n(j),R=n(30),I=n.n(R),S=n(54),w=n.n(S),T=n(75),P=n.n(T),x=n(33),_=n.n(x),F=n(1),D=n(641),M=n(136),B=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},V=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"render",value:function(){var e=this;return d.createElement("form",null,d.createElement(E.a,{fullWidth:!0},d.createElement(g.a,{htmlFor:"notify-template-selector"},this.props.i18n.t("Шаблон письма")),d.createElement(I.a,{inputProps:{id:"notify-template-selector"},fullWidth:!0,value:this.props.fields.templateId.value,error:this.props.fields.templateId.touched&&this.props.fields.templateId.error,onChange:function(t){return e.props.fields.templateId.onChange(t.target.value)}},this.props.notifyTemplatesDescriptionsList.getOrElse(function(){return[]}).filter(function(e){return e.manualUse}).map(function(e,t){return d.createElement(v.a,{key:t,value:e.id.toString()},d.createElement(w.a,{primary:e.name}))})),this.props.fields.templateId.touched&&this.props.fields.templateId.error&&d.createElement(C.a,null,this.props.fields.templateId.error)),d.createElement(_.a,{label:this.props.i18n.t("Создавать черновик"),control:d.createElement(P.a,{checked:this.props.fields.draftOnly.value,onChange:this.props.fields.draftOnly.onChange})}))}}]),t}(d.Component);V=B([y.autobind],V),t.a=Object(h.connect)(function(e){return{i18n:e.i18n,notifyTemplatesDescriptionsList:e.currentForm.data.map(function(t){return e.notifyTemplates.descriptionsList.filter(function(n){return e.user.userRole.map(function(e){return!e.entity.isNotifyTemplateRestricted(t.id,new F.Id(n.id))}).getOrElse(function(){return!1})})})}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:"notifyForm",fields:["templateId","draftOnly"]})(Object(M.a)(function(e){e.isTokenChecked&&e.dispatch(Object(D.b)(e.formId))})(V)))},1826:function(e,t,n){"use strict";var r=n(17),o=n(21),i=n(6),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(18),f=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Payment.Config","Create",{config:e}))}return s()(t,e),t}(p.a),d=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Payment.Config","Update",{config:e}))}return s()(t,e),t}(p.a),h=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Payment.Config","Delete",{configId:e}))}return s()(t,e),t}(p.a),m=(function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Payment.Config","Request",{configId:e}))}s()(t,e)}(p.a),function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Payment.Config","List",{}))}return s()(t,e),t}(p.a)),y=function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Payment.Config","GetConfigInfo",{}))}return s()(t,e),t}(p.a),b=n(436);n(484);n.d(t,"c",function(){return g}),n.d(t,"e",function(){return O}),n.d(t,"a",function(){return v}),n.d(t,"b",function(){return k}),n.d(t,"d",function(){return E});var g=function(){return function(e){return e(Object(b.e)()),r.a.send(new m,Object(o.g)()).then(function(t){return e(Object(b.f)(t.list)),t}).catch(function(t){throw e(Object(b.d)(t)),t})}},O=function(e){return r.a.send(new d(e),Object(o.f)())},v=function(e){return r.a.send(new f(e),Object(o.f)())},k=function(e){return r.a.send(new h(e),Object(o.f)())},E=function(){return r.a.send(new y,function(e){return e})}},1838:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(2)),i=(0,r(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"}),o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"Textsms");t.default=i},1884:function(e,t,n){"use strict";var r=n(1),o=n(240),i=n(215),a=n(1826),u=n(17),l=n(6),c=n.n(l),s=n(7),p=n.n(s),f=n(8),d=n.n(f),h=function(e){function t(e,n,r,o){return c()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Payment.Document","Create",{blockId:e,formDataId:n,amount:r,token:o}))}return d()(t,e),t}(n(18).a),m=n(82);n.d(t,"a",function(){return y});var y=function(e,t,n,l,c){return function(s,p){var f=p();return new Promise(function(s,p){m.default.isA5000?s():Object(o.b)(f.block,t).filter(function(e){return e.entity.payment instanceof r.BlockPaymentConfigDonatePayment&&e.entity.payment.enabled}).map(function(e){return e.entity.payment}).map(function(o){f.organisation.data.map(function(e){return e.entity.currency}).foreach(function(d){Object(a.d)().then(function(a){if(a.data instanceof r.PaymentInfoDataStripe){var m=a.data;o.amountField.map(function(r){Object(i.e)(f.dataOutput,n,r).map(function(n){var r=n.value;window.StripeCheckout.configure({key:m.pubKey,locale:"auto",token:function(n){(function(e,t,n,r){return u.a.send(new h(e,t,n,r),function(e){return e})})(t,e,r,n.id).then(function(){c&&c()}).catch(function(e){return p(e)})}}).open({name:"Obvida",zipCode:!0,amount:r.getCents(),currency:d,closed:function(){l(),s(!1)}})})})}})})}).getOrElse(function(){return s(!1)})})}}},1905:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(13),m=n(14),y=n(29),b=n(26),g=n.n(b),O=n(1),v=n(0),k=n(192),E=n(264),j=n(84),C=n(3),R=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},I=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),a()(t,[{key:"componentWillMount",value:function(){var e=this;Object(v.headOption)(this.props.forms.list.filter(function(t){return t.id.value===e.props.params.formId})).map(function(t){t.entity.limits.forEach(function(t){t.limitType instanceof O.LimitTypeLinkedFieldType&&e.getFormField(new O.Id(e.props.params.formId),t.memberFieldId).map(function(n){e.getFormField(n.entity.valueType.family,t.limitType.memberTypeId).map(function(t){t.entity.valueType instanceof O.ValueTypeObjectRefs&&e.props.dispatch(Object(E.c)(t.entity.valueType.family,new v.None))}).getOrElse(function(){e.props.dispatch(Object(j.c)(n.entity.valueType.family)).then(function(){e.getFormField(n.entity.valueType.family,t.limitType.memberTypeId).map(function(t){t.entity.valueType instanceof O.ValueTypeObjectRefs&&e.props.dispatch(Object(E.c)(t.entity.valueType.family,new v.None))})})})}).getOrElse(function(){return console.error("Fields were not found!")})})}).getOrElse(function(){return console.error("FormLimitProps were not found!")})}},{key:"onMembersLimitChanged",value:function(e){this.props.dispatch(Object(k.h)(e))}},{key:"onTotalMaxCountChanged",value:function(e,t){var n=e.target.value.toString();""!==n?this.onMembersLimitChanged(new O.MembersLimitTotal(t.limitType.id,t.memberFieldId,""!==n?parseInt(n):-1)):this.props.dispatch(Object(k.i)(new O.MembersLimitTotal(t.limitType.id,t.memberFieldId,0)))}},{key:"onValueMaxCountChanged",value:function(e,t,n){var r=this,o=this.props.formRecord.data.flatMap(function(e){return e.entity.permissions}).getOrElse(function(){return new O.FormDataModelFormDataPermissions([])}),i=e.target.value.toString();""!==i&&(isNaN(parseInt(i))||parseInt(i)<0)||Object(v.headOption)(o.limits.filter(function(e){return e.tpe.value===O.MembersLimitLinkedValues.$Type.value}).filter(function(e){return t.memberFieldId.value===e.fieldId.value&&t.limitType.memberTypeId.value===e.linkedFieldId.value})).map(function(e){var t=e.linkedValues.findIndex(function(e){return e.dictId.value===n.value});-1===t?r.onMembersLimitChanged(C(e,{linkedValues:{$push:[new O.LinkedValue(n,parseInt(i))]}})):""!==i?r.onMembersLimitChanged(C(e,{linkedValues:{$splice:[[t,1,new O.LinkedValue(n,parseInt(i))]]}})):r.onMembersLimitChanged(C(e,{linkedValues:{$splice:[[t,1]]}}))}).getOrElse(function(){""!==i&&r.onMembersLimitChanged(new O.MembersLimitLinkedValues(t.limitType.id,t.memberFieldId,[new O.LinkedValue(n,parseInt(i))],t.limitType.memberTypeId))})}},{key:"getTotalTextFieldValue",value:function(e){var t=this.props.formRecord.data.flatMap(function(e){return e.entity.permissions}).getOrElse(function(){return new O.FormDataModelFormDataPermissions([])}),n=Object(v.headOption)(t.limits.filter(function(e){return e.tpe.value===O.MembersLimitTotal.$Type.value}).filter(function(t){return e.memberFieldId.value===t.fieldId.value})).map(function(e){return e.maxCount}).getOrElse(function(){return-1});return n>=0?n.toString():""}},{key:"getLinkedFieldTextFieldValue",value:function(e,t){var n=this.props.formRecord.data.flatMap(function(e){return e.entity.permissions}).getOrElse(function(){return new O.FormDataModelFormDataPermissions([])}),r=Object(v.headOption)(n.limits.filter(function(e){return e.tpe.value===O.MembersLimitLinkedValues.$Type.value}).filter(function(t){return e.memberFieldId.value===t.fieldId.value&&e.limitType.memberTypeId.value===t.linkedFieldId.value})).flatMap(function(e){return Object(v.headOption)(e.linkedValues.filter(function(e){return e.dictId.value===t.value}))}).map(function(e){return e.maxCount}).getOrElse(function(){return-1});return r>=0?r.toString():""}},{key:"getFormField",value:function(e,t){return Object(v.headOption)(Object(y.e)(this.props.fields,e).getOrElse(function(){return[]}).filter(function(e){return e.id.value===t.value}))}},{key:"render",value:function(){var e=this,t=Object(v.headOption)(this.props.forms.list.filter(function(t){return t.id.value===e.props.params.formId})).map(function(e){return e.entity.limits.filter(function(e){return e.limitType.tpe.value===O.LimitTypeTotalLimitType.$Type.value})}).getOrElse(function(){return[]}),n=Object(v.headOption)(this.props.forms.list.filter(function(t){return t.id.value===e.props.params.formId})).map(function(e){return e.entity.limits.filter(function(e){return e.limitType.tpe.value===O.LimitTypeLinkedFieldType.$Type.value})}).getOrElse(function(){return[]});return d.createElement("div",null,t.length>0&&d.createElement("p",null,this.props.i18n.t("Всего"),":"),t.map(function(t,n){return d.createElement(g.a,{label:e.getFormField(new O.Id(e.props.params.formId),t.memberFieldId).map(function(e){return e.entity.caption}).getOrElse(function(){return e.props.i18n.t("Поле не найдено")}),type:"number",fullWidth:!0,key:t.limitType.id,value:e.getTotalTextFieldValue(t),onChange:function(n){return e.onTotalMaxCountChanged(n,t)}})}),n.length>0&&d.createElement("p",null,this.props.i18n.t("По полю связанной формы"),":"),n.map(function(t){return e.getFormField(new O.Id(e.props.params.formId),t.memberFieldId).map(function(n){return d.createElement("div",{style:{marginLeft:10}},d.createElement("p",null,n.entity.caption),n.entity.valueType instanceof O.ValueTypeObjectRefs&&e.getFormField(n.entity.valueType.family,t.limitType.memberTypeId).map(function(n){return d.createElement("div",{style:{marginLeft:20,borderLeft:"2px solid rgba(0,0,0,0.6)",paddingLeft:10}},d.createElement("p",{style:{margin:0}},n.entity.caption),n.entity.valueType instanceof O.ValueTypeObjectRefs&&Object(v.liftKey)(e.props.dictionaries.list,n.entity.valueType.family.value).getOrElse(function(){return[]}).map(function(r){return d.createElement(g.a,{key:r.id.value,label:Object(v.toOption)(r.entity.values[Object(v.headOption)(n.entity.valueType.displayFields).map(function(e){return e.value}).getOrElse(function(){return""})]).map(function(e){return e.value.toString()}).getOrElse(function(){return e.props.i18n.t("Значение не найдено")}),value:e.getLinkedFieldTextFieldValue(t,r.id),fullWidth:!0,type:"number",onChange:function(n){return e.onValueMaxCountChanged(n,t,r.id)}})}))}).getOrElse(function(){return d.createElement("div",null)}))}).getOrElse(function(){return d.createElement("div",null)})}))}}]),t}(d.Component);I=R([h.autobind],I),t.a=Object(m.connect)(function(e){return{i18n:e.i18n,user:e.user,fields:e.fields,forms:e.forms,formRecord:e.currentFormRecord,dictionaries:e.dictionaries}})(I)},1906:function(e,t,n){"use strict";var r=n(4),o=n.n(r),i=n(6),a=n.n(i),u=n(10),l=n.n(u),c=n(7),s=n.n(c),p=n(8),f=n.n(p),d=n(11),h=n.n(d),m=n(2),y=n(14),b=n(13),g=n(26),O=n.n(g),v=n(3),k=n(1),E=n(377),j=n(0),C=n(443),R=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},I=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},S=function(e){function t(e){a()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={notifyTemplate:new j.None,value:{}},n}return f()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this;Object(j.headOption)(this.props.notifyTemplatesList.getOrElse(function(){return[]}).filter(function(t){return t.id===e.props.notifyTemplateId.value})).foreach(function(t){Object(E.f)(new k.Id(t.id)).then(function(t){0===t.record.entity.textFields.length&&e.handleSubmit(),e.setState(v(e.state,{notifyTemplate:{$set:Object(j.toOption)(t.record)}}))})})}},{key:"handleFieldChange",value:function(e,t,n){this.setState(v(this.state,{value:{$set:v(this.state.value,o()({},e,{$set:new k.FieldValue(e,t,n)}))}}))}},{key:"handleSubmit",value:function(){this.props.onSubmit(Object(C.a)(this.state.value))}},{key:"render",value:function(){var e=this;return this.state.notifyTemplate.map(function(t){return m.createElement("form",null,t.entity.textFields.map(function(t){return m.createElement("div",{key:t.id},m.createElement("p",null,t.name),m.createElement(O.a,{name:t.id,multiline:!0,rows:15,rowsMax:20,fullWidth:!0,onChange:function(n){return e.handleFieldChange(t.id,t.name,n.target.value)}}))}))}).getOrNull()}}]),t}(m.Component);S=R([b.autobind,I("design:paramtypes",[Object])],S),t.a=Object(y.connect)(function(e){return{i18n:e.i18n,notifyTemplatesList:e.currentForm.data.map(function(t){return e.notifyTemplates.descriptionsList.filter(function(n){return e.user.userRole.map(function(e){return!e.entity.isNotifyTemplateRestricted(t.id,new k.Id(n.id))}).getOrElse(function(){return!1})})})}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(S)},1974:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(1476),y=n.n(m),b=n(1838),g=n.n(b),O=n(1485),v=n.n(O),k=n(218),E=n.n(k),j=n(24),C=n.n(j),R=n(25),I=n.n(R),S=n(203),w=n.n(S),T=n(19),P=n.n(T),x=n(1),_=n(0),F=(n(1975),n(13)),D=n(51),M=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},B=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},V=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={menuAnchorEl:new _.None},n}return s()(t,e),a()(t,[{key:"onMenuOpen",value:function(e){this.setState({menuAnchorEl:new _.Some(Object(D.findDOMNode)(e.currentTarget))})}},{key:"onMenuClosed",value:function(){this.setState({menuAnchorEl:new _.None})}},{key:"render",value:function(){var e=this,t=this.props.user.userRole.map(function(t){return t.entity.getFunctions(e.props.formId)}).getOrElse(function(){return new x.FormFunctionsProps(!1,!1,!1,!0,!1)});return this.props.user.userRole.filter(function(e){return e.entity.uiConfig.controlsVisible}).map(function(n){return d.createElement(E.a,{style:{display:"flex",alignItems:"center",paddingTop:"6px"}},d.createElement(I.a,{onClick:e.props.openFormRecordsPage},d.createElement(y.a,null)),d.createElement(P.a,{variant:"raised",color:"primary",style:{margin:"0 15px"},disabled:!t.edit,onClick:function(){return e.props.onEditRequested(new _.None)}},e.props.i18n.t("Редактировать анкету")),d.createElement("div",{style:{margin:"0 0 0 auto"}},t.sendingProps.manual&&d.createElement(I.a,{onClick:e.props.onNotificationSendRequested},d.createElement(g.a,null)),d.createElement(I.a,{onClick:e.onMenuOpen},d.createElement(v.a,null))),d.createElement(w.a,{open:e.state.menuAnchorEl.nonEmpty(),anchorEl:e.state.menuAnchorEl.getOrUndefined(),onClose:e.onMenuClosed},t.remove&&d.createElement(C.a,{onClick:e.props.onDeleteClick},e.props.i18n.t("Удалить")),(t.memberLimitEdit||e.props.user.userRole.filter(function(e){return e.entity.isAdmin()||e.entity.isSuperAdmin()}).nonEmpty())&&d.createElement(C.a,{onClick:e.props.onLimitsSettingsClick},e.props.i18n.t("Лимиты"))))}).getOrNull()}}]),t}(d.Component);V=M([F.autobind,B("design:paramtypes",[Object])],V),t.a=Object(h.connect)(function(e){return{i18n:e.i18n,user:e.user}})(V)},1975:function(e,t,n){var r=n(1976);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},1976:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FormRecordPanel__nav {\n  background-color: #fff !important;\n  height: 48px !important;\n  width: 100% !important;\n  flex-shrink: 0;\n  position: relative;\n  z-index: 1; }\n\n.FormRecordPanel__nav-button {\n  margin: 10px; }\n",""])},2352:function(e,t,n){var r=n(2353);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2353:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".BlockPanelPage div .Screen__container {\n  padding: 0px;\n  overflow: auto; }\n\n.BlockPanelPage__personal {\n  flex: 2;\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column; }\n\n.BlockPanelPage__personal-paper {\n  height: 100%; }\n",""])},2746:function(e,t,n){"use strict";n.r(t);var r=n(6),o=n.n(r),i=n(10),a=n.n(i),u=n(7),l=n.n(u),c=n(8),s=n.n(c),p=n(11),f=n.n(p),d=n(2),h=n(14),m=n(59),y=n(1),b=n(1477),g=n(627),O=n(1467),v=n(1496),k=n(13),E=n(240),j=n(19),C=n.n(j),R=n(147),I=n(1466),S=(n(2352),n(0)),w=n(377),T=n(79),P=n(3),x=n(71),_=n(1974),F=n(1905),D=n(635),M=n(1820),B=n(1906),V=n(201),L=n(626),q=n(104),$=n(176),A=n(136),N=n(1461),W=n(641),z=n(1884),U=n(365),H=n(83),K=n(1774),G=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},J=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Y=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign({saveButtonBlock:!1,createdFormDataId:new S.None,stripeDialog:{publicKey:new S.None,show:!1,form:new S.None}})))}return s()(t,e),a()(t,[{key:"processPayment",value:function(e,t,n){var r=this;this.props.dispatch(Object(z.a)(e,t,this.props.blockRendererId,function(){r.setState(P(r.state,{saveButtonBlock:{$set:!1},createdFormDataId:{$set:Object(S.toOption)(e)}}))},function(){r.onPaymentSuccess(e,n)}))}},{key:"onPaymentSuccess",value:function(e,t){var n=this;this.props.dispatch(Object(R.f)(this.props.formId,e)).then(function(){n.setState(P(n.state,{saveButtonBlock:{$set:!1},createdFormDataId:{$set:new S.None}}),function(){n.handleSuccessUpdating(e,t)})})}},{key:"onSaveAndPayRequested",value:function(e){var t=this;if(this.props.recordId.nonEmpty())return this.onSaveRequested(e);this.state.saveButtonBlock||this.setState(P(this.state,{saveButtonBlock:{$set:!0}}),function(){var n=t.props.blockId;t.props.dispatch(Object(I.g)(n,t.props.blockRendererId,new S.None)).then(function(){return t.props.dispatch(Object(I.a)(n,t.props.blockRendererId,t.props.formId))}).then(function(){t.state.createdFormDataId.map(function(r){t.processPayment(r,n,e)}).getOrElse(function(){t.props.dispatch(Object(I.c)(n,t.props.formId,t.props.blockRendererId)).then(function(r){t.processPayment(r.id,n,e)})})}).catch(function(e){t.props.dispatch(Object(V.c)(e,t.props,t.props.blockRendererId,t.props.blockId)),t.setState(P(t.state,{saveButtonBlock:{$set:!1}}))})})}},{key:"onSaveRequested",value:function(e){var t=this,n=this.props.blockId;return this.props.dispatch(Object(I.g)(n,this.props.blockRendererId,new S.None)).then(function(){return t.props.dispatch(Object(I.a)(n,t.props.blockRendererId,t.props.formId))}).then(function(){return t.props.recordId.matchWith(function(e){return Object(E.b)(t.props.block,n).map(function(r){return t.props.dispatch(Object(I.f)(n,t.props.formId,r.entity,t.props.blockRendererId,e)).then(function(e){return t.props.dispatch(Object(x.h)(t.props.i18n.t("Изменения успешно сохранены"))),e})}).getOrElse(function(){return new Promise(function(e,t){return t()})})},function(){return t.props.dispatch(Object(I.c)(n,t.props.formId,t.props.blockRendererId)).then(function(e){return e.id})})})}},{key:"openFormRecordsPage",value:function(){var e=this;this.props.currentForm.data.foreach(function(t){e.props.formRecord.data.foreach(function(n){return e.props.dispatch(Object(T.J)(t.entity.eventLineId,t.entity.formType.getFormTypeId(),n.entity.formId))})})}},{key:"onEditRequested",value:function(e){var t=this;this.props.formRecord.data.foreach(function(n){return Object(R.i)(n.entity.formId,n.id).then(function(n){return e.orElse(function(){return t.props.user.userRole.flatMap(function(e){return t.props.currentForm.data.flatMap(function(n){return e.entity.getEditBlock(n.id).orElse(function(){return Object(K.a)(t.props.currentForm.data,t.props.formRecord.data).orElse(function(){return n.entity.editBlock.map(function(e){return e.defaultId})})})})})}).map(function(e){var r=m.v4(),o=t.props.openDialog(t.props.i18n.t("Редактирование анкеты"),d.createElement(v.a,{formId:t.props.formId,blockRendererId:r,rootBlockRendererId:new S.None,blockType:y.webRegistrationBlockTypeEdit,formRecord:Object(S.toOption)(n.record),formRecordId:t.props.recordId,blockId:e,initialValues:n.record.entity.values,initialValuesError:t.props.formRecord.error.nonEmpty()&&!t.props.formRecord.fetching,getBlockComponent:function(){},onSave:function(){return new Promise(function(e,t){return t(new Error("onSave not implemented"))})},onEdit:function(){return new Promise(function(e,t){return t(new Error("onEdit not implemented"))})}}),[d.createElement(C.a,{variant:"raised",onClick:function(e){return t.handleClose(o)},style:{marginRight:"10px"}},t.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return function(e,n,r){return Object(S.liftKey)(t.props.block.record,e.value).getOrElse(function(){return new S.None}).foreach(function(o){return t.props.formRecord.data.foreach(function(i){return t.props.dispatch(Object(I.g)(e,n,new S.None)).then(function(){return t.props.dispatch(Object(I.a)(e,t.props.blockRendererId,t.props.formId))}).then(function(){return t.props.dispatch(Object(I.f)(e,t.props.formId,o.entity,n,i.id)).then(function(e){console.log("Registration saved"),t.handleRegistration(r)}).catch(function(e){console.error("Registration failed",e),t.handleRegisterFailed(r)})}).catch(function(e){t.props.dispatch(Object(V.c)(e,t.props,t.props.blockRendererId,t.props.blockId)),console.log("block invalid",e)})})})}(e,r,o)},color:"primary",disabled:t.props.formRecord.error.nonEmpty()||t.props.formRecord.fetching},t.props.i18n.t("Сохранить"))])}).getOrElse(function(){t.props.dispatch(Object(x.h)(t.props.i18n.t("Ошибка - не выбран блок редактирования анкет")))})})})}},{key:"onOpenBlock",value:function(e,t,n){var r=this;e.foreach(function(e){n.matchWith(function(n){return r.props.dispatch(Object(T.m)(t,n,e))},function(){return r.props.dispatch(Object(T.l)(t,e))})})}},{key:"handleSuccessCreating",value:function(e,t){var n=this;window.scrollTo(0,0),this.props.user.userRole.map(function(e){return e.entity.getFunctions(n.props.formId).view}).getOrElse(function(){return!1})?this.props.dispatch(Object(R.f)(this.props.formId,e)).then(function(){t.foreach(function(t){n.props.dispatch(Object(T.m)(n.props.formId,e,t))})}):t.foreach(function(e){n.props.dispatch(Object(T.l)(n.props.formId,e))})}},{key:"handleSuccessUpdating",value:function(e,t){var n=this;t.foreach(function(t){n.props.dispatch(Object(T.m)(n.props.formId,e,t))})}},{key:"handleRegistration",value:function(e){var t=this;this.props.handleDialogClose(e),this.props.dispatch(Object(x.h)(this.props.i18n.t("Изменения успешно сохранены"))),this.props.formRecord.data.map(function(e){t.props.dispatch(Object(R.f)(e.entity.formId,e.id)),t.props.dispatch(Object(b.e)(e.entity.formId,e.id))})}},{key:"handleRegisterFailed",value:function(e){this.props.handleDialogClose(e),this.props.dispatch(Object(x.h)(this.props.i18n.t("Сохранения изменений прервалось с ошибкой")))}},{key:"handleClose",value:function(e){this.props.handleDialogClose(e)}},{key:"getBlockComponent",value:function(e,t,n,r,o,i,a,u,l){a(d.createElement(v.a,{formId:e,blockType:o,blockRendererId:r,rootBlockRendererId:i,formRecord:t,formRecordId:t.map(function(e){return e.id}),blockId:n,initialValues:l,initialValuesError:!1,initialDictionares:u,getBlockComponent:this.getBlockComponent,onSave:function(){return new Promise(function(e,t){return t(new Error("onSave not implemented"))})},onEdit:function(){return new Promise(function(e,t){return t(new Error("onEdit not implemented"))})}}))}},{key:"onDeleteClick",value:function(){var e=this;this.props.formRecord.data.foreach(function(t){return e.onDeleteRequested(t.id,y.FormDataStatusNominalDeleted.$Type.value===t.entity.attributes.status.tpe.value)})}},{key:"onLimitsSettingsClick",value:function(){var e=this;this.props.formRecord.data.foreach(function(t){var n=e.props.openDialog(e.props.i18n.t("Лимиты"),d.createElement(F.a,{params:e.props.params}),[d.createElement(C.a,{variant:"raised",onClick:function(t){return e.handleClose(n)},style:{marginRight:"10px"}},e.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return function(t,n){return e.props.currentForm.data.map(function(r){return Object(R.u)(r.id,t.id,e.props.formRecord.data.flatMap(function(e){return e.entity.permissions}).map(function(e){return P(e,{limit:{$set:e.limits.filter(function(e){return r.entity.limits.filter(function(t){return t.limitType.id===e.cfgId}).length>0})}})})).then(function(t){e.props.handleDialogClose(n),e.props.dispatch(Object(x.h)(e.props.i18n.t("Изменения успешно сохранены")))}).catch(function(t){e.props.handleDialogClose(n),e.props.dispatch(Object(x.h)(e.props.i18n.t("Сохранения изменений прервалось с ошибкой")))})})}(t,n)},color:"primary"},e.props.i18n.t("Сохранить"))])})}},{key:"isAdmin",value:function(){return this.props.user.userRole.map(function(e){return e.entity.isAdmin()}).getOrElse(function(){return!1})}},{key:"onDeleteRequested",value:function(e,t){var n=this,r=this.isAdmin(),o=function(t){n.props.currentForm.data.map(function(r){n.props.user.userRole.map(function(o){var i=t.permanently&&o.entity.canAdminEvent(r.entity.eventLineId)?new y.FormDataStatusDeleted:new y.FormDataStatusNominalDeleted;Object(R.v)(r.id,e,i).then(function(){n.openFormRecordsPage(),n.handleClose(a)})})})},i=[d.createElement(C.a,{variant:"raised",onClick:function(e){return n.handleClose(a)}},this.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return o({})},color:"primary",style:{marginLeft:"10px"}},this.props.i18n.t("Удалить"))];r&&(t&&i.unshift(d.createElement(C.a,{variant:"raised",style:{float:"left",marginLeft:"10px"},color:"primary",onClick:function(){n.props.currentForm.data.map(function(t){n.props.user.userRole.map(function(r){Object(R.v)(t.id,e,new y.FormDataStatusActive).then(function(){n.props.currentForm.data.foreach(function(e){return n.props.dispatch(Object(D.a)(e.id))}),n.handleClose(a)})})})}},this.props.i18n.t("Восстановить"))),i.unshift(d.createElement(C.a,{variant:"raised",style:{float:"left"},color:"primary",onClick:function(){return o({permanently:!0})}},this.props.i18n.t("Удалить перманентно"))));var a=this.props.openDialog(this.props.i18n.t("Удаление анкеты"),d.createElement("div",null,this.props.i18n.t("Вы уверены? Данное действие нельзя отменить")),i)}},{key:"onNotificationSendRequested",value:function(){var e=this,t=void 0,n=this.props.openDialog(this.props.i18n.t("Отправить письмо"),d.createElement(M.a,{ref:function(e){return t=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},formId:this.props.formId,onSubmit:function(t){return n=t.templateId,r=!!t.draftOnly,void e.onNotificationEnterInsertionsRequested(new y.Id(n),r);var n,r}}),[d.createElement(C.a,{variant:"raised",onClick:function(t){return e.handleClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))])}},{key:"onNotificationEnterInsertionsRequested",value:function(e,t){var n=this,r=void 0,o=this.props.openDialog(this.props.i18n.t("Отправить письмо"),d.createElement(B.a,{notifyTemplateId:e,ref:function(e){return r=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},onSubmit:function(r){return function(r){return new Promise(function(i,a){n.props.recordId.foreach(function(i){Object(w.h)(e,i,r,t).then(function(e){n.props.dispatch(Object(x.h)(n.props.i18n.t("Письмо отправлено!"))),n.handleClose(o)}).catch(function(e){n.props.dispatch(Object(x.h)(n.props.i18n.t("Ошибка при отправке письма")))})})})}(r)}}),[d.createElement(C.a,{variant:"raised",onClick:function(e){return n.handleClose(o)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return r.map(function(e){return e.handleSubmit()})},color:"primary"},this.props.i18n.t("Отправить"))])}},{key:"render",value:function(){var e=this.props;e.i18n,e.currentForm;return d.createElement(v.a,{formId:this.props.formId,blockType:this.props.recordId.nonEmpty()&&!this.props.isPrivateCabinet?y.webRegistrationBlockTypeDisplay:y.webRegistrationBlockTypeEdit,blockRendererId:this.props.blockRendererId,rootBlockRendererId:Object(S.toOption)(this.props.blockRendererId),formRecord:this.props.formRecord.data,formRecordId:this.props.recordId,blockId:this.props.blockId,initialValues:this.props.recordId.nonEmpty()?this.props.formRecord.data.map(function(e){return e.entity.values}).getOrElse(function(){return{}}):{},initialValuesError:!!this.props.recordId.nonEmpty()&&this.props.formRecord.error.nonEmpty(),getBlockComponent:this.getBlockComponent,onSave:this.onSaveRequested,onSaveAndPay:this.onSaveAndPayRequested,onEdit:this.onEditRequested,onOpenBlock:this.onOpenBlock})}}]),t}(d.Component);Y=G([k.autobind,J("design:paramtypes",[Object])],Y);var Z=Object(h.connect)(function(e){return{i18n:e.i18n,block:e.block,currentForm:e.currentForm,forms:e.forms,formRecord:e.currentFormRecord,user:e.user,eventLines:e.eventLines}})(Object(N.a)(Object(A.a)(function(e){e.isTokenChecked&&(e.forms.fetching||e.dispatch(Object($.g)(e.formId)),Object(q.e)(e.forms,e.formId).foreach(function(t){Object(S.headOption)(e.eventLines.list.filter(function(e){return t.entity.eventLineId.value===e.id.value})).map(function(t){return e.dispatch(Object(U.d)(t))})}),e.recordId.foreach(function(t){e.dispatch(Object(W.b)(e.formId)),e.formRecord.data.matchWith(function(e){return e.id.value!==t.value},function(){return!0})&&e.dispatch(Object(R.f)(e.formId,t))}))},function(){},function(e,t){!e.forms.fetching&&t.forms.fetching&&e.dispatch(Object($.g)(e.formId)),e.formId.value!==t.formId.value&&e.dispatch(Object($.g)(e.formId)),e.formId.value===t.formId.value&&e.isTokenChecked&&!t.isTokenChecked&&e.currentForm.error.nonEmpty()&&e.dispatch(Object($.g)(e.formId)),Object(S.isEqual)(e.recordId.map(function(e){return e.value}),t.recordId.map(function(e){return e.value}))||Object(S.isEqual)(e.formRecord.data.map(function(e){return e.id.value}),e.recordId.map(function(e){return e.value}))?e.isTokenChecked&&!t.isTokenChecked&&e.formRecord.error.nonEmpty()&&e.recordId.foreach(function(t){e.dispatch(Object(R.f)(e.formId,t))}):e.recordId.foreach(function(t){e.dispatch(Object(R.f)(e.formId,t))})})(Object(L.a)(Object(H.a)(Y))))),X=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Q=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ee=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(O.a.screenInitialState(),{blockRendererId:m.v4()})))}return s()(t,e),a()(t,[{key:"onSaveRequested",value:function(e){var t=this;return this.getBlock().map(function(e){return t.props.dispatch(Object(I.g)(e,t.state.blockRendererId,new S.None)).then(function(){return t.props.dispatch(Object(I.a)(e,t.state.blockRendererId,new y.Id(t.props.params.formId)))}).then(function(){return t.props.params.recordId?Object(E.b)(t.props.block,e).map(function(n){return t.props.dispatch(Object(I.f)(e,new y.Id(t.props.params.formId),n.entity,t.state.blockRendererId,new y.Id(t.props.params.recordId))).then(function(e){return t.props.dispatch(Object(x.h)(t.props.i18n.t("Изменения успешно сохранены"))),e})}).getOrElse(function(){return new Promise(function(e,t){return t()})}):t.props.dispatch(Object(I.c)(e,new y.Id(t.props.params.formId),t.state.blockRendererId)).then(function(e){return e.id})})}).getOrElse(function(){return new Promise(function(e,t){return t()})})}},{key:"openFormRecordsPage",value:function(){var e=this;this.props.currentForm.data.foreach(function(t){Object(S.headOption)(e.props.eventLines.list.filter(function(e){return t.entity.eventLineId.value===e.id.value})).foreach(function(n){e.props.formRecord.data.foreach(function(r){return e.props.dispatch(Object(T.J)(n.id,t.entity.formType.getFormTypeId(),r.entity.formId))})})})}},{key:"onEditRequested",value:function(e){var t=this;this.props.formRecord.data.foreach(function(n){return Object(R.i)(n.entity.formId,n.id).then(function(n){return e.orElse(function(){return t.props.user.userRole.flatMap(function(e){return t.props.currentForm.data.flatMap(function(n){return e.entity.getEditBlock(n.id).orElse(function(){return Object(K.a)(t.props.currentForm.data,t.props.formRecord.data).orElse(function(){return n.entity.editBlock.map(function(e){return e.defaultId})})})})})}).map(function(e){var r=m.v4();t.openDialog(t.props.i18n.t("Редактирование анкеты"),d.createElement(v.a,{formId:new y.Id(t.props.params.formId),blockRendererId:r,rootBlockRendererId:Object(S.toOption)(r),blockType:y.webRegistrationBlockTypeEdit,formRecord:Object(S.toOption)(n.record),formRecordId:Object(S.toOption)(t.props.params.recordId).map(function(e){return new y.Id(e)}),blockId:e,initialValues:n.record.entity.values,initialValuesError:t.props.formRecord.error.nonEmpty()&&!t.props.formRecord.fetching,getBlockComponent:function(){},onSave:function(){return new Promise(function(e,t){return t(new Error("onSave not implemented"))})},onEdit:function(){return new Promise(function(e,t){return t(new Error("onEdit not implemented"))})}}),[d.createElement(C.a,{variant:"raised",onClick:t.handleClose,style:{marginRight:"10px"}},t.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return function(e,n){return Object(S.liftKey)(t.props.block.record,e.value).getOrElse(function(){return new S.None}).foreach(function(r){return t.props.formRecord.data.foreach(function(o){return t.props.dispatch(Object(I.g)(e,n,new S.None)).then(function(){return t.props.dispatch(Object(I.a)(e,t.state.blockRendererId,new y.Id(t.props.params.formId)))}).then(function(){return t.props.dispatch(Object(I.f)(e,new y.Id(t.props.params.formId),r.entity,n,o.id)).then(function(e){console.log("Registration saved"),t.handleRegistration()}).catch(function(e){console.error("Registration failed",e),t.handleRegisterFailed()})}).catch(function(n){t.props.dispatch(Object(V.c)(n,t.props,t.state.blockRendererId,e)),console.log("block invalid",n)})})})}(e,r)},color:"primary",disabled:t.props.formRecord.error.nonEmpty()||t.props.formRecord.fetching},t.props.i18n.t("Сохранить"))])}).getOrElse(function(){t.props.dispatch(Object(x.h)(t.props.i18n.t("Ошибка - не выбран блок редактирования анкет")))})})})}},{key:"onOpenBlock",value:function(e,t){var n=this;e.foreach(function(e){n.props.dispatch(Object(T.l)(t,e))})}},{key:"handleSuccessCreating",value:function(e,t){var n=this;window.scrollTo(0,0),this.props.user.userRole.map(function(e){return e.entity.getFunctions(new y.Id(n.props.params.formId)).view}).getOrElse(function(){return!1})?this.props.dispatch(Object(R.f)(new y.Id(this.props.params.formId),e)).then(function(){t.foreach(function(t){n.props.dispatch(Object(T.m)(new y.Id(n.props.params.formId),e,t))})}):t.foreach(function(e){n.props.dispatch(Object(T.l)(new y.Id(n.props.params.formId),e))})}},{key:"handleSuccessUpdating",value:function(e,t){var n=this;t.foreach(function(t){n.props.dispatch(Object(T.m)(new y.Id(n.props.params.formId),e,t))})}},{key:"handleRegistration",value:function(){var e=this;this.handleDialogClose(!1),this.props.dispatch(Object(x.h)(this.props.i18n.t("Изменения успешно сохранены"))),this.props.formRecord.data.map(function(t){e.props.dispatch(Object(R.f)(t.entity.formId,t.id)),e.props.dispatch(Object(b.e)(t.entity.formId,t.id))})}},{key:"handleRegisterFailed",value:function(){this.handleDialogClose(!1),this.props.dispatch(Object(x.h)(this.props.i18n.t("Сохранения изменений прервалось с ошибкой")))}},{key:"handleClose",value:function(){this.handleDialogClose(!1)}},{key:"renderNavigation",value:function(){return d.createElement(g.a,null)}},{key:"getBlock",value:function(){return Object(S.toOption)(this.props.params.blockId).map(function(e){return new y.Id(e)})}},{key:"getBlockComponent",value:function(e,t,n,r,o,i,a,u,l){a(d.createElement(v.a,{formId:e,blockType:o,blockRendererId:r,rootBlockRendererId:i,formRecord:t,formRecordId:t.map(function(e){return e.id}),blockId:n,initialValues:l,initialValuesError:!1,initialDictionares:u,getBlockComponent:this.getBlockComponent,onSave:function(){return new Promise(function(e,t){return t(new Error("onSave not implemented"))})},onEdit:function(){return new Promise(function(e,t){return t(new Error("onEdit not implemented"))})}}))}},{key:"onDeleteClick",value:function(){var e=this;this.props.formRecord.data.foreach(function(t){return e.onDeleteRequested(t.id,y.FormDataStatusNominalDeleted.$Type.value===t.entity.attributes.status.tpe.value)})}},{key:"onLimitsSettingsClick",value:function(){var e=this;this.props.formRecord.data.foreach(function(t){return e.openDialog(e.props.i18n.t("Лимиты"),d.createElement(F.a,{params:e.props.params}),[d.createElement(C.a,{variant:"raised",onClick:e.handleClose,style:{marginRight:"10px"}},e.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return function(t){return e.props.currentForm.data.map(function(n){return Object(R.u)(n.id,t.id,e.props.formRecord.data.flatMap(function(e){return e.entity.permissions}).map(function(e){return P(e,{limit:{$set:e.limits.filter(function(e){return n.entity.limits.filter(function(t){return t.limitType.id===e.cfgId}).length>0})}})})).then(function(t){e.handleDialogClose(!1),e.props.dispatch(Object(x.h)(e.props.i18n.t("Изменения успешно сохранены")))}).catch(function(t){e.handleDialogClose(!1),e.props.dispatch(Object(x.h)(e.props.i18n.t("Сохранения изменений прервалось с ошибкой")))})})}(t)},color:"primary"},e.props.i18n.t("Сохранить"))])})}},{key:"isAdmin",value:function(){return this.props.user.userRole.map(function(e){return e.entity.isAdmin()}).getOrElse(function(){return!1})}},{key:"onDeleteRequested",value:function(e,t){var n=this,r=this.isAdmin(),o=function(t){n.props.currentForm.data.map(function(r){Object(S.headOption)(n.props.eventLines.list.filter(function(e){return r.entity.eventLineId.value===e.id.value})).map(function(o){return n.props.user.userRole.map(function(i){var a=t.permanently&&i.entity.canAdminEvent(o.id)?new y.FormDataStatusDeleted:new y.FormDataStatusNominalDeleted;Object(R.v)(r.id,e,a).then(function(){n.openFormRecordsPage(),n.handleClose()})})})})},i=[d.createElement(C.a,{variant:"raised",onClick:this.handleClose},this.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return o({})},color:"primary",style:{marginLeft:"10px"}},this.props.i18n.t("Удалить"))];r&&(t&&i.unshift(d.createElement(C.a,{variant:"raised",style:{float:"left",marginLeft:"10px"},color:"primary",onClick:function(){n.props.currentForm.data.map(function(t){n.props.user.userRole.map(function(r){Object(R.v)(t.id,e,new y.FormDataStatusActive).then(function(){n.props.currentForm.data.foreach(function(e){return n.props.dispatch(Object(D.a)(e.id))}),n.handleClose()})})})}},this.props.i18n.t("Восстановить"))),i.unshift(d.createElement(C.a,{variant:"raised",style:{float:"left"},color:"primary",onClick:function(){return o({permanently:!0})}},this.props.i18n.t("Удалить перманентно")))),this.openDialog(this.props.i18n.t("Удаление анкеты"),d.createElement("div",null,this.props.i18n.t("Вы уверены? Данное действие нельзя отменить")),i)}},{key:"onNotificationSendRequested",value:function(){var e=this,t=void 0;this.openDialog(this.props.i18n.t("Отправить письмо"),d.createElement(M.a,{ref:function(e){return t=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},formId:y.Id.createId(this.props.params.formId).getOrElse(function(){throw"wrong form id"}),onSubmit:function(t){return n=t.templateId,r=!!t.draftOnly,void e.onNotificationEnterInsertionsRequested(new y.Id(n),r);var n,r}}),[d.createElement(C.a,{variant:"raised",onClick:this.handleClose,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))])}},{key:"onNotificationEnterInsertionsRequested",value:function(e,t){var n=this,r=void 0;this.openDialog(this.props.i18n.t("Отправить письмо"),d.createElement(B.a,{notifyTemplateId:e,ref:function(e){return r=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},onSubmit:function(r){return function(r){return new Promise(function(o,i){return Object(w.h)(e,new y.Id(n.props.params.recordId),r,t).then(function(e){n.props.dispatch(Object(x.h)(n.props.i18n.t("Письмо отправлено!"))),n.handleClose()}).catch(function(e){n.props.dispatch(Object(x.h)(n.props.i18n.t("Ошибка при отправке письма")))})})}(r)}}),[d.createElement(C.a,{variant:"raised",onClick:this.handleClose,style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(C.a,{variant:"raised",onClick:function(){return r.map(function(e){return e.handleSubmit()})},color:"primary"},this.props.i18n.t("Отправить"))])}},{key:"render",value:function(){var e=this,t=this.props,n=t.i18n;t.currentForm;return this.renderScreenBody({className:"BlockPanelPage"},d.createElement("div",{className:"BlockPanelPage__personal"},!!this.props.params.recordId&&d.createElement(_.a,{onDeleteClick:this.onDeleteClick,onEditRequested:this.onEditRequested,onLimitsSettingsClick:this.onLimitsSettingsClick,onNotificationSendRequested:this.onNotificationSendRequested,openFormRecordsPage:this.openFormRecordsPage,formId:new y.Id(this.props.params.formId)}),d.createElement("div",{className:"BlockPanelPage__personal-paper"},this.getBlock().map(function(t){return d.createElement(Z,{blockId:t,blockRendererId:e.state.blockRendererId,formId:new y.Id(e.props.params.formId),recordId:Object(S.toOption)(e.props.params.recordId).map(function(e){return new y.Id(e)}),params:e.props.params})}).getOrElse(function(){return d.createElement("div",null,n.t("Ошибка - не выбран блок отображения анкет"))}))))}}]),t}(O.a);ee=X([k.autobind,Q("design:paramtypes",[Object])],ee);t.default=Object(h.connect)(function(e){return{i18n:e.i18n,block:e.block,currentForm:e.currentForm,forms:e.forms,formRecord:e.currentFormRecord,user:e.user,eventLines:e.eventLines}})(Object(L.a)(ee))}}]);