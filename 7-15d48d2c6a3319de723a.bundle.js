(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[7],{1459:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return o});var a=n(79),r=n(104),i=n(82),l=function(){return function(e,t){return e(i.default.isA5000?Object(a.Mb)():Object(a.h)())}},o=function(e,t){return function(n,i){return i().eventLine.data.foreach(function(l){Object(r.e)(i().forms,e).foreach(function(r){n(Object(a.H)(l.id,r.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var a=n(6),r=n.n(a),i=n(10),l=n.n(i),o=n(7),u=n.n(o),s=n(8),c=n.n(s),p=n(2),d=n(14),f=n(1469),h=n(1459),m=n(320),y=n(69),v=n(0),T=n(624);t.a=function(e){return Object(d.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return r()(this,n),u()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return c()(n,t),l()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(v.toOption)(this.props.routing.location).map(function(t){Object(v.liftKey)(Object(T.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(f.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(y.r)()),this.props.dispatch(Object(m.c)()),this.props.dispatch(Object(h.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?p.createElement(e,this.props):p.createElement("div",null)}}]),n}(p.Component)}(e))}},1478:function(e,t,n){"use strict";var a=n(6),r=n.n(a),i=n(10),l=n.n(i),o=n(7),u=n.n(o),s=n(8),c=n.n(s),p=n(2),d=n(218),f=n.n(d),h=n(25),m=n.n(h),y=n(1476),v=n.n(y),T=(n(1481),n(52)),g=n.n(T),b=function(e){function t(){return r()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),l()(t,[{key:"render",value:function(){return p.createElement(f.a,{className:"PageHeader__main"},this.props.onGoBackRequested?p.createElement(m.a,{onClick:this.props.onGoBackRequested,style:{flexShrink:0}},p.createElement(v.a,null)):p.createElement("div",{style:{display:"inline-block"}}),p.createElement(g.a,{variant:"title",align:"center",style:{flex:1}},this.props.title),p.createElement("div",{style:{flexShrink:0}},this.props.rightButtonGroup))}}]),t}(p.Component);t.a=b},1481:function(e,t,n){var a=n(1482);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(a,r);a.locals&&(e.exports=a.locals)},1482:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".PageHeader__main {\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  margin-bottom: 10px;\n  background-color: #fff !important;\n  height: 48px !important;\n  width: 100% !important;\n  flex-shrink: 0;\n  padding: 0; }\n",""])},1531:function(e,t,n){"use strict";var a=n(65),r=n.n(a),i=n(2),l=n(1),o=n(84),u=n(1803),s=n(4),c=n.n(s),p=n(6),d=n.n(p),f=n(10),h=n.n(f),m=n(7),y=n.n(m),v=n(8),T=n.n(v),g=n(11),b=n.n(g),O=n(14),w=n(95),j=n(156),V=n.n(j),E=n(24),I=n.n(E),C=n(25),F=n.n(C),k=n(30),x=n.n(k),D=n(26),R=n.n(D),$=n(34),S=n.n($),N=n(32),P=n.n(N),_=n(54),A=n.n(_),M=n(209),W=n(418),L=n(3),B=n(0),G=n(374),Y=function(e){function t(e){d()(this,t);var n=y()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={separator:l.FieldsMassCreationSeparatorLineBreak.$Type},n}return T()(t,e),h()(t,[{key:"componentWillReceiveProps",value:function(e){e.fields.referenceFamily.value&&e.fields.referenceFamily.value!==this.props.fields.referenceFamily.value&&e.dispatch(Object(o.c)(new l.Id(e.fields.referenceFamily.value))).then(function(e){return console.log("Fields list updated?",e)})}},{key:"handleNameChange",value:function(e){this.props.fields.caption.onChange(e.target.value),this.props.fields.name.onChange(Object(G.a)(e.target.value)),this.separateFieldsInText({caption:e.target})}},{key:"separateFieldsInText",value:function(e){var t=this.getSeparatorSymbol(e.separator||this.state.separator.value).getOrElse(function(){return""}),n=(e.caption||this.props.fields.caption).value.split(t).filter(function(e){return e.match(/[a-яА-Я0-9]/i)}).map(function(e){return e.trim()}).map(function(e){var t=Object(G.a)(e);if(t)return c()({},e,t)}).filter(function(e){return e});this.props.fields.captionName.onChange(n)}},{key:"onSeparatorSelected",value:function(e){this.setState(L(this.state,{separator:{$set:new B.TypeId(e)}})),this.separateFieldsInText({separator:e})}},{key:"getSeparatorSymbol",value:function(e){switch(e){case l.FieldsMassCreationSeparatorComa.$Type.value:return new B.Some(",");case l.FieldsMassCreationSeparatorSemicolon.$Type.value:return new B.Some(";");case l.FieldsMassCreationSeparatorLineBreak.$Type.value:return new B.Some("\n");default:return new B.None}}},{key:"getSeparatorTypeName",value:function(e){switch(e){case l.FieldsMassCreationSeparatorComa.$Type:return new B.Some(this.props.i18n.t("Запятая"));case l.FieldsMassCreationSeparatorSemicolon.$Type:return new B.Some(this.props.i18n.t("Точка с запятой"));case l.FieldsMassCreationSeparatorLineBreak.$Type:return new B.Some(this.props.i18n.t("Перенос строки"));default:return new B.None}}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields.caption,a=t.handleSubmit,r=t.onSubmit;return i.createElement("form",{onSubmit:function(e){e.preventDefault(),a(r)}},i.createElement("input",{type:"submit",style:{display:"none"}}),i.createElement("div",{style:{position:"relative"}},i.createElement(P.a,{fullWidth:!0},i.createElement(S.a,null,this.props.i18n.t("Разделитель")),i.createElement(x.a,{onChange:function(t){return e.onSeparatorSelected(t.target.value)},value:this.state.separator.value,style:{width:"98%"}},l.FieldsMassCreationSeparators.map(function(t,n){return i.createElement(I.a,{key:n,value:t.value},i.createElement(A.a,{primary:e.getSeparatorTypeName(t).getOrElse(function(){return""})}))}))),i.createElement(P.a,{fullWidth:!0},i.createElement(R.a,{label:this.props.i18n.t("Список полей"),rows:4,error:n.touched&&n.error,value:n.value,onChange:function(t){return e.handleNameChange(t)},fullWidth:!0,multiline:!0}),Object(B.toOption)(n.error).map(function(e){return i.createElement(V.a,null,e)}).getOrNull()),i.createElement(M.b,{toolTipContent:i.createElement("div",null,this.props.i18n.t("текст подсказки"))},i.createElement(F.a,{style:{position:"absolute",right:"-3px",bottom:"14px",width:"15px",height:"15px",padding:0,zIndex:5e3}},i.createElement(W.a,null)))))}}]),t}(i.Component),U=Object(O.connect)(function(e){return{i18n:e.i18n,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(w.reduxForm)({form:"fieldEditForm",fields:["id","name","caption","valueType","captionName","staticValues","referenceFamily","referenceFamilyDisplayField","attributeGeneratorType","dateFormat","internalIdPrefix","internalIdPostfix","dateType"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.caption&&0!==e.caption.trim().length||(n.caption=t.i18n.t("Обязательное значение")),e.valueType&&0!==e.valueType.trim().length||(n.valueType=t.i18n.t("Обязательное значение")),e.internalIdPrefix||(e.internalIdPrefix=""),e.internalIdPostfix||(e.internalIdPostfix=""),!e.caption||"object"===b()(e.captionName)&&0!==Object.keys(e.captionName).length||(n.caption=t.i18n.t("Требуются стандартные символы")),n}})(Y)),H=function(e){function t(){return d()(this,t),y()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return T()(t,e),h()(t,[{key:"componentWillReceiveProps",value:function(e){e.fields.referenceFamily.value&&e.fields.referenceFamily.value!==this.props.fields.referenceFamily.value&&e.dispatch(Object(o.c)(new l.Id(e.fields.referenceFamily.value))).then(function(e){return console.log("Fields list updated?",e)})}},{key:"handleNameChange",value:function(e){this.props.fields.caption.onChange(e.target.value),this.props.fields.name.onChange(Object(G.a)(e.target.value))}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields.caption,a=t.handleSubmit,r=t.onSubmit;return i.createElement("form",{onSubmit:function(e){e.preventDefault(),a(r)}},i.createElement("input",{type:"submit",style:{display:"none"}}),i.createElement(R.a,{fullWidth:!0,value:n.value,onChange:function(t){return e.handleNameChange(t)},label:this.props.i18n.t("Название поля"),error:n.touched&&n.error,helperText:n.touched&&Object(B.toOption)(n.error).map(function(e){return e}).getOrNull()}))}}]),t}(i.Component),K=(Object(O.connect)(function(e){return{i18n:e.i18n,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(w.reduxForm)({form:"fieldEditForm",fields:["id","name","caption","valueType","valueTypeTag","staticValues","referenceFamily","referenceFamilyDisplayField","attributeGeneratorType","dateFormat","internalIdPrefix","internalIdPostfix","dateType"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.caption&&0!==e.caption.trim().length||(n.caption=t.i18n.t("Обязательное значение")),e.valueType&&0!==e.valueType.trim().length||(n.valueType=t.i18n.t("Обязательное значение")),e.internalIdPrefix||(e.internalIdPrefix=""),e.internalIdPostfix||(e.internalIdPostfix=""),n}})(H)),n(71)),q=n(19),z=n.n(q),J=n(201),Z=n(174);n.d(t,"a",function(){return X}),n.d(t,"b",function(){return ee}),n.d(t,"d",function(){return te}),n.d(t,"c",function(){return ne});var Q=function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function l(e){try{u(a.next(e))}catch(e){i(e)}}function o(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(l,o)}u((a=a.apply(e,t||[])).next())})},X=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.i18n.t("Новое поле"),r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=void 0;e.openDialog(a,i.createElement(u.a,{ref:function(e){return s=Object(B.toOption)(e).flatMap(function(e){return Object(B.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(e,t,n){return Object(o.a)(e.formId,new l.FormField(e.formId,t.name,t.caption,Object(u.b)(new B.TypeId(t.valueType),t))).then(function(a){e.dispatch(Object(o.c)(e.formId)).then(function(){Object(B.toOption)(n).filter(function(e){return e}).foreach(function(){return e.dispatch(Object(Z.a)(e.formId,[a.id],Object(B.toOption)(t.referenceFamilyDisplayField)))}),e.handleDialogClose(!0),e.handleCreateAnBound&&e.handleCreateAnBound(new l.ElementDataOutput(a.id)),e.dispatch(Object(K.h)(e.i18n.t("Поле добавлено")))})}).catch(function(t){return e.dispatch(Object(J.a)(t))})}(e,t,r)},initialValues:t||{valueType:l.ValueTypeStr.$Type.value},disableTypeChange:n}),[i.createElement(z.a,{variant:"raised",onClick:function(){return e.handleDialogClose(!0)},style:{marginRight:"10px"}},e.i18n.t("Закрыть")),i.createElement(z.a,{variant:"raised",onClick:function(){return s.map(function(e){e.submited||(e.submited=!0,e.submit())})},color:"primary"},e.i18n.t("Создать"))],!0)},ee=function(e){var t=void 0;e.openDialog(e.i18n.t("Новые поля текстового типа"),i.createElement(U,{ref:function(e){return t=Object(B.toOption)(e).flatMap(function(e){return Object(B.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(e,t){return Q(void 0,void 0,void 0,r.a.mark(function n(){var a,i,s,c,p,d,f;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a=[],i=!0,s=!1,c=void 0,n.prev=4,p=t.captionName[Symbol.iterator]();case 6:if(i=(d=p.next()).done){n.next=13;break}return f=d.value,n.next=10,Object(o.a)(e.formId,new l.FormField(e.formId,f[Object.keys(f)[0]],Object.keys(f)[0],Object(u.b)(new B.TypeId(t.valueType),t))).then(function(e){return a.push(e.id)});case 10:i=!0,n.next=6;break;case 13:n.next=19;break;case 15:n.prev=15,n.t0=n.catch(4),s=!0,c=n.t0;case 19:n.prev=19,n.prev=20,!i&&p.return&&p.return();case 22:if(n.prev=22,!s){n.next=25;break}throw c;case 25:return n.finish(22);case 26:return n.finish(19);case 27:e.dispatch(Object(o.c)(e.formId)).then(function(){return e.dispatch(Object(Z.a)(e.formId,a,Object(B.toOption)(t.referenceFamilyDisplayField)))}),e.handleDialogClose(!0),e.dispatch(Object(K.h)(e.i18n.t("Все поля добавлены успешно.")));case 30:case"end":return n.stop()}},n,this,[[4,15,19,27],[20,,22,26]])}))}(e,t)},initialValues:{valueType:l.ValueTypeStr.$Type.value}}),[i.createElement(z.a,{variant:"raised",onClick:function(){return e.handleDialogClose(!0)},style:{marginRight:"10px"}},e.i18n.t("Отмена")),i.createElement(z.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},e.i18n.t("Создать"))],!0)},te=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};X(e,Object.assign({},t,{valueType:l.ValueTypeObjectRefs.$Type.value}),!0,e.i18n.t("Новое ссылочное поле"))},ne=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.i18n.t("Новое поле"),r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=void 0,c=e.openDialog(a,i.createElement(u.a,{ref:function(e){return s=Object(B.toOption)(e).flatMap(function(e){return Object(B.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(e,t,n,a){return Object(o.a)(e.formId,new l.FormField(e.formId,t.name,t.caption,Object(u.b)(new B.TypeId(t.valueType),t))).then(function(r){e.dispatch(Object(o.c)(e.formId)).then(function(){Object(B.toOption)(n).filter(function(e){return e}).foreach(function(){return e.dispatch(Object(Z.a)(e.formId,[r.id],Object(B.toOption)(t.referenceFamilyDisplayField)))}),e.handleDialogClose(a),e.handleCreateAnBound&&e.handleCreateAnBound(new l.ElementDataOutput(r.id)),e.dispatch(Object(K.h)(e.i18n.t("Поле добавлено")))})}).catch(function(t){return e.dispatch(Object(J.a)(t))})}(e,t,r,c)},initialValues:t||{valueType:l.ValueTypeStr.$Type.value},disableTypeChange:n}),[i.createElement(z.a,{variant:"raised",onClick:function(){return e.handleDialogClose(c)},style:{marginRight:"10px"}},e.i18n.t("Закрыть")),i.createElement(z.a,{variant:"raised",onClick:function(){return s.map(function(e){return e.submit()})},color:"primary"},e.i18n.t("Создать"))])}},1803:function(e,t,n){"use strict";n.d(t,"b",function(){return ne});var a=n(6),r=n.n(a),i=n(10),l=n.n(i),o=n(7),u=n.n(o),s=n(8),c=n.n(s),p=n(11),d=n.n(p),f=n(2),h=n(14),m=n(95),y=n(24),v=n.n(y),T=n(30),g=n.n(T),b=n(26),O=n.n(b),w=n(34),j=n.n(w),V=n(32),E=n.n(V),I=n(156),C=n.n(I),F=n(19),k=n.n(F),x=n(25),D=n.n(x),R=n(241),$=n.n(R),S=n(243),N=n.n(S),P=n(242),_=n.n(P),A=n(261),M=n.n(A),W=n(82),L=n(1),B=n(0),G=n(50),Y=n(84),U=n(374),H=n(384),K=n(68),q=n(418),z=n(209),J=n(3),Z=n(563),Q=n(13),X=n(660),ee=function(e,t,n,a){var r,i=arguments.length,l=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},te=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ne(e,t){var n=Object(B.toOption)(t.valueTypeTag).filter(function(e){return""!==e}).map(function(e){return ae(new B.TypeId(e))});switch(e.value){case L.ValueTypeGeoPoint.$Type.value:return new L.ValueTypeGeoPoint(n);case L.ValueTypeValuesList.$Type.value:return new L.ValueTypeValuesList(t.staticValues||[],n);case L.ValueTypeObjectRefs.$Type.value:case L.ValueTypeObjectRefsTypes.DICTIONARY:case L.ValueTypeObjectRefsTypes.FORM:case L.ValueTypeObjectRefsTypes.SERVICE:return new L.ValueTypeObjectRefs(new L.Id(t.referenceFamily),[new L.Id(t.referenceFamilyDisplayField)],n);case L.ValueTypeUserRefs.$Type.value:return new L.ValueTypeUserRefs;case L.ValueTypeMoney.$Type.value:return new L.ValueTypeMoney;case L.ValueTypeStr.$Type.value:return new L.ValueTypeStr(n);case L.ValueTypeBool.$Type.value:return new L.ValueTypeBool(n);case L.ValueTypeImage.$Type.value:return new L.ValueTypeImage(n);case L.ValueTypeFileList.$Type.value:return new L.ValueTypeFileList(n);case L.ValueTypeNumber.$Type.value:return new L.ValueTypeNumber(n);case L.ValueTypeInterval.$Type.value:return new L.ValueTypeInterval(n);case L.ValueTypeDate.$Type.value:return new L.ValueTypeDate(Object(G.r)(t),n);case L.ValueTypeFormDataAttribute.$Type.value:return new L.ValueTypeFormDataAttribute(Object(G.k)(t),n);case L.ValueTypePassword.$Type.value:return new L.ValueTypePassword(n);default:throw"unknown type provided "+e.value}}var ae=function(e){switch(e.value){case L.ValueTagAccessLogRefs.$Type.value:return new L.ValueTagAccessLogRefs;case L.ValueTagAccessZoneId.$Type.value:return new L.ValueTagAccessZoneId;case L.ValueTagBlockId.$Type.value:return new L.ValueTagBlockId;case L.ValueTagDocumentId.$Type.value:return new L.ValueTagDocumentId;case L.ValueTagDocumentRecordId.$Type.value:return new L.ValueTagDocumentRecordId;case L.ValueTagInputData.$Type.value:return new L.ValueTagInputData;case L.ValueTagReason.$Type.value:return new L.ValueTagReason;case L.ValueTagResult.$Type.value:return new L.ValueTagResult;case L.ValueTagRuleName.$Type.value:return new L.ValueTagRuleName;case L.ValueTagTerminalId.$Type.value:return new L.ValueTagTerminalId;case L.ValueTagTerminalName.$Type.value:return new L.ValueTagTerminalName;case L.ValueTagDate.$Type.value:return new L.ValueTagDate;case L.ValueTagDocumentRecordRefs.$Type.value:return new L.ValueTagDocumentRecordRefs;case L.ValueTagEmailLogRefs.$Type.value:return new L.ValueTagEmailLogRefs;default:throw"unknown value tag type provided "+e.value}},re=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showTagsSelect:!1,dialog:{open:!1,actions:[],title:new B.None,body:new B.None}},n}return c()(t,e),l()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.fields.referenceFamily.value&&e.fields.referenceFamily.value!==this.props.fields.referenceFamily.value&&e.dispatch(Object(Y.c)(new L.Id(e.fields.referenceFamily.value))).then(function(e){if(t.props.fields.valueType.value===L.ValueTypeObjectRefsTypes.DICTIONARY){var n=e.list.filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===L.ValueTagSimpleDictionaryValue.$Type.value}).getOrElse(function(){return!1})});return Object(B.headOption)(n).map(function(e){return t.props.fields.referenceFamilyDisplayField.onChange(e.id.value)})}return Object(B.headOption)(e.list).map(function(e){return t.props.fields.referenceFamilyDisplayField.onChange(e.id.value)})})}},{key:"componentDidMount",value:function(){var e=this;this.setState(Object.assign({},this.state,{showTagsSelect:!!this.props.fields.valueTypeTag.value})),this.props.fields.referenceFamily.value&&!this.props.fields.referenceFamilyDisplayField.value&&this.props.dispatch(Object(Y.c)(new L.Id(this.props.fields.referenceFamily.value))).then(function(){var t=Object(B.headOption)(Object(B.liftKey)(e.props.formFields.list,e.props.fields.referenceFamily.value).getOrElse(function(){return[]})).map(function(e){return e.id.value}).getOrElse(function(){return""});e.props.fields.referenceFamilyDisplayField.onChange(t)})}},{key:"handleDialogClose",value:function(){this.setState(J(this.state,{dialog:{$set:J(this.state.dialog,{open:{$set:!1}})}}))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.setState(J(this.state,{dialog:{$set:{open:!0,title:new B.Some(e),body:new B.Some(t),actions:n||[]}}}))}},{key:"getValueTypeName",value:function(e){switch(e.value){case L.ValueTypeGeoPoint.$Type.value:return this.props.i18n.t("Географическое местоположение");case L.ValueTypeStr.$Type.value:return this.props.i18n.t("Текст");case L.ValueTypeNumber.$Type.value:return this.props.i18n.t("Числовое");case L.ValueTypeInterval.$Type.value:return this.props.i18n.t("Длительность");case L.ValueTypeMoney.$Type.value:return this.props.i18n.t("Деньги");case L.ValueTypeValuesList.$Type.value:return this.props.i18n.t("Список значений");case L.ValueTypeObjectRefs.$Type.value:return this.props.i18n.t("Список ссылок на анкету");case L.ValueTypeUserRefs.$Type.value:return this.props.i18n.t("Пользователь");case L.ValueTypeBool.$Type.value:return this.props.i18n.t("Булевый");case L.ValueTypeDate.$Type.value:return this.props.i18n.t("Дата и время");case L.ValueTypeImage.$Type.value:return this.props.i18n.t("Изображение");case L.ValueTypeFileList.$Type.value:return this.props.i18n.t("Файлы");case L.ValueTypeFormDataAttribute.$Type.value:return this.props.i18n.t("Атрибут");case L.ValueTypePassword.$Type.value:return this.props.i18n.t("Пароль")}}},{key:"handleNameChange",value:function(e){this.props.fields.caption.onChange(e.target.value),this.props.fields.name.onChange(Object(U.a)(e.target.value))}},{key:"onNameChange",value:function(e){Object(U.c)(e.target.value)||this.props.fields.name.onChange(e.target.value)}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,a=n.name,r=n.caption,i=n.valueType,l=(n.valueTypeTag,n.staticValues,n.referenceFamily),o=n.referenceFamilyDisplayField,u=n.attributeGeneratorType,s=n.dateFormat,c=n.internalIdPrefix,p=n.internalIdPostfix,d=n.dateType,h=t.handleSubmit,m=t.onSubmit,y=Object(B.liftKey)(this.props.formFields.list,l.value).getOrElse(function(){return[]});return f.createElement("form",{onSubmit:function(e){e.preventDefault(),h(m)}},f.createElement("input",{type:"submit",style:{display:"none"}}),f.createElement(O.a,{fullWidth:!0,autoFocus:!0,disabled:this.props.disabled,value:r.value,onChange:function(t){return e.handleNameChange(t)},label:this.props.i18n.t("Название"),error:r.touched&&r.error,helperText:r.touched&&Object(B.toOption)(r.error).map(function(e){return f.createElement(C.a,null,e)}).getOrNull()}),f.createElement(O.a,{fullWidth:!0,disabled:this.props.disabled,value:a.value,onChange:this.onNameChange,label:this.props.i18n.t("Системное имя"),error:a.touched&&a.error,helperText:a.touched&&Object(B.toOption)(a.error).map(function(e){return f.createElement(C.a,null,e)}).getOrNull()}),!this.props.disableTypeChange&&f.createElement("div",{style:{position:"relative"}},f.createElement(E.a,{fullWidth:!0},f.createElement(j.a,null,this.props.i18n.t("Тип поля")),f.createElement(g.a,{native:!0,value:i.value,disabled:this.props.disabled,onChange:function(e){i.onChange(e.target.value),l.onChange(""),o.onChange("")},error:i.touched&&i.error,style:{width:"98%"}},Y.h.filter(function(e){return e.value!==L.ValueTypeGeoPoint.$Type.value||!W.default.isA5000}).filter(function(e){return e.value!==L.ValueTypeObjectRefs.$Type.value}).map(function(t){return f.createElement("option",{key:t.value,value:t.value},e.getValueTypeName(t))}),f.createElement("option",{value:L.ValueTypeObjectRefsTypes.DICTIONARY},this.props.i18n.t("Справочник")),f.createElement("option",{value:L.ValueTypeObjectRefsTypes.FORM},this.props.i18n.t("Ссылка на форму")),f.createElement("option",{value:L.ValueTypeObjectRefsTypes.SERVICE},this.props.i18n.t("Ссылка на служебную форму"))),Object(B.toOption)(i.error).map(function(e){return f.createElement(C.a,null,e)}).getOrNull()),f.createElement(z.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(D.a,{style:{position:"absolute",right:"-3px",bottom:"14px",width:"15px",height:"15px",padding:0,zIndex:5e3}},f.createElement(q.a,null)))),(i.value===L.ValueTypeObjectRefsTypes.DICTIONARY||i.value===L.ValueTypeObjectRefsTypes.FORM||i.value===L.ValueTypeObjectRefsTypes.SERVICE)&&f.createElement("div",null,f.createElement("div",{style:{display:"flex",alignItems:"center"}},f.createElement(H.a,{native:!0,disabled:this.props.disabled,formType:i.value,errorText:l.touched&&l.error?new B.Some(l.error):new B.None,value:Object(B.toOption)(l.value&&new L.Id(l.value)),onChange:function(e){return e.map(function(e){l.onChange(e)})}}),f.createElement("div",{style:{width:40}}),f.createElement(K.a,{fullWidth:!0,disabled:!l.value||this.props.disabled,fields:y,labelText:new B.Some(this.props.i18n.t("Поле")),errorText:o.touched&&o.error?new B.Some(o.error):new B.None,value:Object(B.toOption)(new L.Id(o.value)),onChanged:function(e){return e.map(function(e){return o.onChange(e)})}}),Object(B.headOption)(this.props.forms.list.filter(function(e){return e.id.value===l.value})).map(function(t){return L.FormType.isSimpleDictionary(t.entity.formType)&&f.createElement("div",{style:{flex:1}},f.createElement(k.a,{variant:"raised",onClick:function(){return e.openDialog(e.props.i18n.t("Редактирование справочника"),f.createElement(X.a,{form:t,openDialog:e.openDialog,handleDialogClose:e.handleDialogClose}),[])}},e.props.i18n.t("Редактировать")))}).getOrNull()),i.value===L.ValueTypeObjectRefsTypes.DICTIONARY&&this.props.eventLineId.map(function(t){return f.createElement("p",null,f.createElement(k.a,{color:"primary",style:{margin:0},className:"link",onClick:function(){return Object(Z.a)({openDialog:e.openDialog,handleDialogClose:e.handleDialogClose,i18n:e.props.i18n,handleCreateAnBound:function(e){l.onChange(e)},dispatch:e.props.dispatch,eventLineId:t})}},e.props.i18n.t("Или создать новый справочник")))}).getOrNull()),i.value===L.ValueTypeDate.$Type.value&&f.createElement(E.a,{fullWidth:!0},f.createElement(j.a,null,this.props.i18n.t("Тип значения")),f.createElement(g.a,{value:d.value,disabled:this.props.disabled,onChange:function(e){return d.onChange(e.target.value)},error:u.touched&&u.error,fullWidth:!0},L.DateTypes.map(function(t,n){return f.createElement(v.a,{key:n,value:t.value},Object(G.s)(t.value,e.props.i18n.t))}))),i.value===L.ValueTypeFormDataAttribute.$Type.value&&f.createElement(E.a,{fullWidth:!0},f.createElement(j.a,null,this.props.i18n.t("Тип атрибута")),f.createElement(g.a,{value:u.value,disabled:this.props.disabled,onChange:function(e){return u.onChange(e.target.value)},error:u.touched&&u.error,fullWidth:!0},L.attributeGeneratorTypes.map(function(t,n){return f.createElement(v.a,{key:n,value:t.value},Object(G.l)(t.value,e.props.i18n.t))}))),(u.value===L.AttributeGeneratorTypeCreatedDate.$Type.value||u.value===L.AttributeGeneratorTypeUpdatedDate.$Type.value)&&f.createElement(E.a,{fullWidth:!0},f.createElement(O.a,{placeholder:this.props.i18n.t("Формат даты ")+"(dd.MM.yyyy hh:mm:ss)",error:s.touched&&s.error,value:s.value,onChange:s.onChange,disabled:this.props.disabled})),u.value===L.AttributeGeneratorTypeInternalId.$Type.value&&f.createElement(O.a,{fullWidth:!0,disabled:this.props.disabled,value:c.value,onChange:c.onChange,label:this.props.i18n.t("Префикс идентификатора"),error:c.touched&&c.error,helperText:c.touched&&Object(B.toOption)(c.error).map(function(e){return e}).getOrNull()}),u.value===L.AttributeGeneratorTypeInternalId.$Type.value&&f.createElement(O.a,{fullWidth:!0,disabled:this.props.disabled,value:p.value,onChange:p.onChange,label:this.props.i18n.t("Постфикс идентификатора"),error:p.touched&&p.error,helperText:p.touched&&Object(B.toOption)(p.error).map(function(e){return e}).getOrNull()}),f.createElement($.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose,className:"Screen__dialog"},f.createElement(N.a,{style:{borderTop:"none"}},this.state.dialog.actions),f.createElement(M.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),f.createElement(_.a,null,this.state.dialog.body.getOrElse(function(){return f.createElement("div",null)}))))}}]),t}(f.Component);re=ee([Q.autobind,te("design:paramtypes",[Object])],re),t.a=Object(h.connect)(function(e){return{i18n:e.i18n,formFields:e.fields,dictionaryForm:e.dictionaryForm,forms:e.forms,eventLineId:e.eventLine.eventLineId}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:"fieldEditForm",fields:["id","name","caption","valueType","valueTypeTag","staticValues","referenceFamily","referenceFamilyDisplayField","attributeGeneratorType","dateFormat","internalIdPrefix","internalIdPostfix","dateType"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.caption&&0!==e.caption.trim().length||(n.caption=t.i18n.t("Обязательное значение")),e.valueType&&0!==e.valueType.trim().length||(n.valueType=t.i18n.t("Обязательное значение")),e.internalIdPrefix||(e.internalIdPrefix=""),e.internalIdPostfix||(e.internalIdPostfix=""),n}})(re))}}]);