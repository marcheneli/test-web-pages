(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[35],{1459:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return s});var i=n(79),o=n(104),a=n(82),r=function(){return function(e,t){return e(a.default.isA5000?Object(i.Mb)():Object(i.h)())}},s=function(e,t){return function(n,a){return a().eventLine.data.foreach(function(r){Object(o.e)(a().forms,e).foreach(function(o){n(Object(i.H)(r.id,o.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var i=n(6),o=n.n(i),a=n(10),r=n.n(a),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(2),h=n(14),d=n(1469),f=n(1459),m=n(320),g=n(69),v=n(0),E=n(624);t.a=function(e){return Object(h.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return o()(this,n),l()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return p()(n,t),r()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(v.toOption)(this.props.routing.location).map(function(t){Object(v.liftKey)(Object(E.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(d.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(d.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(d.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(g.r)()),this.props.dispatch(Object(m.c)()),this.props.dispatch(Object(f.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?u.createElement(e,this.props):u.createElement("div",null)}}]),n}(u.Component)}(e))}},1462:function(e,t,n){"use strict";var i=n(855);Object.defineProperty(t,"__esModule",{value:!0});var o={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var a=i(n(1464));Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))})},1463:function(e,t,n){"use strict";var i=n(855),o=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(36)),r=o(n(2)),s=(o(n(31)),i(n(1462))),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.breakpoint,i=void 0===n?"sm":n;return(0,s.default)()(function(e){return r.default.createElement(t,(0,a.default)({fullScreen:(0,s.isWidthDown)(i,e.width)},e))})}};t.default=l},1464:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.isWidthDown=t.isWidthUp=void 0;var o=i(n(36)),a=i(n(39)),r=i(n(73)),s=i(n(74)),l=i(n(76)),c=i(n(77)),p=i(n(78)),u=i(n(2)),h=(i(n(31)),i(n(217))),d=i(n(373)),f=(n(61),i(n(539))),m=i(n(263)),g=n(859),v=i(n(860));t.isWidthUp=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?g.keys.indexOf(e)<g.keys.indexOf(t):g.keys.indexOf(e)<=g.keys.indexOf(t)};t.isWidthDown=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?g.keys.indexOf(t)<g.keys.indexOf(e):g.keys.indexOf(t)<=g.keys.indexOf(e)};var E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.withTheme,i=void 0!==n&&n,E=e.noSSR,y=void 0!==E&&E,b=e.initialWidth,O=e.resizeInterval,S=void 0===O?166:O,w=function(e){function n(e){var t;return(0,r.default)(this,n),(t=(0,l.default)(this,(0,c.default)(n).call(this,e))).state={width:y?t.getWidth():void 0},"undefined"!=typeof window&&(t.handleResize=(0,d.default)(function(){var e=t.getWidth();e!==t.state.width&&t.setState({width:e})},S)),t}return(0,p.default)(n,e),(0,s.default)(n,[{key:"componentDidMount",value:function(){var e=this.getWidth();e!==this.state.width&&this.setState({width:e})}},{key:"componentWillUnmount",value:function(){this.handleResize.clear()}},{key:"getWidth",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,t=this.props.theme.breakpoints,n=null,i=1;null===n&&i<g.keys.length;){var o=g.keys[i];if(e<t.values[o]){n=g.keys[i-1];break}i+=1}return n=n||"xl"}},{key:"render",value:function(){var e=(0,v.default)({theme:this.props.theme,name:"MuiWithWidth",props:(0,o.default)({},this.props)}),n=e.initialWidth,r=e.theme,s=e.width,l=(0,a.default)(e,["initialWidth","theme","width"]),c=(0,o.default)({width:s||this.state.width||n||b},l);return void 0===c.width?null:(i&&(c.theme=r),u.default.createElement(u.default.Fragment,null,u.default.createElement(t,c),u.default.createElement(h.default,{target:"window",onResize:this.handleResize})))}}]),n}(u.default.Component);return(0,f.default)(w,t),(0,m.default)()(w)}};t.default=E},1465:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.isHorizontal=O,t.getAnchor=S,t.default=t.styles=void 0;var o=i(n(36)),a=i(n(55)),r=i(n(39)),s=i(n(73)),l=i(n(74)),c=i(n(76)),p=i(n(77)),u=i(n(78)),h=i(n(2)),d=(i(n(31)),i(n(47))),f=i(n(625)),m=i(n(38)),g=i(n(858)),v=i(n(93)),E=n(110),y=n(321),b={left:"right",right:"left",top:"down",bottom:"up"};function O(e){return-1!==["left","right"].indexOf(e.anchor)}function S(e){return"rtl"===e.theme.direction&&O(e)?b[e.anchor]:e.anchor}var w=function(e){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:e.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:"none"},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(e.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(e.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(e.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(e.palette.divider)},modal:{}}};t.styles=w;var C=function(e){function t(){var e,n;(0,s.default)(this,t);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(n=(0,c.default)(this,(e=(0,p.default)(t)).call.apply(e,[this].concat(o)))).mounted=!1,n}return(0,u.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){var e=this.props,t=(e.anchor,e.BackdropProps),n=e.children,i=e.classes,s=e.className,l=e.elevation,c=e.ModalProps,p=(c=void 0===c?{}:c).BackdropProps,u=(0,r.default)(c,["BackdropProps"]),m=e.onClose,y=e.open,O=e.PaperProps,w=e.SlideProps,C=(e.theme,e.transitionDuration),j=e.variant,k=(0,r.default)(e,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","theme","transitionDuration","variant"]),x=S(this.props),M=h.default.createElement(v.default,(0,o.default)({elevation:"temporary"===j?l:0,square:!0,className:(0,d.default)(i.paper,i["paperAnchor".concat((0,E.capitalize)(x))],(0,a.default)({},i["paperAnchorDocked".concat((0,E.capitalize)(x))],"temporary"!==j))},O),n);if("permanent"===j)return h.default.createElement("div",(0,o.default)({className:(0,d.default)(i.root,i.docked,s)},k),M);var P=h.default.createElement(g.default,(0,o.default)({in:y,direction:b[x],timeout:C,appear:this.mounted},w),M);return"persistent"===j?h.default.createElement("div",(0,o.default)({className:(0,d.default)(i.root,i.docked,s)},k),P):h.default.createElement(f.default,(0,o.default)({BackdropProps:(0,o.default)({},t,p,{transitionDuration:C}),className:(0,d.default)(i.root,i.modal,s),open:y,onClose:m},k,u),P)}}]),t}(h.default.Component);C.defaultProps={anchor:"left",elevation:16,open:!1,transitionDuration:{enter:y.duration.enteringScreen,exit:y.duration.leavingScreen},variant:"temporary"};var j=(0,m.default)(w,{name:"MuiDrawer",flip:!1,withTheme:!0})(C);t.default=j},1473:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var o=i(n(1463))},1474:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var o=i(n(1465))},1476:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})),"ArrowBack");t.default=a},1478:function(e,t,n){"use strict";var i=n(6),o=n.n(i),a=n(10),r=n.n(a),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(2),h=n(218),d=n.n(h),f=n(25),m=n.n(f),g=n(1476),v=n.n(g),E=(n(1481),n(52)),y=n.n(E),b=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){return u.createElement(d.a,{className:"PageHeader__main"},this.props.onGoBackRequested?u.createElement(m.a,{onClick:this.props.onGoBackRequested,style:{flexShrink:0}},u.createElement(v.a,null)):u.createElement("div",{style:{display:"inline-block"}}),u.createElement(y.a,{variant:"title",align:"center",style:{flex:1}},this.props.title),u.createElement("div",{style:{flexShrink:0}},this.props.rightButtonGroup))}}]),t}(u.Component);t.a=b},1481:function(e,t,n){var i=n(1482);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},1482:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".PageHeader__main {\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  margin-bottom: 10px;\n  background-color: #fff !important;\n  height: 48px !important;\n  width: 100% !important;\n  flex-shrink: 0;\n  padding: 0; }\n",""])},1615:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"FilterList");t.default=a},1772:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),o.default.createElement("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})),"ZoomIn");t.default=a},1773:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),o.default.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"})),"ZoomOut");t.default=a},1896:function(e,t,n){"use strict";n.d(t,"e",function(){return p}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return h}),n.d(t,"f",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return m});var i=n(6),o=n.n(i),a=n(7),r=n.n(a),s=n(8),l=n.n(s),c=n(18),p=function(e){function t(e){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Request",{id:e}))}return l()(t,e),t}(c.a),u=function(e){function t(e){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Delete",{id:e}))}return l()(t,e),t}(c.a),h=function(e){function t(e){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Create",{template:e}))}return l()(t,e),t}(c.a),d=function(e){function t(e){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Update",{template:e}))}return l()(t,e),t}(c.a),f=function(e){function t(){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","List",{}))}return l()(t,e),t}(c.a),m=function(e){function t(){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","ListDescriptions",{}))}return l()(t,e),t}(c.a)},1970:function(e,t,n){"use strict";var i=n(2),o=n(94),a=n.n(o);t.a=function(e){return i.createElement(a.a,Object.assign({},e),i.createElement("path",{d:"M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"}))}},1971:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H6V6h12v12z"})),"CropSquare");t.default=a},1972:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})),"PanoramaFishEye");t.default=a},1973:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{fillOpacity:".36",d:"M0 20h24v4H0z"}),o.default.createElement("path",{d:"M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z"})),"FormatColorText");t.default=a},2340:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.default.createElement("path",{d:"M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"})),"WbSunny");t.default=a},2341:function(e,t,n){"use strict";var i=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),a=(0,i(n(44)).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{d:"M5 17v2h14v-2H5zm4.5-4.2h5l.9 2.2h2.1L12.75 4h-1.5L6.5 15h2.1l.9-2.2zM12 5.98L13.87 11h-3.74L12 5.98z"}),o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),"TextFormat");t.default=a},2342:function(e,t,n){var i=n(2343);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},2343:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".DocumentTemplate-TextEditor__toolbar {\n  display: flex;\n  align-items: center; }\n\n.DocumentTemplate-TextEditor__textAlignCenter div {\n  text-align: center; }\n\n.DocumentTemplate-TextEditor__textAlignLeft div {\n  text-align: left; }\n\n.DocumentTemplate-TextEditor__textAlignJustify div {\n  text-align: justify; }\n\n.DocumentTemplate-TextEditor__textAlignRight div {\n  text-align: right; }\n",""])},2344:function(e,t,n){var i=n(2345);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},2345:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.Anchor__resize {\n  position: absolute;\n  display: block;\n  text-decoration: none; }\n\n.Anchor__resize::before {\n  position: absolute;\n  content: "";\n  background: #3f4652;\n  width: 10px;\n  height: 10px;\n  left: 13px;\n  top: 13px;\n  border: 2px solid #fff;\n  border-radius: 10px;\n  transition: background .15s linear;\n  box-shadow: 0 0 3px 1px rgba(0, 0, 0, 0.15); }\n\n.Anchor__resize:hover:before {\n  background: #00c4cc; }\n\n.Anchor__rotate {\n  position: absolute;\n  display: block;\n  text-decoration: none; }\n\n.Anchor__rotate::before {\n  position: absolute;\n  content: "";\n  background: #fff;\n  left: 11px;\n  top: 12px;\n  width: 16px;\n  height: 16px;\n  border-radius: 16px;\n  box-shadow: 0 0 3px 1px rgba(0, 0, 0, 0.15); }\n\n.Anchor__rotation-icon {\n  position: absolute;\n  width: 14px;\n  height: 14px;\n  left: 12px;\n  top: 14px; }\n',""])},2346:function(e,t,n){var i=n(2347);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},2347:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".SeatmapEditorScene__sceneArea {\n  border: 0px; }\n\n.SeatmapEditorScene__pixel-ratio {\n  width: 25mm;\n  height: 25mm;\n  position: absolute;\n  top: 0;\n  left: 0;\n  visibility: hidden; }\n\n.SeatmapEditorScene__seat:hover {\n  cursor: pointer;\n  border-color: #2196f3 !important; }\n\n.SeatmapEditorScene__section:hover {\n  cursor: pointer; }\n",""])},2348:function(e,t,n){var i=n(2349);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},2349:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".SeatmapEditor__actionsMenu {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  flex-shrink: 0;\n  padding: 10px;\n  border-radius: 0%; }\n\n.SeatmapEditor__viewport {\n  display: flex;\n  height: 100%; }\n  .SeatmapEditor__viewport .SeatmapEditor__viewport-page-scene {\n    display: flex;\n    flex-direction: row;\n    box-sizing: border-box;\n    flex: 1 1 auto;\n    overflow: hidden; }\n  .SeatmapEditor__viewport .SeatmapEditor__attributes {\n    overflow-x: auto;\n    overflow-y: hidden;\n    flex-shrink: 0;\n    padding: 5px;\n    position: absolute;\n    z-index: 5;\n    top: 0;\n    left: 0;\n    right: 0;\n    opacity: 0.95;\n    background-color: #fff;\n    border-radius: 0%; }\n  .SeatmapEditor__viewport .SeatmapEditor__scene {\n    display: block; }\n",""])},2350:function(e,t,n){var i=n(2351);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,o);i.locals&&(e.exports=i.locals)},2351:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".SeatmapEditorNavigation {\n  position: absolute;\n  bottom: 20px;\n  left: 0;\n  right: 0;\n  margin: auto;\n  text-align: center; }\n\n.SeatmapEditorNavigation__navMargin {\n  margin: 5px; }\n",""])},2723:function(e,t,n){"use strict";n.r(t);var i=n(6),o=n.n(i),a=n(10),r=n.n(a),s=n(7),l=n.n(s),c=n(8),p=n.n(c),u=n(11),h=n.n(u),d=n(2),f=n(14),m=n(13),g=n(19),v=n.n(g),E=n(1),y=n(556),b=n(176),O=n(71),S=n(79),w=n(627),C=n(1467),j=n(136),k=n(1461),x=n(93),M=n.n(x),P=n(40),I=n(105),_=n(25),z=n.n(_),R=n(1971),T=n.n(R),D=n(1970),F=n(604),A=n.n(F),B=n(1972),N=n.n(B),L=n(2341),U=n.n(L),H=n(1615),$=n.n(H),Y=n(2340),q=n.n(Y),X=n(83),W=n(3),V=n(52),K=n.n(V),J=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},G=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Z=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={shape:new E.SeatmapElementDisplayTableTypeRect},n}return p()(t,e),r()(t,[{key:"onTableCreate",value:function(){this.props.dispatch(Object(P.db)(new E.SeatmapElementDisplayTable(this.state.shape))),this.props.closePopover()}},{key:"onShapeChange",value:function(e){this.setState(W(this.state,{shape:{$set:e}}))}},{key:"render",value:function(){var e=this;return d.createElement(M.a,{style:{display:"flex",flexDirection:"column",width:300,padding:15}},d.createElement(K.a,{variant:"subheading",style:{textAlign:"center",marginBottom:20}},this.props.i18n.t("Создать стол")),d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:15}},d.createElement(K.a,{variant:"body1"},this.props.i18n.t("Форма")),d.createElement("div",null,d.createElement(z.a,{disabled:this.state.shape.tpe.value===E.SeatmapElementDisplayTableTypeRect.$Type.value,onClick:function(){return e.onShapeChange(new E.SeatmapElementDisplayTableTypeRect)}},d.createElement(T.a,null)),d.createElement(z.a,{disabled:this.state.shape.tpe.value===E.SeatmapElementDisplayTableTypeCircle.$Type.value,onClick:function(){return e.onShapeChange(new E.SeatmapElementDisplayTableTypeCircle)}},d.createElement(N.a,null)))),d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:15}},d.createElement(v.a,{variant:"raised",color:"secondary",style:{marginRight:15},onClick:this.props.closePopover},this.props.i18n.t("Отмена")),d.createElement(v.a,{variant:"raised",color:"primary",onClick:this.onTableCreate},this.props.i18n.t("Создать"))))}}]),t}(d.Component);Z=J([m.autobind,G("design:paramtypes",[Object])],Z);var Q=Object(f.connect)(function(e){return{i18n:e.i18n}})(Object(I.a)(Z)),ee=n(0),te=n(26),ne=n.n(te),ie=n(808),oe=n.n(ie),ae=n(809),re=n.n(ae),se=n(348),le=n.n(se),ce=n(45),pe=n.n(ce),ue=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},he=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},de=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={shape:new E.SeatmapElementDisplayTableTypeRect,label:new ee.None,iconEnabled:!1,icon:new ee.None},n}return p()(t,e),r()(t,[{key:"onObjectCreate",value:function(){this.props.dispatch(Object(P.db)(new E.SeatmapElementDisplayObject(this.state.shape,this.state.label,new E.OptionalValue(this.state.iconEnabled,this.state.icon)))),this.props.closePopover()}},{key:"onShapeChange",value:function(e){this.setState(W(this.state,{shape:{$set:e}}))}},{key:"onLabelChange",value:function(e){this.setState(W(this.state,{label:{$set:Object(ee.toOption)(e.target.value)}}))}},{key:"onIconEnabledChange",value:function(e,t){this.setState(W(this.state,{iconEnabled:{$set:t}}))}},{key:"onIconChange",value:function(e){this.setState(W(this.state,{icon:{$set:Object(ee.toOption)(e)}}))}},{key:"renderShapeEditor",value:function(){var e=this;return d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:15}},d.createElement(K.a,{variant:"body1"},this.props.i18n.t("Форма")),d.createElement("div",null,d.createElement(z.a,{disabled:this.state.shape.tpe.value===E.SeatmapElementDisplayTableTypeRect.$Type.value,onClick:function(){return e.onShapeChange(new E.SeatmapElementDisplayTableTypeRect)}},d.createElement(T.a,null)),d.createElement(z.a,{disabled:this.state.shape.tpe.value===E.SeatmapElementDisplayTableTypeCircle.$Type.value,onClick:function(){return e.onShapeChange(new E.SeatmapElementDisplayTableTypeCircle)}},d.createElement(N.a,null))))}},{key:"renderLabelEditor",value:function(){var e=this;return d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:15}},d.createElement(K.a,{variant:"body1"},this.props.i18n.t("Надпись")),d.createElement("div",null,d.createElement(ne.a,{style:{marginTop:0},value:this.state.label.getOrElse(function(){return e.props.i18n.t("Label")}),onChange:this.onLabelChange})))}},{key:"renderIconEditor",value:function(){return d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:15}},d.createElement(K.a,{variant:"body1"},this.props.i18n.t("Иконка")),d.createElement("div",null,d.createElement(pe.a,{checked:this.state.iconEnabled,onChange:this.onIconEnabledChange})))}},{key:"renderIconSelector",value:function(){var e=this;return d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:15}},d.createElement(z.a,{disabled:this.state.icon.map(function(e){return"Mic"===e}).getOrElse(function(){return!1}),onClick:function(){return e.onIconChange("Mic")}},d.createElement(A.a,null)),d.createElement(z.a,{disabled:this.state.icon.map(function(e){return"FastFood"===e}).getOrElse(function(){return!1}),onClick:function(){return e.onIconChange("FastFood")}},d.createElement(oe.a,null)),d.createElement(z.a,{disabled:this.state.icon.map(function(e){return"LocalBar"===e}).getOrElse(function(){return!1}),onClick:function(){return e.onIconChange("LocalBar")}},d.createElement(re.a,null)),d.createElement(z.a,{disabled:this.state.icon.map(function(e){return"ExitToApp"===e}).getOrElse(function(){return!1}),onClick:function(){return e.onIconChange("ExitToApp")}},d.createElement(le.a,null)))}},{key:"renderControl",value:function(){return d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:15}},d.createElement(v.a,{variant:"raised",color:"secondary",style:{marginRight:15},onClick:this.props.closePopover},this.props.i18n.t("Отмена")),d.createElement(v.a,{variant:"raised",color:"primary",onClick:this.onObjectCreate},this.props.i18n.t("Создать")))}},{key:"render",value:function(){return d.createElement(M.a,{style:{display:"flex",flexDirection:"column",width:300,padding:15}},d.createElement(K.a,{variant:"subheading",style:{textAlign:"center",marginBottom:20}},this.props.i18n.t("Создать объект")),this.renderShapeEditor(),this.renderLabelEditor(),this.renderIconEditor(),this.renderIconSelector(),this.renderControl())}}]),t}(d.Component);de=ue([m.autobind,he("design:paramtypes",[Object])],de);var fe=Object(f.connect)(function(e){return{i18n:e.i18n}})(Object(I.a)(de)),me=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ge=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ve=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={rowsCount:Object(ee.toOption)(5),seatsCount:Object(ee.toOption)(10)},n}return p()(t,e),r()(t,[{key:"onObjectCreate",value:function(){this.props.dispatch(Object(P.db)(new E.SeatmapElementDisplaySection(this.state.rowsCount,this.state.seatsCount))),this.props.closePopover()}},{key:"onRowsCountChange",value:function(e){this.setState(W(this.state,{rowsCount:{$set:Object(ee.toOption)(parseInt(e.target.value))}}))}},{key:"onSeatsCountChange",value:function(e){this.setState(W(this.state,{seatsCount:{$set:Object(ee.toOption)(parseInt(e.target.value))}}))}},{key:"render",value:function(){return d.createElement(M.a,{style:{display:"flex",flexDirection:"column",width:300,padding:15}},d.createElement(K.a,{variant:"subheading",style:{textAlign:"center",marginBottom:20}},this.props.i18n.t("Создать секцию")),d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:15}},d.createElement(K.a,{variant:"body1"},this.props.i18n.t("Рядов")),d.createElement("div",null,d.createElement(ne.a,{style:{marginTop:0,width:50},type:"number",InputProps:{inputProps:{min:0}},value:this.state.rowsCount.getOrElse(function(){return 5}),onChange:this.onRowsCountChange}))),d.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:15}},d.createElement(K.a,{variant:"body1"},this.props.i18n.t("Мест")),d.createElement("div",null,d.createElement(ne.a,{style:{marginTop:0,width:50},type:"number",InputProps:{inputProps:{min:0}},value:this.state.seatsCount.getOrElse(function(){return 10}),onChange:this.onSeatsCountChange}))),d.createElement(v.a,{variant:"raised",color:"primary",onClick:this.onObjectCreate},this.props.i18n.t("Создать")))}}]),t}(d.Component);ve=me([m.autobind,ge("design:paramtypes",[Object])],ve);var Ee=Object(f.connect)(function(e){return{i18n:e.i18n}})(Object(I.a)(ve)),ye=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},be=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Oe=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={openMenu:!1,fileInput:new ee.None},n}return p()(t,e),r()(t,[{key:"onParagraphSelected",value:function(){var e=this;if(0!==this.props.fonts.list.length)this.props.dispatch(Object(P.db)(Object(ee.headOption)(this.props.fonts.list).flatMap(function(t){return Object(ee.headOption)(t.fonts).map(function(t){return new E.SeatmapElementDisplayParagraph([new E.SeatmapElementDisplayTextChunk(new E.SeatmapElementDataSourceStaticValue(e.props.i18n.t("Текст надписи")),new E.ElementFont(t),[])])})}).getOrElse(function(){throw new Error("There's no fonts")})));else var t=this.props.openDialog(this.props.i18n.t("Ошибка"),d.createElement("div",null,d.createElement("p",null,this.props.i18n.t("Для организации не добавлено ни одного шрифта. Управлять шрифтами вы можете на "),d.createElement("a",{href:"javascript:void(null);",onClick:function(){e.props.dispatch(Object(S.pb)())}},this.props.i18n.t("странице организациии")))),[d.createElement(v.a,{variant:"raised",onClick:function(){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"onImageSelected",value:function(){this.props.dispatch(Object(P.db)(new E.SeatmapElementDisplayImage))}},{key:"onLineSelected",value:function(){this.props.dispatch(Object(P.db)(new E.SeatmapElementDisplayLine))}},{key:"onRectSelected",value:function(){this.props.dispatch(Object(P.db)(new E.SeatmapElementDisplayRect))}},{key:"onCircleSelected",value:function(){this.props.dispatch(Object(P.db)(new E.SeatmapElementDisplayCircle))}},{key:"onTableSelected",value:function(e){this.props.openPopover(Object(ee.toOption)(e.currentTarget),d.createElement(Q,null))}},{key:"onObjectCreate",value:function(e){this.props.openPopover(Object(ee.toOption)(e.currentTarget),d.createElement(fe,null))}},{key:"onSectionCreate",value:function(e){this.props.openPopover(Object(ee.toOption)(e.currentTarget),d.createElement(Ee,null))}},{key:"render",value:function(){return d.createElement(M.a,{className:this.props.className},d.createElement(z.a,{onClick:this.onRectSelected},d.createElement(T.a,null)),d.createElement(z.a,{onClick:this.onCircleSelected},d.createElement(N.a,null)),d.createElement(z.a,{onClick:this.onTableSelected},d.createElement(q.a,null)),d.createElement(z.a,{onClick:this.onObjectCreate},d.createElement(A.a,null)),d.createElement(z.a,{onClick:this.onSectionCreate},d.createElement($.a,null)),d.createElement(z.a,{onClick:this.onParagraphSelected},d.createElement(U.a,null)),d.createElement(z.a,{onClick:this.onImageSelected},d.createElement(D.a,null)))}}]),t}(d.Component);Oe=ye([m.autobind,be("design:paramtypes",[Object])],Oe);var Se=Object(f.connect)(function(e){return{i18n:e.i18n,fonts:e.fonts}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fonts===t.fonts},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.fonts===t.fonts}})(Object(X.a)(Object(I.a)(Oe))),we=n(24),Ce=n.n(we),je=n(30),ke=n.n(je),xe=n(32),Me=n.n(xe),Pe=n(34),Ie=n.n(Pe),_e=n(43),ze=n.n(_e),Re={width:80},Te=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:n.formatString(e.value.toString())},n.newValue=new ee.None,n}return p()(t,e),r()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState(W(this.state,{value:{$set:this.newValue.map(function(e){return t.newValue=new ee.None,t.formatString(e)}).getOrElse(function(){return t.props.value!==e.value?t.formatString(e.value.toString()):t.state.value})}}))}},{key:"formatString",value:function(e){return Object(ee.lift)(e.split("."),1).map(function(t){return t.length>2?e.slice(0,2-t.length):e}).getOrElse(function(){return e})}},{key:"handleChange",value:function(e){var t=e.trim().replace(",",".");""===t?this.props.onChange(0):this.props.onChange(Number.parseFloat(t)),this.newValue=Object(ee.toOption)(t)}},{key:"render",value:function(){var e=this;return d.createElement(ne.a,{style:Re,onChange:function(t){return e.handleChange(t.target.value)},value:this.state.value,label:this.props.label,onFocus:this.props.onFocus,onBlur:this.props.onBlur})}}]),t}(d.Component),De={width:80},Fe=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:n.formatString((100*e.value).toString())},n.newValue=new ee.None,n}return p()(t,e),r()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState(W(this.state,{value:{$set:this.newValue.map(function(e){return t.newValue=new ee.None,t.formatString(e)}).getOrElse(function(){return t.props.value!==e.value?t.formatString((100*e.value).toString()):t.state.value})}}))}},{key:"formatString",value:function(e){return Object(ee.lift)(e.split("."),1).map(function(t){return t.length>2?e.slice(0,2-t.length):e}).getOrElse(function(){return e})}},{key:"handleChange",value:function(e){var t=e.trim().replace(",",".");if(""===t)this.props.onChange(0),this.newValue=Object(ee.toOption)(t);else{var n=Number.parseFloat(t)/100;if(void 0!==this.props.minValue&&n<this.props.minValue)this.props.onChange(this.props.minValue),this.newValue=Object(ee.toOption)(this.formatString((100*this.props.minValue).toString()));else{if(void 0!==this.props.maxValue&&n>this.props.maxValue)return this.props.onChange(this.props.maxValue),void(this.newValue=Object(ee.toOption)(this.formatString((100*this.props.maxValue).toString())));this.props.onChange(Number.parseFloat(t)/100),this.newValue=Object(ee.toOption)(t)}}}},{key:"render",value:function(){var e=this;return d.createElement(ne.a,{style:this.props.style||De,onChange:function(t){return e.handleChange(t.target.value)},value:this.state.value,label:this.props.label,onFocus:this.props.onFocus,onBlur:this.props.onBlur})}}]),t}(d.Component),Ae=n(631),Be=n.n(Ae),Ne=n(23),Le=n(99),Ue=n(139),He=n(153),$e=n(433),Ye=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},qe=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Xe=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileMetaId:new Ne.None},n}return p()(t,e),r()(t,[{key:"handleCropTopChanged",value:function(e){this.props.dispatch(Object(P.rb)(e))}},{key:"handleCropRightChanged",value:function(e){this.props.dispatch(Object(P.qb)(e))}},{key:"handleCropBottomChanged",value:function(e){this.props.dispatch(Object(P.ob)(e))}},{key:"handleCropLeftChanged",value:function(e){this.props.dispatch(Object(P.pb)(e))}},{key:"handleBrightnessChanged",value:function(e){this.props.dispatch(Object(P.nb)(e))}},{key:"createImageAttributesTab",value:function(e){var t=this;return d.createElement("div",{style:{display:"flex"}},d.createElement(Me.a,{fullWidth:!0,style:{width:200}},d.createElement(Ie.a,null,this.props.i18n.t("Поставщик данных")),d.createElement(ke.a,{value:this.props.seatmapEditor.imageSourceType.map(function(e){return e.value}).getOrElse(function(){return e.source.map(function(e){return e.tpe.value}).getOrElse(function(){return E.SeatmapElementDataSourceStaticFile.$Type.value})}),onChange:this.onImageSourceTypeChanged},E.SeatmapElementImageDataSourceTypes.map(function(e){return d.createElement(Ce.a,{value:e.value,key:e.value},function(){switch(e){case E.SeatmapElementDataSourceStaticFile.$Type:return t.props.i18n.t("Статическое изображение");default:throw"Unknown image data source type"}}())}))),this.getImageSource(e).value===E.SeatmapElementDataSourceStaticFile.$Type.value&&d.createElement("div",{style:{display:"flex",alignItems:"center",width:"300px"}},d.createElement(Me.a,{fullWidth:!0},d.createElement(Ie.a,null,this.props.i18n.t("Файл")),d.createElement(ke.a,{value:e.source.map(function(e){return e.fileId.value}).getOrElse(function(){return""}),onChange:this.onElementImageFileChanged},this.props.seatmapEditor.images.map(function(e){return d.createElement(Ce.a,{value:e.value,key:e.value},Object(Ne.headOption)(t.props.fileMetas.list.filter(function(t){return t.id.value===e.value})).map(function(e){return e.entity.originalName}).getOrElse(function(){return t.props.i18n.t("Описание файла не найдено")}))}))),d.createElement(z.a,{onClick:this.handleAddFile},d.createElement(Be.a,null))))}},{key:"getImageSource",value:function(e){return this.props.seatmapEditor.imageSourceType.getOrElse(function(){return e.source.map(function(e){return e.tpe}).getOrElse(function(){return E.SeatmapElementDataSourceStaticFile.$Type})})}},{key:"onImageSourceTypeChanged",value:function(e){var t=e.target.value;t&&this.props.dispatch(Object(P.zb)(new ee.TypeId(t)))}},{key:"onElementImageFileChanged",value:function(e){this.props.dispatch(Object(P.yb)(new E.SeatmapElementDataSourceStaticFile(new E.Id(e.target.value))))}},{key:"handleAddFile",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Выбор файла"),this.props.organisationId.map(function(t){return d.createElement($e.a,{organisationId:t,excludedFolders:[].concat(ze()(E.FileTypes.map(function(e){return Object(He.b)(e.$Type.value)}))),initialFolder:Object(Ne.toOption)("free"),onSelectionChange:e.onFileSelected,acceptedFiles:new Ne.None,elementId:new Ne.None})}).getOrElse(function(){return d.createElement("div",null,e.props.i18n.t("Организация не найдена"))}),[d.createElement(v.a,{variant:"raised",onClick:function(n){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),d.createElement(v.a,{variant:"raised",onClick:function(){e.onFileInserted(),e.props.handleDialogClose(t)},color:"primary"},this.props.i18n.t("Вставить"))])}},{key:"onFileInserted",value:function(){var e=this;this.state.fileMetaId.map(function(t){var n=new E.Id(t);e.props.dispatch(Object(P.Gb)(n)),Object(Le.b)(n).then(function(t){e.props.dispatch(Object(Ue.e)([t.record]))}).catch(function(e){console.log("File fetched with error",e)})})}},{key:"onFileSelected",value:function(e){var t=this;e.forEach(function(e){return t.setState({fileMetaId:Object(Ne.toOption)(e)})})}},{key:"render",value:function(){return d.createElement("div",{style:{display:"flex"}},d.createElement("div",null,d.createElement(Fe,{label:this.props.i18n.t("Яркость")+" (%)",style:{width:100},value:this.props.element.brightness.level,minValue:0,maxValue:2,onChange:this.handleBrightnessChanged,onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),d.createElement("span",{style:{marginRight:8,marginTop:37,fontSize:14}},this.props.i18n.t("Обрезка"),":"),d.createElement("div",null,d.createElement(Te,{label:this.props.i18n.t("Сверху"),value:this.props.element.crop.top,onChange:this.handleCropTopChanged,onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),d.createElement("div",null,d.createElement(Te,{label:this.props.i18n.t("Справа"),value:this.props.element.crop.right,onChange:this.handleCropRightChanged,onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),d.createElement("div",null,d.createElement(Te,{label:this.props.i18n.t("Снизу"),value:this.props.element.crop.bottom,onChange:this.handleCropBottomChanged,onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),d.createElement("div",null,d.createElement(Te,{label:this.props.i18n.t("Слева"),value:this.props.element.crop.left,onChange:this.handleCropLeftChanged,onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),this.createImageAttributesTab(this.props.element.display))}}]),t}(d.Component);Xe=Ye([m.autobind,qe("design:paramtypes",[Object])],Xe);var We=Object(f.connect)(function(e){return{i18n:e.i18n,seatmapEditor:e.seatmapEditor,fileMetas:e.fileMetas,organisationId:e.organisation.organisationId}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor&&e.fileMetas===t.fileMetas&&e.organisation===t.organisation},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor&&e.fileMetas===t.fileMetas&&Object(Ne.isEqual)(e.organisationId,t.organisationId)}})(Object(X.a)(Xe)),Ve=n(33),Ke=n.n(Ve),Je=n(46),Ge=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ze=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"getActiveElement",value:function(){var e=this;return this.props.activeElementId.zip(this.props.activePageIndex).flatMap(function(t){var n=t._2,i=t._1.value;return Object(Ne.headOption)(e.props.pages[n].elements.filter(function(e){return e.ownId.value===i}))})}},{key:"onWidthChanged",value:function(e){var t=this;this.props.dispatch(Object(P.Fb)(e)),this.getActiveElement().map(function(n){if(n.size.aspectRatio){var i=n.size.width/n.size.height;t.onHeightChanged(e/i)}})}},{key:"onHeightChanged",value:function(e){var t=this;this.props.dispatch(Object(P.wb)(e)),this.getActiveElement().map(function(n){if(n.size.aspectRatio){var i=n.size.width/n.size.height;t.onWidthChanged(e*i)}})}},{key:"onAspectRatioChanged",value:function(e){this.props.dispatch(Object(P.mb)(e.target.checked))}},{key:"render",value:function(){return d.createElement("div",{style:{display:"flex",flexDirection:"column"}},d.createElement("div",{style:{display:"flex"}},d.createElement("div",{style:{margin:5}},d.createElement(Te,{onChange:this.onWidthChanged,value:this.props.element.size.width,label:this.props.i18n.t("Ширина"),onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),d.createElement("div",{style:{margin:5}},d.createElement(Te,{onChange:this.onHeightChanged,value:this.props.element.size.height,label:this.props.i18n.t("Высота"),onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus}))),d.createElement("div",{style:{margin:5}},d.createElement(Ke.a,{label:this.props.i18n.t("Сохранять пропорции"),control:d.createElement(pe.a,{style:Object.assign({},Je.f,{paddingLeft:7}),checked:this.props.element.size.aspectRatio,onChange:this.onAspectRatioChanged})})))}}]),t}(d.Component);Ze=Ge([m.autobind],Ze);var Qe=Object(f.connect)(function(e){return{i18n:e.i18n,activeElementId:e.seatmapEditor.activeElementId,pages:e.seatmapEditor.pages,activePageIndex:e.seatmapEditor.activePageIndex}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.activeElementId===t.activeElementId&&e.pages===t.pages&&e.activePageIndex===t.activePageIndex}})(Ze),et=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},tt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onAbscissaChanged",value:function(e){this.props.dispatch(Object(P.lb)(e))}},{key:"onOrdinateChanged",value:function(e){this.props.dispatch(Object(P.Bb)(e))}},{key:"onRotationChanged",value:function(e){this.props.dispatch(Object(P.Cb)(e))}},{key:"render",value:function(){return d.createElement(d.Fragment,null,d.createElement("div",{style:{margin:5}},d.createElement(Te,{onChange:this.onAbscissaChanged,value:this.props.element.position.x,label:this.props.i18n.t("X"),onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),d.createElement("div",{style:{margin:5}},d.createElement(Te,{onChange:this.onOrdinateChanged,value:this.props.element.position.y,label:this.props.i18n.t("Y"),onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})),d.createElement("div",{style:{margin:5}},d.createElement(Te,{onChange:this.onRotationChanged,value:this.props.element.rotation,label:this.props.i18n.t("Поворот"),onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus})))}}]),t}(d.Component);tt=et([m.autobind],tt);var nt=Object(f.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(X.a)(tt)),it=n(16),ot=n(189),at=n.n(ot),rt=n(1973),st=n.n(rt),lt=n(309),ct=n.n(lt),pt=n(687),ut=n.n(pt),ht=n(329),dt=n.n(ht),ft=n(331),mt=n.n(ft),gt=n(272),vt=n.n(gt),Et=n(330),yt=n.n(Et),bt=n(295),Ot=n.n(bt),St=n(262),wt=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ct=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onElementMaxLinesChanged",value:function(e){var t=parseInt(e.target.value);isNaN(t)||this.props.dispatch(Object(P.vb)(t))}},{key:"onElementLineSpacingChanged",value:function(e){var t=parseFloat(e.target.value);isNaN(t)||this.props.dispatch(Object(P.ub)(t))}},{key:"getParagraphFontStyleName",value:function(){return this.props.seatmapEditor.textEditorState.editorState.flatMap(function(e){try{var t=e.getCurrentInlineStyle();return Object(Ne.toOption)(t.find(function(e){return"string"==typeof e&&e.indexOf("fontfamily")>=0})).flatMap(function(e){return Object(Ne.toOption)(e.slice("fontfamily-".length))})}catch(e){return Object(Ne.toOption)("")}})}},{key:"getFontSize",value:function(){return this.props.seatmapEditor.textEditorState.editorState.flatMap(function(e){try{var t=e.getCurrentInlineStyle();return Object(Ne.toOption)(t.find(function(e){return"string"==typeof e&&e.indexOf("fontsize")>=0})).map(function(e){return e.slice("fontsize-".length)})}catch(e){return Object(Ne.toOption)("")}})}},{key:"handleTextEditorStateChange",value:function(e){this.props.dispatch(Object(P.Yb)(e))}},{key:"removeCustomInlineStyle",value:function(e){var t=this.props.seatmapEditor.textEditorState.editorState.getOrElse(function(){throw new Error("editorState isn't initialized")}),n=t.getSelection(),i=t.getCurrentInlineStyle();if(n.isCollapsed())return it.EditorState.setInlineStyleOverride(t,i.remove(i.find(function(t){return"string"==typeof t&&t.indexOf(e.slice(0,e.indexOf("-")))>=0})));var o=it.Modifier.removeInlineStyle(t.getCurrentContent(),n,i.find(function(t){return"string"==typeof t&&t.indexOf(e.slice(0,e.indexOf("-")))>=0}));return it.EditorState.push(t,o,"change-inline-style")}},{key:"onParagraphFontFamilyChange",value:function(e){var t=this;Object(Ne.headOption)(this.props.fonts.list.filter(function(t){return t.name===e})).foreach(function(e){return t.onParagraphFontStyleChange(Object(Ne.head)(e.fonts).getName())})}},{key:"onParagraphFontStyleChange",value:function(e){var t=this.removeCustomInlineStyle("fontfamily"),n="fontfamily-"+e,i=this.toggleCustomInlineStyle(n,t);this.handleTextEditorStateChange(i)}},{key:"onFontSizeChange",value:function(e){var t=this.removeCustomInlineStyle("fontsize"),n="fontsize-"+e,i=this.toggleCustomInlineStyle(n,t);this.handleTextEditorStateChange(i)}},{key:"toggleCustomInlineStyle",value:function(e,t){var n=t||this.props.seatmapEditor.textEditorState.editorState.getOrElse(function(){throw new Error("editorState isn't initialized")});return it.RichUtils.toggleInlineStyle(n,e)}},{key:"toggleTextEffect",value:function(e){var t=this.removeCustomInlineStyle("texttransform");this.handleTextEditorStateChange(this.toggleCustomInlineStyle(e,t))}},{key:"onFormatAlignCenterClick",value:function(){this.handleTextEditorStateChange(this.setBlockData({"text-align":"center"}))}},{key:"onFormatAlignJustifyClick",value:function(){this.handleTextEditorStateChange(this.setBlockData({"text-align":"justify"}))}},{key:"onFormatAlignLeftClick",value:function(){this.handleTextEditorStateChange(this.setBlockData({"text-align":"left"}))}},{key:"onFormatAlignRightClick",value:function(){this.handleTextEditorStateChange(this.setBlockData({"text-align":"right"}))}},{key:"setBlockData",value:function(e){return this.props.seatmapEditor.textEditorState.editorState.map(function(t){var n=t.getCurrentContent(),i=t.getSelection(),o=it.Modifier.setBlockData(n,i,e);return it.EditorState.push(t,o,"change-block-data")}).getOrElse(function(){throw new Error("editorState hasn't initialized")})}},{key:"onUppercaseClick",value:function(){this.toggleTextEffect("texttransform-uppercase")}},{key:"onLowercaseClick",value:function(){this.toggleTextEffect("texttransform-lowercase")}},{key:"onCapitalizeClick",value:function(){this.toggleTextEffect("texttransform-capitalize")}},{key:"onFormatUnderlinedClick",value:function(){var e=this;this.props.seatmapEditor.textEditorState.editorState.map(function(t){e.handleTextEditorStateChange(it.RichUtils.toggleInlineStyle(t,"UNDERLINE"))})}},{key:"onFormatStrikethroughClick",value:function(){var e=this;this.props.seatmapEditor.textEditorState.editorState.map(function(t){e.handleTextEditorStateChange(it.RichUtils.toggleInlineStyle(t,"STRIKETHROUGH"))})}},{key:"onColorPopoverOpen",value:function(e){this.props.dispatch(Object(P.Xb)(e.currentTarget))}},{key:"onAlignMenuOpen",value:function(e){this.props.openMenu(e.currentTarget,[d.createElement(Ce.a,{key:"formatAlignJustify",onClick:this.onFormatAlignJustifyClick},d.createElement(at.a,null,d.createElement(mt.a,null))),d.createElement(Ce.a,{key:"formatAlignLeft",onClick:this.onFormatAlignLeftClick},d.createElement(at.a,null,d.createElement(vt.a,null))),d.createElement(Ce.a,{key:"formatAlignCenter",onClick:this.onFormatAlignCenterClick},d.createElement(at.a,null,d.createElement(dt.a,null))),d.createElement(Ce.a,{key:"formatAlignRight",onClick:this.onFormatAlignRightClick},d.createElement(at.a,null,d.createElement(yt.a,null)))])}},{key:"onUnderlinedMenuOpen",value:function(e){this.props.openMenu(e.currentTarget,[d.createElement(Ce.a,{key:"strikethroughS",onClick:this.onFormatStrikethroughClick},d.createElement(at.a,null,d.createElement(ut.a,null))),d.createElement(Ce.a,{key:"strikethroughS",onClick:this.onFormatUnderlinedClick},d.createElement(at.a,null,d.createElement(ut.a,null)))])}},{key:"onCapitalisationMenuOpen",value:function(e){this.props.openMenu(e.currentTarget,[d.createElement(Ce.a,{key:"upper",onClick:this.onUppercaseClick},d.createElement(at.a,null,d.createElement(Ot.a,null,"TT"))),d.createElement(Ce.a,{key:"lower",onClick:this.onLowercaseClick},d.createElement(at.a,null,d.createElement(Ot.a,null,"tt"))),d.createElement(Ce.a,{key:"startWithCapital",onClick:this.onCapitalizeClick},d.createElement(at.a,null,d.createElement(Ot.a,null,"Tt"))),d.createElement(Ce.a,{key:"formatUnderlined",onClick:this.onFormatUnderlinedClick},d.createElement(at.a,null,d.createElement(ct.a,null)))])}},{key:"createParagraphAttributesTab",value:function(){var e=this,t=this.getParagraphFontStyleName(),n=t.flatMap(function(t){return E.ElementFont.getFontFamily(e.props.fonts.list,t)});return d.createElement("div",{style:{display:"flex",alignItems:"center"}},this.props.seatmapEditor.sceneState.doubleClicked&&d.createElement("div",{style:{display:"flex",alignItems:"center",marginRight:16}},d.createElement(Me.a,{fullWidth:!0,style:{margin:5}},d.createElement(Ie.a,null,this.props.i18n.t("Шрифт")),d.createElement(ke.a,{value:n.map(function(e){return e.name}).getOrElse(function(){return""}),onChange:function(t){return e.onParagraphFontFamilyChange(t.target.value)}},this.props.fonts.list.map(function(e,t){return d.createElement(Ce.a,{value:e.name,key:t},e.name)}))),d.createElement(Me.a,{fullWidth:!0,style:{margin:5}},d.createElement(Ie.a,null,this.props.i18n.t("Стиль")),d.createElement(ke.a,{value:t.getOrElse(function(){return""}),onChange:function(t){return e.onParagraphFontStyleChange(t.target.value)}},n.flatMap(function(t){return Object(Ne.headOption)(e.props.fonts.list.filter(function(e){return e.name===t.name})).map(function(n){return n.fonts.map(function(n){return d.createElement(Ce.a,{value:n.getName(),key:n.getName()},E.ElementFont.handleFontStyleName(t.name,n.getName(),e.props.i18n.t("Regular")))})})}).getOrNull())),d.createElement(ne.a,{style:{margin:5},value:this.getFontSize().getOrElse(function(){return""}),onChange:function(t){return e.onFontSizeChange(t.target.value)},label:this.props.i18n.t("Размер"),onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus}),d.createElement(z.a,{onClick:this.onAlignMenuOpen},d.createElement(vt.a,null)),d.createElement(z.a,{onClick:this.onUnderlinedMenuOpen},d.createElement(ct.a,null)),d.createElement(z.a,{onClick:this.onCapitalisationMenuOpen},d.createElement(Ot.a,null,d.createElement("div",{style:{fontSize:20}},"TT"))),d.createElement(z.a,{onClick:this.onColorPopoverOpen},d.createElement(st.a,{style:{color:this.props.seatmapEditor.textEditorState.colorPopover.color.getOrElse(function(){return"#000"})}}))))}},{key:"render",value:function(){return d.createElement("div",{style:{display:"flex"}},d.createElement(ne.a,{type:"number",style:{width:100,minWidth:100,margin:5},label:this.props.i18n.t("Max строк"),value:this.props.element.display.maxLines,onChange:this.onElementMaxLinesChanged,onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus}),d.createElement(ne.a,{style:{width:100,minWidth:100,margin:5},label:this.props.i18n.t("Межстрочный интервал"),value:this.props.element.display.lineSpacing.getOrElse(function(){return 1.2}),onChange:this.onElementLineSpacingChanged,onBlur:this.props.onInputBlur,onFocus:this.props.onInputFocus}),this.createParagraphAttributesTab())}}]),t}(d.Component);Ct=wt([m.autobind],Ct);var jt=Object(f.connect)(function(e){return{i18n:e.i18n,seatmapEditor:e.seatmapEditor,fonts:e.fonts}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor&&e.fonts===t.fonts},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor&&e.fonts===t.fonts}})(Object(St.a)(Ct)),kt=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},xt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onPageWidthChanged",value:function(e){this.props.dispatch(Object(P.Kb)(e))}},{key:"onPageHeightChanged",value:function(e){this.props.dispatch(Object(P.Jb)(e))}},{key:"onElementLevelChanged",value:function(e){this.props.dispatch(Object(P.Ab)(e.target.value))}},{key:"renderElementLevel",value:function(e,t){return d.createElement(Me.a,{fullWidth:!0,style:{marginTop:20}},d.createElement(Ie.a,{htmlFor:"level-attribute-select"},this.props.i18n.t("Уровень")),d.createElement(ke.a,{value:this.props.pages[t].elements.indexOf(e).toString(),onChange:this.onElementLevelChanged,style:{width:60},inputProps:{id:"level-attribute-select"}},this.props.pages[t].elements.map(function(e,t){return d.createElement(Ce.a,{key:e.ownId.value.toString(),value:t},t.toString())})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.activeElementId,i=t.pages,o=t.activePageIndex;return n.zip(o).flatMap(function(t){var n=t._2,o=t._1.value;return Object(ee.headOption)(i[n].elements.filter(function(e){return e.ownId.value===o})).map(function(t){return d.createElement(M.a,{className:e.props.className},d.createElement("div",{style:{display:"flex",flexDirection:"column"}},d.createElement("div",{style:{display:"flex"}},d.createElement(Qe,{element:t,onInputBlur:e.props.onInputBlur,onInputFocus:e.props.onInputFocus}),t.position instanceof E.ElementPositionAbsolutePosition&&d.createElement(nt,{element:t,onInputBlur:e.props.onInputBlur,onInputFocus:e.props.onInputFocus}),d.createElement("div",null,e.renderElementLevel(t,n))),t.display instanceof E.SeatmapElementDisplayParagraph&&d.createElement(jt,{element:t,onInputBlur:e.props.onInputBlur,onInputFocus:e.props.onInputFocus}),t.display instanceof E.SeatmapElementDisplayImage&&d.createElement(We,{element:t,onInputBlur:e.props.onInputBlur,onInputFocus:e.props.onInputFocus})))})}).getOrNull()}}]),t}(d.Component);xt=kt([m.autobind],xt);var Mt=Object(f.connect)(function(e){return{i18n:e.i18n,pages:e.seatmapEditor.pages,activeElementId:e.seatmapEditor.activeElementId,activePageIndex:e.seatmapEditor.activePageIndex}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.pages===t.pages&&Object(ee.isEqual)(e.activeElementId,t.activeElementId)&&Object(ee.isEqual)(e.activePageIndex,t.activePageIndex)}})(xt),Pt=n(51),It=n(557),_t=n(190),zt=n.n(_t),Rt=n(804),Tt=n(183),Dt=(n(2342),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r}),Ft=function(e){var t=e.getData().get("text-align");if(!t)return"DocumentTemplate-TextEditor__textAlignLeft";switch(t){case"center":return"DocumentTemplate-TextEditor__textAlignCenter";case"left":return"DocumentTemplate-TextEditor__textAlignLeft";case"right":return"DocumentTemplate-TextEditor__textAlignRight";case"justify":return"DocumentTemplate-TextEditor__textAlignJustify";default:return"DocumentTemplate-TextEditor__textAlignLeft"}},At={},Bt={},Nt=Object.assign({},At,Bt),Lt=new it.CompositeDecorator([]),Ut=function(e){var t={};return e.toJS().forEach(function(e){e.indexOf("color")>=0&&(t.color=e.slice("fontcolor-".length)),e.indexOf("transform")>=0&&(t.textTransform=e.slice("texttransform-".length)),e.indexOf("fontsize")>=0&&(t.fontSize=e.slice("fontsize-".length)+"pt"),e.indexOf("fontfamily")>=0&&(t.fontFamily=e.slice("fontfamily-".length))}),t},Ht=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"componentWillMount",value:function(){var e=void 0;e=this.props.paragraph.body.length>0?Object(Rt.a)(this.props.paragraph.body,Lt):it.EditorState.createWithContent(it.ContentState.createFromText(this.props.i18n.t("Текст надписи")),Lt),this.handleEditorStateChange(e)}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.seatmapEditor.textEditorState.editorState.map(function(n){return e.seatmapEditor.textEditorState.editorState.map(function(e){e===n||t.props.onChange(e)})})}},{key:"handleEditorStateChange",value:function(e){this.props.dispatch(Object(P.Yb)(e))}},{key:"handleKeyCommand",value:function(e){var t=this;return this.props.seatmapEditor.textEditorState.editorState.map(function(n){var i=it.RichUtils.handleKeyCommand(n,e);return i?(t.handleEditorStateChange(i),Tt.a):Tt.b}).getOrElse(function(){throw new Error("editorState hasn't initialized")})}},{key:"handleBeforeInput",value:function(e){return this.props.seatmapEditor.textEditorState.editorState.map(function(e){var t=e.getSelection(),n=t.getAnchorKey(),i=e.getCurrentContent().getBlockForKey(n),o=t.getStartOffset();return i.getEntityAt(o-1)&&i.getEntityAt(o)&&0!==o&&i.getEntityAt(o-1)===i.getEntityAt(o)?Tt.a:Tt.b}).getOrElse(function(){return Tt.b})}},{key:"setBlockData",value:function(e){return this.props.seatmapEditor.textEditorState.editorState.map(function(t){var n=t.getCurrentContent(),i=t.getSelection(),o=it.Modifier.setBlockData(n,i,e);return it.EditorState.push(t,o,"change-block-data")}).getOrElse(function(){throw new Error("editorState hasn't initialized")})}},{key:"toggleCustomInlineStyle",value:function(e){return this.props.seatmapEditor.textEditorState.editorState.map(function(t){return it.RichUtils.toggleInlineStyle(t,e)}).getOrElse(function(){throw new Error("editorState hasn't initialized")})}},{key:"onColorPopoverClose",value:function(){this.props.dispatch(Object(P.Wb)())}},{key:"onColorSelect",value:function(e){var t="fontcolor-"+e.hex;this.props.dispatch(Object(P.Vb)(Object(ee.toOption)(e.hex))),this.onColorPopoverClose(),this.handleEditorStateChange(this.toggleCustomInlineStyle(t))}},{key:"render",value:function(){var e=this;return d.createElement("div",{style:{position:"relative"}},this.props.seatmapEditor.textEditorState.colorPopover.open&&d.createElement(zt.a,{open:this.props.seatmapEditor.textEditorState.colorPopover.open,anchorEl:this.props.seatmapEditor.textEditorState.colorPopover.anchorElement.getOrElse(function(){throw"popover anchor hasn't been provided"}),anchorOrigin:{horizontal:"left",vertical:"bottom"},transformOrigin:{horizontal:"left",vertical:"top"},onClose:this.onColorPopoverClose},d.createElement(It.SketchPicker,{color:{hex:this.props.seatmapEditor.textEditorState.colorPopover.color.getOrElse(function(){return"#000"})},onChangeComplete:this.onColorSelect})),d.createElement("div",{style:this.props.style},this.props.seatmapEditor.textEditorState.editorState.map(function(t){return d.createElement(it.Editor,{editorState:t,customStyleMap:Nt,customStyleFn:Ut,blockStyleFn:Ft,handleKeyCommand:e.handleKeyCommand,handleBeforeInput:e.handleBeforeInput,onChange:e.handleEditorStateChange})}).getOrNull()))}}]),t}(d.Component);Ht=Dt([m.autobind],Ht);var $t=Object(f.connect)(function(e){return{i18n:e.i18n,form:e.currentForm,forms:e.forms,fonts:e.fonts,seatmapEditor:e.seatmapEditor}})(Ht),Yt=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},qt=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onTextEditorChange",value:function(e){var t=this,n=Object(it.convertToRaw)(e.getCurrentContent());Object(ee.headOption)(n.blocks).foreach(function(e){var i,o,a;t.props.dispatch(Object(P.Lb)({body:(i=n,o=t.props.fonts.list,a=Object(ee.headOption)(o).flatMap(function(e){return Object(ee.headOption)(e.fonts)}).getOrElse(function(){throw new Error("There's no fonts")}),i.blocks.map(function(e){var t=function(t){return Object(ee.headOption)(e.entityRanges.filter(function(e){return e.offset<=t&&t<e.offset+e.length})).map(function(e){return e.key})},n=e.inlineStyleRanges.reduce(function(e,t){for(var n=t.offset;n<t.length+t.offset;n++)e[n]?e[n].push(t.style):e[n]=[t.style];return e},[]);return(""===e.text?[{text:"",styles:n[0]?n[0]:[],entityKey:t(0)}]:e.text.split("").reduce(function(e,i,o){var a=[];n[o]&&(a=a.concat(n[o]));var r=t(o);if(0===o)e.push({text:i,styles:a,entityKey:r});else{var s=e[e.length-1];r.map(function(t){s.entityKey.filter(function(e){return e===t}).map(function(){s.text+=i}).getOrElse(function(){e.push({text:i,styles:a,entityKey:r})})}).getOrElse(function(){s.entityKey.isEmpty()&&s.styles.length===a.length&&s.styles.filter(function(e){return a.indexOf(e)>=0}).length===a.length?s.text+=i:e.push({text:i,styles:a,entityKey:r})})}return e},[])).map(function(e){var t=new E.SeatmapElementDataSourceStaticValue(e.text),n=e.entityKey.flatMap(function(e){return Object(ee.liftKey)(i.entityMap,e.toString())}).flatMap(function(e){return e.data.substringEffect?e.data.substringEffect:new ee.None}),r=new E.SeatmapElementDisplayTextChunk(t,new E.ElementFont(a),n.map(function(e){return[e]}).getOrElse(function(){return[]}));return e.styles.forEach(function(e){if(0===e.indexOf("fontfamily-")){var t=e.slice("fontfamily-".length);E.ElementFont.getFontFile(o,t).foreach(function(e){r=W(r,{font:{font:{$set:e}}})})}if(0===e.indexOf("fontsize-")){var n=e.slice("fontsize-".length);r=W(r,{font:{fontSize:{$set:parseFloat(n)}}})}if(0===e.indexOf("fontcolor-")){var i=e.slice("fontcolor-".length);r=W(r,{font:{color:{$set:i}}})}if(0===e.indexOf("texttransform-")){var a=e.slice("texttransform-".length),s=void 0;switch(a){case"uppercase":s=new E.SeatmapElementDisplayEffectToUppercase;break;case"lowercase":s=new E.SeatmapElementDisplayEffectToLowercase;break;case"capitalize":s=new E.SeatmapElementDisplayEffectToCapitalize}"none"!==a&&(r=W(r,{effects:{$push:[s]}})),"none"===a&&(r=W(r,{effects:{$set:[]}}))}"BOLD"===e&&(r=W(r,{font:{isBold:{$set:!0}}})),"ITALIC"===e&&(r=W(r,{font:{isItalic:{$set:!0}}})),"UNDERLINE"===e&&(r=r=W(r,{font:{isUnderlined:{$set:!0}}}))}),r})}).reduce(function(e,t){return e.concat(t).concat(new E.SeatmapElementDisplayTextChunk(new E.SeatmapElementDataSourceStaticValue(String.fromCharCode(10)),new E.ElementFont(a),[]))},[]).slice(0,-1))})),e.data instanceof Object&&Object(ee.toOption)(e.data["text-align"]).foreach(function(e){return t.props.dispatch(Object(P.xb)(t.getHorizontalAlignment(e)))})})}},{key:"getHorizontalAlignment",value:function(e){switch(e){case"center":return new E.ElementHorizontalAlignmentCentered;case"left":return new E.ElementHorizontalAlignmentLeft;case"right":return new E.ElementHorizontalAlignmentRight;case"justify":return new E.ElementHorizontalAlignmentJustified;default:throw"uknown alignment"}}},{key:"render",value:function(){var e=this,t=this.props.seatmapEditor.pages[this.props.pageIdx];return t&&this.props.seatmapEditor.sceneState.doubleClicked?this.props.seatmapEditor.activeElementId.flatMap(function(n){return Object(ee.headOption)(t.elements.filter(function(e){return e.ownId.value===n.value})).filter(function(e){return e.display.tpe.value===E.SeatmapElementDisplayParagraph.$Type.value}).map(function(t){var n=t.rotation,i=t.position,o=e.props.seatmapEditor.pixelRatio,a=t.size.width*o/2,r=t.size.height*o/2,s=e.props.seatmapEditor.scale,l=a*s-a,c=r*s-r,p=t.display.lineSpacing.getOrElse(function(){return 1.2});return d.createElement("div",{style:{width:2*a+"px",height:2*r+"px",position:"absolute",top:i.y*s*o+"px",left:i.x*s*o+"px",transform:"rotate("+n+"deg)"},onMouseDown:function(e){return e.stopPropagation()}},d.createElement($t,{style:{transform:"translate("+l+"px, "+c+"px) scale("+s+", "+s+")",backgroundColor:"#fff",width:2*a+"px",height:2*r+"px",lineHeight:p,fontSize:"12pt",overflow:"hidden",background:"rgba(255, 255, 255, 0)"},refFields:[],fields:e.props.currentForm.data.flatMap(function(t){return Object(ee.liftKey)(e.props.fields.list,t.id.value)}).getOrElse(function(){return[]}),paragraph:t.display,onChange:e.onTextEditorChange}))})}).getOrNull():null}}]),t}(d.Component);qt=Yt([m.autobind],qt);var Xt=Object(f.connect)(function(e){return{i18n:e.i18n,seatmapEditor:e.seatmapEditor,fonts:e.fonts,fields:e.fields,currentForm:e.currentForm}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor&&e.fonts===t.fonts&&e.fields===t.fields&&e.currentForm===t.currentForm},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor&&e.fonts===t.fonts&&e.fields===t.fields&&e.currentForm===t.currentForm}})(qt),Wt=n(290),Vt=n(4),Kt=n.n(Vt),Jt=n(803),Gt=n(615),Zt=n(805),Qt=n(806),en=n(807),tn=n(56),nn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){var e=this;return this.props.drawingContext.map(function(t){var n;return Object(tn.b)(t.drawingContext)((n={},Kt()(n,P.a.Line,t.startPoint.zip(t.endPoint).map(function(t){return d.createElement(Zt.a,{points:[t._1.pointX,t._1.pointY,t._2.pointX,t._2.pointY],element:new ee.None,decorateCreatedComponent:e.props.decorateCreatedComponent})}).getOrNull()),Kt()(n,P.a.Paragaph,d.createElement(Jt.a,{startAtOpt:t.startPoint,endAtOpt:t.endPoint,element:new ee.None,decorateCreatedComponent:e.props.decorateCreatedComponent})),Kt()(n,P.a.Rect,d.createElement(Gt.a,{startAtOpt:t.startPoint,endAtOpt:t.endPoint,element:new ee.None,decorateCreatedComponent:e.props.decorateCreatedComponent})),Kt()(n,P.a.Image,d.createElement(Qt.a,{startAtOpt:t.startPoint,endAtOpt:t.endPoint,element:new ee.None,decorateCreatedComponent:e.props.decorateCreatedComponent})),Kt()(n,P.a.Circle,d.createElement(en.a,{startAtOpt:t.startPoint,endAtOpt:t.endPoint,element:new ee.None,decorateCreatedComponent:e.props.decorateCreatedComponent})),n)).getOrNull()}).getOrNull()}}]),t}(d.Component),on=Object(f.connect)(function(e){return{i18n:e.i18n,drawingContext:e.seatmapEditor.drawingContext}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.drawingContext===t.drawingContext}})(nn),an=(n(2344),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r}),rn=function(e){function t(){o()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.width=40,e.height=40,e}return p()(t,e),r()(t,[{key:"onMouseDown",value:function(e){e.preventDefault(),this.props.onSelect(e,this.onResize)}},{key:"onMouseUp",value:function(e){e.preventDefault(),this.props.onUnselect(e)}},{key:"onMouseMove",value:function(e){e.preventDefault(),this.props.onMove(e)}},{key:"onResize",value:function(e,t){}},{key:"getX",value:function(){return 0}},{key:"getY",value:function(){return 0}},{key:"render",value:function(){return d.createElement("a",{className:"Anchor__resize",style:{width:this.width+"px",height:this.height+"px",borderRadius:"50%",top:this.getY()+"px",left:this.getX()+"px"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove})}}]),t}(d.Component),sn=rn=an([m.autobind],rn),ln=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},cn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((90-this.props.element.rotation+a)*Math.PI/180)-e.initialElementSize.width/2,s=o*Math.cos((this.props.element.rotation-a)*Math.PI/180)-e.initialElementSize.height/2,l=n+e.initialElementSize.width*Math.cos(this.props.element.rotation*Math.PI/180)/2-e.initialElementSize.height*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-(r+e.initialElementSize.width)*Math.cos(this.props.element.rotation*Math.PI/180)/2+(s+e.initialElementSize.height)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,c=i+e.initialElementSize.width*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+e.initialElementSize.height*Math.cos(this.props.element.rotation*Math.PI/180)/2-(r+e.initialElementSize.width)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-(s+e.initialElementSize.height)*Math.cos(this.props.element.rotation*Math.PI/180)/2,p=e.initialElementSize.width+r,u=e.initialElementSize.height+s;if(this.props.element.size.aspectRatio){var h=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.wb)(u+r/h)),this.props.dispatch(Object(P.Fb)(p+s*h))}else this.props.dispatch(Object(P.Fb)(p)),this.props.dispatch(Object(P.wb)(u));this.props.dispatch(Object(P.lb)(l-p/2)),this.props.dispatch(Object(P.Bb)(c-u/2))}},{key:"getX",value:function(){return-this.width/2}},{key:"getY",value:function(){return-this.height/2}}]),t}(sn),pn=cn=ln([m.autobind],cn),un=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},hn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((a-this.props.element.rotation)*Math.PI/180)-e.initialElementSize.height/2,s=n-e.initialElementSize.height*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+(r+e.initialElementSize.height)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,l=i+e.initialElementSize.height*Math.cos(this.props.element.rotation*Math.PI/180)/2-(r+e.initialElementSize.height)*Math.cos(this.props.element.rotation*Math.PI/180)/2,c=e.initialElementSize.height+r;if(this.props.dispatch(Object(P.wb)(c)),this.props.element.size.aspectRatio){var p=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.Fb)(c*p))}this.props.dispatch(Object(P.lb)(s-e.initialElementSize.width/2)),this.props.dispatch(Object(P.Bb)(l-c/2))}},{key:"getX",value:function(){return this.props.element.size.width*this.props.scale/2-this.width/2}},{key:"getY",value:function(){return-this.height/2}}]),t}(sn),dn=hn=un([m.autobind],hn),fn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},mn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((90+this.props.element.rotation-a)*Math.PI/180)-e.initialElementSize.width/2,s=o*Math.cos((a-this.props.element.rotation)*Math.PI/180)-e.initialElementSize.height/2,l=n-e.initialElementSize.width*Math.cos(this.props.element.rotation*Math.PI/180)/2-e.initialElementSize.height*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+(r+e.initialElementSize.width)*Math.cos(this.props.element.rotation*Math.PI/180)/2+(s+e.initialElementSize.height)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,c=i-e.initialElementSize.width*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+e.initialElementSize.height*Math.cos(this.props.element.rotation*Math.PI/180)/2+(r+e.initialElementSize.width)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-(s+e.initialElementSize.height)*Math.cos(this.props.element.rotation*Math.PI/180)/2,p=e.initialElementSize.width+r,u=e.initialElementSize.height+s;if(this.props.element.size.aspectRatio){var h=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.wb)(u+r/h)),this.props.dispatch(Object(P.Fb)(p+s*h))}else this.props.dispatch(Object(P.Fb)(p)),this.props.dispatch(Object(P.wb)(u));this.props.dispatch(Object(P.lb)(l-p/2)),this.props.dispatch(Object(P.Bb)(c-u/2))}},{key:"getX",value:function(){return this.props.element.size.width*this.props.scale-this.width/2}},{key:"getY",value:function(){return-this.height/2}}]),t}(sn),gn=mn=fn([m.autobind],mn),vn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},En=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((this.props.element.rotation-(90+a))*Math.PI/180)-e.initialElementSize.width/2,s=o*Math.cos((180-this.props.element.rotation+a)*Math.PI/180)-e.initialElementSize.height/2,l=n+e.initialElementSize.width*Math.cos(this.props.element.rotation*Math.PI/180)/2+e.initialElementSize.height*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-(r+e.initialElementSize.width)*Math.cos(this.props.element.rotation*Math.PI/180)/2-(s+e.initialElementSize.height)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,c=i+e.initialElementSize.width*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-e.initialElementSize.height*Math.cos(this.props.element.rotation*Math.PI/180)/2-(r+e.initialElementSize.width)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+(s+e.initialElementSize.height)*Math.cos(this.props.element.rotation*Math.PI/180)/2,p=e.initialElementSize.width+r,u=e.initialElementSize.height+s;if(this.props.element.size.aspectRatio){var h=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.wb)(u+r/h)),this.props.dispatch(Object(P.Fb)(p+s*h))}else this.props.dispatch(Object(P.Fb)(p)),this.props.dispatch(Object(P.wb)(u));this.props.dispatch(Object(P.lb)(l-p/2)),this.props.dispatch(Object(P.Bb)(c-u/2))}},{key:"getX",value:function(){return-this.width/2}},{key:"getY",value:function(){return this.props.element.size.height*this.props.scale-this.height/2}}]),t}(sn),yn=En=vn([m.autobind],En),bn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},On=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((this.props.element.rotation-(a+180))*Math.PI/180)-e.initialElementSize.height/2,s=n+e.initialElementSize.height*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-(r+e.initialElementSize.height)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,l=i-e.initialElementSize.height*Math.cos(this.props.element.rotation*Math.PI/180)/2+(r+e.initialElementSize.height)*Math.cos(this.props.element.rotation*Math.PI/180)/2,c=e.initialElementSize.height+r;if(this.props.dispatch(Object(P.wb)(c)),this.props.element.size.aspectRatio){var p=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.Fb)(c*p))}this.props.dispatch(Object(P.lb)(s-e.initialElementSize.width/2)),this.props.dispatch(Object(P.Bb)(l-c/2))}},{key:"getX",value:function(){return this.props.element.size.width*this.props.scale/2-this.width/2}},{key:"getY",value:function(){return this.props.element.size.height*this.props.scale-this.height/2}}]),t}(sn),Sn=On=bn([m.autobind],On),wn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Cn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((a-90-this.props.element.rotation)*Math.PI/180)-e.initialElementSize.width/2,s=o*Math.cos((180-a+this.props.element.rotation)*Math.PI/180)-e.initialElementSize.height/2,l=n-e.initialElementSize.width*Math.cos(this.props.element.rotation*Math.PI/180)/2+e.initialElementSize.height*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+(r+e.initialElementSize.width)*Math.cos(this.props.element.rotation*Math.PI/180)/2-(s+e.initialElementSize.height)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,c=i-e.initialElementSize.width*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-e.initialElementSize.height*Math.cos(this.props.element.rotation*Math.PI/180)/2+(r+e.initialElementSize.width)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+(s+e.initialElementSize.height)*Math.cos(this.props.element.rotation*Math.PI/180)/2,p=e.initialElementSize.width+r,u=e.initialElementSize.height+s;if(this.props.element.size.aspectRatio){var h=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.wb)(u+r/h)),this.props.dispatch(Object(P.Fb)(p+s*h))}else this.props.dispatch(Object(P.Fb)(p)),this.props.dispatch(Object(P.wb)(u));this.props.dispatch(Object(P.lb)(l-p/2)),this.props.dispatch(Object(P.Bb)(c-u/2))}},{key:"getX",value:function(){return this.props.element.size.width*this.props.scale-this.width/2}},{key:"getY",value:function(){return this.props.element.size.height*this.props.scale-this.height/2}}]),t}(sn),jn=Cn=wn([m.autobind],Cn),kn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},xn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((a-90-this.props.element.rotation)*Math.PI/180)-e.initialElementSize.width/2,s=n-e.initialElementSize.width*Math.cos(this.props.element.rotation*Math.PI/180)/2+(r+e.initialElementSize.width)*Math.cos(this.props.element.rotation*Math.PI/180)/2,l=i-e.initialElementSize.width*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2+(r+e.initialElementSize.width)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,c=e.initialElementSize.width+r;if(this.props.dispatch(Object(P.Fb)(c)),this.props.element.size.aspectRatio){var p=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.wb)(c/p))}this.props.dispatch(Object(P.lb)(s-c/2)),this.props.dispatch(Object(P.Bb)(l-e.initialElementSize.height/2))}},{key:"getX",value:function(){return this.props.element.size.width*this.props.scale-this.width/2}},{key:"getY",value:function(){return this.props.element.size.height*this.props.scale/2-this.height/2}}]),t}(sn),Mn=xn=kn([m.autobind],xn),Pn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},In=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2,o=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=-180*Math.atan2(n-t.x,i-t.y)/Math.PI,r=o*Math.cos((90+a-this.props.element.rotation)*Math.PI/180)-e.initialElementSize.width/2,s=n+e.initialElementSize.width*Math.cos(this.props.element.rotation*Math.PI/180)/2-(r+e.initialElementSize.width)*Math.cos(this.props.element.rotation*Math.PI/180)/2,l=i+e.initialElementSize.width*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2-(r+e.initialElementSize.width)*Math.cos((90-this.props.element.rotation)*Math.PI/180)/2,c=e.initialElementSize.width+r;if(this.props.dispatch(Object(P.Fb)(c)),this.props.element.size.aspectRatio){var p=this.props.element.size.width/this.props.element.size.height;this.props.dispatch(Object(P.wb)(c/p))}this.props.dispatch(Object(P.lb)(s-c/2)),this.props.dispatch(Object(P.Bb)(l-e.initialElementSize.height/2))}},{key:"getX",value:function(){return-this.width/2}},{key:"getY",value:function(){return this.props.element.size.height*this.props.scale/2-this.height/2}}]),t}(sn),_n=In=Pn([m.autobind],In),zn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Rn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onResize",value:function(e,t){var n=e.initialElementPosition.pointX+e.initialElementSize.width/2,i=e.initialElementPosition.pointY+e.initialElementSize.height/2;this.props.dispatch(Object(P.Cb)(-180*Math.atan2(n-t.x,i-t.y)/Math.PI))}},{key:"getX",value:function(){return this.props.element.size.width*this.props.scale/2-this.width/2}},{key:"getY",value:function(){return-60}},{key:"render",value:function(){return d.createElement("a",{className:"Anchor__rotate",style:{width:this.width+"px",height:this.height+"px",borderRadius:"50%",top:this.getY()+"px",left:this.getX()+"px"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove},d.createElement("svg",{className:"Anchor__rotation-icon",viewBox:"0 0 10 12"},d.createElement("path",{fill:"#3F4652",d:"M5,0C2.2,0,0,2.2,0,5h2c0-1.7,1.3-3,3-3s3,1.3,3,3S6.7,8,5,8V6L2,9l3,3v-2c2.8,0,5-2.2,5-5 S7.8,0,5,0z"})))}}]),t}(sn),Tn=Rn=zn([m.autobind],Rn),Dn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Fn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"handleStateUpdate",value:function(e){return this.props.dispatch(Object(P.Ob)(e))}},{key:"onAnchorSelect",value:function(e,t){var n=this;e.stopPropagation(),this.props.stage.foreach(function(i){var o=i.getClientRects()[0],a=e.clientX-o.left,r=e.clientY-o.top,s=n.props.seatmapEditor.pixelRatio,l=n.props.seatmapEditor.scale;n.props.seatmapEditor.activeElementId.map(function(e){return Object(ee.toOption)(n.props.seatmapEditor.activePageIndex.map(function(t){return n.props.seatmapEditor.pages[t].elements.find(function(t){return t.ownId.value===e.value})}).getOrElse(function(){})).map(function(e){n.handleStateUpdate(W(n.props.seatmapEditor.sceneState,{onResize:{$set:t},anchorContext:{$set:new ee.Some({anchorId:"",originalPoint:{pointX:a/(l*s),pointY:r/(l*s)},initialElementPosition:{pointX:e.position.x,pointY:e.position.y},initialElementSize:e.size})}}))}).getOrNull()}).getOrNull(),n.props.seatmapEditor.draggingContext.foreach(function(e){n.props.dispatch(Object(P.eb)({pointX:a/(l*s),pointY:r/(l*s)}))})})}},{key:"onAnchorUnselect",value:function(e){this.handleStateUpdate(W(this.props.seatmapEditor.sceneState,{onResize:{$set:null},anchorContext:{$set:new ee.None}}))}},{key:"onAnchorMove",value:function(e){var t=this;e.stopPropagation(),this.props.stage.foreach(function(n){var i=n.getClientRects()[0],o=e.clientX-i.left,a=e.clientY-i.top,r=t.props.seatmapEditor.scale,s=t.props.seatmapEditor.pixelRatio;t.props.seatmapEditor.sceneState.anchorContext.map(function(e){t.props.seatmapEditor.sceneState.onResize(e,{x:o/(r*s),y:a/(r*s)})})})}},{key:"renderDefaultResizeFrame",value:function(e){var t=this,n=e.rotation,i=e.position,o=e.size.width/2,a=e.size.height/2,r=this.props.seatmapEditor.scale,s=this.props.seatmapEditor.pixelRatio;return d.createElement("div",{key:e.ownId.value.toString(),style:{position:"absolute",width:2*o*(r*s)+"px",height:2*a*(r*s)+"px",top:i.y*(r*s)+"px",left:i.x*(r*s)+"px",transform:"rotate("+n+"deg)",border:"1px solid #000",boxSizing:"border-box"}},d.createElement("div",{style:{position:"absolute",width:2*o*(r*s)+"px",height:2*a*(r*s)+"px",top:"0px",left:"0px"},onMouseDown:function(n){return t.props.onTouchStarted(n,Object(ee.toOption)(e))},onMouseMove:function(e){return t.props.onTouchMove(e)},onMouseUp:this.props.onTouchEnded}),d.createElement(pn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(dn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(gn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(yn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(Sn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(jn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(Mn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(_n,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}),d.createElement(Tn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:r*s,dispatch:this.props.dispatch}))}},{key:"renderSectionResizeFrame",value:function(e){var t=this,n=e.rotation,i=e.position,o=this.props.seatmapEditor.scale,a=this.props.seatmapEditor.pixelRatio;return d.createElement("div",{key:e.ownId.value.toString(),style:{position:"absolute",width:"10px",height:"10px",top:i.y*(o*a)+"px",left:i.x*(o*a)+"px",transform:"rotate("+n+"deg)"}},d.createElement("div",{style:{position:"absolute",width:"10px",height:"10px",top:"0px",left:"0px"},onMouseDown:function(n){return t.props.onTouchStarted(n,Object(ee.toOption)(e))},onMouseMove:function(e){return t.props.onTouchMove(e)},onMouseUp:this.props.onTouchEnded}),d.createElement(Tn,{onSelect:this.onAnchorSelect,onUnselect:this.props.onTouchEnded,onMove:this.onAnchorMove,element:e,scale:o*a,dispatch:this.props.dispatch}))}},{key:"render",value:function(){var e=this;return this.props.seatmapEditor.activeElementId.flatMap(function(t){return Object(ee.headOption)(e.props.page.elements.filter(function(e){return e.ownId.value===t.value})).map(function(t){switch(t.display.tpe.value){case E.SeatmapElementDisplayImage.$Type.value:case E.SeatmapElementDisplayParagraph.$Type.value:case E.SeatmapElementDisplayObject.$Type.value:case E.SeatmapElementDisplayCircle.$Type.value:case E.SeatmapElementDisplayTable.$Type.value:case E.SeatmapElementDisplayRect.$Type.value:return e.renderDefaultResizeFrame(t);case E.SeatmapElementDisplaySection.$Type.value:return e.renderSectionResizeFrame(t)}})}).getOrNull()}}]),t}(d.Component);Fn=Dn([m.autobind],Fn);var An=Object(f.connect)(function(e){return{i18n:e.i18n,seatmapEditor:e.seatmapEditor}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor}})(Fn),Bn=(n(2346),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r}),Nn=function(e){function t(){o()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.stage=new ee.None,e}return p()(t,e),r()(t,[{key:"componentWillMount",value:function(){document.addEventListener("keydown",this.onKeyDown),document.addEventListener("mousemove",this.onTouchMove)}},{key:"componentWillUnmount",value:function(){this.stage=new ee.None,document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("mousemove",this.onTouchMove)}},{key:"onKeyDown",value:function(e){if(this.props.seatmapEditor.sceneState.doubleClicked||this.props.seatmapEditor.inputFocused)return null;switch(e.keyCode){case 8:case 46:this.onElementDeleted();break;case 37:e.preventDefault(),this.onMoveLeft();break;case 38:e.preventDefault(),this.onMoveUp();break;case 39:e.preventDefault(),this.onMoveRight();break;case 40:e.preventDefault(),this.onMoveDown()}}},{key:"onElementDeleted",value:function(){this.props.dispatch(Object(P.sb)())}},{key:"handleStateUpdate",value:function(e){return this.props.dispatch(Object(P.Ob)(e))}},{key:"decorateCreatedComponent",value:function(e,t){var n=this;return d.cloneElement(e,{key:t.map(function(e){return e.ownId.value}).getOrUndefined(),onMouseDown:function(e){return n.onTouchStarted(e,t)},onMouseUp:function(e){return n.onTouchEnded(e)}})}},{key:"onTouchStarted",value:function(e,t){var n=this;e.stopPropagation(),this.stage.foreach(function(i){var o=i.getClientRects()[0],a=n.props.seatmapEditor.scale,r=n.props.seatmapEditor.pixelRatio,s=e.clientX-o.left,l=e.clientY-o.top;(t||new ee.None).map(function(e){n.handleStateUpdate(W(n.props.seatmapEditor.sceneState,{doubleClicked:{$set:n.props.seatmapEditor.sceneState.clickedElementId===e.ownId.value||n.props.seatmapEditor.sceneState.doubleClickedId===e.ownId.value},doubleClickedId:{$set:(n.props.seatmapEditor.sceneState.clickedElementId===e.ownId.value||n.props.seatmapEditor.sceneState.doubleClickedId===e.ownId.value)&&e.ownId.value},clickedElementId:{$set:e.ownId.value}})),setTimeout(function(){n.props.seatmapEditor.activeElementId.foreach(function(e){e&&n.handleStateUpdate(W(n.props.seatmapEditor.sceneState,{clickedElementId:{$set:""}}))})},250),n.props.seatmapEditor.activeElementId.map(function(t){t.value!=e.ownId.value&&n.props.dispatch(Object(P.Eb)(e.ownId))}).getOrElse(function(){return n.props.dispatch(Object(P.Eb)(e.ownId))}),n.props.dispatch(Object(P.gb)({draggingContext:e.ownId,startedAt:(new Date).getTime(),originalPoint:new ee.Some({pointX:s/(a*r),pointY:l/(a*r)}),currentPoint:new ee.Some({pointX:s/(a*r),pointY:l/(a*r)}),initialElementPosition:new ee.Some({pointX:e.position.x,pointY:e.position.y})}))}).getOrElse(function(){n.handleStateUpdate(W(n.props.seatmapEditor.sceneState,{doubleClicked:{$set:!1},clickedElementId:{$set:""},doubleClickedId:{$set:""}})),n.props.dispatch(Object(P.Eb)(new E.DisplayElementId)),n.props.seatmapEditor.selectedDrawingContext.map(function(e){n.props.dispatch(Object(P.hb)(e)),n.props.dispatch(Object(P.kb)({startPoint:new ee.Some({pointX:s/(a*r),pointY:l/(a*r)}),endPoint:new ee.Some({pointX:s/(a*r),pointY:l/(a*r)})}))})})})}},{key:"onTouchEnded",value:function(e){var t=this;e.stopPropagation(),this.stage.foreach(function(n){var i=n.getClientRects()[0],o=t.props.seatmapEditor.scale,a=t.props.seatmapEditor.pixelRatio;t.props.seatmapEditor.sceneState.anchorContext.map(function(n){return t.onAnchorUnselect(e)});var r={pointX:(e.clientX-i.left)/(o*a),pointY:(e.clientY-i.top)/(o*a)};t.props.dispatch(t.props.seatmapEditor.drawingContext.map(function(e){return Object(P.ib)(r)}).getOrElse(function(){return Object(P.eb)(r)}))})}},{key:"onTouchMove",value:function(e){var t=this;e.stopPropagation(),this.stage.foreach(function(n){var i=n.getClientRects()[0],o=e.clientX-i.left,a=e.clientY-i.top,r=t.props.seatmapEditor.scale,s=t.props.seatmapEditor.pixelRatio;t.props.seatmapEditor.sceneState.anchorContext.map(function(e){t.props.seatmapEditor.sceneState.onResize(e,{x:o/(r*s),y:a/(r*s)})}).getOrElse(function(){return t.props.seatmapEditor.drawingContext.map(function(e){t.props.dispatch(Object(P.jb)({pointX:o/(r*s),pointY:a/(r*s)}))}).getOrElse(function(){t.props.seatmapEditor.sceneState.doubleClicked||t.props.dispatch(Object(P.fb)({pointX:o/(r*s),pointY:a/(r*s)}))})})})}},{key:"onAnchorUnselect",value:function(e){this.handleStateUpdate(W(this.props.seatmapEditor.sceneState,{onResize:{$set:null},anchorContext:{$set:new ee.None}}))}},{key:"onAbscissaChanged",value:function(e){this.props.dispatch(Object(P.lb)(e))}},{key:"onOrdinateChanged",value:function(e){this.props.dispatch(Object(P.Bb)(e))}},{key:"onElementMoveY",value:function(e){var t=this;this.props.seatmapEditor.activePageIndex.foreach(function(n){t.props.seatmapEditor.activeElementId.foreach(function(i){Object(ee.headOption)(t.props.seatmapEditor.pages[n].elements.filter(function(e){return e.ownId.value===i.value})).foreach(function(n){t.onOrdinateChanged(n.position.y+e)})})})}},{key:"onElementMoveX",value:function(e){var t=this;this.props.seatmapEditor.activePageIndex.foreach(function(n){t.props.seatmapEditor.activeElementId.foreach(function(i){Object(ee.headOption)(t.props.seatmapEditor.pages[n].elements.filter(function(e){return e.ownId.value===i.value})).foreach(function(n){t.onAbscissaChanged(n.position.x+e)})})})}},{key:"onMoveUp",value:function(){this.onElementMoveY(-1)}},{key:"onMoveDown",value:function(){this.onElementMoveY(1)}},{key:"onMoveLeft",value:function(){this.onElementMoveX(-1)}},{key:"onMoveRight",value:function(){this.onElementMoveX(1)}},{key:"stageRefHandler",value:function(e){e&&(this.stage=new ee.Some(Pt.findDOMNode(e)))}},{key:"renderSceneArea",value:function(e){var t=this,n=this.props.seatmapEditor.pages[e],i=this.props.seatmapEditor.scale,o=this.props.seatmapEditor.pixelRatio;if(!n)return d.createElement("div",null," ");var a=o*(n.size.width*i-n.size.width)/2,r=o*(n.size.height*i-n.size.height)/2;return d.createElement("div",{ref:this.stageRefHandler,style:{position:"relative",width:n.size.width*i*o+"px",height:n.size.height*i*o+"px",textAlign:"left"}},d.createElement("div",{onMouseDown:function(e){return t.onTouchStarted(e,new ee.None)},onMouseUp:this.onTouchEnded,onMouseMove:function(e){return t.onTouchMove(e)},style:{position:"absolute",top:"0px",left:"0px",width:n.size.width*i*o+"px",height:n.size.height*i*o+" * pixelRatiopx"}}),d.createElement("div",{style:{position:"relative",width:n.size.width*o+"px",height:n.size.height*o+"px",transform:"translate("+a+"px, "+r+"px) scale("+i+", "+i+")"}},d.createElement("div",{onMouseDown:function(e){return t.onTouchStarted(e,new ee.None)},onMouseUp:this.onTouchEnded,onMouseMove:function(e){return t.onTouchMove(e)},style:{position:"relative",width:n.size.width*o+"px",height:n.size.height*o+"px"}}),n.elements.map(function(e){return d.createElement(Wt.a,{element:e,decorateCreatedComponent:t.decorateCreatedComponent})}),d.createElement(on,{decorateCreatedComponent:this.decorateCreatedComponent})),d.createElement(An,{page:n,stage:this.stage,onTouchStarted:this.onTouchStarted,onTouchEnded:this.onTouchEnded,onTouchMove:this.onTouchMove}))}},{key:"pixelRatioRefHandler",value:function(e){var t=this;e&&Object(ee.toOption)(Pt.findDOMNode(e)).foreach(function(e){return t.props.dispatch(Object(P.Mb)(e.clientHeight*window.devicePixelRatio/25))})}},{key:"renderPixelRatio",value:function(){return d.createElement("div",{ref:this.pixelRatioRefHandler,className:"SeatmapEditorScene__pixel-ratio"})}},{key:"render",value:function(){var e=this;return d.createElement("div",{className:this.props.className},this.props.seatmapEditor.activePageIndex.map(function(t){return d.createElement("div",{style:{position:"relative"}},e.renderPixelRatio(),e.renderSceneArea(t),d.createElement(Xt,{pageIdx:t}))}).getOrNull())}}]),t}(d.Component);Nn=Bn([m.autobind],Nn);var Ln=Object(f.connect)(function(e){return{i18n:e.i18n,seatmapEditor:e.seatmapEditor}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor}})(Object(I.a)(Nn)),Un=(n(2348),n(1772)),Hn=n.n(Un),$n=n(1773),Yn=n.n($n),qn=n(414),Xn=n.n(qn),Wn=(n(2350),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r}),Vn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"onScaleChange",value:function(e){this.props.scale<=.2&&!e||(e?this.props.dispatch(Object(P.Nb)(this.props.scale+.15)):this.props.dispatch(Object(P.Nb)(this.props.scale-.15)))}},{key:"onElementDeleted",value:function(){this.props.dispatch(Object(P.sb)())}},{key:"render",value:function(){var e=this;return d.createElement("div",{className:"SeatmapEditorNavigation"},d.createElement(v.a,{variant:"fab",mini:!0,className:"SeatmapEditorNavigation__navMargin",disabled:this.props.activePageIndex.isEmpty(),onClick:function(t){return e.onScaleChange(!0)}},d.createElement(Hn.a,null)),d.createElement(v.a,{variant:"fab",mini:!0,className:"SeatmapEditorNavigation__navMargin",disabled:this.props.activePageIndex.isEmpty(),onClick:function(t){return e.onScaleChange(!1)}},d.createElement(Yn.a,null)),d.createElement(v.a,{variant:"fab",mini:!0,className:"SeatmapEditorNavigation__navMargin",onClick:function(t){return e.onElementDeleted()}},d.createElement(Xn.a,null)))}}]),t}(d.Component);Vn=Wn([m.autobind],Vn);var Kn=Object(f.connect)(function(e){return{i18n:e.i18n,activePageIndex:e.seatmapEditor.activePageIndex,scale:e.seatmapEditor.scale}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.seatmapEditor===t.seatmapEditor},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.activePageIndex===t.activePageIndex&&e.scale===t.scale}})(Object(I.a)(Vn)),Jn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Gn=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"handleInputFocus",value:function(){this.props.dispatch(Object(P.Ib)())}},{key:"handleInputBlur",value:function(){this.props.dispatch(Object(P.Hb)())}},{key:"render",value:function(){var e=this;return d.createElement("div",{className:"SeatmapEditor__viewport"},d.createElement("div",{className:"SeatmapEditor__viewport-page-scene"},d.createElement(Se,{className:"SeatmapEditor__actionsMenu"}),d.createElement(M.a,{style:{overflow:"hidden",flex:"1 1 auto",position:"relative",height:"100%",display:"flex",flexDirection:"column",borderRadius:0}},d.createElement(Mt,{className:"SeatmapEditor__attributes",onInputBlur:this.handleInputBlur,onInputFocus:this.handleInputFocus}),d.createElement(M.a,{style:{padding:"200px 60px 80px 60px",textAlign:"center",flex:"1 1 auto",overflow:"auto",width:"100%",height:"100%",boxSizing:"border-box",position:"relative",border:"none",borderRadius:0},onMouseDown:function(){return e.props.dispatch(Object(P.Eb)(new E.DocumentElementId))}},d.createElement(Ln,{className:"SeatmapEditor__scene"}))),d.createElement(Kn,null)))}}]),t}(d.Component);Gn=Jn([m.autobind],Gn);var Zn=Object(f.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(I.a)(Gn)),Qn=n(1478),ei=n(21),ti=n(1896),ni=n(17),ii=n(655),oi=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ai=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ri=function(e){var t;e.dispatch(Object(b.h)(new E.Id(e.params.formId))),e.auth.token.foreach(function(t){return e.dispatch(Object(y.a)(t))}),e.dispatch((t=new E.Id(e.params.templateId),function(e){return e(Object(P.Qb)()),ni.a.send(new ti.e(t),Object(ei.e)()).then(function(t){return e(Object(P.Rb)(t.record)),t}).catch(function(t){throw e(Object(P.Pb)(t)),t})}))},si=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(C.a.screenInitialState(),{})))}return p()(t,e),r()(t,[{key:"renderNavigation",value:function(){return d.createElement(w.a,null)}},{key:"openSeatmapTemplatesPage",value:function(){this.props.dispatch(Object(S.Cb)())}},{key:"onSave",value:function(){var e=this;this.props.dispatch(function(e,t){return t().seatmapEditor.record.map(function(n){return e(Object(P.Sb)()),ni.a.send(new ti.f(W(n,{entity:{schema:{pages:{$set:t().seatmapEditor.pages},images:{$set:t().seatmapEditor.images}},updated:{$set:n.entity.updated}}})),Object(ei.f)()).then(function(t){return e(Object(P.Tb)()),t}).catch(function(t){throw e(Object(P.Ub)(t)),t})}).getOrElse(function(){return Promise.reject("no record context found")})}).then(function(t){return e.props.dispatch(Object(O.h)(e.props.i18n.t("Сохранено")))}).catch(function(t){return e.props.dispatch(Object(O.h)(e.props.i18n.t("Ошибка")))})}},{key:"render",value:function(){var e=this,t=this.props.i18n,n=this.props.templateName.getOrElse(function(){return e.props.i18n.t("Шаблон не найден")});return this.renderScreenBody({className:"formBlockPage"},d.createElement("div",{className:"SeatmapEditorPage"},d.createElement(Qn.a,{title:n,onGoBackRequested:this.openSeatmapTemplatesPage,rightButtonGroup:[d.createElement("div",null,d.createElement(v.a,{variant:"raised",style:{margin:"6px 24px"},onClick:this.onSave,color:"primary"},t.t("Сохранить")))]}),d.createElement(Zn,null)))}}]),t}(C.a);si=oi([m.autobind,ai("design:paramtypes",[Object])],si);t.default=Object(f.connect)(function(e){return{i18n:e.i18n,auth:e.auth,templateName:e.seatmapEditor.record.map(function(t){return e.i18n.t("Шаблон")+" "+t.entity.name}),seatMapImages:e.seatmapEditor.images}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.seatmapEditor===t.seatmapEditor},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.auth===t.auth&&e.seatMapImages===t.seatMapImages&&Object(ee.isEqual)(e.templateName,t.templateName)}})(Object(k.a)(Object(j.a)(function(e){e.isTokenChecked&&ri(e)},function(){},function(e,t){e.params.templateId!==t.params.templateId&&ri(e),e.params.templateId===t.params.templateId&&e.isTokenChecked&&!t.isTokenChecked&&ri(e),e.seatMapImages!==t.seatMapImages&&e.dispatch(Object(ii.a)(e.seatMapImages))})(si)))}}]);