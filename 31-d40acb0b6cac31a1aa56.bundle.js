(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[31,0,7],{1459:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return l});var i=n(79),r=n(104),o=n(82),a=function(){return function(e,t){return e(o.default.isA5000?Object(i.Mb)():Object(i.h)())}},l=function(e,t){return function(n,o){return o().eventLine.data.foreach(function(a){Object(r.e)(o().forms,e).foreach(function(r){n(Object(i.H)(a.id,r.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(2),d=n(14),f=n(1469),h=n(1459),m=n(320),g=n(69),v=n(0),y=n(624);t.a=function(e){return Object(d.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return r()(this,n),s()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u()(n,t),a()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(v.toOption)(this.props.routing.location).map(function(t){Object(v.liftKey)(Object(y.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(f.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(g.r)()),this.props.dispatch(Object(m.c)()),this.props.dispatch(Object(h.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?p.createElement(e,this.props):p.createElement("div",null)}}]),n}(p.Component)}(e))}},1467:function(e,t,n){"use strict";var i=n(10),r=n.n(i),o=n(7),a=n.n(o),l=n(8),s=n.n(l),c=n(6),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=(n(1601),function(e){function t(){return u()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.navigation,i=e.styles,r=e.className;return f.createElement("div",{ref:"content",className:"FullScreen"+(r?" "+r:""),style:i},f.createElement("div",{className:"FullScreen__top"},n),f.createElement("div",{className:"FullScreen__content"},t))}}]),t}(f.Component)),m=n(1474),g=n.n(m),v=n(190),y=n.n(v),b=n(24),E=n.n(b),O=n(863),k=n.n(O),C=n(13),j=n(0),T=(n(1603),n(3)),w=n(71),S=n(1592),I=n(14),R=n(325),P=n.n(R),x=n(19),_=n.n(x),L=n(386),D=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},A=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},F=function(e){function t(e){u()(this,t);var n=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={remainingReconnectionTime:new j.None,intervalId:new j.None},n}return s()(t,e),r()(t,[{key:"updateRemainingReconnectionTime",value:function(e){this.setState(T(this.state,{remainingReconnectionTime:{$set:this.getRemainingReconnectionTime(e)}}))}},{key:"startInterval",value:function(e){var t=this,n=setInterval(function(){t.updateRemainingReconnectionTime(e)},1e3);this.setState(T(this.state,{remainingReconnectionTime:{$set:this.getRemainingReconnectionTime(e)},intervalId:{$set:Object(j.toOption)(n)}}))}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=this;this.state.intervalId.foreach(function(t){clearInterval(t),e.setState(T(e.state,{remainingReconnectionTime:{$set:new j.None},intervalId:{$set:new j.None}}))})})},{key:"componentDidMount",value:function(){this.props.websocket.lastReconnectingTime.nonEmpty()&&this.startInterval(this.props),this.props.websocket.lastReconnectingTime.isEmpty()&&this.clearInterval()}},{key:"componentWillReceiveProps",value:function(e){this.props.websocket.lastReconnectingTime.isEmpty()&&e.websocket.lastReconnectingTime.nonEmpty()&&this.startInterval(e),this.props.websocket.lastReconnectingTime.nonEmpty()&&e.websocket.lastReconnectingTime.isEmpty()&&this.clearInterval()}},{key:"getRemainingReconnectionTime",value:function(e){return e.websocket.lastReconnectingTime.flatMap(function(t){return e.websocket.reconnectionTimeout.map(function(e){return(e-((new Date).getTime()-t))/1e3})})}},{key:"render",value:function(){var e=this;return f.createElement("div",null,this.props.websocket.reconnecting||this.state.remainingReconnectionTime.filter(function(e){return e<0}).nonEmpty()?this.props.i18n.t("Связь с сервером потеряна, идет восстановление соединения..."):this.props.i18n.t("Связь с сервером потеряна, до следующей попытки соединения")+this.state.remainingReconnectionTime.map(function(t){return" "+Math.round(t)+" "+e.props.i18n.t("сек.")}).getOrElse(function(){return""}))}}]),t}(f.Component);F=D([C.autobind,A("design:paramtypes",[Object])],F);var $=Object(I.connect)(function(e){return{websocket:e.websocket,i18n:e.i18n}})(F),W=function(e){function t(){return u()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),r()(t,[{key:"hideNotification",value:function(){this.props.dispatch(Object(w.f)())}},{key:"handleReconnect",value:function(){L.a.reconnect()}},{key:"render",value:function(){return f.createElement("div",null,f.createElement(P.a,{open:!this.props.active&&(this.props.websocketError.nonEmpty()||this.props.closed)&&!this.props.screenSnackbaropen,message:f.createElement($,null),autoHideDuration:0,action:this.props.reconnecting?[]:[f.createElement(_.a,{key:"undo",color:"secondary",size:"small",onClick:this.handleReconnect},this.props.i18n.t("Подключиться"))]}))}}]),t}(f.Component);W=D([C.autobind],W);var M=Object(I.connect)(function(e){return{active:e.websocket.active,closed:e.websocket.closed,websocketError:e.websocket.error,reconnecting:e.websocket.reconnecting,screenSnackbaropen:e.screen.snackbar.open,i18n:e.i18n}})(W),N=n(1473),H=n.n(N),z=n(241),B=n.n(z),V=n(243),U=n.n(V),q=n(242),K=n.n(q),G=n(261),J=n.n(G),Y=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},X=function(e){function t(){return u()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s()(t,e),r()(t,[{key:"handleDialogClose",value:function(e){this.props.dispatch(Object(w.e)(e))}},{key:"render",value:function(){var e=this;this.props.screen.dialog;return f.createElement(B.a,{fullScreen:this.props.fullScreen,fullWidth:!0,maxWidth:"md",open:this.props.screen.dialog.open,onClose:function(){return e.handleDialogClose(!1)},className:"Screen__dialog"},f.createElement(J.a,{style:{borderBottom:"none"}},this.props.screen.dialog.title.getOrElse(function(){return""})),f.createElement(K.a,null,this.props.screen.dialog.body.getOrElse(function(){return f.createElement("div",null)})),f.createElement(U.a,{style:{borderTop:"none"}},this.props.screen.dialog.actions))}}]),t}(f.Component);X=Y([C.autobind],X);var Z=Object(I.connect)(function(e){return{screen:e.screen}})(H()()(X)),Q=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ee=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},te=function e(t,n){u()(this,e),this.disabled=!1,this.disabled=n,this.label=t},ne=(function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];u()(this,t);var r=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.actionType=-1,r.actionType=n,r}s()(t,e)}(te),function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];u()(this,t);var r=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.execute=function(){},r.execute=n,r}s()(t,e)}(te),function(e){function t(e,n){u()(this,t);var i=a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state=n,i}return s()(t,e),r()(t,[{key:"handleDialogClose",value:function(e){this.props.dispatch(Object(w.e)(e))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments[4];this.props.dispatch(Object(w.g)({title:new j.Some(e),body:new j.Some(t),actions:n,onlyManualClose:i,options:r||new j.None}))}},{key:"scrollBottom",value:function(){window.document.body.scrollTop=window.document.body.scrollHeight}},{key:"scrollTop",value:function(){window.document.body.scrollTop=0}},{key:"renderNavigation",value:function(){throw"renderNavigation() should be defined in Screen implementation"}},{key:"closePopover",value:function(){this.setState(T(this.state,{popover:{$set:T(this.state.popover,{open:{$set:!1}})}}))}},{key:"openPopover",value:function(e,t){this.setState(T(this.state,{popover:{$set:{open:!0,actions:t,anchorElement:e}}}))}},{key:"onPopoverAction",value:function(e){this.closePopover(),e.execute()}},{key:"renderPopover",value:function(){var e=this;return this.state.popover.anchorElement.map(function(t){return f.createElement(y.a,{open:e.state.popover.open,anchorEl:t,anchorOrigin:{horizontal:"left",vertical:"bottom"},transformOrigin:{horizontal:"left",vertical:"top"},onClose:e.closePopover},f.createElement(k.a,null,e.state.popover.actions))})}},{key:"renderDrawer",value:function(){var e=this;return f.createElement(g.a,{open:this.state.drawer.open,onClose:function(t){return e.setState(T(e.state,{drawer:{open:{$set:t}}}))}},this.state.drawer.actions.map(function(e){return f.createElement(E.a,{onClick:e.execute},e.label)}))}},{key:"renderScreenBody",value:function(e,t){return f.createElement(h,Object.assign({},e,{navigation:f.createElement("div",null)}),f.createElement("div",{className:"Screen__container"},f.createElement(Z,null),this.renderPopover().getOrNull(),t,f.createElement(S.a,null),f.createElement(M,null)))}}],[{key:"screenInitialState",value:function(){return{popover:{anchorElement:new j.None,open:!1,actions:[]},drawer:{open:!1,actions:[]}}}}]),t}(f.PureComponent));ne=Q([C.autobind,ee("design:paramtypes",[Object,Object])],ne);t.a=ne},1469:function(e,t,n){"use strict";var i=n(17),r=n(1),o=n(6),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(18),d=function(e){function t(){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","GetOrganisationInfo",{}))}return u()(t,e),t}(p.a),f=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","Check",{token:e}))}return u()(t,e),t}(p.a),h=(function(e){function t(e,n){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AppLogin",{apiKey:e,captcha:n}))}u()(t,e)}(p.a),function(e){function t(e,n){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","HashLinkLogin",{hash:e,captcha:n}))}u()(t,e)}(p.a),function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","TwoFactorVerificationCode",{code:e}))}return u()(t,e),t}(p.a)),m=function(e){function t(e,n,i,r,o){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","UserLogin",{username:e,password:n,terminal:i,organisationId:r,captcha:o}))}return u()(t,e),t}(p.a),g=function(e){function t(e,n,i,r){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AccountRegister",{name:e,email:n,password:i,captcha:r}))}return u()(t,e),t}(p.a),v=function(e){function t(e,n,i){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","AccountLogin",{email:e,password:n,captcha:i}))}return u()(t,e),t}(p.a),y=function(e){function t(e,n,i){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Auth","EnrichedAccountLogin",{email:e,password:n,captcha:i}))}return u()(t,e),t}(p.a),b=n(257),E=n(69),O=n(79),k=n(547),C=(n(320),n(0),n(201),n(1511));n(111);n.d(t,"d",function(){return T}),n.d(t,"g",function(){return w}),n.d(t,"h",function(){return S}),n.d(t,"b",function(){return I}),n.d(t,"a",function(){return R}),n.d(t,"e",function(){return P}),n.d(t,"c",function(){return x}),n.d(t,"f",function(){return _});var j=function(e,t){switch(e.tpe.value){case r.UserInfo.$Type.value:t(Object(E.v)(e));break;case r.AccountInfo.$Type.value:t(Object(k.a)()).then(function(){t(Object(E.m)(e))});break;case r.AppInfo.$Type.value:t(Object(E.o)(e)),t(Object(C.b)(e));break;case r.TwoFactorCodeRequired.$Type.value:t(Object(E.t)()),t(Object(O.Lb)())}},T=function(e){return function(t){return new Promise(function(n,r){e||r(),t(Object(E.p)()),i.a.send(new f(e),function(e){return e}).then(function(e){j(e,t),n(e)}).catch(function(e){r(e)})})}},w=function(e){return function(t){return new Promise(function(n,r){e||r(),t(Object(E.p)()),i.a.send(new h(e),function(e){return e}).then(function(e){j(e,t),n(e)}).catch(function(e){r(e)})})}},S=function(e,t,n,r,o){return function(a){return a(Object(E.s)()),i.a.send(new m(e,t,n,r,o),function(e){return e}).then(function(e){return a(Object(E.u)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},I=function(e,t,n,r){return function(o){return o(Object(E.s)()),i.a.send(new g(e,t,n,r),function(e){return e}).then(function(e){return o(Object(E.l)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},R=function(e,t,n){return function(o){return o(Object(E.s)()),i.a.send(new v(e,t,n),function(e){return e}).then(function(e){return function(e,t){switch(e.tpe.value){case r.AccountInfo.$Type.value:t(Object(k.a)()).then(function(){t(Object(E.m)(e))});break;case r.TwoFactorCodeRequired.$Type.value:t(Object(E.t)()),t(Object(O.Lb)())}}(e,o),e}).catch(function(e){throw console.error(e.message,e),e})}},P=function(e,t,n){return function(r){return r(Object(E.s)()),i.a.send(new y(e,t,n),function(e){return e}).then(function(e){return r(Object(E.l)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},x=function(e,t){return function(n){return i.a.send(new b.b(e,t),function(e){return e}).then(function(e){return n(Object(E.u)(e)),e}).catch(function(e){throw console.error(e.message,e),e})}},_=function(){return i.a.send(new d,function(e){return e})}},1475:function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return d});var i=n(106),r=n(62),o=n.n(r),a=n(50),l=n(0),s=function(e){var t=Object(i.q)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(i.c)(e)).getOrElse(function(){return"dashed"}),r=Object(i.b)(e).getOrElse(function(){return o.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+r)},c=function(e){var t=Object(i.h)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(i.c)(e)).getOrElse(function(){return"dashed"}),r=Object(i.b)(e).getOrElse(function(){return o.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+r)},u=function(e){var t=Object(i.d)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(i.c)(e)).getOrElse(function(){return"dashed"}),r=Object(i.b)(e).getOrElse(function(){return o.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+r)},p=function(e){var t=Object(i.f)(e).getOrElse(function(){return 0}),n=Object(a.g)(Object(i.c)(e)).getOrElse(function(){return"dashed"}),r=Object(i.b)(e).getOrElse(function(){return o.a[600]});return 0===t?new l.None:Object(l.toOption)(t+"px "+n+" "+r)},d=function(e){return"\n    "+Object(i.l)(e).map(function(e){return e?"inset":""}).getOrElse(function(){return""})+" \n    "+Object(i.k)(e).getOrElse(function(){return 0})+"px\n    "+Object(i.n)(e).getOrElse(function(){return 0})+"px\n    "+Object(i.i)(e).getOrElse(function(){return 0})+"px\n    "+Object(i.m)(e).getOrElse(function(){return 0})+"px\n    "+Object(i.j)(e).getOrElse(function(){return o.a[600]})+"\n"}},1478:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(2),d=n(218),f=n.n(d),h=n(25),m=n.n(h),g=n(1476),v=n.n(g),y=(n(1481),n(52)),b=n.n(y),E=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"render",value:function(){return p.createElement(f.a,{className:"PageHeader__main"},this.props.onGoBackRequested?p.createElement(m.a,{onClick:this.props.onGoBackRequested,style:{flexShrink:0}},p.createElement(v.a,null)):p.createElement("div",{style:{display:"inline-block"}}),p.createElement(b.a,{variant:"title",align:"center",style:{flex:1}},this.props.title),p.createElement("div",{style:{flexShrink:0}},this.props.rightButtonGroup))}}]),t}(p.Component);t.a=E},1479:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(2),d=n(52),f=n.n(d),h=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"render",value:function(){return p.createElement(f.a,{component:"div",style:Object.assign({overflowY:"auto"},this.props.style)},this.props.children)}}]),t}(p.PureComponent);t.a=h},1480:function(e,t,n){e.exports=n(97)(3)},1481:function(e,t,n){var i=n(1482);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},1482:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".PageHeader__main {\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  margin-bottom: 10px;\n  background-color: #fff !important;\n  height: 48px !important;\n  width: 100% !important;\n  flex-shrink: 0;\n  padding: 0; }\n",""])},1483:function(e,t,n){"use strict";var i=n(17),r=n(21),o=n(6),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(18),d=function(e){function t(e,n,i,r,o,l){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Create",{name:e,organisationId:n,roleId:i,eventLineId:r,appType:o,active:l}))}return u()(t,e),t}(p.a),f=function(e){function t(e,n,i,r,o){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Update",{id:e,name:n,roleId:i,appType:r,active:o}))}return u()(t,e),t}(p.a),h=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Delete",{appId:e}))}return u()(t,e),t}(p.a),m=(function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","Request",{appId:e}))}u()(t,e)}(p.a),function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListEventLine",{eventLineId:e}))}return u()(t,e),t}(p.a)),g=function(e){function t(e){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","ListOrganisation",{organisationId:e}))}return u()(t,e),t}(p.a),v=function(e){function t(e,n){return a()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Permissions.Apps","EnrichContext",{loginValues:e,formId:n}))}return u()(t,e),t}(p.a),y=n(427),b=n(5);Object(b.createAction)("Application.Fetching"),Object(b.createAction)("Application.Resolve"),Object(b.createAction)("Application.Error"),Object(b.createAction)("Auth.SetBlockId",function(e){return e});n.d(t,"d",function(){return E}),n.d(t,"e",function(){return O}),n.d(t,"f",function(){return k}),n.d(t,"a",function(){return C}),n.d(t,"b",function(){return j}),n.d(t,"c",function(){return T});var E=function(e){return function(t){return t(Object(y.e)()),i.a.send(new m(e),Object(r.g)()).then(function(e){return t(Object(y.f)(e.list)),e}).catch(function(e){throw t(Object(y.d)(e)),e})}},O=function(e){return function(t){return t(Object(y.e)()),i.a.send(new g(e),Object(r.g)()).then(function(e){return t(Object(y.f)(e.list)),e}).catch(function(e){throw t(Object(y.d)(e)),e})}},k=function(e,t,n,o,a){return i.a.send(new f(e,t,n,o,a),Object(r.f)())},C=function(e,t,n,o,a,l){return i.a.send(new d(e,t,n,o,a,l),Object(r.f)())},j=function(e){return i.a.send(new h(e),Object(r.f)())},T=function(e,t){return i.a.send(new v(e,t),function(e){return e})}},1493:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(13),m=n(3),g=n(1620),v=n.n(g),y=n(1621),b=n.n(y),E=n(1622),O=n.n(E),k=n(93),C=n.n(k),j=n(24),T=n.n(j),w=n(38),S=n.n(w),I=n(163),R=n.n(I),P=n(548),x=n.n(P),_=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},L=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&(n[i[r]]=e[i[r]])}return n},A=function(e){function t(e){r()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={suggestions:[]},n}return u()(t,e),a()(t,[{key:"escapeRegexCharacters",value:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},{key:"getSuggestionsOnFocus",value:function(e){var t=this.escapeRegexCharacters(e.trim()),n=new RegExp("^"+t,"i");return this.props.suggestions.filter(function(e){return n.test(e)})}},{key:"getSuggestions",value:function(e){var t=e.trim().toLowerCase(),n=t.length,i=0;return 0===n?[]:this.props.suggestions.filter(function(e){var r=i<5&&e.toLowerCase().slice(0,n)===t;return r&&(i+=1),r})}},{key:"handleSuggestionsFetchRequested",value:function(e){var t=e.value;this.setState(m(this.state,{suggestions:{$set:this.props.showSuggestionsOnFocus?this.getSuggestionsOnFocus(t):this.getSuggestions(t)}}))}},{key:"handleSuggestionsClearRequested",value:function(){this.setState(m(this.state,{suggestions:{$set:[]}}))}},{key:"renderInput",value:function(e){e.classes,e.ref;var t=D(e,["classes","ref"]);return f.Children.map(this.props.children,function(e){return f.cloneElement(e,Object.assign({},t,{inputProps:Object.assign({},t)}))})}},{key:"shouldRenderSuggestions",value:function(){return!0}},{key:"renderSuggestion",value:function(e,t){var n=t.query,i=t.isHighlighted,r=b()(e,n),o=O()(e,r);return f.createElement(T.a,{selected:i,component:"div"},f.createElement("div",null,o.map(function(e,t){return e.highlight?f.createElement("span",{key:String(t),style:{fontWeight:500}},e.text):f.createElement("strong",{key:String(t),style:{fontWeight:300}},e.text)})))}},{key:"getSuggestionValue",value:function(e){return e}},{key:"render",value:function(){var e=this,t=this.props.classes,n={suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.handleSuggestionsFetchRequested,onSuggestionsClearRequested:this.handleSuggestionsClearRequested,getSuggestionValue:this.getSuggestionValue,renderSuggestion:this.renderSuggestion};return f.createElement(v.a,Object.assign({},n,{inputProps:{classes:t,placeholder:"",value:this.props.value,onChange:function(t,n){var i=n.newValue;return e.props.onChange(i)},onBlur:this.props.onBlur,inputRef:function(t){return e.popperNode=t},InputLabelProps:{shrink:!0}},shouldRenderSuggestions:this.shouldRenderSuggestions,renderInputComponent:this.renderInput,theme:{suggestionsList:t.suggestionsList,suggestion:t.suggestion},renderSuggestionsContainer:function(t){return f.createElement(x.a,{anchorEl:e.popperNode,open:Boolean(t.children),style:{zIndex:5e3}},f.createElement(C.a,Object.assign({square:!0},t.containerProps,{style:{width:e.popperNode?e.popperNode.clientWidth:null}}),t.children))}}))}}]),t}(f.Component);A=_([h.autobind,L("design:paramtypes",[Object])],A),t.a=S()(function(e){return R()({root:{height:250,flexGrow:1},container:{position:"relative"},suggestionsContainerOpen:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:2*e.spacing.unit}})})(A)},1495:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(13),m=n(542),g=n.n(m),v=n(38),y=n.n(v),b=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},E=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"render",value:function(){return f.createElement(g.a,{style:{margin:0},classes:this.props.classes,variant:this.props.variant,color:this.props.color,disabled:this.props.disabled,onClick:this.props.onClick,type:this.props.type,size:this.props.size},this.props.children)}}]),t}(f.Component);E=b([h.autobind],E),t.a=y()(function(e){return{sizeSmall:{minWidth:32,minHeight:16,fontSize:e.typography.pxToRem(8)}}})(E)},1511:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var i=n(4),r=n.n(i),o=n(1),a=n(0),l=n(3),s=function(e){return function(t,n){if(e.appType instanceof o.ApplicationTypePrivateCabinet){var i=e.token,l=localStorage.getItem("platform5_embedded_user_tokens_map");Object(a.toOption)(l).matchWith(function(e){var t=JSON.parse(e);return n().appKey.appKey.map(function(e){return Object.assign(t,r()({},e,i))})},function(){return n().appKey.appKey.map(function(e){return r()({},e,i)})}).foreach(function(e){localStorage.setItem("platform5_embedded_user_tokens_map",JSON.stringify(e))})}}},c=function(){return function(e,t){var n=localStorage.getItem("platform5_embedded_user_tokens_map");Object(a.toOption)(n).map(function(e){var n=JSON.parse(e);return t().appKey.appKey.map(function(e){return l(n,{$unset:[e]})})}).foreach(function(e){localStorage.setItem("platform5_embedded_user_tokens_map",JSON.stringify(e))})}}},1529:function(e,t,n){e.exports=n(97)(69)},1531:function(e,t,n){"use strict";var i=n(65),r=n.n(i),o=n(2),a=n(1),l=n(84),s=n(1803),c=n(4),u=n.n(c),p=n(6),d=n.n(p),f=n(10),h=n.n(f),m=n(7),g=n.n(m),v=n(8),y=n.n(v),b=n(11),E=n.n(b),O=n(14),k=n(95),C=n(156),j=n.n(C),T=n(24),w=n.n(T),S=n(25),I=n.n(S),R=n(30),P=n.n(R),x=n(26),_=n.n(x),L=n(34),D=n.n(L),A=n(32),F=n.n(A),$=n(54),W=n.n($),M=n(209),N=n(418),H=n(3),z=n(0),B=n(374),V=function(e){function t(e){d()(this,t);var n=g()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={separator:a.FieldsMassCreationSeparatorLineBreak.$Type},n}return y()(t,e),h()(t,[{key:"componentWillReceiveProps",value:function(e){e.fields.referenceFamily.value&&e.fields.referenceFamily.value!==this.props.fields.referenceFamily.value&&e.dispatch(Object(l.c)(new a.Id(e.fields.referenceFamily.value))).then(function(e){return console.log("Fields list updated?",e)})}},{key:"handleNameChange",value:function(e){this.props.fields.caption.onChange(e.target.value),this.props.fields.name.onChange(Object(B.a)(e.target.value)),this.separateFieldsInText({caption:e.target})}},{key:"separateFieldsInText",value:function(e){var t=this.getSeparatorSymbol(e.separator||this.state.separator.value).getOrElse(function(){return""}),n=(e.caption||this.props.fields.caption).value.split(t).filter(function(e){return e.match(/[a-яА-Я0-9]/i)}).map(function(e){return e.trim()}).map(function(e){var t=Object(B.a)(e);if(t)return u()({},e,t)}).filter(function(e){return e});this.props.fields.captionName.onChange(n)}},{key:"onSeparatorSelected",value:function(e){this.setState(H(this.state,{separator:{$set:new z.TypeId(e)}})),this.separateFieldsInText({separator:e})}},{key:"getSeparatorSymbol",value:function(e){switch(e){case a.FieldsMassCreationSeparatorComa.$Type.value:return new z.Some(",");case a.FieldsMassCreationSeparatorSemicolon.$Type.value:return new z.Some(";");case a.FieldsMassCreationSeparatorLineBreak.$Type.value:return new z.Some("\n");default:return new z.None}}},{key:"getSeparatorTypeName",value:function(e){switch(e){case a.FieldsMassCreationSeparatorComa.$Type:return new z.Some(this.props.i18n.t("Запятая"));case a.FieldsMassCreationSeparatorSemicolon.$Type:return new z.Some(this.props.i18n.t("Точка с запятой"));case a.FieldsMassCreationSeparatorLineBreak.$Type:return new z.Some(this.props.i18n.t("Перенос строки"));default:return new z.None}}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields.caption,i=t.handleSubmit,r=t.onSubmit;return o.createElement("form",{onSubmit:function(e){e.preventDefault(),i(r)}},o.createElement("input",{type:"submit",style:{display:"none"}}),o.createElement("div",{style:{position:"relative"}},o.createElement(F.a,{fullWidth:!0},o.createElement(D.a,null,this.props.i18n.t("Разделитель")),o.createElement(P.a,{onChange:function(t){return e.onSeparatorSelected(t.target.value)},value:this.state.separator.value,style:{width:"98%"}},a.FieldsMassCreationSeparators.map(function(t,n){return o.createElement(w.a,{key:n,value:t.value},o.createElement(W.a,{primary:e.getSeparatorTypeName(t).getOrElse(function(){return""})}))}))),o.createElement(F.a,{fullWidth:!0},o.createElement(_.a,{label:this.props.i18n.t("Список полей"),rows:4,error:n.touched&&n.error,value:n.value,onChange:function(t){return e.handleNameChange(t)},fullWidth:!0,multiline:!0}),Object(z.toOption)(n.error).map(function(e){return o.createElement(j.a,null,e)}).getOrNull()),o.createElement(M.b,{toolTipContent:o.createElement("div",null,this.props.i18n.t("текст подсказки"))},o.createElement(I.a,{style:{position:"absolute",right:"-3px",bottom:"14px",width:"15px",height:"15px",padding:0,zIndex:5e3}},o.createElement(N.a,null)))))}}]),t}(o.Component),U=Object(O.connect)(function(e){return{i18n:e.i18n,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(k.reduxForm)({form:"fieldEditForm",fields:["id","name","caption","valueType","captionName","staticValues","referenceFamily","referenceFamilyDisplayField","attributeGeneratorType","dateFormat","internalIdPrefix","internalIdPostfix","dateType"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.caption&&0!==e.caption.trim().length||(n.caption=t.i18n.t("Обязательное значение")),e.valueType&&0!==e.valueType.trim().length||(n.valueType=t.i18n.t("Обязательное значение")),e.internalIdPrefix||(e.internalIdPrefix=""),e.internalIdPostfix||(e.internalIdPostfix=""),!e.caption||"object"===E()(e.captionName)&&0!==Object.keys(e.captionName).length||(n.caption=t.i18n.t("Требуются стандартные символы")),n}})(V)),q=function(e){function t(){return d()(this,t),g()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y()(t,e),h()(t,[{key:"componentWillReceiveProps",value:function(e){e.fields.referenceFamily.value&&e.fields.referenceFamily.value!==this.props.fields.referenceFamily.value&&e.dispatch(Object(l.c)(new a.Id(e.fields.referenceFamily.value))).then(function(e){return console.log("Fields list updated?",e)})}},{key:"handleNameChange",value:function(e){this.props.fields.caption.onChange(e.target.value),this.props.fields.name.onChange(Object(B.a)(e.target.value))}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields.caption,i=t.handleSubmit,r=t.onSubmit;return o.createElement("form",{onSubmit:function(e){e.preventDefault(),i(r)}},o.createElement("input",{type:"submit",style:{display:"none"}}),o.createElement(_.a,{fullWidth:!0,value:n.value,onChange:function(t){return e.handleNameChange(t)},label:this.props.i18n.t("Название поля"),error:n.touched&&n.error,helperText:n.touched&&Object(z.toOption)(n.error).map(function(e){return e}).getOrNull()}))}}]),t}(o.Component),K=(Object(O.connect)(function(e){return{i18n:e.i18n,formFields:e.fields}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(k.reduxForm)({form:"fieldEditForm",fields:["id","name","caption","valueType","valueTypeTag","staticValues","referenceFamily","referenceFamilyDisplayField","attributeGeneratorType","dateFormat","internalIdPrefix","internalIdPostfix","dateType"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.caption&&0!==e.caption.trim().length||(n.caption=t.i18n.t("Обязательное значение")),e.valueType&&0!==e.valueType.trim().length||(n.valueType=t.i18n.t("Обязательное значение")),e.internalIdPrefix||(e.internalIdPrefix=""),e.internalIdPostfix||(e.internalIdPostfix=""),n}})(q)),n(71)),G=n(19),J=n.n(G),Y=n(201),X=n(174);n.d(t,"a",function(){return Q}),n.d(t,"b",function(){return ee}),n.d(t,"d",function(){return te}),n.d(t,"c",function(){return ne});var Z=function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function l(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,l)}s((i=i.apply(e,t||[])).next())})},Q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.i18n.t("Новое поле"),r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=void 0;e.openDialog(i,o.createElement(s.a,{ref:function(e){return c=Object(z.toOption)(e).flatMap(function(e){return Object(z.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(e,t,n){return Object(l.a)(e.formId,new a.FormField(e.formId,t.name,t.caption,Object(s.b)(new z.TypeId(t.valueType),t))).then(function(i){e.dispatch(Object(l.c)(e.formId)).then(function(){Object(z.toOption)(n).filter(function(e){return e}).foreach(function(){return e.dispatch(Object(X.a)(e.formId,[i.id],Object(z.toOption)(t.referenceFamilyDisplayField)))}),e.handleDialogClose(!0),e.handleCreateAnBound&&e.handleCreateAnBound(new a.ElementDataOutput(i.id)),e.dispatch(Object(K.h)(e.i18n.t("Поле добавлено")))})}).catch(function(t){return e.dispatch(Object(Y.a)(t))})}(e,t,r)},initialValues:t||{valueType:a.ValueTypeStr.$Type.value},disableTypeChange:n}),[o.createElement(J.a,{variant:"raised",onClick:function(){return e.handleDialogClose(!0)},style:{marginRight:"10px"}},e.i18n.t("Закрыть")),o.createElement(J.a,{variant:"raised",onClick:function(){return c.map(function(e){e.submited||(e.submited=!0,e.submit())})},color:"primary"},e.i18n.t("Создать"))],!0)},ee=function(e){var t=void 0;e.openDialog(e.i18n.t("Новые поля текстового типа"),o.createElement(U,{ref:function(e){return t=Object(z.toOption)(e).flatMap(function(e){return Object(z.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(e,t){return Z(void 0,void 0,void 0,r.a.mark(function n(){var i,o,c,u,p,d,f;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=[],o=!0,c=!1,u=void 0,n.prev=4,p=t.captionName[Symbol.iterator]();case 6:if(o=(d=p.next()).done){n.next=13;break}return f=d.value,n.next=10,Object(l.a)(e.formId,new a.FormField(e.formId,f[Object.keys(f)[0]],Object.keys(f)[0],Object(s.b)(new z.TypeId(t.valueType),t))).then(function(e){return i.push(e.id)});case 10:o=!0,n.next=6;break;case 13:n.next=19;break;case 15:n.prev=15,n.t0=n.catch(4),c=!0,u=n.t0;case 19:n.prev=19,n.prev=20,!o&&p.return&&p.return();case 22:if(n.prev=22,!c){n.next=25;break}throw u;case 25:return n.finish(22);case 26:return n.finish(19);case 27:e.dispatch(Object(l.c)(e.formId)).then(function(){return e.dispatch(Object(X.a)(e.formId,i,Object(z.toOption)(t.referenceFamilyDisplayField)))}),e.handleDialogClose(!0),e.dispatch(Object(K.h)(e.i18n.t("Все поля добавлены успешно.")));case 30:case"end":return n.stop()}},n,this,[[4,15,19,27],[20,,22,26]])}))}(e,t)},initialValues:{valueType:a.ValueTypeStr.$Type.value}}),[o.createElement(J.a,{variant:"raised",onClick:function(){return e.handleDialogClose(!0)},style:{marginRight:"10px"}},e.i18n.t("Отмена")),o.createElement(J.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},e.i18n.t("Создать"))],!0)},te=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Q(e,Object.assign({},t,{valueType:a.ValueTypeObjectRefs.$Type.value}),!0,e.i18n.t("Новое ссылочное поле"))},ne=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.i18n.t("Новое поле"),r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=void 0,u=e.openDialog(i,o.createElement(s.a,{ref:function(e){return c=Object(z.toOption)(e).flatMap(function(e){return Object(z.toOption)(e.wrappedInstance)})},onSubmit:function(t){return function(e,t,n,i){return Object(l.a)(e.formId,new a.FormField(e.formId,t.name,t.caption,Object(s.b)(new z.TypeId(t.valueType),t))).then(function(r){e.dispatch(Object(l.c)(e.formId)).then(function(){Object(z.toOption)(n).filter(function(e){return e}).foreach(function(){return e.dispatch(Object(X.a)(e.formId,[r.id],Object(z.toOption)(t.referenceFamilyDisplayField)))}),e.handleDialogClose(i),e.handleCreateAnBound&&e.handleCreateAnBound(new a.ElementDataOutput(r.id)),e.dispatch(Object(K.h)(e.i18n.t("Поле добавлено")))})}).catch(function(t){return e.dispatch(Object(Y.a)(t))})}(e,t,r,u)},initialValues:t||{valueType:a.ValueTypeStr.$Type.value},disableTypeChange:n}),[o.createElement(J.a,{variant:"raised",onClick:function(){return e.handleDialogClose(u)},style:{marginRight:"10px"}},e.i18n.t("Закрыть")),o.createElement(J.a,{variant:"raised",onClick:function(){return c.map(function(e){return e.submit()})},color:"primary"},e.i18n.t("Создать"))])}},1546:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return l});var i=n(130),r=n(1469),o=n(425),a=function(){return function(e,t){t().organisation.infoFetching||t().organisation.infoFetched||(e(Object(i.t)()),r.f().then(function(t){e(Object(i.q)(t))}).catch(function(t){e(Object(i.s)(t))}))}},l=function(e){return function(t){return t(Object(i.m)()),o.e(e).then(function(e){return t(Object(i.n)(e.list)),e}).catch(function(e){throw t(Object(i.l)(e)),e})}}},1589:function(e,t,n){"use strict";var i=n(17),r=n(6),o=n.n(r),a=n(7),l=n.n(a),s=n(8),c=n.n(s),u=n(18),p=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","List",{organisationId:e}))}return c()(t,e),t}(u.a),d=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","Update",{connection:e}))}return c()(t,e),t}(u.a),f=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","Create",{connection:e}))}return c()(t,e),t}(u.a),h=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","Delete",{id:e}))}return c()(t,e),t}(u.a),m=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SocialConnections","XeroConnect",{connectionId:e}))}return c()(t,e),t}(u.a),g=n(21);n.d(t,"d",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"b",function(){return b}),n.d(t,"c",function(){return E}),n.d(t,"a",function(){return O});var v=function(e){return i.a.send(new p(e),Object(g.g)())},y=function(e){return i.a.send(new d(e),Object(g.f)())},b=function(e){return i.a.send(new f(e),Object(g.c)())},E=function(e){return i.a.send(new h(e),Object(g.d)())},O=function(e){return i.a.send(new m(e),function(e){return e})}},1592:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(14),m=n(13),g=n(325),v=n.n(g),y=n(71),b=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},E=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"hideNotification",value:function(){this.props.dispatch(Object(y.f)())}},{key:"render",value:function(){var e=this;return f.createElement(v.a,{open:this.props.screen.snackbar.open,autoHideDuration:4e3,onClose:function(){return e.hideNotification()},message:f.createElement("div",null,this.props.screen.snackbar.message)})}}]),t}(f.Component);E=b([m.autobind],E),t.a=Object(h.connect)(function(e){return{screen:e.screen}})(E)},1599:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a});var i=n(446),r=n(1589),o=function(e){return function(t,n){return n().socialConnections.fetched?new Promise(function(e,t){e(n().socialConnections.list)}):t(a(e))}},a=function(e){return function(t,n){return t(Object(i.e)()),r.d(e).then(function(e){return t(Object(i.f)(e.list)),e.list}).catch(function(e){throw t(Object(i.d)(e)),e})}}},1601:function(e,t,n){var i=n(1602);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},1602:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".FullScreen {\n  height: 100%;\n  display: flex;\n  flex-direction: column; }\n\n.FullScreen__top {\n  width: 100%; }\n\n.FullScreen__content {\n  display: flex;\n  flex-direction: row;\n  flex: 1 1 auto;\n  min-height: 0; }\n",""])},1603:function(e,t,n){var i=n(1604);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},1604:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".Screen__container {\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 auto;\n  min-height: 0;\n  overflow: hidden;\n  background-color: #eeeded;\n  padding: 8px;\n  box-sizing: border-box; }\n\n.DefaultPage__paper {\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  width: 100%;\n  overflow: auto; }\n",""])},1768:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(2),d=n(642);t.a=function(e){return function(t){function n(){return r()(this,n),s()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u()(n,t),a()(n,[{key:"render",value:function(){var t=this;return p.createElement(d.a,null,function(n){return p.createElement(e,Object.assign({onTabChange:n.onTabChange,currentTab:n.currentTab,ref:function(e){return t.ref=e}},t.props))})}}]),n}(p.Component)}},1770:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(2),d=n(647);t.a=function(e){return function(t){function n(){return r()(this,n),s()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u()(n,t),a()(n,[{key:"render",value:function(){var t=this;return p.createElement(d.a,null,function(n){return p.createElement(e,Object.assign({createPortal:n.createPortal},t.props))})}}]),n}(p.Component)}},1803:function(e,t,n){"use strict";n.d(t,"b",function(){return ne});var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(14),m=n(95),g=n(24),v=n.n(g),y=n(30),b=n.n(y),E=n(26),O=n.n(E),k=n(34),C=n.n(k),j=n(32),T=n.n(j),w=n(156),S=n.n(w),I=n(19),R=n.n(I),P=n(25),x=n.n(P),_=n(241),L=n.n(_),D=n(243),A=n.n(D),F=n(242),$=n.n(F),W=n(261),M=n.n(W),N=n(82),H=n(1),z=n(0),B=n(50),V=n(84),U=n(374),q=n(384),K=n(68),G=n(418),J=n(209),Y=n(3),X=n(563),Z=n(13),Q=n(660),ee=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},te=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ne(e,t){var n=Object(z.toOption)(t.valueTypeTag).filter(function(e){return""!==e}).map(function(e){return ie(new z.TypeId(e))});switch(e.value){case H.ValueTypeGeoPoint.$Type.value:return new H.ValueTypeGeoPoint(n);case H.ValueTypeValuesList.$Type.value:return new H.ValueTypeValuesList(t.staticValues||[],n);case H.ValueTypeObjectRefs.$Type.value:case H.ValueTypeObjectRefsTypes.DICTIONARY:case H.ValueTypeObjectRefsTypes.FORM:case H.ValueTypeObjectRefsTypes.SERVICE:return new H.ValueTypeObjectRefs(new H.Id(t.referenceFamily),[new H.Id(t.referenceFamilyDisplayField)],n);case H.ValueTypeUserRefs.$Type.value:return new H.ValueTypeUserRefs;case H.ValueTypeMoney.$Type.value:return new H.ValueTypeMoney;case H.ValueTypeStr.$Type.value:return new H.ValueTypeStr(n);case H.ValueTypeBool.$Type.value:return new H.ValueTypeBool(n);case H.ValueTypeImage.$Type.value:return new H.ValueTypeImage(n);case H.ValueTypeFileList.$Type.value:return new H.ValueTypeFileList(n);case H.ValueTypeNumber.$Type.value:return new H.ValueTypeNumber(n);case H.ValueTypeInterval.$Type.value:return new H.ValueTypeInterval(n);case H.ValueTypeDate.$Type.value:return new H.ValueTypeDate(Object(B.r)(t),n);case H.ValueTypeFormDataAttribute.$Type.value:return new H.ValueTypeFormDataAttribute(Object(B.k)(t),n);case H.ValueTypePassword.$Type.value:return new H.ValueTypePassword(n);default:throw"unknown type provided "+e.value}}var ie=function(e){switch(e.value){case H.ValueTagAccessLogRefs.$Type.value:return new H.ValueTagAccessLogRefs;case H.ValueTagAccessZoneId.$Type.value:return new H.ValueTagAccessZoneId;case H.ValueTagBlockId.$Type.value:return new H.ValueTagBlockId;case H.ValueTagDocumentId.$Type.value:return new H.ValueTagDocumentId;case H.ValueTagDocumentRecordId.$Type.value:return new H.ValueTagDocumentRecordId;case H.ValueTagInputData.$Type.value:return new H.ValueTagInputData;case H.ValueTagReason.$Type.value:return new H.ValueTagReason;case H.ValueTagResult.$Type.value:return new H.ValueTagResult;case H.ValueTagRuleName.$Type.value:return new H.ValueTagRuleName;case H.ValueTagTerminalId.$Type.value:return new H.ValueTagTerminalId;case H.ValueTagTerminalName.$Type.value:return new H.ValueTagTerminalName;case H.ValueTagDate.$Type.value:return new H.ValueTagDate;case H.ValueTagDocumentRecordRefs.$Type.value:return new H.ValueTagDocumentRecordRefs;case H.ValueTagEmailLogRefs.$Type.value:return new H.ValueTagEmailLogRefs;default:throw"unknown value tag type provided "+e.value}},re=function(e){function t(e){r()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showTagsSelect:!1,dialog:{open:!1,actions:[],title:new z.None,body:new z.None}},n}return u()(t,e),a()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.fields.referenceFamily.value&&e.fields.referenceFamily.value!==this.props.fields.referenceFamily.value&&e.dispatch(Object(V.c)(new H.Id(e.fields.referenceFamily.value))).then(function(e){if(t.props.fields.valueType.value===H.ValueTypeObjectRefsTypes.DICTIONARY){var n=e.list.filter(function(e){return e.entity.valueType.tag.map(function(e){return e.tpe.value===H.ValueTagSimpleDictionaryValue.$Type.value}).getOrElse(function(){return!1})});return Object(z.headOption)(n).map(function(e){return t.props.fields.referenceFamilyDisplayField.onChange(e.id.value)})}return Object(z.headOption)(e.list).map(function(e){return t.props.fields.referenceFamilyDisplayField.onChange(e.id.value)})})}},{key:"componentDidMount",value:function(){var e=this;this.setState(Object.assign({},this.state,{showTagsSelect:!!this.props.fields.valueTypeTag.value})),this.props.fields.referenceFamily.value&&!this.props.fields.referenceFamilyDisplayField.value&&this.props.dispatch(Object(V.c)(new H.Id(this.props.fields.referenceFamily.value))).then(function(){var t=Object(z.headOption)(Object(z.liftKey)(e.props.formFields.list,e.props.fields.referenceFamily.value).getOrElse(function(){return[]})).map(function(e){return e.id.value}).getOrElse(function(){return""});e.props.fields.referenceFamilyDisplayField.onChange(t)})}},{key:"handleDialogClose",value:function(){this.setState(Y(this.state,{dialog:{$set:Y(this.state.dialog,{open:{$set:!1}})}}))}},{key:"openDialog",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.setState(Y(this.state,{dialog:{$set:{open:!0,title:new z.Some(e),body:new z.Some(t),actions:n||[]}}}))}},{key:"getValueTypeName",value:function(e){switch(e.value){case H.ValueTypeGeoPoint.$Type.value:return this.props.i18n.t("Географическое местоположение");case H.ValueTypeStr.$Type.value:return this.props.i18n.t("Текст");case H.ValueTypeNumber.$Type.value:return this.props.i18n.t("Числовое");case H.ValueTypeInterval.$Type.value:return this.props.i18n.t("Длительность");case H.ValueTypeMoney.$Type.value:return this.props.i18n.t("Деньги");case H.ValueTypeValuesList.$Type.value:return this.props.i18n.t("Список значений");case H.ValueTypeObjectRefs.$Type.value:return this.props.i18n.t("Список ссылок на анкету");case H.ValueTypeUserRefs.$Type.value:return this.props.i18n.t("Пользователь");case H.ValueTypeBool.$Type.value:return this.props.i18n.t("Булевый");case H.ValueTypeDate.$Type.value:return this.props.i18n.t("Дата и время");case H.ValueTypeImage.$Type.value:return this.props.i18n.t("Изображение");case H.ValueTypeFileList.$Type.value:return this.props.i18n.t("Файлы");case H.ValueTypeFormDataAttribute.$Type.value:return this.props.i18n.t("Атрибут");case H.ValueTypePassword.$Type.value:return this.props.i18n.t("Пароль")}}},{key:"handleNameChange",value:function(e){this.props.fields.caption.onChange(e.target.value),this.props.fields.name.onChange(Object(U.a)(e.target.value))}},{key:"onNameChange",value:function(e){Object(U.c)(e.target.value)||this.props.fields.name.onChange(e.target.value)}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,i=n.name,r=n.caption,o=n.valueType,a=(n.valueTypeTag,n.staticValues,n.referenceFamily),l=n.referenceFamilyDisplayField,s=n.attributeGeneratorType,c=n.dateFormat,u=n.internalIdPrefix,p=n.internalIdPostfix,d=n.dateType,h=t.handleSubmit,m=t.onSubmit,g=Object(z.liftKey)(this.props.formFields.list,a.value).getOrElse(function(){return[]});return f.createElement("form",{onSubmit:function(e){e.preventDefault(),h(m)}},f.createElement("input",{type:"submit",style:{display:"none"}}),f.createElement(O.a,{fullWidth:!0,autoFocus:!0,disabled:this.props.disabled,value:r.value,onChange:function(t){return e.handleNameChange(t)},label:this.props.i18n.t("Название"),error:r.touched&&r.error,helperText:r.touched&&Object(z.toOption)(r.error).map(function(e){return f.createElement(S.a,null,e)}).getOrNull()}),f.createElement(O.a,{fullWidth:!0,disabled:this.props.disabled,value:i.value,onChange:this.onNameChange,label:this.props.i18n.t("Системное имя"),error:i.touched&&i.error,helperText:i.touched&&Object(z.toOption)(i.error).map(function(e){return f.createElement(S.a,null,e)}).getOrNull()}),!this.props.disableTypeChange&&f.createElement("div",{style:{position:"relative"}},f.createElement(T.a,{fullWidth:!0},f.createElement(C.a,null,this.props.i18n.t("Тип поля")),f.createElement(b.a,{native:!0,value:o.value,disabled:this.props.disabled,onChange:function(e){o.onChange(e.target.value),a.onChange(""),l.onChange("")},error:o.touched&&o.error,style:{width:"98%"}},V.h.filter(function(e){return e.value!==H.ValueTypeGeoPoint.$Type.value||!N.default.isA5000}).filter(function(e){return e.value!==H.ValueTypeObjectRefs.$Type.value}).map(function(t){return f.createElement("option",{key:t.value,value:t.value},e.getValueTypeName(t))}),f.createElement("option",{value:H.ValueTypeObjectRefsTypes.DICTIONARY},this.props.i18n.t("Справочник")),f.createElement("option",{value:H.ValueTypeObjectRefsTypes.FORM},this.props.i18n.t("Ссылка на форму")),f.createElement("option",{value:H.ValueTypeObjectRefsTypes.SERVICE},this.props.i18n.t("Ссылка на служебную форму"))),Object(z.toOption)(o.error).map(function(e){return f.createElement(S.a,null,e)}).getOrNull()),f.createElement(J.b,{toolTipContent:f.createElement("div",null,this.props.i18n.t("текст подсказки"))},f.createElement(x.a,{style:{position:"absolute",right:"-3px",bottom:"14px",width:"15px",height:"15px",padding:0,zIndex:5e3}},f.createElement(G.a,null)))),(o.value===H.ValueTypeObjectRefsTypes.DICTIONARY||o.value===H.ValueTypeObjectRefsTypes.FORM||o.value===H.ValueTypeObjectRefsTypes.SERVICE)&&f.createElement("div",null,f.createElement("div",{style:{display:"flex",alignItems:"center"}},f.createElement(q.a,{native:!0,disabled:this.props.disabled,formType:o.value,errorText:a.touched&&a.error?new z.Some(a.error):new z.None,value:Object(z.toOption)(a.value&&new H.Id(a.value)),onChange:function(e){return e.map(function(e){a.onChange(e)})}}),f.createElement("div",{style:{width:40}}),f.createElement(K.a,{fullWidth:!0,disabled:!a.value||this.props.disabled,fields:g,labelText:new z.Some(this.props.i18n.t("Поле")),errorText:l.touched&&l.error?new z.Some(l.error):new z.None,value:Object(z.toOption)(new H.Id(l.value)),onChanged:function(e){return e.map(function(e){return l.onChange(e)})}}),Object(z.headOption)(this.props.forms.list.filter(function(e){return e.id.value===a.value})).map(function(t){return H.FormType.isSimpleDictionary(t.entity.formType)&&f.createElement("div",{style:{flex:1}},f.createElement(R.a,{variant:"raised",onClick:function(){return e.openDialog(e.props.i18n.t("Редактирование справочника"),f.createElement(Q.a,{form:t,openDialog:e.openDialog,handleDialogClose:e.handleDialogClose}),[])}},e.props.i18n.t("Редактировать")))}).getOrNull()),o.value===H.ValueTypeObjectRefsTypes.DICTIONARY&&this.props.eventLineId.map(function(t){return f.createElement("p",null,f.createElement(R.a,{color:"primary",style:{margin:0},className:"link",onClick:function(){return Object(X.a)({openDialog:e.openDialog,handleDialogClose:e.handleDialogClose,i18n:e.props.i18n,handleCreateAnBound:function(e){a.onChange(e)},dispatch:e.props.dispatch,eventLineId:t})}},e.props.i18n.t("Или создать новый справочник")))}).getOrNull()),o.value===H.ValueTypeDate.$Type.value&&f.createElement(T.a,{fullWidth:!0},f.createElement(C.a,null,this.props.i18n.t("Тип значения")),f.createElement(b.a,{value:d.value,disabled:this.props.disabled,onChange:function(e){return d.onChange(e.target.value)},error:s.touched&&s.error,fullWidth:!0},H.DateTypes.map(function(t,n){return f.createElement(v.a,{key:n,value:t.value},Object(B.s)(t.value,e.props.i18n.t))}))),o.value===H.ValueTypeFormDataAttribute.$Type.value&&f.createElement(T.a,{fullWidth:!0},f.createElement(C.a,null,this.props.i18n.t("Тип атрибута")),f.createElement(b.a,{value:s.value,disabled:this.props.disabled,onChange:function(e){return s.onChange(e.target.value)},error:s.touched&&s.error,fullWidth:!0},H.attributeGeneratorTypes.map(function(t,n){return f.createElement(v.a,{key:n,value:t.value},Object(B.l)(t.value,e.props.i18n.t))}))),(s.value===H.AttributeGeneratorTypeCreatedDate.$Type.value||s.value===H.AttributeGeneratorTypeUpdatedDate.$Type.value)&&f.createElement(T.a,{fullWidth:!0},f.createElement(O.a,{placeholder:this.props.i18n.t("Формат даты ")+"(dd.MM.yyyy hh:mm:ss)",error:c.touched&&c.error,value:c.value,onChange:c.onChange,disabled:this.props.disabled})),s.value===H.AttributeGeneratorTypeInternalId.$Type.value&&f.createElement(O.a,{fullWidth:!0,disabled:this.props.disabled,value:u.value,onChange:u.onChange,label:this.props.i18n.t("Префикс идентификатора"),error:u.touched&&u.error,helperText:u.touched&&Object(z.toOption)(u.error).map(function(e){return e}).getOrNull()}),s.value===H.AttributeGeneratorTypeInternalId.$Type.value&&f.createElement(O.a,{fullWidth:!0,disabled:this.props.disabled,value:p.value,onChange:p.onChange,label:this.props.i18n.t("Постфикс идентификатора"),error:p.touched&&p.error,helperText:p.touched&&Object(z.toOption)(p.error).map(function(e){return e}).getOrNull()}),f.createElement(L.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose,className:"Screen__dialog"},f.createElement(A.a,{style:{borderTop:"none"}},this.state.dialog.actions),f.createElement(M.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),f.createElement($.a,null,this.state.dialog.body.getOrElse(function(){return f.createElement("div",null)}))))}}]),t}(f.Component);re=ee([Z.autobind,te("design:paramtypes",[Object])],re),t.a=Object(h.connect)(function(e){return{i18n:e.i18n,formFields:e.fields,dictionaryForm:e.dictionaryForm,forms:e.forms,eventLineId:e.eventLine.eventLineId}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(m.reduxForm)({form:"fieldEditForm",fields:["id","name","caption","valueType","valueTypeTag","staticValues","referenceFamily","referenceFamilyDisplayField","attributeGeneratorType","dateFormat","internalIdPrefix","internalIdPostfix","dateType"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),e.caption&&0!==e.caption.trim().length||(n.caption=t.i18n.t("Обязательное значение")),e.valueType&&0!==e.valueType.trim().length||(n.valueType=t.i18n.t("Обязательное значение")),e.internalIdPrefix||(e.internalIdPrefix=""),e.internalIdPostfix||(e.internalIdPostfix=""),n}})(re))},1828:function(e,t,n){e.exports=n(97)(290)},1829:function(e,t,n){e.exports=n(97)(95)},1831:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(e,t){return Object.assign({background:e.isDragging?"lightgreen":"inherit"},t.draggableProps.style,(e.isDragging,{}))}},1895:function(e,t,n){"use strict";var i=n(1),r=n(0),o=n(109),a=/\$id\d+/gi,l=/\$value-[a-z0-9\-]{36}/gi,s=/\$link-(\d+)/gi;t.a=function(e,t,c,u,p,d,f){return function(e,t,n){return e.replace(a,function(e){return Object(r.headOption)(t.filter(function(t){return t.id.value===e.slice("$id".length)})).map(function(e){return"{{"+e.entity.caption+"}}"}).getOrElse(function(){return"{{"+n("Поле не найдено")+"}}"})})}(function(e,t,n){return e.replace(l,function(e){return Object(r.headOption)(t.filter(function(t){return t.id===e.slice("$value-".length)})).map(function(e){return"{{"+e.name+"}}"}).getOrElse(function(){return"{{"+n("Значение для вставки не найдено")+"}}"})})}(function(e,t,r,a,l){return e.replace('<img style="width: auto','<img style="width: 100%').replace(s,function(e){return r.map(function(t){return Object(o.b)(t,new i.Id(e.slice("$link-".length)),l)}).getOrElse(function(){return n(854)})})}(e,0,p,0,f),c,d),t,d)}},1919:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(14),m=n(1522),g=n(13),v=n(98),y=n.n(v),b=n(376),E=n.n(b),O=n(1),k=n(42),C=n(4),j=n.n(C),T=n(538),w=n.n(T),S=n(1472),I=n.n(S),R=n(1530),P=n.n(R),x=n(380),_=n.n(x),L=n(56),D=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},A=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"renderChip",value:function(e){var t;return Object(L.b)(this.props.controlType.value)((t={},j()(t,O.HtmlContentElement.$Type.value,e(this.props.i18n.t("Html"),f.createElement(P.a,null))),j()(t,O.EmailButtonElement.$Type.value,e(this.props.i18n.t("Кнопка"),f.createElement(_.a,null))),j()(t,O.EmailImageElement.$Type.value,e(this.props.i18n.t("Изображение"),f.createElement(P.a,null))),j()(t,O.EmailDividerElement.$Type.value,e(this.props.i18n.t("Разделитель"),f.createElement(P.a,null))),t)).getOrElse(function(){return f.createElement(I.a,null,"Unknown")})}},{key:"handleDoubleClick",value:function(e){this.props.onAddControl(this.props.controlType)}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"ControlWidget__container"},this.renderChip(function(t,n){return f.createElement(I.a,{onDoubleClick:e.handleDoubleClick,label:t,avatar:f.createElement(w.a,null,n)})}))}}]),t}(f.Component);A=D([g.autobind],A);var F=Object(h.connect)(function(e){return{i18n:e.i18n}})(A),$=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},W=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"renderChip",value:function(e){return Object(L.b)(this.props.controlType.value)(j()({},O.EmailRowElement.$Type.value,e(this.props.i18n.t("Ряд"),f.createElement(P.a,null)))).getOrElse(function(){return f.createElement(I.a,null,"Unknown")})}},{key:"handleDoubleClick",value:function(e){this.props.onAddControl(this.props.controlType)}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"ContainerWidget__container"},this.renderChip(function(t,n){return f.createElement(I.a,{onDoubleClick:e.handleDoubleClick,label:t,avatar:f.createElement(w.a,null,n)})}))}}]),t}(f.Component);W=$([g.autobind],W);var M=Object(h.connect)(function(e){return{i18n:e.i18n}})(W),N=n(0),H=n(177),z=n(83);n(1939);n.d(t,"a",function(){return V});var B=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},V="ComponentsListType",U=function(e,t,n){return f.createElement(m.b,{key:e,draggableId:e,index:t},function(e,t){return f.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps),n)})},q=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"handleAddControl",value:function(e){var t=this;this.props.emailEditor.selectedElementId.matchWith(function(n){Object(H.c)(t.props.advancedEmailTemplate,n).filter(function(t){return t instanceof O.EmailRowElement&&e.value===O.EmailColumnElement.$Type.value||t instanceof O.EmailRootElement||t instanceof O.EmailColumnElement}).matchWith(function(n){t.props.onComponentAdded(Object(N.toOption)(n.id),e,n.children.length),t.props.dispatch(Object(k.Eb)())},function(){t.addToRoot(e)})},function(){t.addToRoot(e)})}},{key:"addToRoot",value:function(e){var t=this;Object(N.headOption)(this.props.advancedEmailTemplate.rootContainerElement.map(function(e){return e.children}).getOrElse(function(){return[]})).foreach(function(n){t.props.openComponentAttributes(Object(N.toOption)(n.id),e,n.children.length)})}},{key:"render",value:function(){var e=this,t=this.props.i18n;return f.createElement(m.c,{droppableId:V,isDropDisabled:!0},function(n,i){return f.createElement("div",{className:e.props.className,ref:n.innerRef},f.createElement(y.a,{style:{flex:1}},f.createElement(E.a,null,t.t("Контейнеры")),U(O.EmailRowElement.$Type.value,0,f.createElement("div",{className:"ConfigComponentsList__row"},f.createElement(M,{controlType:O.EmailRowElement.$Type,onAddControl:e.handleAddControl}))),f.createElement(E.a,null,t.t("Html")),U(O.HtmlContentElement.$Type.value,1,f.createElement("div",{className:"ConfigComponentsList__row"},f.createElement(F,{controlType:O.HtmlContentElement.$Type,onAddControl:e.handleAddControl}))),f.createElement(E.a,null,t.t("Изображения")),U(O.EmailImageElement.$Type.value,2,f.createElement("div",{className:"ConfigComponentsList__row"},f.createElement(F,{controlType:O.EmailImageElement.$Type,onAddControl:e.handleAddControl}))),f.createElement(E.a,null,t.t("Кнопки")),U(O.EmailButtonElement.$Type.value,3,f.createElement("div",{className:"ConfigComponentsList__row"},f.createElement(F,{controlType:O.EmailButtonElement.$Type,onAddControl:e.handleAddControl}))),f.createElement(E.a,null,t.t("Прочие")),U(O.EmailDividerElement.$Type.value,4,f.createElement("div",{className:"ConfigComponentsList__row"},f.createElement(F,{controlType:O.EmailDividerElement.$Type,onAddControl:e.handleAddControl})))))})}}]),t}(f.Component);q=B([g.autobind],q);t.b=Object(h.connect)(function(e){return{i18n:e.i18n,emailEditor:e.emailEditor,advancedEmailTemplate:e.advancedEmailTemplate.present}})(Object(z.a)(q))},1935:function(e,t,n){"use strict";var i=n(2),r=n(94),o=n.n(r);t.a=function(e){return i.createElement(o.a,Object.assign({},e),i.createElement("path",{d:"M5.35,12.65L6.5,9L7.65,12.65M5.5,7L2.3,16H4.2L4.9,14H8.1L8.8,16H10.7L7.5,7M11,20H22V18H11M14,16H19V11H22L16.5,5.5L11,11H14V16Z"}))}},1939:function(e,t,n){var i=n(1940);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},1940:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},1943:function(e,t,n){"use strict";var i=n(2),r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},s={base:{position:"absolute",userSelect:"none",MsUserSelect:"none"},top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}},c=function(e){return Object(i.createElement)("div",{className:e.className,style:a({},s.base,s[e.direction],e.replaceStyles||{}),onMouseDown:function(t){e.onResizeStart(t,e.direction)},onTouchStart:function(t){e.onResizeStart(t,e.direction)}},e.children)},u={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},p={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"},d=function(e,t,n){return Math.max(Math.min(e,n),t)},f=function(e,t){return Math.round(e/t)*t},h=function(e,t){return t.reduce(function(t,n){return Math.abs(n-e)<Math.abs(t-e)?n:t})},m=function(e,t){return e.substr(e.length-t.length,t.length)===t},g=function(e){return"auto"===e.toString()?e.toString():m(e.toString(),"px")?e.toString():m(e.toString(),"%")?e.toString():m(e.toString(),"vh")?e.toString():m(e.toString(),"vw")?e.toString():m(e.toString(),"vmax")?e.toString():m(e.toString(),"vmin")?e.toString():e+"px"},v=["style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatioX","resizeRatioY"],y=function(e){function t(e){r(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isResizing:!1,resizeCursor:"auto",width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0}},n.updateExtendsProps(e),n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),"undefined"!=typeof window&&(window.addEventListener("mouseup",n.onMouseUp),window.addEventListener("mousemove",n.onMouseMove),window.addEventListener("mouseleave",n.onMouseUp),window.addEventListener("touchmove",n.onMouseMove),window.addEventListener("touchend",n.onMouseUp)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),o(t,[{key:"updateExtendsProps",value:function(e){this.extendsProps=Object.keys(e).reduce(function(t,n){return-1!==v.indexOf(n)?t:(t[n]=e[n],t)},{})}},{key:"getParentSize",value:function(){var e=this.base;if(!e)return{width:window.innerWidth,height:window.innerHeight};var t=!1,n=this.parentNode.style.flexWrap,i=e.style.minWidth;"wrap"!==n&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%";var r={width:e.offsetWidth,height:e.offsetHeight};return e.style.position="absolute",t&&(this.parentNode.style.flexWrap=n),e.style.minWidth=i,r}},{key:"componentDidMount",value:function(){var e=this.size;this.setState({width:this.state.width||e.width,height:this.state.height||e.height});var t=this.parentNode;if(t instanceof HTMLElement&&!this.base){var n=document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.transform="scale(0, 0)",n.style.left="0",n.style.flex="0",n.classList?n.classList.add("__resizable_base__"):n.className+="__resizable_base__",t.appendChild(n)}}},{key:"componentWillReceiveProps",value:function(e){this.updateExtendsProps(e)}},{key:"componentWillUnmount",value:function(){if("undefined"!=typeof window){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseleave",this.onMouseUp),window.removeEventListener("touchmove",this.onMouseMove),window.removeEventListener("touchend",this.onMouseUp);var e=this.parentNode,t=this.base;if(!t||!e)return;if(!(e instanceof HTMLElement&&t instanceof Node))return;e.removeChild(t)}}},{key:"calculateNewSize",value:function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"}},{key:"onResizeStart",value:function(e,t){var n=0,i=0;if(e.nativeEvent instanceof MouseEvent){if(n=e.nativeEvent.clientX,i=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent instanceof TouchEvent&&(n=e.nativeEvent.touches[0].clientX,i=e.nativeEvent.touches[0].clientY);this.props.onResizeStart&&this.props.onResizeStart(e,t,this.resizable),this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.setState({original:{x:n,y:i,width:this.size.width,height:this.size.height},isResizing:!0,resizeCursor:window.getComputedStyle(e.target).cursor,direction:t})}},{key:"onMouseMove",value:function(e){if(this.state.isResizing){var t=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,n=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,i=this.state,r=i.direction,o=i.original,a=i.width,l=i.height,s=this.props,c=s.lockAspectRatio,u=s.lockAspectRatioExtraHeight,p=s.lockAspectRatioExtraWidth,g=this.props.scale||1,v=this.props,y=v.maxWidth,b=v.maxHeight,E=v.minWidth,O=v.minHeight,k=this.props.resizeRatioX||1,C=this.props.resizeRatioY||1,j=this.getParentSize();if(y&&"string"==typeof y&&m(y,"%")){var T=Number(y.replace("%",""))/100;y=j.width*T}if(b&&"string"==typeof b&&m(b,"%")){var w=Number(b.replace("%",""))/100;b=j.height*w}if(E&&"string"==typeof E&&m(E,"%")){var S=Number(E.replace("%",""))/100;E=j.width*S}if(O&&"string"==typeof O&&m(O,"%")){var I=Number(O.replace("%",""))/100;O=j.height*I}y=void 0===y?void 0:Number(y),b=void 0===b?void 0:Number(b),E=void 0===E?void 0:Number(E),O=void 0===O?void 0:Number(O);var R="number"==typeof c?c:o.width/o.height,P=o.width,x=o.height;if(/right/i.test(r)&&(P=o.width+(t-o.x)*k/g,c&&(x=(P-p)/R+u)),/left/i.test(r)&&(P=o.width-(t-o.x)*k/g,c&&(x=(P-p)/R+u)),/bottom/i.test(r)&&(x=o.height+(n-o.y)*C/g,c&&(P=(x-u)*R+p)),/top/i.test(r)&&(x=o.height-(n-o.y)*C/g,c&&(P=(x-u)*R+p)),"parent"===this.props.bounds){var _=this.parentNode;if(_ instanceof HTMLElement){var L=_.getBoundingClientRect(),D=L.left,A=L.top,F=this.resizable.getBoundingClientRect(),$=F.left,W=F.top,M=_.offsetWidth+(D-$),N=_.offsetHeight+(A-W);y=y&&y<M?y:M,b=b&&b<N?b:N}}else if("window"===this.props.bounds){if("undefined"!=typeof window){var H=this.resizable.getBoundingClientRect(),z=H.left,B=H.top,V=window.innerWidth-z,U=window.innerHeight-B;y=y&&y<V?y:V,b=b&&b<U?b:U}}else if(this.props.bounds instanceof HTMLElement){var q=this.props.bounds.getBoundingClientRect(),K=q.left,G=q.top,J=this.resizable.getBoundingClientRect(),Y=J.left,X=J.top;if(!(this.props.bounds instanceof HTMLElement))return;var Z=this.props.bounds.offsetWidth+(K-Y),Q=this.props.bounds.offsetHeight+(G-X);y=y&&y<Z?y:Z,b=b&&b<Q?b:Q}var ee=void 0===E?10:E,te=void 0===y||y<0?P:y,ne=void 0===O?10:O,ie=void 0===b||b<0?x:b;if(c){var re=(ne-u)*R+p,oe=(ie-u)*R+p,ae=(ee-p)/R+u,le=(te-p)/R+u,se=Math.max(ee,re),ce=Math.min(te,oe),ue=Math.max(ne,ae),pe=Math.min(ie,le);P=d(P,se,ce),x=d(x,ue,pe)}else P=d(P,ee,te),x=d(x,ne,ie);this.props.grid&&(P=f(P,this.props.grid[0])),this.props.grid&&(x=f(x,this.props.grid[1])),this.props.snap&&this.props.snap.x&&(P=h(P,this.props.snap.x)),this.props.snap&&this.props.snap.y&&(x=h(x,this.props.snap.y));var de={width:P-o.width,height:x-o.height};if(a&&"string"==typeof a&&m(a,"%"))P=P/j.width*100+"%";if(l&&"string"==typeof l&&m(l,"%"))x=x/j.height*100+"%";this.setState({width:this.calculateNewSize(P,"width"),height:this.calculateNewSize(x,"height")}),this.props.onResize&&this.props.onResize(e,r,this.resizable,de)}}},{key:"onMouseUp",value:function(e){var t=this.state,n=t.isResizing,i=t.direction,r=t.original;if(n){var o={width:this.size.width-r.width,height:this.size.height-r.height};this.props.onResizeStop&&this.props.onResizeStop(e,i,this.resizable,o),this.props.size&&this.setState(this.props.size),this.setState({isResizing:!1,resizeCursor:"auto"})}}},{key:"updateSize",value:function(e){this.setState({width:e.width,height:e.height})}},{key:"renderResizer",value:function(){var e=this,t=this.props,n=t.enable,r=t.handleStyles,o=t.handleClasses,a=t.handleWrapperStyle,l=t.handleWrapperClass,s=t.handleComponent;if(!n)return null;var u=Object.keys(n).map(function(t){return!1!==n[t]?Object(i.createElement)(c,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:r&&r[t],className:o&&o[t]},s&&s[t]?Object(i.createElement)(s[t]):null):null});return Object(i.createElement)("span",{className:l,style:a},u)}},{key:"render",value:function(){var e=this,t=this.state.isResizing?u:p;return Object(i.createElement)("div",a({ref:function(t){t&&(e.resizable=t)},style:a({position:"relative"},t,this.props.style,this.sizeStyle,{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box"}),className:this.props.className},this.extendsProps),this.state.isResizing&&Object(i.createElement)("div",{style:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:""+(this.state.resizeCursor||"auto"),opacity:"0",position:"fixed",zIndex:"9999",top:"0",left:"0",bottom:"0",right:"0"}}),this.props.children,this.renderResizer())}},{key:"parentNode",get:function(){return this.resizable.parentNode}},{key:"propsSize",get:function(){return this.props.size||this.props.defaultSize}},{key:"base",get:function(){var e=this.parentNode;if(e)for(var t=[].slice.call(e.children),n=0;n<t.length;n+=1){var i=t[n];if(i instanceof HTMLElement&&i.classList.contains("__resizable_base__"))return i}}},{key:"size",get:function(){var e=0,t=0;if("undefined"!=typeof window){var n=this.resizable.offsetWidth,i=this.resizable.offsetHeight,r=this.resizable.style.position;"relative"!==r&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:i,this.resizable.style.position=r}return{width:e,height:t}}},{key:"sizeStyle",get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&m(e.propsSize[t].toString(),"%")){if(m(e.state[t].toString(),"%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return g(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?g(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?g(t.height):n("height")}}}]),t}();y.defaultProps={onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatioX:1,resizeRatioY:1},t.a=y},2004:function(e,t,n){e.exports=n(49)(124)},2015:function(e,t,n){"use strict";var i=n(6),r=n.n(i),o=n(10),a=n.n(o),l=n(7),s=n.n(l),c=n(8),u=n.n(c),p=n(11),d=n.n(p),f=n(2),h=n(14),m=n(13),g=n(867),v=n.n(g),y=n(19),b=n.n(y),E=n(98),O=n.n(E),k=n(1),C=n(29),j=n(3),T=n(32),w=n.n(T),S=n(34),I=n.n(S),R=n(30),P=n.n(R),x=n(25),_=n.n(x),L=n(72),D=n.n(L),A=n(228),F=n(16),$=n(270),W=n(68),M=n(0),N=n(46),H=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},z=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"onAddressTypeChanged",value:function(e){this.props.onChange(j(this.props.addressType,{type:{$set:e.target.value}}),this.props.idx)}},{key:"onFormFieldIdChanged",value:function(e){this.props.onChange(j(this.props.addressType,{fieldId:{$set:e.map(function(e){return e.value}).getOrElse(function(){return""})}}),this.props.idx)}},{key:"onTemplateChanged",value:function(e){this.props.onChange(j(this.props.addressType,{template:{$set:Object($.a)(Object(F.convertToRaw)(e.getCurrentContent()))}}),this.props.idx)}},{key:"onDeleteClick",value:function(e){this.props.onDelete(this.props.idx)}},{key:"render",value:function(){return f.createElement("div",{style:{position:"relative"}},f.createElement(w.a,{fullWidth:!0},f.createElement(I.a,{shrink:!0},this.props.i18n.t("Тип поля")),f.createElement(P.a,{fullWidth:!0,native:!0,value:this.props.addressType.type,onChange:this.onAddressTypeChanged},f.createElement("option",{value:k.EmailAddressTypeFieldId.$Type.value},this.props.i18n.t("Поле анкеты")),f.createElement("option",{value:k.EmailAddressTypeTemplate.$Type.value},this.props.i18n.t("Шаблон")))),this.props.addressType.type===k.EmailAddressTypeFieldId.$Type.value&&f.createElement(W.a,{native:!0,errorText:new M.None,labelText:Object(M.toOption)(this.props.i18n.t("Поле с email")),fullWidth:!0,fields:this.props.formFields.getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===k.ValueTypeStr.$Type.value}),onChanged:this.onFormFieldIdChanged,value:k.Id.createId(this.props.addressType.fieldId)}),this.props.addressType.type===k.EmailAddressTypeTemplate.$Type.value&&f.createElement("div",{style:{marginTop:10}},f.createElement(A.a,{formId:this.props.formId,generators:[],onChange:this.onTemplateChanged,templateId:"",template:this.props.addressType.template,withRefFieldSelector:!0})),f.createElement(_.a,{style:Object.assign({},N.f,{position:"absolute",top:"5px",right:"5px"}),onClick:this.onDeleteClick},f.createElement(D.a,{style:N.g})))}}]),t}(f.Component);z=H([m.autobind],z);var B=Object(h.connect)(function(e,t){return{i18n:e.i18n,formFields:Object(C.e)(e.fields,t.formId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(z),V=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},U=function(e){function t(){return r()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"getInitialValues",value:function(e){var t={addressType:e.tpe.value};switch(e.tpe.value){case k.EmailAddressTypeFieldId.$Type.value:return Object.assign({},t,{formFieldId:e.id.value});case k.EmailAddressTypeTemplate.$Type.value:return Object.assign({},t,{template:e.value});default:throw"unknown address type"}}},{key:"getAddressType",value:function(e){switch(e.addressType){case k.EmailAddressTypeFieldId.$Type.value:return new k.EmailAddressTypeFieldId(k.Id.createId(e.formFieldId).getOrElse(function(){throw"wrong form field id"}));case k.EmailAddressTypeTemplate.$Type.value:return new k.EmailAddressTypeTemplate(e.template);default:throw"unknown address type"}}},{key:"onAddAddressTypeButtonClick",value:function(){this.props.onChange(j(this.props.addressTypes,{$push:[{type:k.EmailAddressTypeFieldId.$Type.value,fieldId:"",template:""}]}))}},{key:"onAddressTypeRemove",value:function(e){this.props.onChange(j(this.props.addressTypes,{$splice:[[e,1]]}))}},{key:"onAddressTypeChanged",value:function(e,t){this.props.onChange(j(this.props.addressTypes,{$splice:[[t,1,e]]}))}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:{marginBottom:"20px",marginTop:"20px"}},f.createElement(v.a,null,this.props.i18n.t("Список адресов отправки")),this.props.addressTypes.length>0&&f.createElement(O.a,null,this.props.addressTypes.map(function(t,n){return f.createElement(B,{idx:n,formId:e.props.formId,addressType:t,onChange:e.onAddressTypeChanged,onDelete:e.onAddressTypeRemove})})),f.createElement("div",null,f.createElement(b.a,{variant:"raised",onClick:this.onAddAddressTypeButtonClick,style:{marginRight:"10px"}},this.props.i18n.t("Добавить"))))}}]),t}(f.Component);U=V([m.autobind],U);t.a=Object(h.connect)(function(e,t){return{i18n:e.i18n,fields:Object(C.e)(e.fields,t.formId)}})(U)},2592:function(e,t,n){var i=n(2593);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2593:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".EmailEditor-HtmlContentWidget p {\n  margin: 0; }\n",""])},2594:function(e,t,n){var i=n(2595);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2595:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.subtitle {\n  margin: 2em 0 2em 0; }\n\n.fancy {\n  line-height: 0.5;\n  text-align: center; }\n\n.fancy span {\n  display: inline-block;\n  position: relative; }\n\n.fancy span:before,\n.fancy span:after {\n  content: "";\n  position: absolute;\n  border-bottom: 1px solid white;\n  border-top: 1px solid white;\n  height: 5px;\n  top: 0;\n  width: 600px; }\n\n.fancy span:before {\n  right: 100%;\n  margin-right: 15px; }\n\n.fancy span:after {\n  left: 100%;\n  margin-left: 15px; }\n',""])},2596:function(e,t,n){var i=n(2597);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2597:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,"",""])},2598:function(e,t,n){var i=n(2599);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2599:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".RootContainerWidget__container-selected {\n  height: 100%;\n  box-sizing: border-box; }\n\n.RootContainerWidget__container {\n  height: 100%;\n  box-sizing: border-box; }\n\n.RootContainerWidget__selection {\n  height: 100%; }\n\n.RootContainerWidget__container-children {\n  height: 100%; }\n",""])},2600:function(e,t,n){var i=n(2601);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2601:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.RowWidget__container-children {\n  display: flex;\n  flex-direction: row; }\n\n.RowWidget__wrapper {\n  cursor: pointer;\n  z-index: 1; }\n  .RowWidget__wrapper--selected, .RowWidget__wrapper--dragging, .RowWidget__wrapper:hover {\n    background-color: #EFF9FE; }\n  .RowWidget__wrapper--dragging .RowWidget__cover {\n    opacity: 0; }\n  .RowWidget__wrapper:hover .RowWidget__button {\n    display: block; }\n\n.RowWidget__cover {\n  display: flex;\n  flex: 1;\n  position: relative;\n  z-index: 2; }\n\n.RowWidget__cover:before {\n  content: "";\n  display: block;\n  background-color: transparent;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 10; }\n\n.RowWidget__button {\n  display: none;\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  z-index: 11; }\n',""])},2603:function(e,t,n){var i=n(2604);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2604:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".ColumnWidget__selection {\n  height: 100%; }\n\n.ColumnWidget__container-children {\n  height: 100%; }\n",""])},2605:function(e,t,n){var i=n(2606);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2606:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".Email-ElementRenderer__component-selected {\n  background-color: #B3E5FC;\n  cursor: pointer;\n  min-height: 200px;\n  z-index: 1; }\n\n.Email-ElementRenderer__component {\n  cursor: pointer;\n  min-height: 200px;\n  z-index: 1; }\n\n.Email-ElementRenderer__container {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n\n.Email-ElementRenderer__container-selected {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n  .Email-ElementRenderer__container-selected > .Email-ElementRenderer__container-selection {\n    background-color: rgba(136, 136, 136, 0.3) !important; }\n\n.Email-ElementRenderer__container-selection {\n  height: 100%; }\n\n.Email-ElementRenderer__button {\n  position: absolute !important;\n  font-size: 15px;\n  width: 15px;\n  height: 15px;\n  top: 0px !important;\n  right: 0px !important;\n  z-index: 11 !important; }\n",""])},2607:function(e,t,n){var i=n(2608);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2608:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,'.ComponentWidget__cover {\n  display: flex;\n  flex: 1;\n  position: relative;\n  z-index: 2; }\n\n.ComponentWidget__wrapper {\n  cursor: pointer;\n  z-index: 1; }\n  .ComponentWidget__wrapper--selected, .ComponentWidget__wrapper--dragging, .ComponentWidget__wrapper:hover {\n    background-color: #B3E5FC; }\n  .ComponentWidget__wrapper--dragging .ComponentWidget__cover {\n    opacity: 0; }\n  .ComponentWidget__wrapper:hover .ComponentWidget__button {\n    display: block; }\n\n.ComponentWidget__container {\n  position: relative;\n  display: flex;\n  flex: 1; }\n\n.ComponentWidget__cover:before {\n  content: "";\n  display: block;\n  background-color: transparent;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 10; }\n\n.ComponentWidget__button {\n  display: none;\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  z-index: 11; }\n\n.ComponentWidget__dropzone {\n  position: relative;\n  width: 100%;\n  height: 100px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.ComponentWidget__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.ComponentWidget__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n\n.ComponentWidget__imageControlEditor-container {\n  text-align: center; }\n\n.ComponentWidget__imageControlEditor-wrapper {\n  display: inline-block; }\n\n.ComponentWidget__imageControlEditor-image {\n  height: 300px;\n  width: 225px;\n  margin-bottom: 6px; }\n\n.ComponentWidget__imageControlEditor-button {\n  width: 100%;\n  display: block !important; }\n\n.ComponentWidget__ImageListControlEditor-container {\n  text-align: center;\n  display: flex;\n  align-items: center;\n  justify-content: center; }\n\n.ComponentWidget__ImageListControlEditor-imagesWrapper {\n  display: flex;\n  flex-flow: row nowrap; }\n\n.ComponentWidget__ImageListControlEditor-image {\n  width: 100%;\n  max-width: 100px; }\n\n.ComponentWidget__ImageListControlEditor-imageContainer {\n  margin: 4px; }\n\n.ComponentWidget__ImageListControlEditor-addButton {\n  color: #03A9F4 !important;\n  height: 36px !important;\n  width: 36px !important; }\n\n.ComponentWidget__ObjRefsTableEditor-background {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%; }\n\n.ComponentWidget__ObjRefsTableEditor-background:hover {\n  background-color: #B3E5FC !important; }\n\n.LogWidget__title {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  font-size: 75px;\n  transform: translateX(-50%) translateY(-50%);\n  opacity: 0.1; }\n\n.ComponentWidget__colorPickerWidget {\n  width: 100%;\n  position: relative; }\n  .ComponentWidget__colorPickerWidget-color {\n    position: absolute;\n    width: 50%;\n    height: 80%;\n    top: 5%;\n    right: 25%; }\n\n.ComponentWidget__tagsWidget {\n  margin: .5em 0;\n  display: flex; }\n  .ComponentWidget__tagsWidget > * {\n    margin: .3em; }\n\n.HTMLWidget__title {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  font-size: 3em;\n  opacity: 0.2; }\n\n.HTMLWidget__placeholder {\n  width: 100%;\n  position: relative;\n  min-height: 150px;\n  min-width: 250px;\n  border: 1px dashed; }\n',""])},2609:function(e,t,n){var i=n(2610);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2610:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".EmailEditorScene__container > * {\n  font-family: Arial, Helvetica, sans-serif; }\n",""])},2611:function(e,t,n){var i=n(2612);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2612:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".TextEditor__content {\n  padding: 5px;\n  border: 1px solid #757575; }\n  .TextEditor__content .public-DraftEditor-content {\n    min-height: 300px; }\n\n.HtmlEditor__toolbar {\n  padding: 0 !important;\n  margin-bottom: 10px;\n  background-color: #fff !important;\n  flex-shrink: 0; }\n\n.HtmlEditor__textAlignCenter div {\n  text-align: center; }\n\n.HtmlEditor__textAlignLeft div {\n  text-align: left; }\n\n.HtmlEditor__textAlignJustify div {\n  text-align: justify; }\n\n.HtmlEditor__textAlignRight div {\n  text-align: right; }\n",""])},2614:function(e,t,n){var i=n(2615);"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(121)(i,r);i.locals&&(e.exports=i.locals)},2615:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".bell {\n  -webkit-animation: ring 4s .7s ease-in-out infinite;\n  -webkit-transform-origin: 50% 4px;\n  -moz-animation: ring 4s .7s ease-in-out infinite;\n  -moz-transform-origin: 50% 4px;\n  animation: ring 4s .7s ease-in-out infinite;\n  transform-origin: 50% 4px; }\n\n.NotifyTemplatePage__notificationItem {\n  cursor: pointer; }\n  .NotifyTemplatePage__notificationItem:hover {\n    background-color: #E0E0E0; }\n\n@-webkit-keyframes ring {\n  0% {\n    -webkit-transform: rotateZ(0); }\n  1% {\n    -webkit-transform: rotateZ(30deg); }\n  3% {\n    -webkit-transform: rotateZ(-28deg); }\n  5% {\n    -webkit-transform: rotateZ(34deg); }\n  7% {\n    -webkit-transform: rotateZ(-32deg); }\n  9% {\n    -webkit-transform: rotateZ(30deg); }\n  11% {\n    -webkit-transform: rotateZ(-28deg); }\n  13% {\n    -webkit-transform: rotateZ(26deg); }\n  15% {\n    -webkit-transform: rotateZ(-24deg); }\n  17% {\n    -webkit-transform: rotateZ(22deg); }\n  19% {\n    -webkit-transform: rotateZ(-20deg); }\n  21% {\n    -webkit-transform: rotateZ(18deg); }\n  23% {\n    -webkit-transform: rotateZ(-16deg); }\n  25% {\n    -webkit-transform: rotateZ(14deg); }\n  27% {\n    -webkit-transform: rotateZ(-12deg); }\n  29% {\n    -webkit-transform: rotateZ(10deg); }\n  31% {\n    -webkit-transform: rotateZ(-8deg); }\n  33% {\n    -webkit-transform: rotateZ(6deg); }\n  35% {\n    -webkit-transform: rotateZ(-4deg); }\n  37% {\n    -webkit-transform: rotateZ(2deg); }\n  39% {\n    -webkit-transform: rotateZ(-1deg); }\n  41% {\n    -webkit-transform: rotateZ(1deg); } }\n",""])},2716:function(e,t,n){"use strict";n.r(t);var i=n(4),r=n.n(i),o=n(6),a=n.n(o),l=n(10),s=n.n(l),c=n(7),u=n.n(c),p=n(8),d=n.n(p),f=n(11),h=n.n(f),m=n(2),g=n(13),v=n(14),y=n(1932),b=n.n(y),E=n(3),O=n(1933),k=n.n(O),C=n(16),j=n(434),T=n(93),w=n.n(T),S=n(19),I=n.n(S),R=n(25),P=n.n(R),x=n(33),_=n.n(x),L=n(75),D=n.n(L),A=n(115),F=n.n(A),$=n(241),W=n.n($),M=n(261),N=n.n(M),H=n(242),z=n.n(H),B=n(243),V=n.n(B),U=n(1935),q=n(1945),K=n.n(q),G=n(1911),J=n.n(G),Y=n(347),X=n(310),Z={FIELDID:["$id<%= fieldId %>"," "],EVENT_LINK:["$actionUrl-<%= eventId %>"," "],APP_LOGIN_LINK:["$actionUrl-<%= uid %>"," "]},Q=function(e){return e.blocks.map(function(t,n){return Object(Y.a)(t.entityRanges,["offset"],["desc"]).reduce(function(t,n){var i=e.entityMap[n.key],r=Z[i.type],o=n.offset,a=Object(X.a)(r[0])(i.data);return t=t.substr(0,o)+a+t.substr(o+n.length)},t.text)}).join(String.fromCharCode(10))},ee=n(1),te=n(0),ne=n(627),ie=n(1478),re=n(1467),oe=n(79),ae=n(377),le=n(364),se=n(801),ce=function(e){return function(t){return t(Object(le.e)()),ae.f(e).then(function(e){return t(Object(le.f)(e.record)),e.record}).catch(function(e){throw t(Object(le.d)(e)),e})}},ue=function(e){return function(t,n){return n().notifyTemplate.data.matchWith(function(e){return new Promise(function(t,n){return t(e)})},function(){return Object(se.b)(n().notifyTemplates,e).matchWith(function(e){return t(Object(le.f)(e)),new Promise(function(t,n){return t(e)})},function(){return t(ce(e))})})}},pe=n(641),de=n(1599),fe=n(645),he=n(1483),me=n(18),ge=n(95),ve=n(26),ye=n.n(ve),be=n(856),Ee=n.n(be),Oe=n(857),ke=n.n(Oe),Ce=n(32),je=n.n(Ce),Te=n(34),we=n.n(Te),Se=n(30),Ie=n.n(Se),Re=n(42),Pe=n(29),xe=n(104),_e=n(68),Le=n(98),De=n.n(Le),Ae=n(107),Fe=n.n(Ae),$e=n(219),We=n.n($e),Me=n(54),Ne=n.n(Me),He=n(72),ze=n.n(He),Be=n(651),Ve=n(99),Ue=n(139),qe=n(24),Ke=n.n(qe),Ge=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Je=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ye=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={selectedDocumentId:new te.None},n}return d()(t,e),s()(t,[{key:"onDocumentSelected",value:function(e){var t=new ee.Id(e.target.value);this.setState(E(this.state,{selectedDocumentId:{$set:new te.Some(t)}})),this.props.onSelect(t)}},{key:"render",value:function(){return m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Документ")),m.createElement(Ie.a,{fullWidth:!0,onChange:this.onDocumentSelected,value:this.state.selectedDocumentId.map(function(e){return e.value}).getOrElse(function(){return""})},Object(Be.b)(this.props.documents,this.props.formId).getOrElse(function(){return[]}).filter(function(e){return e.entity.issueType.tpe.value===ee.IssueTypeEmail.$Type.value}).map(function(e){return m.createElement(Ke.a,{key:e.id.value,value:e.id.value},e.entity.name)})))}}]),t}(m.Component);Ye=Ge([g.autobind,Je("design:paramtypes",[Object])],Ye);var Xe=Object(v.connect)(function(e){return{i18n:e.i18n,documents:e.formDocuments}})(Ye),Ze=n(83),Qe=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},et=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tt=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fieldId:new te.None},n}return d()(t,e),s()(t,[{key:"onFieldSelected",value:function(e){var t=new ee.Id(e.target.value);this.setState(E(this.state,{fieldId:{$set:new te.Some(t)}})),this.props.onSelect(t)}},{key:"render",value:function(){return m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Поле")),m.createElement(Ie.a,{fullWidth:!0,onChange:this.onFieldSelected,value:this.state.fieldId.map(function(e){return e.value}).getOrElse(function(){return""})},Object(Pe.e)(this.props.fields,this.props.formId).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType instanceof ee.ValueTypeFileList}).map(function(e){return m.createElement(Ke.a,{key:e.id.value,value:e.id.value},e.entity.caption)})))}}]),t}(m.Component);tt=Qe([g.autobind,et("design:paramtypes",[Object])],tt);var nt=Object(v.connect)(function(e){return{i18n:e.i18n,fields:e.fields}})(tt),it=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},rt=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ot=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fileFieldId=new te.None,n.state={files:[],selectedDocumentId:new te.None,dialog:{open:!1,title:new te.None,body:new te.None,actions:[]},fileInput:new te.None},n}return d()(t,e),s()(t,[{key:"componentWillMount",value:function(){this.props.dispatch(Object(Ve.d)(this.props.attachments.filter(function(e){return e.tpe.value===ee.AttachmentFileAttachment.$Type.value}).map(function(e){return e.fileId})))}},{key:"openDialog",value:function(e,t,n){this.setState(E(this.state,{dialog:{open:{$set:!0},title:{$set:new te.Some(e)},body:{$set:new te.Some(t)},actions:{$set:n}}}))}},{key:"handleDialogClose",value:function(){this.setState(E(this.state,{dialog:{open:{$set:!1},title:{$set:new te.None},body:{$set:new te.None},actions:{$set:[]}}}))}},{key:"onFileRemove",value:function(e){this.props.onChange(E(this.props.attachments,{$splice:[[e,1]]}))}},{key:"getAttachmentName",value:function(e){var t=this;switch(e.tpe.value){case ee.AttachmentFileAttachment.$Type.value:return Object(te.headOption)(this.props.fileMetas.list.filter(function(t){return t.id.value===e.fileId.value})).map(function(e){return e.entity.originalName}).getOrElse(function(){return t.props.i18n.t("Файл не найден")});case ee.AttachmentDocumentAttachment.$Type.value:return Object(te.headOption)(Object(Be.b)(this.props.documents,this.props.formId).getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.documentId.value})).map(function(e){return e.entity.name.toString()}).getOrElse(function(){return t.props.i18n.t("Документ не найден")});case ee.AttachmentLinkAttachment.$Type.value:return Object(te.headOption)(Object(Be.b)(this.props.documents,this.props.formId).getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.fileId.value})).map(function(e){return e.entity.name.toString()}).getOrElse(function(){return t.props.i18n.t("Файл не найден")});case ee.AttachmentFormDataAttachment.$Type.value:return Object(te.headOption)(Object(Pe.e)(this.props.fields,this.props.formId).getOrElse(function(){return[]}).filter(function(t){return t.id.value===e.fieldId.value})).map(function(e){return e.entity.name.toString()}).getOrElse(function(){return t.props.i18n.t("Файл не найден")});default:throw"Wrong attachment type "+e.tpe.value}}},{key:"onDocumentSelected",value:function(e){this.setState(E(this.state,{selectedDocumentId:{$set:new te.Some(e)}}))}},{key:"onAddDocumentButtonClick",value:function(){var e=this;this.openDialog(this.props.i18n.t("Добавление документа"),m.createElement("div",null,m.createElement(Xe,{formId:this.props.formId,onSelect:this.onDocumentSelected})),[m.createElement(I.a,{variant:"raised",onClick:function(){e.handleDialogClose()},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),m.createElement(I.a,{variant:"raised",color:"primary",onClick:function(){return e.state.selectedDocumentId.foreach(function(t){e.props.onChange(E(e.props.attachments,{$push:[new ee.AttachmentDocumentAttachment(t)]})),e.handleDialogClose()})}},this.props.i18n.t("Добавить"))])}},{key:"onAddFileButtonClick",value:function(){this.fileUpload(this.fileChanged)}},{key:"fileUpload",value:function(e){this.state.fileInput.foreach(function(e){return e.click()})}},{key:"fileChanged",value:function(e){var t=this,n=e.target.files[0];Object(Ve.h)(n,this.props.cdnAddress,this.props.auth.token,this.props.organisation.organisationId,this.props.eventLine.eventLineId,new te.None,new te.Some(new ee.FileTypeMailAttach),"true").then(function(e){Object(Ve.b)(e).then(function(e){t.props.dispatch(Object(Ue.e)([e.record]))}),t.props.onChange(E(t.props.attachments,{$push:[new ee.AttachmentFileAttachment(e)]}))}).catch(function(e){console.error("File uploaded with error",e)})}},{key:"fileInputHandler",value:function(e){this.setState(E(this.state,{fileInput:{$set:Object(te.toOption)(e)}}))}},{key:"onFileFieldSelected",value:function(e){this.fileFieldId=new te.Some(e)}},{key:"onAddFileField",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Добавление файла из поля"),m.createElement(nt,{formId:this.props.formId,onSelect:this.onFileFieldSelected}),[m.createElement(I.a,{variant:"raised",onClick:function(){return e.props.handleDialogClose(t)}},this.props.i18n.t("Отмена")),m.createElement(I.a,{variant:"raised",color:"primary",onClick:function(){return e.fileFieldId.foreach(function(n){e.props.onChange(E(e.props.attachments,{$push:[new ee.AttachmentFormDataAttachment(n)]})),e.props.handleDialogClose(t)})}},this.props.i18n.t("Добавить"))])}},{key:"render",value:function(){var e=this;return m.createElement("div",null,m.createElement("input",{ref:this.fileInputHandler,type:"file",onChange:this.fileChanged,style:{display:"none"}}),m.createElement(De.a,null,this.props.attachments.map(function(t,n){return m.createElement(Fe.a,{key:n},m.createElement(Ne.a,{primary:e.getAttachmentName(t)}),m.createElement(We.a,null,m.createElement(P.a,{onClick:function(){return e.onFileRemove(n)}},m.createElement(ze.a,null))))})),m.createElement("div",null,m.createElement(I.a,{variant:"raised",onClick:this.onAddDocumentButtonClick,style:{marginRight:"10px"}},this.props.i18n.t("Добавить документ")),m.createElement(I.a,{variant:"raised",onClick:this.onAddFileButtonClick,style:{marginRight:"10px"}},this.props.i18n.t("Добавить файл")),m.createElement(I.a,{variant:"raised",onClick:this.onAddFileField},this.props.i18n.t("Файлы из поля"))),m.createElement(W.a,{fullWidth:!0,open:this.state.dialog.open,onClose:this.handleDialogClose},m.createElement(N.a,{style:{borderBottom:"none"}},this.state.dialog.title.getOrElse(function(){return""})),m.createElement(z.a,null,this.state.dialog.body.getOrElse(function(){return m.createElement("div",null)})),m.createElement(V.a,{style:{borderTop:"none"}},">",this.state.dialog.actions)))}}]),t}(m.Component);ot=it([g.autobind,rt("design:paramtypes",[Object])],ot);var at=Object(v.connect)(function(e){return{i18n:e.i18n,fileMetas:e.fileMetas,documents:e.formDocuments,auth:e.auth,eventLine:e.eventLine,organisation:e.organisation,fields:e.fields,cdnAddress:e.config.cdnAddress}})(Object(Ze.a)(ot)),lt=n(417),st=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ct=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ut=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={files:[]},n}return d()(t,e),s()(t,[{key:"onFilesDrop",value:function(e){var t=this,n=e[0];Object(Ve.h)(n,this.props.cdnAddress,this.props.auth.token,this.props.organisation.organisationId,this.props.eventLine.eventLineId,new te.None,new te.None).then(function(e){Object(Ve.b)(e).then(function(e){t.setState(E(t.state,{files:{$push:[e.record.entity]}}))}),t.props.onChange(E(t.props.attachments,{$push:[new ee.AttachmentFileAttachment(e)]}))}).catch(function(e){console.log("File uploaded with error",e)})}},{key:"onFileRemove",value:function(e){this.setState(E(this.state,{files:{$splice:[[e,1]]}})),this.props.onChange(E(this.props.attachments,{$splice:[[e,1]]}))}},{key:"render",value:function(){var e=this;return m.createElement("div",{style:{display:"flex"}},m.createElement("div",{style:{flex:1}},m.createElement(De.a,null,this.state.files.map(function(t,n){return m.createElement(Fe.a,null,m.createElement(Ne.a,{primary:t.originalName}),m.createElement(We.a,null,m.createElement(P.a,{onClick:function(){return e.onFileRemove(n)}},m.createElement(ze.a,null))))}))),m.createElement("div",{style:{flex:1}},m.createElement(lt,{onDrop:this.onFilesDrop,className:"ImportPipelinesList__dropzone"},function(t){var n=t.isDragActive;return m.createElement("div",{className:n?"ImportPipelinesList__dropzone-wrapper":""},m.createElement("div",{className:"ImportPipelinesList__dropzone-message"},e.props.i18n.t("Нажмите для выбора файла либо перетащите файл в зону отмеченную пунктиром")))})))}}]),t}(m.Component);ut=st([g.autobind,ct("design:paramtypes",[Object])],ut);var pt=Object(v.connect)(function(e){return{i18n:e.i18n,auth:e.auth,eventLine:e.eventLine,organisation:e.organisation,cdnAddress:e.config.cdnAddress}})(ut),dt=n(220),ft=n.n(dt),ht=n(224),mt=n.n(ht),gt=n(225),vt=n.n(gt),yt=n(223),bt=n.n(yt),Et=n(52),Ot=n.n(Et),kt=n(191),Ct=n.n(kt),jt=n(1769),Tt=n.n(jt),wt=n(669),St=n.n(wt),It=n(670),Rt=n.n(It),Pt=n(1919),xt=n(177),_t=n(424),Lt=n(245),Dt=n(246),At=n(247),Ft=n(266),$t=n(292),Wt=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Mt=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Nt=new C.CompositeDecorator([{strategy:Lt.b,component:Lt.a},{strategy:Dt.b,component:Dt.a},{strategy:At.b,component:At.a}]),Ht=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=Object(Ft.a)(n.props.element.content,Nt,n.props.fields,n.props.insertions,n.props.urlLinks,n.props.i18n.t);C.EditorState.moveSelectionToEnd(i);return n.state={editorState:i,htmlBody:n.props.element.content,showHtml:!1,insertions:n.props.insertions,urlLinks:n.props.urlLinks,attachments:n.props.attachments},n}return d()(t,e),s()(t,[{key:"onAttachmentsChange",value:function(e){this.setState(E(this.state,{attachments:{$set:e}}))}},{key:"onInsertionsChange",value:function(e){this.setState(E(this.state,{insertions:{$set:e}}))}},{key:"onUrlLinksChange",value:function(e){this.setState(E(this.state,{urlLinks:{$set:e}}))}},{key:"onEditorStateChange",value:function(e){var t=this;this.setState(E(this.state,{editorState:{$set:e}}),function(){setTimeout(function(){t.state.editorState===e&&t.props.dispatch(Object(Re.fb)({element:E(t.props.element,{content:{$set:Object($t.a)(Object(C.convertToRaw)(e.getCurrentContent()))}}),attachments:t.state.attachments,insertions:t.state.insertions,urlLinks:t.state.urlLinks}))},200)})}},{key:"onShowHTMLChange",value:function(e){this.setState(E(this.state,{showHtml:{$set:e}}))}},{key:"onHtmlChange",value:function(e){var t=this;this.setState(E(this.state,{htmlBody:{$set:e}}),function(){t.props.dispatch(Object(Re.fb)({element:E(t.props.element,{content:{$set:e}}),attachments:t.state.attachments,insertions:t.state.insertions,urlLinks:t.state.urlLinks}))})}},{key:"render",value:function(){return m.createElement(_t.a,{showInsertionButtons:!0,fields:this.props.fields,formId:this.props.formId,organisationId:this.props.organisationId,insertions:this.state.insertions,attachments:this.state.attachments,urlLinks:this.state.urlLinks,onAttachmentsChange:this.onAttachmentsChange,onInsertionsChange:this.onInsertionsChange,onUrlLinksChange:this.onUrlLinksChange,html:this.state.htmlBody,showHtml:this.state.showHtml,editorState:this.state.editorState,onChange:this.onEditorStateChange,onShowHTMLChange:this.onShowHTMLChange,onHtmlChange:this.onHtmlChange})}}]),t}(m.Component);Ht=Wt([g.autobind,Mt("design:paramtypes",[Object])],Ht);var zt=Object(v.connect)(function(e,t){return{i18n:e.i18n,insertions:e.advancedEmailTemplate.present.insertions,attachments:e.advancedEmailTemplate.present.attachments,urlLinks:e.advancedEmailTemplate.present.urlLinks,formId:e.currentForm.data.map(function(e){return e.id})}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Ht),Bt=n(343),Vt=function(e,t){var n=e.openDialog(e.i18n.t("Редактирование содержимого"),m.createElement(Bt.b,null,m.createElement(zt,{element:e.component,fields:e.fields,organisationId:e.organisationId})),[m.createElement(I.a,{variant:"raised",onClick:function(){return e.handleDialogClose(n)},style:{marginRight:"10px"}},e.i18n.t("Закрыть"))],{onDialogClose:t})},Ut=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qt=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"onContentEdit",value:function(){Vt(this.props)}},{key:"render",value:function(){return m.createElement("div",null,m.createElement(I.a,{variant:"raised",onClick:this.onContentEdit},this.props.i18n.t("Отредактировать содержимое")))}}]),t}(m.Component);qt=Ut([g.autobind],qt);var Kt=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(Ze.a)(qt)),Gt=n(43),Jt=n.n(Gt),Yt=n(86),Xt=n.n(Yt),Zt=n(433),Qt=n(153),en=n(109),tn=n(71),nn=n(420),rn=n(686),on=n(620),an=n(655),ln=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},sn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cn=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element,attachments:e.attachments,openImageSrcTypeSelect:!1},n}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(E(this.state,{element:{$set:e.element}})),this.props.attachments!==e.attachments&&this.setState(E(this.state,{attachments:{$set:e.attachments}}))}},{key:"updateSrc",value:function(e){return E(this.state.element,{src:{$set:e}})}},{key:"onImageSrcTypeChange",value:function(e){var t=this;switch(e.target.value){case ee.ImageSrcExternal.$Type.value:this.setState(E(this.state,{element:{$set:this.updateSrc(new ee.ImageSrcExternal(""))},openImageSrcTypeSelect:{$set:!1}}),function(){t.props.dispatch(Object(Re.db)(t.updateSrc(new ee.ImageSrcExternal("")))),t.props.onDialogClose&&t.props.onDialogClose()});break;case ee.ImageSrcFile.$Type.value:this.setState(E(this.state,{element:{$set:this.updateSrc(new ee.ImageSrcFile(new ee.Id("")))},openImageSrcTypeSelect:{$set:!1}}),function(){t.props.dispatch(Object(Re.db)(t.updateSrc(new ee.ImageSrcFile(new ee.Id(""))))),t.props.onDialogClose&&t.props.onDialogClose()})}}},{key:"onFileSelect",value:function(e,t){var n=this,i=this.state.element,r=this.updateSrc(new ee.ImageSrcFile(e)),o=this.state.attachments.filter(function(e){return e instanceof ee.AttachmentLinkAttachment&&i.src instanceof ee.ImageSrcFile&&e.fileId.value!==i.src.file.value}).concat(new ee.AttachmentLinkAttachment(e));this.setState(E(this.state,{element:{$set:r},attachments:{$set:o}}),function(){n.props.dispatch(Object(Re.gb)({image:r,attachments:o}))}),this.props.handleDialogClose(t),setTimeout(function(){return n.props.onComplete&&n.props.onComplete()},0)}},{key:"onFileDialogOpen",value:function(){var e=this;this.props.organisationId.foreach(function(t){var n=void 0;e.props.onDialogOpen&&e.props.onDialogOpen();var i=e.props.openDialog(e.props.i18n.t("Файлы"),m.createElement(Zt.a,{organisationId:t,excludedFolders:[].concat(Jt()(ee.FileTypes.map(function(e){return Object(Qt.b)(e.$Type.value)}))),initialFolder:Object(te.toOption)("free"),onSelectionChange:function(e){Object(te.headOption)(e).foreach(function(e){n=e})},acceptedFiles:Object(te.toOption)("image/*"),cropper:!0,elementId:Object(te.toOption)(e.state.element.id),onFileUpload:function(t){return e.onFileSelect(t,i)}}),[m.createElement(I.a,{key:"cancel",variant:"raised",onClick:function(){return e.props.handleDialogClose(i)},style:{marginRight:"10px"}},e.props.i18n.t("Закрыть")),m.createElement(I.a,{key:"select",variant:"raised",onClick:function(){return e.onFileSelect(ee.Id.createId(n).getOrElse(function(){throw"wrong file meta id"}),i)},color:"primary"},e.props.i18n.t("Выбрать"))],{onDialogClose:function(){e.props.onDialogClose&&e.props.onDialogClose(),setTimeout(function(){return e.props.closePopper&&e.props.closePopper()},0)}})})}},{key:"onImageSrcChange",value:function(e){this.props.dispatch(Object(Re.hb)(this.updateSrc(new ee.ImageSrcExternal(e.target.value)))),this.setState(E(this.state,{element:{$set:this.updateSrc(new ee.ImageSrcExternal(e.target.value))}}))}},{key:"openFileNameDialog",value:function(e,t,n){var i=this,r=void 0,o=this.props.openDialog(this.props.i18n.t("Сохранение"),m.createElement(rn.a,{ref:function(e){r=Object(te.toOption)(e).flatMap(function(e){return Object(te.toOption)(e.wrappedInstance)})},onSubmit:function(e){return t(e,o)},initialValues:{name:e.entity.originalName,deleteSource:!0}}),[m.createElement(I.a,{variant:"raised",onClick:function(){n(),i.props.handleDialogClose(o)},style:{marginRight:"10px"}},this.props.i18n.t("Отмена")),m.createElement(I.a,{variant:"raised",onClick:function(){return r.map(function(e){return e.ref.submit()})},color:"primary"},this.props.i18n.t("Создать"))])}},{key:"uploadImage",value:function(e,t){var n=this;return Object(Ve.h)(e,this.props.cdnAddress,this.props.authToken,this.props.organisationId,this.props.eventLineId,new te.None,new te.None,"true",!1,new te.None,new te.None,new te.None,Object(te.toOption)(t)).catch(function(e){throw n.props.dispatch(Object(tn.h)(n.props.i18n.t("Во время загрузки файла произошла ошибка"))),e})}},{key:"openImageFileEditor",value:function(e,t){var n=this;this.props.onDialogOpen&&this.props.onDialogOpen();var i=this.props.openDialog(this.props.i18n.t("Редактирование фотографии"),m.createElement(nn.b,{src:Object(te.toOption)(Object(en.c)(e.id,this.props.cdnAddress)),onClose:function(){n.props.handleDialogClose(i),setTimeout(function(){return n.props.closePopper&&n.props.closePopper()},0)},onFileChange:function(e){},onFileCreate:function(e){},onSave:function(t,r){n.openFileNameDialog(e,function(o,a){return new Promise(function(t,i){o.deleteSource?Object(Ve.a)(e.id).then(function(){t()}).catch(function(e){n.props.dispatch(Object(tn.h)(n.props.i18n.t("Во время удаления файла произошла ошибка"))),i(e)}):t()}).then(function(){return n.uploadImage(t,o.name).then(function(e){var t=n.state.element,r=n.updateSrc(new ee.ImageSrcFile(e)),o=n.state.attachments.filter(function(e){return e instanceof ee.AttachmentLinkAttachment&&t.src instanceof ee.ImageSrcFile&&e.fileId.value!==t.src.file.value}).concat(new ee.AttachmentLinkAttachment(e));n.setState(E(n.state,{element:{$set:r},attachments:{$set:o}}),function(){n.props.dispatch(Object(Re.gb)({image:r,attachments:o}))}),n.props.handleDialogClose(a),n.props.handleDialogClose(i),setTimeout(function(){return n.props.closePopper&&n.props.closePopper()},0)})}).catch(function(){r()})},r)},onDelete:function(){var e=n.state.element,t=n.updateSrc(new ee.ImageSrcFile(new ee.Id(""))),i=n.state.attachments.filter(function(t){return t instanceof ee.AttachmentLinkAttachment&&e.src instanceof ee.ImageSrcFile&&t.fileId.value!==e.src.file.value});n.props.dispatch(Object(Re.gb)({image:t,attachments:i})),n.setState(E(n.state,{element:{$set:t},attachments:{$set:i}}))},aspectRatioEdit:!0,defaultSrc:new te.None,resizeEdit:!0,recommendedAspectRatios:t.reduce(function(e,t){return e.filter(function(e){return e.aspectRatioHeight===t.aspectRatioHeight&&e.aspectRatioWidth===t.aspectRatioWidth}).length>0?e:e.concat(t)},[]).filter(function(e){return e.elementId!==n.state.element.id}),recommendedSizes:t.reduce(function(e,t){return e.filter(function(e){return e.height===t.height&&e.width===t.width}).length>0?e:e.concat(t)},[])}),[],{onDialogClose:function(){return n.props.onDialogClose&&n.props.onDialogClose()}})}},{key:"onImageFileEditClick",value:function(e){var t=this;this.props.dispatch(Object(fe.d)(this.state.element.id)).getOrElse(function(){return new Promise(function(e,t){return e([])})}).then(function(n){t.openImageFileEditor(e,n)})}},{key:"openImageSrcTypeSelect",value:function(){var e=this;this.setState(E(this.state,{openImageSrcTypeSelect:{$set:!0}}),function(){e.props.onDialogOpen&&e.props.onDialogOpen()})}},{key:"closeImageSrcTypeSelect",value:function(){var e=this;this.setState(E(this.state,{openImageSrcTypeSelect:{$set:!1}}),function(){e.props.onDialogClose&&e.props.onDialogClose()})}},{key:"renderImageSrcSettings",value:function(e){var t=this,n=Object(te.headOption)(this.props.fileMetas.list.filter(function(t){return t.id.value===e.file.value}));return m.createElement("div",null,m.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},m.createElement("div",{style:{overflowX:"hidden",wordBreak:"break-word"}},n.map(function(e){return e.entity.originalName}).getOrElse(function(){return t.props.i18n.t("Файл не найден")})),n.map(function(e){return m.createElement(P.a,{onClick:function(){return t.onImageFileEditClick(e)}},m.createElement(Xt.a,null))}).getOrNull()),m.createElement(I.a,{variant:"raised",onClick:this.onFileDialogOpen},this.props.i18n.t("Выбрать файл")))}},{key:"render",value:function(){return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Тип добавления")),m.createElement(Ie.a,{open:this.state.openImageSrcTypeSelect,value:this.state.element.src.tpe.value,onOpen:this.openImageSrcTypeSelect,onClose:this.closeImageSrcTypeSelect,onChange:this.onImageSrcTypeChange},m.createElement(Ke.a,{value:ee.ImageSrcExternal.$Type.value},this.props.i18n.t("По внешней ссылке")),m.createElement(Ke.a,{value:ee.ImageSrcFile.$Type.value},this.props.i18n.t("Файл")))),this.state.element.src.tpe.value===ee.ImageSrcFile.$Type.value&&this.renderImageSrcSettings(this.state.element.src),this.state.element.src.tpe.value===ee.ImageSrcExternal.$Type.value&&m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("Ссылка на файл"),value:this.state.element.src.src,onChange:this.onImageSrcChange}))}}]),t}(m.Component);cn=ln([g.autobind,sn("design:paramtypes",[Object])],cn);var un=Object(v.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,attachments:e.advancedEmailTemplate.present.attachments,authToken:e.auth.token,eventLineId:e.eventLine.eventLineId,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas.list===t.fileMetas.list&&e.advancedEmailTemplate.present.attachments===t.advancedEmailTemplate.present.attachments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.attachments===t.attachments&&e.fileMetas===t.fileMetas}})(Object(on.a)([function(e){e.element.src instanceof ee.ImageSrcFile&&e.dispatch(Object(an.a)([e.element.src.file].filter(function(e){return""!==e.value})))}],[function(e,t){e.element.src instanceof ee.ImageSrcFile&&t.element.src!==e.element.src&&e.dispatch(Object(an.a)([e.element.src.file].filter(function(e){return""!==e.value})))}])(Object(Ze.a)(cn))),pn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},dn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fn=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element},n}return d()(t,e),s()(t,[{key:"onLabelChange",value:function(e){var t=E(this.props.element,{label:{$set:e.target.value}});this.props.dispatch(Object(Re.cb)(t)),this.setState(E(this.state,{element:{$set:t}}))}},{key:"render",value:function(){return m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("Надпись"),value:this.state.element.label,onChange:this.onLabelChange})}}]),t}(m.Component);fn=pn([g.autobind,dn("design:paramtypes",[Object])],fn);var hn=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(Ze.a)(fn)),mn=n(50),gn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yn=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element},n}return d()(t,e),s()(t,[{key:"onLabelChange",value:function(e){var t=this,n=E(this.props.element,{type:{label:{$set:Object(te.toOption)(e.target.value)}}});this.setState(E(this.state,{element:{$set:n}}),function(){t.props.dispatch(Object(Re.eb)(n))})}},{key:"handleEmailDividerElementTypeChanged",value:function(e){var t=this,n=E(this.props.element,{type:{$set:Object(mn.E)(e.target.value)}});this.setState(E(this.state,{element:{$set:n}}),function(){t.props.dispatch(Object(Re.db)(n))})}},{key:"render",value:function(){return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Тип центральной части")),m.createElement(Ie.a,{onChange:this.handleEmailDividerElementTypeChanged,value:this.props.element.type.tpe.value},m.createElement(Ke.a,{value:ee.EmailDividerElementSimple.$Type.value},this.props.i18n.t("Простой")),m.createElement(Ke.a,{value:ee.EmailDividerElementWithLabel.$Type.value},this.props.i18n.t("Надпись")))),this.props.element.type instanceof ee.EmailDividerElementWithLabel&&m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("Надпись"),value:this.props.element.type.label.getOrElse(function(){return""}),onChange:this.onLabelChange}))}}]),t}(m.Component);yn=gn([g.autobind,vn("design:paramtypes",[Object])],yn);var bn=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(Ze.a)(yn)),En=n(59),On=n(45),kn=n.n(On),Cn=n(82),jn=n(422),Tn=n(183),wn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Sn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},In=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element,urlLinks:e.urlLinks,openHrefType:!1,openAppsSelect:!1,openEventJourneySelect:!1,trackedLink:n.isLinkTracked(e.element.href)},n}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(E(this.state,{element:{$set:e.element}})),this.props.urlLinks!==e.urlLinks&&this.setState(E(this.state,{urlLinks:{$set:e.urlLinks}}))}},{key:"updateHref",value:function(e){return E(this.state.element,{href:{$set:e}})}},{key:"onHrefTypeChanged",value:function(e){var t=this,n=this.state.element.href,i=Object(te.headOption)(this.props.urlLinks.filter(function(e){return n instanceof ee.ButtonHrefAppLogin&&e instanceof ee.UrlLinkAppLogin&&e.uid===n.uid||n instanceof ee.ButtonHrefJourneyEvent&&e instanceof ee.UrlLinkJourneyEvent&&e.eventId.value===n.eventId})),r=this.props.urlLinks.filter(function(e){return i.matchWith(function(t){return t!==e},function(){return!0})});if(e.target.value!==ee.ButtonHrefAppLogin.$Type.value)if(e.target.value!==ee.ButtonHrefJourneyEvent.$Type.value)this.setState(E(this.state,{element:{$set:this.updateHref(new ee.ButtonHrefExternal(""))},urlLinks:{$set:r},openHrefType:{$set:!1}}),function(){t.props.dispatch(Object(Re.bb)({button:t.updateHref(new ee.ButtonHrefExternal("")),urlLinks:r})),t.props.onSelectClose&&t.props.onSelectClose()});else{var o=Object(te.headOption)(this.props.journeyEventIds.list).map(function(e){return[new ee.UrlLinkJourneyEvent("",e.id)]}).getOrElse(function(){return[]}),a=new ee.ButtonHrefJourneyEvent("");this.setState(E(this.state,{element:{$set:this.updateHref(a)},urlLinks:{$set:[].concat(Jt()(r),Jt()(o))},openHrefType:{$set:!1}}),function(){t.props.dispatch(Object(Re.bb)({button:t.updateHref(a),urlLinks:[].concat(Jt()(r),Jt()(o))})),t.props.onSelectClose&&t.props.onSelectClose()})}else{var l=En.v4(),s=new ee.UrlLinkAppLogin(l,new ee.Id(""),""),c=new ee.ButtonHrefAppLogin(l);this.setState(E(this.state,{element:{$set:this.updateHref(c)},urlLinks:{$set:r.concat(s)},openHrefType:{$set:!1}}),function(){t.props.dispatch(Object(Re.bb)({button:t.updateHref(c),urlLinks:r.concat(s)})),t.props.onSelectClose&&t.props.onSelectClose()})}}},{key:"getLink",value:function(e){return this.state.trackedLink?this.addTrackedLink(e):this.rmTrackedLink(e)}},{key:"externalUrlChangeHandler",value:function(e){this.onExternalUrlChange(e.target.value)}},{key:"onExternalUrlChange",value:function(e){var t=this;this.setState(E(this.state,{element:{$set:this.updateHref(new ee.ButtonHrefExternal(this.getLink(e)))},urlLinks:{$set:this.props.urlLinks}}),function(){return t.props.dispatch(Object(Re.ab)({button:t.updateHref(new ee.ButtonHrefExternal(t.getLink(e))),urlLinks:t.props.urlLinks}))})}},{key:"renderHrefExternal",value:function(e){return m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("Путь"),value:this.rmTrackedLink(e.link),onChange:this.externalUrlChangeHandler})}},{key:"onLinkEventIdChange",value:function(e){var t=this,n=this.state.element.href,i=Object(te.headOption)(this.props.urlLinks.filter(function(e){return n instanceof ee.ButtonHrefJourneyEvent&&e instanceof ee.UrlLinkJourneyEvent&&e.eventId.value===n.eventId})),r=this.props.urlLinks.filter(function(e){return i.matchWith(function(t){return t!==e},function(){return!0})}),o=this.updateHref(new ee.ButtonHrefJourneyEvent(e.target.value)),a=ee.Id.createId(e.target.value).getOrElse(function(){throw"wrong journey event id"}),l=r.concat(i.matchWith(function(e){return E(e,{eventId:{$set:a}})},function(){return new ee.UrlLinkJourneyEvent("",a)}));this.setState(E(this.state,{element:{$set:o},urlLinks:{$set:l}}),function(){t.props.dispatch(Object(Re.Y)({button:o,urlLinks:l})),setTimeout(function(){return t.onJourneySelectClose()},0)})}},{key:"journeyEventUrlChangeHandler",value:function(e){this.onJourneyEventUrlChange(e.target.value)}},{key:"onJourneyEventUrlChange",value:function(e){var t=this,n=this.state.element.href,i=Object(te.headOption)(this.props.urlLinks.filter(function(e){return n instanceof ee.ButtonHrefJourneyEvent&&e instanceof ee.UrlLinkJourneyEvent&&e.eventId.value===n.eventId})),r=this.props.urlLinks.filter(function(e){return i.matchWith(function(t){return t!==e},function(){return!0})}),o=Object(te.headOption)(this.props.journeyEventIds.list).map(function(n){return[new ee.UrlLinkJourneyEvent(t.getLink(e),n.id)]}).getOrElse(function(){return[]}),a=r.concat.apply(r,Jt()(i.matchWith(function(n){return[E(n,{redirectUrl:{$set:t.getLink(e)}})]},function(){return o})));this.setState(E(this.state,{element:{$set:this.state.element},urlLinks:{$set:a}}),function(){t.props.dispatch(Object(Re.Z)({button:t.state.element,urlLinks:a}))})}},{key:"renderHrefJourneyEvent",value:function(e){var t=Object(te.headOption)(this.props.urlLinks.filter(function(t){return t instanceof ee.UrlLinkJourneyEvent&&t.eventId.value===e.eventId})),n=t.map(function(e){return e.redirectUrl}).getOrElse(function(){return""});return m.createElement("div",null,0===this.props.journeyEventIds.list.length?m.createElement("div",{style:{paddingTop:10}},this.props.i18n.t("Не выбран идентификатор события")):m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("Путь"),value:this.rmTrackedLink(n),onChange:this.journeyEventUrlChangeHandler}),m.createElement(jn.a,{label:this.props.i18n.t("Идентификатор события"),fullWidth:!0,eventLineId:this.props.eventLineId,value:t.map(function(e){return e.eventId.value}).getOrElse(function(){return""}),onChange:this.onLinkEventIdChange,open:this.state.openEventJourneySelect,onOpen:this.openEventJourneySelect,onClose:this.onJourneySelectClose}))}},{key:"onAppLoginAppIdChange",value:function(e){var t=this,n=this.state.element.href,i=Object(te.headOption)(this.props.urlLinks.filter(function(e){return n instanceof ee.ButtonHrefAppLogin&&e instanceof ee.UrlLinkAppLogin&&e.uid===n.uid})),r=this.props.urlLinks.filter(function(e){return i.matchWith(function(t){return t!==e},function(){return!0})}),o=En.v4(),a=this.updateHref(new ee.ButtonHrefAppLogin(o)),l=r.concat(i.matchWith(function(t){return E(t,{appId:{$set:new ee.Id(e.target.value)},uid:{$set:o}})},function(){return new ee.UrlLinkAppLogin(o,new ee.Id(e.target.value),"")}));this.setState(E(this.state,{element:{$set:a},urlLinks:{$set:l}}),function(){t.props.dispatch(Object(Re.W)({button:a,urlLinks:l})),setTimeout(function(){return t.onAppsSelectClose()},0)})}},{key:"appLoginUrlChangeHandler",value:function(e){this.onAppLoginUrlChange(e.target.value)}},{key:"onAppLoginUrlChange",value:function(e){var t=this,n=this.state.element.href,i=n.uid,r=Object(te.headOption)(this.state.urlLinks.filter(function(e){return n instanceof ee.ButtonHrefAppLogin&&e instanceof ee.UrlLinkAppLogin&&e.uid===i})),o=this.state.urlLinks.filter(function(e){return r.matchWith(function(t){return t!==e},function(){return!0})}).concat(r.matchWith(function(n){return E(n,{appUrl:{$set:t.getLink(e)}})},function(){return t.updateHref(new ee.ButtonHrefAppLogin(i)),new ee.UrlLinkAppLogin(i,new ee.Id(""),t.getLink(e))}));this.props.dispatch(Object(Re.X)({button:this.state.element,urlLinks:o})),this.setState(E(this.state,{element:{$set:this.state.element},urlLinks:{$set:o}}))}},{key:"renderHrefAppLogin",value:function(e){var t=Object(te.headOption)(this.props.urlLinks.filter(function(t){return t instanceof ee.UrlLinkAppLogin&&t.uid===e.uid})),n=t.map(function(e){return e.appUrl}).getOrElse(function(){return""});return m.createElement("div",null,m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("Путь"),value:this.rmTrackedLink(n),onChange:this.appLoginUrlChangeHandler}),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("application|Приложение")),m.createElement(Ie.a,{fullWidth:!0,open:this.state.openAppsSelect,value:t.map(function(e){return e.appId.value}).getOrElse(function(){return""}),onOpen:this.openAppsSelect,onClose:this.onAppsSelectClose,onChange:this.onAppLoginAppIdChange},this.props.applications.list.map(function(e){return m.createElement(Ke.a,{key:e.id.value,value:e.id.value},e.entity.name)}))))}},{key:"openHrefType",value:function(){var e=this;this.props.onSelectOpen&&this.props.onSelectOpen(),this.setState(E(this.state,{openHrefType:{$set:!0}}),function(){e.props.onSelectOpen&&e.props.onSelectOpen()})}},{key:"openAppsSelect",value:function(){var e=this;this.setState(E(this.state,{openAppsSelect:{$set:!0}}),function(){e.props.onSelectOpen&&e.props.onSelectOpen()})}},{key:"onAppsSelectClose",value:function(){var e=this;this.setState(E(this.state,{openAppsSelect:{$set:!1}}),function(){e.props.onSelectClose&&e.props.onSelectClose()})}},{key:"openEventJourneySelect",value:function(){var e=this;this.setState(E(this.state,{openEventJourneySelect:{$set:!0}}),function(){e.props.onSelectOpen&&e.props.onSelectOpen()})}},{key:"onJourneySelectClose",value:function(){var e=this;this.setState(E(this.state,{openEventJourneySelect:{$set:!1}}),function(){e.props.onSelectClose&&e.props.onSelectClose()})}},{key:"onHrefTypeSelectClose",value:function(){var e=this;this.setState(E(this.state,{openHrefType:{$set:!1}}),function(){e.props.onSelectClose&&e.props.onSelectClose()})}},{key:"isLinkTracked",value:function(e){switch(e.tpe.value){case ee.ButtonHrefExternal.$Type.value:return e.link.includes(Tn.c);case ee.ButtonHrefAppLogin.$Type.value:return Object(te.headOption)(this.props.urlLinks.filter(function(t){return t instanceof ee.UrlLinkAppLogin&&t.uid===e.uid})).map(function(e){return e.appUrl.includes(Tn.c)}).getOrElse(function(){return!1});case ee.ButtonHrefJourneyEvent.$Type.value:return Object(te.headOption)(this.props.urlLinks.filter(function(t){return t instanceof ee.UrlLinkJourneyEvent&&t.eventId.value===e.eventId})).map(function(e){return e.redirectUrl.includes(Tn.c)}).getOrElse(function(){return!1});default:return!1}}},{key:"rmTrackedLink",value:function(e){return e.replace(Tn.c,"")}},{key:"addTrackedLink",value:function(e){return this.rmTrackedLink(e)+Tn.c}},{key:"onTrackedLinkChange",value:function(){this.setState(E(this.state,{trackedLink:{$set:!this.state.trackedLink}}),this.changeLinkAfterTrackedChange)}},{key:"changeLinkAfterTrackedChange",value:function(){var e=this,t=this.state.element.href;switch(t.tpe.value){case ee.ButtonHrefExternal.$Type.value:return this.onExternalUrlChange(t.link);case ee.ButtonHrefAppLogin.$Type.value:return Object(te.headOption)(this.props.urlLinks.filter(function(e){return e instanceof ee.UrlLinkAppLogin&&e.uid===t.uid})).map(function(t){return e.onAppLoginUrlChange(t.appUrl)});case ee.ButtonHrefJourneyEvent.$Type.value:return Object(te.headOption)(this.props.urlLinks.filter(function(e){return e instanceof ee.UrlLinkJourneyEvent&&e.eventId.value===t.eventId})).map(function(t){return e.onJourneyEventUrlChange(t.redirectUrl)});default:return!1}}},{key:"render",value:function(){var e=this.state.element.href;return m.createElement("div",null,!this.props.hideTitle&&m.createElement("h3",null,this.props.i18n.t("Ссылка")),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Тип ссылки")),m.createElement(Ie.a,{value:e.tpe.value,open:this.state.openHrefType,onChange:this.onHrefTypeChanged,onOpen:this.openHrefType,onClose:this.onHrefTypeSelectClose},m.createElement(Ke.a,{value:ee.ButtonHrefExternal.$Type.value},this.props.i18n.t("Обычный")),m.createElement(Ke.a,{value:ee.ButtonHrefJourneyEvent.$Type.value},this.props.i18n.t("Ссылка на событие")),m.createElement(Ke.a,{value:ee.ButtonHrefAppLogin.$Type.value},this.props.i18n.t("Ссылка для логина лк")))),e instanceof ee.ButtonHrefExternal&&this.renderHrefExternal(e),e instanceof ee.ButtonHrefAppLogin&&this.renderHrefAppLogin(e),e instanceof ee.ButtonHrefJourneyEvent&&this.renderHrefJourneyEvent(e),!Cn.default.isA5000&&m.createElement(_.a,{label:this.props.i18n.t("Отслеживаемая ссылка"),control:m.createElement(kn.a,{checked:this.state.trackedLink,onChange:this.onTrackedLinkChange})}))}}]),t}(m.Component);In=wn([g.autobind,Sn("design:paramtypes",[Object])],In);var Rn=Object(v.connect)(function(e,t){return{i18n:e.i18n,applications:e.applications,urlLinks:e.advancedEmailTemplate.present.urlLinks,journeyEventIds:e.journeyEventIds}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.applications===t.applications&&e.advancedEmailTemplate.present.urlLinks===t.advancedEmailTemplate.present.urlLinks&&e.journeyEventIds===t.journeyEventIds},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.applications===t.applications&&e.urlLinks===t.urlLinks&&e.journeyEventIds===t.journeyEventIds}})(In),Pn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},xn=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"renderButtonAttributes",value:function(e){return m.createElement(m.Fragment,null,m.createElement(hn,{element:e}),this.props.eventLineId.map(function(t){return m.createElement(Rn,{eventLineId:t,element:e})}).getOrNull())}},{key:"renderDividerAttributes",value:function(e){return m.createElement(bn,{element:e})}},{key:"renderImageAttributes",value:function(e){return m.createElement(m.Fragment,null,m.createElement(un,{element:e,organisationId:this.props.organisationId}),this.props.eventLineId.map(function(t){return m.createElement(Rn,{eventLineId:t,element:e})}).getOrNull())}},{key:"renderHtmlContentAttributes",value:function(e){return m.createElement(Kt,{component:e,fields:this.props.fields,organisationId:this.props.organisationId})}},{key:"render",value:function(){return this.props.element instanceof ee.HtmlContentElement?this.renderHtmlContentAttributes(this.props.element):this.props.element instanceof ee.EmailImageElement?this.renderImageAttributes(this.props.element):this.props.element instanceof ee.EmailButtonElement?this.renderButtonAttributes(this.props.element):this.props.element instanceof ee.EmailDividerElement?this.renderDividerAttributes(this.props.element):void 0}}]),t}(m.Component);xn=Pn([g.autobind],xn);var _n=Object(v.connect)(function(e,t){return{i18n:e.i18n,eventLineId:e.eventLine.eventLineId}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(xn),Ln=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Dn={width:45},An={display:"flex",width:200,justifyContent:"space-between",marginBottom:16,alignItems:"baseline"},Fn=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"updateMargin",value:function(e){return E(this.props.element,{elementCss:{proportions:{$set:Object(te.toOption)(this.props.element.elementCss.proportions.matchWith(function(e){return e},function(){return new ee.ElementProportions})).map(function(t){return E(t,{margin:{$set:Object(te.toOption)(t.margin.matchWith(function(e){return e},function(){return new ee.ElementMargin(ee.EmailElement.DEFAULT_MARGIN,ee.EmailElement.DEFAULT_MARGIN,ee.EmailElement.DEFAULT_MARGIN,ee.EmailElement.DEFAULT_MARGIN)})).map(function(t){return e(t)})}})})}}})}},{key:"handleMarginTopChanged",value:function(e){this.props.dispatch(Object(Re.lb)(this.updateMargin(function(t){return E(t,{top:{$set:e}})})))}},{key:"handleMarginRightChanged",value:function(e){this.props.dispatch(Object(Re.kb)(this.updateMargin(function(t){return E(t,{right:{$set:e}})})))}},{key:"handleMarginBottomChanged",value:function(e){this.props.dispatch(Object(Re.ib)(this.updateMargin(function(t){return E(t,{bottom:{$set:e}})})))}},{key:"handleMarginLeftChanged",value:function(e){this.props.dispatch(Object(Re.jb)(this.updateMargin(function(t){return E(t,{left:{$set:e}})})))}},{key:"render",value:function(){var e=this,t=this.props.element,n=this.props.element.elementCss.proportions.getOrElse(function(){return new ee.ElementProportions});return m.createElement("div",null,m.createElement("h3",null,this.props.i18n.t("Отступы снаружи")),m.createElement("div",{style:An},m.createElement(ye.a,{value:n.margin.map(function(e){return e.top}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginTopChanged(t.target.value)},label:this.props.i18n.t("Cверху"),type:"number",style:Dn}),m.createElement(ye.a,{value:n.margin.map(function(e){return e.right}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginRightChanged(t.target.value)},label:this.props.i18n.t("Cправа"),type:"number",style:Dn}),m.createElement(ye.a,{value:n.margin.map(function(e){return e.bottom}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginBottomChanged(t.target.value)},label:this.props.i18n.t("Cнизу"),type:"number",style:Dn}),m.createElement(ye.a,{value:n.margin.map(function(e){return e.left}).getOrElse(function(){return t.getDefaultMargin()}),onChange:function(t){return e.handleMarginLeftChanged(t.target.value)},label:this.props.i18n.t("Cлева"),type:"number",style:Dn})))}}]),t}(m.Component);Fn=Ln([g.autobind],Fn);var $n=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Fn),Wn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Mn={width:45},Nn={display:"flex",width:200,justifyContent:"space-between",paddingBottom:16,alignItems:"baseline"},Hn=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"updatePadding",value:function(e){return E(this.props.element,{elementCss:{proportions:{$set:Object(te.toOption)(this.props.element.elementCss.proportions.matchWith(function(e){return e},function(){return new ee.ElementProportions})).map(function(t){return E(t,{padding:{$set:Object(te.toOption)(t.padding.matchWith(function(e){return e},function(){return new ee.ElementPadding(ee.EmailElement.DEFAULT_PADDING,ee.EmailElement.DEFAULT_PADDING,ee.EmailElement.DEFAULT_PADDING,ee.EmailElement.DEFAULT_PADDING)})).map(function(t){return e(t)})}})})}}})}},{key:"handlePaddingTopChanged",value:function(e){this.props.dispatch(Object(Re.qb)(this.updatePadding(function(t){return E(t,{top:{$set:e}})})))}},{key:"handlePaddingRightChanged",value:function(e){this.props.dispatch(Object(Re.pb)(this.updatePadding(function(t){return E(t,{right:{$set:e}})})))}},{key:"handlePaddingBottomChanged",value:function(e){this.props.dispatch(Object(Re.nb)(this.updatePadding(function(t){return E(t,{bottom:{$set:e}})})))}},{key:"handlePaddingLeftChanged",value:function(e){this.props.dispatch(Object(Re.ob)(this.updatePadding(function(t){return E(t,{left:{$set:e}})})))}},{key:"render",value:function(){var e=this,t=this.props.element,n=this.props.element.elementCss.proportions.getOrElse(function(){return new ee.ElementProportions});return m.createElement("div",null,m.createElement("h3",null,this.props.i18n.t("Отступы внутри")),m.createElement("div",{style:Nn},m.createElement(ye.a,{value:n.padding.map(function(e){return e.top}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingTopChanged(t.target.value)},label:this.props.i18n.t("Cверху"),type:"number",style:Mn}),m.createElement(ye.a,{value:n.padding.map(function(e){return e.right}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingRightChanged(t.target.value)},label:this.props.i18n.t("Cправа"),type:"number",style:Mn}),m.createElement(ye.a,{value:n.padding.map(function(e){return e.bottom}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingBottomChanged(t.target.value)},label:this.props.i18n.t("Cнизу"),type:"number",style:Mn}),m.createElement(ye.a,{value:n.padding.map(function(e){return e.left}).getOrElse(function(){return t.getDefaultPadding()}),onChange:function(t){return e.handlePaddingLeftChanged(t.target.value)},label:this.props.i18n.t("Cлева"),type:"number",style:Mn})))}}]),t}(m.Component);Hn=Wn([g.autobind],Hn);var zn=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Hn),Bn=n(1495),Vn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Un=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qn=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element},n}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(E(this.state,{element:{$set:e.element}}))}},{key:"getSizeValue",value:function(e){return e.flatMap(function(e){var t=/(\d*)(\D*)/.exec(e);return Object(te.toOption)(t).map(function(e){return{value:e[1],valueType:e[2]}})}).getOrElse(function(){return{value:"",valueType:"auto"}})}},{key:"changeColumnsWidthProportionally",value:function(e){var t=this;Object(xt.e)(this.props.advancedEmailTemplate,this.props.element.id).foreach(function(n){return Object(te.toOption)(document.getElementById(n)).foreach(function(i){Object(xt.c)(t.props.advancedEmailTemplate,n).filter(function(e){return e.columnsResize}).foreach(function(n){n.children.filter(function(e){return e.id!==t.props.element.id}).forEach(function(n,r,o){var a=e.map(function(e){return parseInt(e.replace("px",""))}).getOrElse(function(){return 0}),l=Math.floor((i.clientWidth-a)/o.length);t.props.dispatch(Object(Re.sb)(t.handleChildWidthChanged(n,new te.Some(l+"px"))))})})})})}},{key:"handleChildWidthChanged",value:function(e,t){return E(e,{elementCss:{proportions:{$set:Object(te.toOption)(this.props.element.elementCss.proportions.matchWith(function(e){return e},function(){return new ee.ElementProportions})).map(function(e){return E(e,{width:{$set:t}})})}}})}},{key:"updateWidth",value:function(e){var t=this;return Object(te.toOption)(this.props.element instanceof ee.EmailColumnElement).filter(function(e){return e}).foreach(function(){return t.changeColumnsWidthProportionally(e)}),E(this.state.element,{elementCss:{proportions:{$set:Object(te.toOption)(this.state.element.elementCss.proportions.matchWith(function(e){return e},function(){return new ee.ElementProportions})).map(function(t){return E(t,{width:{$set:e}})})}}})}},{key:"updateHeight",value:function(e){return E(this.state.element,{elementCss:{proportions:{$set:Object(te.toOption)(this.state.element.elementCss.proportions.matchWith(function(e){return e},function(){return new ee.ElementProportions})).map(function(t){return E(t,{height:{$set:e}})})}}})}},{key:"updateWidthType",value:function(e){this.props.dispatch(Object(Re.db)(this.updateWidth(e))),this.setState(E(this.state,{element:{$set:this.updateWidth(e)}}))}},{key:"updateHeightType",value:function(e){this.props.dispatch(Object(Re.db)(this.updateHeight(e))),this.setState(E(this.state,{element:{$set:this.updateHeight(e)}}))}},{key:"updateWidthValue",value:function(e){this.props.dispatch(Object(Re.sb)(this.updateWidth(e))),this.setState(E(this.state,{element:{$set:this.updateWidth(e)}}))}},{key:"updateHeightValue",value:function(e){this.props.dispatch(Object(Re.db)(this.updateHeight(e))),this.setState(E(this.state,{element:{$set:this.updateHeight(e)}}))}},{key:"updateMaxWidth",value:function(e){return E(this.state.element,{elementCss:{proportions:{$set:Object(te.toOption)(this.state.element.elementCss.proportions.matchWith(function(e){return e},function(){return new ee.ElementProportions})).map(function(t){return E(t,{maxWidth:{$set:e}})})}}})}},{key:"updateMaxWidthType",value:function(e){this.props.dispatch(Object(Re.db)(this.updateMaxWidth(e))),this.setState(E(this.state,{element:{$set:this.updateMaxWidth(e)}}))}},{key:"updateMaxWidthValue",value:function(e){this.props.dispatch(Object(Re.mb)(this.updateMaxWidth(e))),this.setState(E(this.state,{element:{$set:this.updateMaxWidth(e)}}))}},{key:"handleWidthValueChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.width}));this.updateWidthValue(Object(te.toOption)(""+e.target.value+t.valueType))}},{key:"handleHeightValueChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.height}));this.updateHeightValue(Object(te.toOption)(""+e.target.value+t.valueType))}},{key:"handleMaxWidthValueChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.maxWidth}));this.updateMaxWidthValue(Object(te.toOption)(""+e.target.value+t.valueType))}},{key:"handleWidthValueTypeChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.width}));this.updateWidthType("auto"!==e?Object(te.toOption)(""+t.value+e):new te.None)}},{key:"handleHeightValueTypeChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.height}));this.updateHeightType("auto"!==e?Object(te.toOption)(""+t.value+e):new te.None)}},{key:"handleMaxWidthValueTypeChanged",value:function(e){var t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.maxWidth}));this.updateMaxWidthType("auto"!==e?Object(te.toOption)(""+t.value+e):new te.None)}},{key:"isContainerElement",value:function(){return this.state.element instanceof ee.EmailContainerElement}},{key:"isRootContainerElement",value:function(){return this.state.element instanceof ee.EmailRootContainerElement}},{key:"renderWidthAttributes",value:function(){var e=this,t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.width}));return m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement(ye.a,{value:t.value,disabled:"auto"===t.valueType,onChange:this.handleWidthValueChanged,label:this.props.i18n.t("Ширина"),style:{flex:"1 0 47%",marginTop:0}}),m.createElement("div",{style:{display:"flex",marginLeft:5}},m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleWidthValueTypeChanged("auto")}},"auto"===t.valueType?{color:"primary"}:{},{variant:"auto"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("auto"))),m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleWidthValueTypeChanged("px")}},"px"===t.valueType?{color:"primary"}:{},{variant:"px"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("px"))),m.createElement("div",null,m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleWidthValueTypeChanged("%")}},"%"===t.valueType?{color:"primary"}:{},{variant:"%"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("%")))))}},{key:"renderHeightAttributes",value:function(){var e=this,t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.height}));return m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement(ye.a,{value:t.value,disabled:"auto"===t.valueType,onChange:this.handleHeightValueChanged,label:this.props.i18n.t("Высота"),style:{flex:"1 0 47%",marginTop:15}}),m.createElement("div",{style:{display:"flex",marginLeft:5}},m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleHeightValueTypeChanged("auto")}},"auto"===t.valueType?{color:"primary"}:{},{variant:"auto"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("auto"))),m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleHeightValueTypeChanged("px")}},"px"===t.valueType?{color:"primary"}:{},{variant:"px"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("px"))),m.createElement("div",null,m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleHeightValueTypeChanged("%")}},"%"===t.valueType?{color:"primary"}:{},{variant:"%"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("%")))))}},{key:"renderMaxWidthAttributes",value:function(){var e=this,t=this.getSizeValue(this.state.element.elementCss.proportions.flatMap(function(e){return e.maxWidth}));return m.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:15}},m.createElement(ye.a,{value:t.value,disabled:"auto"===t.valueType,onChange:this.handleMaxWidthValueChanged,label:this.props.i18n.t("Max ширина"),style:{flex:"1 0 47%",marginTop:0}}),m.createElement("div",{style:{display:"flex",marginLeft:5}},m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleMaxWidthValueTypeChanged("auto")}},"auto"===t.valueType?{color:"primary"}:{},{variant:"auto"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("auto"))),m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleMaxWidthValueTypeChanged("px")}},"px"===t.valueType?{color:"primary"}:{},{variant:"px"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("px"))),m.createElement("div",null,m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleMaxWidthValueTypeChanged("%")}},"%"===t.valueType?{color:"primary"}:{},{variant:"%"===t.valueType?"raised":"text",size:"small"}),this.props.i18n.t("%")))))}},{key:"changeColumnsResize",value:function(e,t){var n=this;e.foreach(function(e){return n.props.dispatch(Object(Re.db)(E(e,{columnsResize:{$set:t}})))})}},{key:"renderColumnAttributes",value:function(){var e=this,t=Object(xt.e)(this.props.advancedEmailTemplate,this.props.element.id).flatMap(function(t){return Object(xt.c)(e.props.advancedEmailTemplate,t)});return m.createElement(_.a,{style:{marginTop:15},label:this.props.i18n.t("Автоматически изменять размеры соседних колонок"),control:m.createElement(kn.a,{checked:t.map(function(e){return e.columnsResize}).getOrElse(function(){return!1}),onChange:function(n,i){return e.changeColumnsResize(t,i)}})})}},{key:"render",value:function(){return m.createElement("div",null,!this.props.hideTitle&&m.createElement("h3",null,this.props.i18n.t("Размер")),this.renderWidthAttributes(),this.renderHeightAttributes(),this.isContainerElement()&&!this.isRootContainerElement()&&this.renderMaxWidthAttributes(),this.props.element instanceof ee.EmailColumnElement&&this.renderColumnAttributes())}}]),t}(m.Component);qn=Vn([g.autobind,Un("design:paramtypes",[Object])],qn);var Kn=Object(v.connect)(function(e,t){return{i18n:e.i18n,advancedEmailTemplate:e.advancedEmailTemplate.present}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.advancedEmailTemplate===t.advancedEmailTemplate},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.advancedEmailTemplate===t.advancedEmailTemplate}})(qn),Gn=n(113),Jn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Yn=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Xn=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={element:e.element,attachments:e.attachments},n}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.element!==e.element&&this.setState(E(this.state,{element:{$set:e.element}})),this.props.attachments!==e.attachments&&this.setState(E(this.state,{attachments:{$set:e.attachments}}))}},{key:"updateBackground",value:function(e){return E(this.state.element,{elementCss:{background:{$set:Object(te.toOption)(this.state.element.elementCss.background.matchWith(function(e){return e},function(){return new ee.ElementBackground})).map(function(t){return e(t)})}}})}},{key:"updateBackgroundImage",value:function(e,t){var n=this.updateBackground(function(t){return E(t,{file:{fileId:{$set:e}}})});this.props.dispatch(Object(Re.V)({element:n,attachments:t})),this.setState(E(this.state,{element:{$set:n},attachments:{$set:t}}))}},{key:"onFileDialogOpen",value:function(){var e=this;this.props.organisationId.foreach(function(t){var n=void 0;e.props.onDialogOpen&&e.props.onDialogOpen();var i=e.props.openDialog(e.props.i18n.t("Файлы"),m.createElement(Zt.a,{organisationId:t,excludedFolders:[].concat(Jt()(ee.FileTypes.map(function(e){return Object(Qt.b)(e.$Type.value)}))),initialFolder:Object(te.toOption)("free"),onSelectionChange:function(e){Object(te.headOption)(e).foreach(function(e){n=e})},acceptedFiles:new te.None,elementId:new te.None}),[m.createElement(I.a,{variant:"raised",onClick:function(){return e.props.handleDialogClose(i)},style:{marginRight:"10px"}},e.props.i18n.t("Закрыть")),m.createElement(I.a,{variant:"raised",onClick:function(){Object(te.toOption)(n).foreach(function(t){e.state.element,e.updateBackgroundImage(Object(te.toOption)(new ee.Id(t)),e.props.attachments.filter(function(e){return e instanceof ee.AttachmentLinkAttachment&&e.fileId.value!==t}).concat(new ee.AttachmentLinkAttachment(new ee.Id(t)))),e.props.handleDialogClose(i)})},color:"primary"},e.props.i18n.t("Выбрать"))],{onDialogClose:function(){return e.props.onDialogClose&&e.props.onDialogClose()}})})}},{key:"handleBackgroundImageToggled",value:function(){var e=this.updateBackground(function(e){return E(e,{file:{enabled:{$set:!e.file.enabled}}})});this.props.dispatch(Object(Re.db)(e)),this.setState(E(this.state,{element:{$set:e}}))}},{key:"handleBackgroundColorUpdated",value:function(e){var t=this.updateBackground(function(t){return E(t,{color:{$set:e}})});this.props.dispatch(Object(Re.db)(t)),this.setState(E(this.state,{element:{$set:t}}))}},{key:"handleBackgroundImageFileDelete",value:function(e){this.updateBackgroundImage(new te.None,this.props.attachments.filter(function(t){return t instanceof ee.AttachmentLinkAttachment&&t.fileId.value!==e.value}))}},{key:"render",value:function(){var e=this,t=(this.state.element,this.state.element.elementCss.background.getOrElse(function(){return new ee.ElementBackground})),n=Object(te.headOption)(this.props.fileMetas.list.filter(function(e){return e.id.value===t.file.fileId.map(function(e){return e.value}).getOrNull()}));return m.createElement("div",null,!this.props.hideTitle&&m.createElement("h3",null,this.props.i18n.t("Фон")),m.createElement(_.a,{label:this.props.i18n.t("Без заливки"),control:m.createElement(kn.a,{checked:"transparent"===t.color,onChange:function(t,n){return e.handleBackgroundColorUpdated(n?"transparent":"#fff")}})}),"transparent"!==t.color&&m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement("span",null,this.props.i18n.t("Заливка")),m.createElement(Gn.a,{value:t.color,onChange:this.handleBackgroundColorUpdated,onDialogClose:this.props.onDialogClose,onDialogOpen:this.props.onDialogOpen})),m.createElement(_.a,{label:this.props.i18n.t("Отображать фоновое изображение"),control:m.createElement(kn.a,{checked:t.file.enabled,onChange:function(t,n){return e.handleBackgroundImageToggled()}})}),t.file.enabled&&m.createElement("div",null,m.createElement("p",null,this.props.i18n.t("Файл фонового изображения")),m.createElement("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},m.createElement("div",{style:{overflowX:"hidden",wordBreak:"break-word"}},n.map(function(e){return e.entity.originalName}).getOrElse(function(){return e.props.i18n.t("Файл не найден")})),n.map(function(t){return m.createElement(P.a,{onClick:function(){return e.handleBackgroundImageFileDelete(t.id)}},m.createElement(ze.a,null))}).getOrNull()),m.createElement(I.a,{variant:"raised",onClick:this.onFileDialogOpen},this.props.i18n.t("Выбрать файл"))))}}]),t}(m.Component);Xn=Jn([g.autobind,Yn("design:paramtypes",[Object])],Xn);var Zn=Object(v.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,attachments:e.advancedEmailTemplate.present.attachments}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas&&e.advancedEmailTemplate.present.attachments===t.advancedEmailTemplate.present.attachments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas&&e.attachments===t.attachments}})(Object(on.a)([function(e){e.element.elementCss.background.flatMap(function(e){return e.file.fileId}).filter(function(e){return""!==e.value}).foreach(function(t){e.dispatch(Object(an.a)([t]))})}],[function(e,t){Object(te.isEqual)(e.element.elementCss.background.flatMap(function(e){return e.file.fileId.map(function(e){return e.value})}),t.element.elementCss.background.flatMap(function(e){return e.file.fileId.map(function(e){return e.value})}))||e.element.elementCss.background.flatMap(function(e){return e.file.fileId}).filter(function(e){return""!==e.value}).foreach(function(t){e.dispatch(Object(an.a)([t]))})}])(Object(Ze.a)(Xn))),Qn=n(272),ei=n.n(Qn),ti=n(329),ni=n.n(ti),ii=n(330),ri=n.n(ii),oi=n(331),ai=n.n(oi),li=n(429),si=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ci=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ui=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={horizontalAlignmentMenuAnchorEl:new te.None,iconButtonIdx:0},n}return d()(t,e),s()(t,[{key:"handleTitleFontColorUpdated",value:function(e){this.props.onFontChange(E(this.props.font,{color:{$set:e}}))}},{key:"handleFontStyleChanged",value:function(e){var t=this.props.font.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return"inherit"}),n=this.props.font.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return"inherit"});this.props.onFontChange(E(this.props.font,{fontFace:{$set:Object(te.toOption)(this.props.font.fontFace.map(function(t){return E(t,{fontStyle:{$set:e.target.value}})}).getOrElse(function(){return new ee.ElementFontFace(t,e.target.value,n)}))}}))}},{key:"handleFontWeightChanged",value:function(e){var t=this.props.font.fontFace.map(function(e){return e.fontFamily}).getOrElse(function(){return"inherit"}),n=this.props.font.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return"inherit"});this.props.onFontChange(E(this.props.font,{fontFace:{$set:Object(te.toOption)(this.props.font.fontFace.map(function(t){return E(t,{fontWeight:{$set:e.target.value}})}).getOrElse(function(){return new ee.ElementFontFace(t,n,e.target.value)}))}}))}},{key:"handleFontSizeChanged",value:function(e){this.props.onFontChange(E(this.props.font,{fontSize:{$set:e}}))}},{key:"onHorizontalAlignmentMenuOpen",value:function(e){this.setState(E(this.state,{horizontalAlignmentMenuAnchorEl:{$set:Object(te.toOption)(e.currentTarget)}}))}},{key:"onHorizontalAlignmentMenuClose",value:function(){this.setState(E(this.state,{horizontalAlignmentMenuAnchorEl:{$set:new te.None}}))}},{key:"onHorizontalAlignmentChange",value:function(e){this.props.onFontChange(E(this.props.font,{horizontalAlignment:{$set:e}}))}},{key:"renderAlignButtons",value:function(e){var t=this;!function(e){switch(e.tpe.value){case ee.ElementHorizontalAlignmentLeft.$Type.value:return ei.a;case ee.ElementHorizontalAlignmentCentered.$Type.value:return ni.a;case ee.ElementHorizontalAlignmentRight.$Type.value:return ri.a;case ee.ElementHorizontalAlignmentJustified.$Type.value:return ai.a;default:ei.a}}(e.map(function(e){return e.horizontalAlignment}).getOrElse(function(){return new ee.ElementHorizontalAlignmentLeft}));return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Выравнивание")),m.createElement(Ie.a,{native:!0,value:this.props.font.horizontalAlignment.tpe.value,onChange:function(e){return t.onHorizontalAlignmentChange(function(e){switch(e.value){case ee.ElementHorizontalAlignmentLeft.$Type.value:return new ee.ElementHorizontalAlignmentLeft;case ee.ElementHorizontalAlignmentCentered.$Type.value:return new ee.ElementHorizontalAlignmentCentered;case ee.ElementHorizontalAlignmentRight.$Type.value:return new ee.ElementHorizontalAlignmentRight;case ee.ElementHorizontalAlignmentJustified.$Type.value:return new ee.ElementHorizontalAlignmentJustified;default:return new ee.ElementHorizontalAlignmentLeft}}(new te.TypeId(e.target.value)))}},"   ",m.createElement("option",{value:"empty"}),ee.ElementHorizontalAlignmentTypes.map(function(e,n){return m.createElement("option",{value:e.$Type.value,key:n},function(e){switch(e.$Type){case ee.ElementHorizontalAlignmentLeft.$Type:return t.props.i18n.t("По левому краю");case ee.ElementHorizontalAlignmentCentered.$Type:return t.props.i18n.t("По центру");case ee.ElementHorizontalAlignmentRight.$Type:return t.props.i18n.t("По правому краю");case ee.ElementHorizontalAlignmentJustified.$Type:return t.props.i18n.t("По ширине");default:return t.props.i18n.t("По левому краю")}}(e))}))))}},{key:"render",value:function(){var e=this;return m.createElement("div",null,m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("Размер"),type:"number",value:this.props.font.fontSize,onChange:function(t){return e.handleFontSizeChanged(parseInt(t.target.value))}}),m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement("span",null,this.props.i18n.t("Цвет шрифта")),m.createElement(Gn.a,{value:this.props.font.color,onChange:this.handleTitleFontColorUpdated})),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Стиль")),m.createElement(Ie.a,{native:!0,value:this.props.font.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),onChange:this.handleFontStyleChanged},"   ",m.createElement("option",{value:"inherit"}),li.a.map(function(e,t){return m.createElement("option",{value:e,key:t},e)}))),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Толщина")),m.createElement(Ie.a,{native:!0,value:this.props.font.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),onChange:this.handleFontWeightChanged},"   ",m.createElement("option",{value:"inherit"}),li.b.map(function(e,t){return m.createElement("option",{value:e,key:t},e)}))),!this.props.hideHorizontalAlignment&&this.renderAlignButtons(Object(te.toOption)(this.props.font)))}}]),t}(m.Component);ui=si([g.autobind,ci("design:paramtypes",[Object])],ui);var pi=Object(v.connect)(function(e,t){return{i18n:e.i18n,fileMetas:e.fileMetas,attachments:e.advancedEmailTemplate.present.attachments}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas&&e.advancedEmailTemplate.present.attachments===t.advancedEmailTemplate.present.attachments},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.fileMetas===t.fileMetas&&e.attachments===t.attachments}})(Object(on.a)([],[])(Object(Ze.a)(ui))),di=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fi=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"onFontChange",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{fonts:{$set:Object(te.toOption)(this.props.element.elementCss.fonts.matchWith(function(e){return e},function(){return new ee.ElementFonts})).map(function(t){return E(t,{titleFont:{$set:Object(te.toOption)(e)}})})}}})))}},{key:"render",value:function(){return m.createElement("div",null,!this.props.hideTitle&&m.createElement("h3",null,this.props.i18n.t("Шрифт")),m.createElement(pi,{font:this.props.element.elementCss.fonts.flatMap(function(e){return e.titleFont}).getOrElse(function(){return new ee.ElementFont(ee.FontFile.createDefault(),16,!1,"#00000",new ee.ElementHorizontalAlignmentLeft,new ee.ElementVerticalAlignmentMiddle)}),onFontChange:this.onFontChange,hideHorizontalAlignment:this.props.element instanceof ee.EmailDividerElement}))}}]),t}(m.Component);fi=di([g.autobind],fi);var hi=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(fi),mi=n(676),gi=function(e){return function(t){function n(){return a()(this,n),u()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return d()(n,t),s()(n,[{key:"render",value:function(){var t=this;return m.createElement(mi.a,null,function(n){return m.createElement(e,Object.assign({closePopper:n.closePopper,openPopper:n.openPopper,setPreventClose:n.setPreventClose,unsetPreventClose:n.unsetPreventClose},t.props))})}}]),n}(m.Component)},vi=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},yi=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{align:{$set:Object(te.toOption)(this.props.element.elementCss.align.matchWith(function(e){return e},function(){return new ee.ElementAlign})).map(function(t){return E(t,{justifySelf:{$set:Object(te.toOption)(e).filter(function(e){return"none"!==e})}})})}}})))}},{key:"render",value:function(){var e=this;return m.createElement("div",null,!this.props.hideTitle&&m.createElement("h3",null,this.props.i18n.t("Выравнивание")),m.createElement(P.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("left")}},m.createElement(ei.a,null)),m.createElement(P.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("center")}},m.createElement(ni.a,null)),m.createElement(P.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("right")}},m.createElement(ri.a,null)),m.createElement(P.a,{onClick:function(){return e.handleSelfAlignmentValueChanged("none")}},m.createElement(ai.a,null)))}}]),t}(m.Component);yi=vi([g.autobind],yi);var bi=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(gi(yi)),Ei=n(106),Oi=n(680),ki=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ci=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleTopBorderThicknessChange",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(te.toOption)(E(t,{top:{$set:e}}))},function(){return Object(te.toOption)(Ei.a)})}}})))}},{key:"handleRightBorderThicknessChange",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(te.toOption)(E(t,{right:{$set:e}}))},function(){return Object(te.toOption)(Ei.a)})}}})))}},{key:"handleBottomBorderThicknessChange",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(te.toOption)(E(t,{bottom:{$set:e}}))},function(){return Object(te.toOption)(Ei.a)})}}})))}},{key:"handleLeftBorderThicknessChange",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(te.toOption)(E(t,{left:{$set:e}}))},function(){return Object(te.toOption)(Ei.a)})}}})))}},{key:"handleElementBorderTypeChanged",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(te.toOption)(E(t,{borderType:{$set:Object(mn.w)(e.target.value)}}))},function(){return Object(te.toOption)(Ei.a)})}}})))}},{key:"handleElementBorderColorChanged",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(te.toOption)(E(t,{color:{$set:Object(te.toOption)(e)}}))},function(){return Object(te.toOption)(Ei.a)})}}})))}},{key:"handleElementBorderRadiusChanged",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{border:{$set:this.props.element.elementCss.border.matchWith(function(t){return Object(te.toOption)(E(t,{borderRadius:{$set:Object(te.toOption)(parseInt(e.target.value,10))}}))},function(){return Object(te.toOption)(Ei.a)})}}})))}},{key:"render",value:function(){var e=this,t=Object(te.toOption)(this.props.element.elementCss),n=Object(Ei.e)(t).getOrElse(function(){return Ei.a}),i=n.borderRadius.getOrElse(function(){return n.getDefaultBorderRadius()});return m.createElement("div",null,!this.props.hideTitle&&m.createElement("h3",null,this.props.i18n.t("Граница")),m.createElement(Oi.a,{top:n.top,right:n.right,bottom:n.bottom,left:n.left,onTopChange:this.handleTopBorderThicknessChange,onRightChange:this.handleRightBorderThicknessChange,onBottomChange:this.handleBottomBorderThicknessChange,onLeftChange:this.handleLeftBorderThicknessChange}),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Тип границы")),m.createElement(Ie.a,{onChange:this.handleElementBorderTypeChanged,value:n.borderType.tpe.value},ee.ElementBorderTypes.map(function(t){return m.createElement(Ke.a,{key:t.tpe.value,value:t.tpe.value},Object(mn.x)(t.tpe.value,e.props.i18n.t))}))),m.createElement("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center",marginTop:"10px"}},m.createElement("span",null,this.props.i18n.t("Цвет границы")),m.createElement(Gn.a,{value:Object(Ei.b)(t).getOrElse(function(){return"#000"}),onChange:this.handleElementBorderColorChanged})),m.createElement(ye.a,{fullWidth:!0,type:"number",label:this.props.i18n.t("Скругление границ"),defaultValue:4,InputProps:{inputProps:{min:0}},value:i,onChange:this.handleElementBorderRadiusChanged}))}}]),t}(m.Component);Ci=ki([g.autobind],Ci);var ji=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Ci),Ti=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},wi=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{align:{$set:Object(te.toOption)(this.props.element.elementCss.align.matchWith(function(e){return e},function(){return new ee.ElementAlign})).map(function(t){return E(t,{justifyContent:{$set:e}})})}}})))}},{key:"render",value:function(){var e=this;return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Горизонтальное")),m.createElement(Ie.a,{value:this.props.element.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return""}),onChange:function(t){return e.handleSelfAlignmentValueChanged(t.target.value)}},m.createElement(Ke.a,{value:"left"},m.createElement(Ne.a,{primary:this.props.i18n.t("По левому краю")})),m.createElement(Ke.a,{value:"center"},m.createElement(Ne.a,{primary:this.props.i18n.t("По центру")})),m.createElement(Ke.a,{value:"right"},m.createElement(Ne.a,{primary:this.props.i18n.t("По правому краю")})))))}}]),t}(m.Component);wi=Ti([g.autobind],wi);var Si=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(wi),Ii=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ri=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{elementCss:{align:{$set:Object(te.toOption)(this.props.element.elementCss.align.matchWith(function(e){return e},function(){return new ee.ElementAlign(new te.None,"top")})).map(function(t){return E(t,{justifyContent:{$set:e}})})}}})))}},{key:"render",value:function(){var e=this;return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Вертикальное")),m.createElement(Ie.a,{value:this.props.element.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"top"}),onChange:function(t){return e.handleSelfAlignmentValueChanged(t.target.value)}},m.createElement(Ke.a,{value:"top"},m.createElement(Ne.a,{primary:this.props.i18n.t("По верху")})),m.createElement(Ke.a,{value:"middle"},m.createElement(Ne.a,{primary:this.props.i18n.t("По середине")})),m.createElement(Ke.a,{value:"bottom"},m.createElement(Ne.a,{primary:this.props.i18n.t("По низу")})),m.createElement(Ke.a,{value:"baseline"},m.createElement(Ne.a,{primary:this.props.i18n.t("По нижней линии текста")})))))}}]),t}(m.Component);Ri=Ii([g.autobind],Ri);var Pi=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Ri),xi=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_i=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleSelfAlignmentValueChanged",value:function(e){this.props.dispatch(Object(Re.db)(E(this.props.element,{horizontalContentAlignment:{$set:e}})))}},{key:"render",value:function(){var e=this;return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Горизонтальное")),m.createElement(Ie.a,{value:this.props.element.horizontalContentAlignment,onChange:function(t){return e.handleSelfAlignmentValueChanged(t.target.value)}},m.createElement(Ke.a,{value:"left"},m.createElement(Ne.a,{primary:this.props.i18n.t("По левому краю")})),m.createElement(Ke.a,{value:"center"},m.createElement(Ne.a,{primary:this.props.i18n.t("По середине")})),m.createElement(Ke.a,{value:"right"},m.createElement(Ne.a,{primary:this.props.i18n.t("По правому краю")})))))}}]),t}(m.Component);_i=xi([g.autobind],_i);var Li=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(_i),Di=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ai=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return m.createElement(m.Fragment,null,m.createElement("h3",null,this.props.i18n.t("Выравнивание содержимого")),(this.props.element instanceof ee.EmailRowElement||this.props.element instanceof ee.EmailColumnElement)&&m.createElement(Pi,{element:this.props.element}),(this.props.element instanceof ee.EmailRowElement||this.props.element instanceof ee.EmailColumnElement)&&m.createElement(Li,{element:this.props.element}),this.props.element instanceof ee.EmailRootElement&&m.createElement(Si,{element:this.props.element}))}}]),t}(m.Component);Ai=Di([g.autobind],Ai);var Fi=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Ai),$i=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Wi=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return m.createElement("div",null,(this.props.element instanceof ee.EmailContainerElement||this.props.element instanceof ee.EmailButtonElement)&&m.createElement(Zn,{element:this.props.element,organisationId:this.props.organisationId}),(this.props.element instanceof ee.EmailButtonElement||this.props.element instanceof ee.EmailDividerElement&&this.props.element.type instanceof ee.EmailDividerElementWithLabel)&&m.createElement(hi,{element:this.props.element}),m.createElement($n,{element:this.props.element}),m.createElement(zn,{element:this.props.element}),m.createElement(Kn,{element:this.props.element}),(this.props.element instanceof ee.EmailRootElement||this.props.element instanceof ee.EmailRowElement||this.props.element instanceof ee.EmailColumnElement)&&m.createElement(Fi,{element:this.props.element}),!(this.props.element instanceof ee.EmailRootContainerElement)&&m.createElement(bi,{element:this.props.element}),(this.props.element instanceof ee.EmailDividerElement||this.props.element instanceof ee.EmailButtonElement)&&m.createElement(ji,{element:this.props.element}))}}]),t}(m.Component);Wi=$i([g.autobind],Wi);var Mi=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Wi),Ni=n(133),Hi=n(437),zi=n.n(Hi),Bi=n(432),Vi=n.n(Bi),Ui=n(46),qi=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ki=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){this.props.element.children.length!==e.element.children.length&&this.changeChildWidth(e)}},{key:"changeChildWidth",value:function(e){var t=this;e.element.children.map(function(n){var i=t.getSizeValue(new te.None);Object(te.toOption)(e.element).filter(function(e){return e instanceof ee.EmailRowElement}).foreach(function(r){return t.handleChildWidthValueChanged(n,Math.floor(e.elementWidth.getOrElse(function(){return 100})/e.element.children.length),i)})})}},{key:"isRowSelected",value:function(){return this.props.element.tpe.value===ee.EmailRowElement.$Type.value}},{key:"isColumnSelected",value:function(){return this.props.element.tpe.value===ee.EmailColumnElement.$Type.value}},{key:"handleChildWidthValueChanged",value:function(e,t,n){this.props.dispatch(Object(Re.sb)(this.handleChildWidthChanged(e,new te.Some(""+t+n.valueType))))}},{key:"handleChildWidthValueTypeChanged",value:function(e,t,n){"auto"===t?this.props.dispatch(Object(Re.db)(this.handleChildWidthChanged(e,new te.Some(""+t)))):this.props.dispatch(Object(Re.db)(this.handleChildWidthChanged(e,new te.Some(""+n.value+t))))}},{key:"handleChildWidthChanged",value:function(e,t){return E(e,{elementCss:{proportions:{$set:Object(te.toOption)(this.props.element.elementCss.proportions.matchWith(function(e){return e},function(){return new ee.ElementProportions})).map(function(e){return E(e,{width:{$set:t}})})}}})}},{key:"handleColumnAdded",value:function(){var e=this.props.element.children.length;this.isColumnSelected()&&this.props.onComponentAdded(Object(te.toOption)(this.props.element.id),ee.EmailRowElement.$Type,e),this.isRowSelected()&&this.props.onComponentAdded(Object(te.toOption)(this.props.element.id),ee.EmailColumnElement.$Type,e),this.props.dispatch(Object(Re.Eb)())}},{key:"handleColumnDelete",value:function(e){this.props.dispatch(Object(Re.Cb)(e.id))}},{key:"getSizeValue",value:function(e){return e.flatMap(function(e){var t=/(\d*)(\D*)/.exec(e);return Object(te.toOption)(t).map(function(e){return{value:e[1],valueType:e[2]}})}).getOrElse(function(){return{value:"150",valueType:"px"}})}},{key:"onSwapActions",value:function(e,t,n){if(void 0!==e[t]&&void 0!==e[n]){var i=t>n?n:t,r=t>n?t:n,o=[].concat(Jt()(e.slice(0,i)),[e[r]],Jt()(e.slice(i+1,r)),[e[i]],Jt()(e.slice(r+1)));this.props.dispatch(Object(Re.db)(E(this.props.element,{children:{$set:o}})))}}},{key:"render",value:function(){var e=this;return m.createElement("div",null,Object(Ni.a)(this.props.element.children,"position").map(function(t,n,i){var r=t.elementCss.proportions.getOrElse(function(){return new ee.ElementProportions}),o=e.getSizeValue(r.width);return m.createElement("div",{key:t.id,style:{display:"flex",alignItems:"center"}},m.createElement(ye.a,{style:{width:"30%",marginLeft:10},disabled:"auto"===o.valueType,fullWidth:!0,value:o.value,onChange:function(n){return e.handleChildWidthValueChanged(t,n.target.value,o)},label:e.props.i18n.t("Ширина")}),m.createElement("div",{style:{display:"flex",marginTop:33,marginLeft:15}},m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleChildWidthValueTypeChanged(t,"auto",o)}},"auto"===o.valueType?{color:"primary"}:{},{variant:"auto"===o.valueType?"raised":"text",size:"small"}),e.props.i18n.t("auto"))),m.createElement("div",{style:{marginRight:5}},m.createElement(Bn.a,Object.assign({onClick:function(){return e.handleChildWidthValueTypeChanged(t,"px",o)}},"px"===o.valueType?{color:"primary"}:{},{variant:"px"===o.valueType?"raised":"text",size:"small"}),e.props.i18n.t("px")))),m.createElement(P.a,{style:Object.assign({},Ui.f,{marginTop:33}),onClick:function(){return e.onSwapActions(i,n,n-1)}},m.createElement(zi.a,{style:Ui.g})),m.createElement(P.a,{style:Object.assign({},Ui.f,{marginTop:33}),onClick:function(){return e.onSwapActions(i,n,n+1)}},m.createElement(Vi.a,{style:Ui.g})),m.createElement(P.a,{style:Object.assign({},Ui.f,{marginTop:33}),onClick:function(){return e.handleColumnDelete(t)}},m.createElement(ze.a,{style:Ui.g})))}),m.createElement(I.a,{variant:"raised",onClick:this.handleColumnAdded},this.isColumnSelected()?this.props.i18n.t("Добавить ряд"):this.props.i18n.t("Добавить колонку")))}}]),t}(m.Component);Ki=qi([g.autobind],Ki);var Gi=Object(v.connect)(function(e,t){return{i18n:e.i18n,elementWidth:Object(te.liftKey)(e.advancedEmailTemplate.present.elementWidth,t.element.id)}})(Ki),Ji=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Yi=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"isHtmlContentSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===ee.HtmlContentElement.$Type.value}).nonEmpty()}},{key:"isImageSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===ee.EmailImageElement.$Type.value}).nonEmpty()}},{key:"isButtonSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===ee.EmailButtonElement.$Type.value}).nonEmpty()}},{key:"isDividerSelected",value:function(){return this.props.selectedElement.filter(function(e){return e.tpe.value===ee.EmailDividerElement.$Type.value}).nonEmpty()}},{key:"onEmailEditorAttributesExpandedToogle",value:function(){this.props.dispatch(Object(Re.R)(!this.props.expandAttributes))}},{key:"render",value:function(){var e=this;return m.createElement(w.a,null,(this.isHtmlContentSelected()||this.isImageSelected()||this.isButtonSelected()||this.isDividerSelected())&&m.createElement("div",null,m.createElement(bt.a,null,m.createElement(mt.a,{expandIcon:m.createElement(Ct.a,null)},m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement(Tt.a,{style:{marginRight:15}}),m.createElement(Ot.a,null,this.props.i18n.t("Свойства")))),m.createElement(vt.a,null,m.createElement(Ot.a,{component:"div",style:{width:"100%"}},this.props.selectedElement.map(function(t){return m.createElement(_n,{element:t,fields:e.props.fields,organisationId:e.props.organisationId})}).getOrNull()))),m.createElement(ft.a,null)),this.props.selectedElement.map(function(t){return m.createElement("div",null,m.createElement(bt.a,{expanded:e.props.expandAttributes},m.createElement(mt.a,{expandIcon:m.createElement(Ct.a,{onClick:e.onEmailEditorAttributesExpandedToogle})},m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement(St.a,{style:{marginRight:15}}),m.createElement(Ot.a,null,e.props.i18n.t("Стиль")))),m.createElement(vt.a,null,m.createElement(Ot.a,{component:"div",style:{width:"100%"}},m.createElement(Mi,{element:t,organisationId:e.props.organisationId})))),m.createElement(ft.a,null))}).getOrNull(),this.props.selectedElement.filter(function(e){return e.tpe.value===ee.EmailRowElement.$Type.value}).map(function(t){return m.createElement("div",null,m.createElement(bt.a,null,m.createElement(mt.a,{expandIcon:m.createElement(Ct.a,null)},m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement(Rt.a,{style:{marginRight:15}}),m.createElement(Ot.a,null,e.props.i18n.t("Колонки")))),m.createElement(vt.a,null,m.createElement(Ot.a,{component:"div",style:{width:"100%"}},m.createElement(Gi,{element:t,onComponentAdded:e.props.onComponentAdded})))))}).getOrNull(),m.createElement(bt.a,null,m.createElement(mt.a,{expandIcon:m.createElement(Ct.a,null)},m.createElement("div",{style:{display:"flex",alignItems:"center"}},m.createElement(Tt.a,{style:{marginRight:15}}),m.createElement(Ot.a,null,this.props.i18n.t("Элементы")))),m.createElement(vt.a,null,m.createElement(Ot.a,{component:"div",style:{width:"100%"}},m.createElement(Pt.b,{className:"FormBlockViewport__viewport-actions",onComponentAdded:this.props.onComponentAdded,openComponentAttributes:this.props.openComponentAttributes})))))}}]),t}(m.Component);Yi=Ji([g.autobind],Yi);var Xi=Object(v.connect)(function(e,t){return{i18n:e.i18n,selectedElement:e.emailEditor.selectedElementId.flatMap(function(t){return Object(xt.c)(e.advancedEmailTemplate.present,t)}),expandAttributes:e.emailEditor.expandAttributes}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.emailEditor.selectedElementId,t.emailEditor.selectedElementId)&&Object(te.isEqual)(e.advancedEmailTemplate.present.rootContainerElement,t.advancedEmailTemplate.present.rootContainerElement)&&e.emailEditor.expandAttributes===t.emailEditor.expandAttributes},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.selectedElement,t.selectedElement)&&e.expandAttributes===t.expandAttributes}})(Yi),Zi=n(56),Qi=n(1499),er=n.n(Qi),tr=n(1612),nr=n.n(tr),ir=n(23),rr=n(269),or=n(1816),ar=n.n(or),lr=n(1528),sr=n.n(lr),cr=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ur=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"onMoveUp",value:function(){this.props.dispatch(Object(fe.f)(this.props.element.id))}},{key:"onMoveDown",value:function(){this.props.dispatch(Object(fe.e)(this.props.element.id))}},{key:"render",value:function(){return m.createElement(m.Fragment,null,m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Переместить вверх")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onMoveUp},m.createElement(ar.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Переместить вниз")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onMoveDown},m.createElement(sr.a,{style:Ui.g}))))}}]),t}(m.Component);ur=cr([g.autobind],ur);var pr=Object(v.connect)(function(e){return{i18n:e.i18n}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(ur),dr=(n(2592),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),fr=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.htmlContentWidgetRef.foreach(function(e){return e.click()})}},{key:"onContentEdit",value:function(e){var t=this;this.props.setPreventClose(e,function(){m.createElement(rr.b,null,Vt(t.props,function(){return t.props.unsetPreventClose(e)}),";")})}},{key:"onHorizontalAlignment",value:function(e){this.props.openPopper(Object(ir.toOption)(e.currentTarget),m.createElement(rr.b,null,m.createElement(bi,{element:this.props.component,hideTitle:!0})))}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(Object(fe.a)(this.props.component))}},{key:"onHtmlContentWidgetSettingsClick",value:function(e){var t=this;e.stopPropagation(),this.props.dispatch(Object(Re.Gb)(this.props.component.id));var n=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"}),i=Object(mn.j)(n),r=this.props.openPopper(Object(ir.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},m.createElement(F.a,{placement:"bottom",title:this.props.i18n.t("Выравнивание текста")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onHorizontalAlignment},m.createElement(i,{style:Ui.g}))),m.createElement(F.a,{placement:"bottom",title:this.props.i18n.t("Редактирование контента")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:function(e){return t.onContentEdit(r)}},m.createElement(Xt.a,{style:Ui.g}))),m.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дублировать")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onDuplicate},m.createElement(nr.a,{style:Ui.g}))),m.createElement(pr,{element:this.props.component,parentId:this.props.parent})))}},{key:"isSelected",value:function(e){return Object(ir.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"EmailEditor-HtmlContentWidget",dangerouslySetInnerHTML:{__html:Object(Tn.d)(this.props.getDisplayHtml(this.props.component.content))},onClick:this.onHtmlContentWidgetSettingsClick,ref:function(t){return e.htmlContentWidgetRef=Object(ir.toOption)(t)}})}}]),t}(m.PureComponent);fr=dr([g.autobind],fr);var hr=Object(v.connect)(function(e,t){return{i18n:e.i18n,parent:Object(xt.e)(e.advancedEmailTemplate.present,t.component.id),selectedElementId:e.emailEditor.selectedElementId}})(Object(Ze.a)(gi(fr))),mr=n(383),gr=n.n(mr),vr=n(1938),yr=n.n(vr),br=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Er=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.buttonWidgetRef.foreach(function(e){return e.click()})}},{key:"onHorizontalAlignment",value:function(e){this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement(bi,{element:this.props.component,hideTitle:!0}))}},{key:"openInsertLinkPopover",value:function(e){var t=this;this.props.eventLineId.foreach(function(n){var i=t.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:15}},m.createElement(Rn,{eventLineId:n,element:t.props.component,hideTitle:!0,onSelectClose:function(){return t.props.unsetPreventClose(i)},onSelectOpen:function(){return t.props.setPreventClose(i,function(){})}})))})}},{key:"openLabelChangePopover",value:function(e){this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:15}},m.createElement(rr.b,null,m.createElement(hn,{element:this.props.component}))))}},{key:"openBackgroundChangePopover",value:function(e){var t=this,n=e.currentTarget,i=this.props.openPopper(Object(te.toOption)(n),m.createElement("div",{style:{padding:15}},m.createElement(rr.b,null,m.createElement(Zn,{element:this.props.component,organisationId:this.props.organisationId,hideTitle:!0,onDialogClose:function(){return t.props.unsetPreventClose(i)},onDialogOpen:function(e){return t.props.setPreventClose(i,e)}}))))}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(Object(fe.a)(this.props.component))}},{key:"onButtonSettingsClick",value:function(e){this.props.dispatch(Object(Re.Gb)(this.props.component.id));var t=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"}),n=Object(mn.j)(t);this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},m.createElement(F.a,{placement:"bottom",title:this.props.i18n.t("Выравнивание текста")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onHorizontalAlignment},m.createElement(n,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Вставить ссылку")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.openInsertLinkPopover},m.createElement(gr.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Редактировать надпись")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.openLabelChangePopover},m.createElement(Xt.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Заливка")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.openBackgroundChangePopover},m.createElement(yr.a,{style:Ui.g}))),m.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дублировать")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onDuplicate},m.createElement(nr.a,{style:Ui.g}))),m.createElement(pr,{element:this.props.component,parentId:this.props.parent})))}},{key:"isSelected",value:function(e){return Object(te.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"getLabelStyle",value:function(){return this.props.component.elementCss.fonts.flatMap(function(e){return e.titleFont}).map(function(e){return{color:e.color,fontSize:e.fontSize,fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""}),textAlign:e.horizontalAlignment.toString()}}).getOrElse(function(){return{}})}},{key:"render",value:function(){var e=this;return m.createElement("div",{style:Object.assign({flex:1,textDecoration:"none",textAlign:"center",border:"0px solid",borderRadius:"3px",boxSizing:"border-box",verticalAlign:"middle",height:this.props.component.elementCss.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"})},this.getLabelStyle()),ref:function(t){return e.buttonWidgetRef=Object(te.toOption)(t)},onClick:this.onButtonSettingsClick},Object(te.toOption)(this.props.component.label).filter(function(e){return""!==e}).getOrElse(function(){return e.props.i18n.t("Кнопка")}))}}]),t}(m.PureComponent);Er=br([g.autobind],Er);var Or=Object(v.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,parent:Object(xt.e)(e.advancedEmailTemplate.present,t.component.id),selectedElementId:e.emailEditor.selectedElementId,eventLineId:e.eventLine.eventLineId}})(gi(Er)),kr=n(681),Cr=n.n(kr),jr=n(414),Tr=n.n(jr),wr=n(682),Sr=n.n(wr),Ir=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Rr=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.imageWidgetRef.foreach(function(e){return e.click()})}},{key:"getSrc",value:function(){var e=this;switch(this.props.component.src.tpe.value){case ee.ImageSrcExternal.$Type.value:return Object(te.toOption)(this.props.component.src.src).filter(function(e){return""!==e}).getOrElse(function(){return n(854)});case ee.ImageSrcFile.$Type.value:return this.props.authToken.map(function(t){return Object(te.toOption)(e.props.component.src.file).filter(function(e){return""!==e.value}).map(function(n){return Object(en.b)(t,n,e.props.cdnAddress)}).getOrElse(function(){return n(854)})}).getOrElse(function(){return n(854)});default:return n(854)}}},{key:"onImageHorizontalAlignment",value:function(e){var t=e.currentTarget;this.props.openPopper(Object(te.toOption)(t),m.createElement(bi,{element:this.props.component,hideTitle:!0}))}},{key:"openInsertLinkPopover",value:function(e){var t=this,n=e.currentTarget;this.props.eventLineId.foreach(function(e){var i=t.props.openPopper(Object(te.toOption)(n),m.createElement("div",{style:{padding:15}},m.createElement(Rn,{eventLineId:e,element:t.props.component,hideTitle:!0,onSelectClose:function(){return t.props.unsetPreventClose(i)},onSelectOpen:function(){return t.props.setPreventClose(i,function(){})}})))})}},{key:"onImageSrcChange",value:function(e){var t=this,n=e.currentTarget,i=this.props.openPopper(Object(te.toOption)(n),m.createElement("div",{style:{padding:15}},m.createElement(rr.b,null,m.createElement(un,{element:this.props.component,organisationId:this.props.organisationId,onDialogOpen:function(){return t.props.setPreventClose(i,function(){})},onDialogClose:function(){return t.props.unsetPreventClose(i)},closePopper:function(){return t.props.closePopper(i)}}))))}},{key:"onImageSizeChange",value:function(e){var t=e.currentTarget;this.props.openPopper(Object(te.toOption)(t),m.createElement("div",{style:{padding:15}},m.createElement(Kn,{element:this.props.component,hideTitle:!0})))}},{key:"onImageRemove",value:function(e){var t=this;Object(te.toOption)(this.props.component).foreach(function(n){t.props.dispatch(Object(Re.Cb)(n.id)),t.props.closePopper(e)})}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onImageSettingsClick",value:function(e){var t=this;e.stopPropagation(),this.props.dispatch(Object(Re.Gb)(this.props.component.id));var n=this.props.component.elementCss.align.flatMap(function(e){return e.justifySelf}).getOrElse(function(){return"none"}),i=Object(mn.j)(n),r=this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},m.createElement(F.a,{placement:"bottom",title:this.props.i18n.t("Выравнивание текста")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onImageHorizontalAlignment},m.createElement(i,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Вставить ссылку")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.openInsertLinkPopover},m.createElement(gr.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Изменить изображение")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onImageSrcChange},m.createElement(Cr.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Изменить размер")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onImageSizeChange},m.createElement(Sr.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Удалить")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:function(e){return t.onImageRemove(r)}},m.createElement(Tr.a,{style:Ui.g}))),m.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),m.createElement(pr,{element:this.props.component,parentId:this.props.parent})))}},{key:"isSelected",value:function(e){return Object(te.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=this.props.component.elementCss.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"});return m.createElement("div",null,m.createElement("img",{style:{display:"block",width:"100%",height:t},src:this.getSrc(),onClick:this.onImageSettingsClick,ref:function(t){return e.imageWidgetRef=Object(te.toOption)(t)}}))}}]),t}(m.Component);Rr=Ir([g.autobind],Rr);var Pr=Object(v.connect)(function(e,t){return{i18n:e.i18n,authToken:e.auth.token,parent:Object(xt.e)(e.advancedEmailTemplate.present,t.component.id),selectedElementId:e.emailEditor.selectedElementId,cdnAddress:e.config.cdnAddress,eventLineId:e.eventLine.eventLineId}})(gi(Rr)),xr=n(62),_r=n.n(xr),Lr=(n(2594),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),Dr=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.dividerWidgetRef.foreach(function(e){return e.click()})}},{key:"getLabel",value:function(){return this.props.component.type.label.getOrElse(function(){return""})}},{key:"getLabelStyle",value:function(){return this.props.component.elementCss.fonts.flatMap(function(e){return e.titleFont}).map(function(e){return{color:e.color,fontSize:e.fontSize,fontStyle:e.fontFace.map(function(e){return e.fontStyle}).getOrElse(function(){return""}),fontWeight:e.fontFace.map(function(e){return e.fontWeight}).getOrElse(function(){return""})}}).getOrElse(function(){return{}})}},{key:"onStyleEdit",value:function(e){var t=this;this.props.setPreventClose(e,function(){t.props.onComponentUpdate(t.props.parent,t.props.component,function(){return t.props.unsetPreventClose(e)})})}},{key:"onSelectParent",value:function(){var e=this;this.props.parent.foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(Object(fe.a)(this.props.component))}},{key:"onDividerWidgetSettingsClick",value:function(e){var t=this;e.stopPropagation(),this.props.dispatch(Object(Re.Gb)(this.props.component.id));var n=this.props.openPopper(Object(ir.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},m.createElement(F.a,{placement:"bottom",title:this.props.i18n.t("Редактирование стиля")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:function(e){return t.onStyleEdit(n)}},m.createElement(Xt.a,{style:Ui.g}))),m.createElement("span",{style:{padding:" 0 10px 0 10px"}},"|"),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дублировать")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onDuplicate},m.createElement(nr.a,{style:Ui.g}))),m.createElement(pr,{element:this.props.component,parentId:this.props.parent})))}},{key:"isSelected",value:function(e){return Object(ir.toOption)(e.component).flatMap(function(t){return e.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=Object(ir.toOption)(this.props.component.elementCss),n="\n            "+Object(Ei.d)(t).getOrElse(function(){return 1})+"px \n            "+Object(mn.g)(Object(Ei.c)(t)).getOrElse(function(){return"solid"})+" \n            "+Object(Ei.b)(t).getOrElse(function(){return _r.a[600]})+"\n        ";switch(this.props.component.type.tpe.value){case ee.EmailDividerElementWithLabel.$Type.value:return m.createElement("table",{style:{width:"100%",padding:"15px 0 15px 0"},onClick:this.onDividerWidgetSettingsClick,ref:function(t){return e.dividerWidgetRef=Object(ir.toOption)(t)}},m.createElement("tbody",null,m.createElement("tr",null,m.createElement("td",{style:{borderBottom:n}}),m.createElement("td",{style:Object.assign({},this.getLabelStyle(),{width:"1%",whiteSpace:"nowrap",textAlign:"center",height:"1px",lineHeight:"1px",padding:"0 15px 0 15px"})},this.getLabel()),m.createElement("td",{style:{borderBottom:n}}))));case ee.EmailDividerElementSimple.$Type.value:default:return m.createElement("div",{style:{width:"100%",padding:10,borderBottom:n},onClick:this.onDividerWidgetSettingsClick,ref:function(t){return e.dividerWidgetRef=Object(ir.toOption)(t)}})}}}]),t}(m.PureComponent);Dr=Lr([g.autobind],Dr);var Ar=Object(v.connect)(function(e,t){return{i18n:e.i18n,parent:Object(xt.e)(e.advancedEmailTemplate.present,t.component.id),selectedElementId:e.emailEditor.selectedElementId}})(gi(Dr)),Fr=n(1522),$r=n(1613),Wr=n.n($r),Mr=(n(2596),n(1830)),Nr=n.n(Mr),Hr=n(691),zr=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Br=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"onComponentDelete",value:function(e){e.stopPropagation(),this.props.dispatch(Object(Re.Cb)(this.props.component.id))}},{key:"onComponentExpanded",value:function(e){e.stopPropagation(),this.props.dispatch(Object(Re.T)(this.props.component.id))}},{key:"onComponentClosed",value:function(e){e.stopPropagation(),this.props.dispatch(Object(Re.S)(this.props.component.id))}},{key:"render",value:function(){return m.createElement("div",{style:{display:"flex",height:"56px",backgroundColor:"#fff"}},m.createElement("div",{style:{flex:1,alignSelf:"center",marginLeft:"10px"}}),this.props.expanded?m.createElement(P.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onComponentClosed},m.createElement(Nr.a,null)):m.createElement(P.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onComponentExpanded},m.createElement(Ct.a,null)),this.props.component.tpe.value!==ee.EmailRootElement.$Type.value&&m.createElement(P.a,{style:{alignSelf:"center",flexShrink:0},onClick:this.onComponentDelete},m.createElement(ze.a,null)))}}]),t}(m.Component);Br=zr([g.autobind],Br);var Vr=Object(v.connect)(function(e,t){return{expanded:Object(Hr.b)(e.emailEditor,t.component.id)}})(Br),Ur=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return m.createElement("div",{style:this.props.style,className:this.props.className},this.props.expanded?this.props.children:null)}}]),t}(m.Component),qr=Object(v.connect)(function(e,t){return{expanded:Object(Hr.b)(e.emailEditor,t.containerId)||e.emailEditor.isWYSIWYG}})(Ur),Kr=function(e){switch(e){case"none":return"0 0 0 0";case"left":return"0 auto 0 0";case"right":return"0 0 0 auto";case"center":return"0 auto";default:return"0 0 0 0"}},Gr=n(1831),Jr=n(1770),Yr=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Xr=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.rootWidgetContainerRef.foreach(function(e){return e.click()})}},{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Gb)(e.id))}),this.onRowSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Cb)(e.id))})}},{key:"getStyle",value:function(e){return{width:"100%",margin:0,minHeight:56,background:e?"lightblue":"inherit",boxShadow:"inset 0px 0px 0px 1px #aaaaaa"}}},{key:"getTableStyle",value:function(e,t){return{width:e.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),height:e.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"}),maxWidth:e.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),margin:Kr(e.align.flatMap(function(e){return e.justifySelf}).filter(function(e){return""!==e}).matchWith(function(e){return e},function(){return t.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"none"})})),borderCollapse:"collapse",borderSpacing:0}}},{key:"onSelectChild",value:function(){var e=this;Object(te.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onRowSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),Object(te.headOption)(this.props.component.children).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectChild},m.createElement(Wr.a,{style:Ui.g})))))}},{key:"isSelected",value:function(e){return Object(te.toOption)(e.component).flatMap(function(t){return e.emailEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this;return m.createElement(Fr.c,{key:Object.keys(this.props.advancedEmailTemplate.elementRelations).length,droppableId:this.props.component.id},function(t,n){return m.createElement("div",{onClick:e.onComponentSelected,ref:function(n){e.rootWidgetContainerRef=Object(te.toOption)(n),t.innerRef(n)},style:e.getStyle(n.isDraggingOver)},!e.props.emailEditor.isWYSIWYG&&m.createElement(Vr,{component:e.props.component}),m.createElement(qr,{containerId:e.props.component.id},Object(Ni.a)(e.props.component.children,"position").map(function(t,n){return m.createElement(Fr.b,{key:t.id,draggableId:t.id,index:n},function(i,r){return e.props.createPortal(m.createElement("table",Object.assign({ref:i.innerRef},i.draggableProps,i.dragHandleProps,{style:Object.assign(e.getTableStyle(t.elementCss,e.props.component.elementCss),Object(Gr.a)(r,i))}),m.createElement("tbody",null,m.createElement("tr",null,m.createElement("td",{style:{padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"}),boxSizing:"border-box"}},m.createElement(bo,{key:t.id,position:t.position,component:t,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1}))))),r.isDragging)})})),t.placeholder)})}}]),t}(m.Component);Xr=Yr([g.autobind],Xr);var Zr=Object(v.connect)(function(e){return{emailEditor:e.emailEditor,advancedEmailTemplate:e.advancedEmailTemplate.present,i18n:e.i18n,auth:e.auth,cdnAddress:e.config.cdnAddress}})(gi(Object(Jr.a)(Xr))),Qr=(n(2598),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),eo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.rootContainerWidgetContainerRef.foreach(function(e){return e.click()})}},{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Gb)(e.id))}),this.onRootContainerSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Cb)(e.id))})}},{key:"getStyle",value:function(){return{width:"100%",margin:"0 0 0 0",minHeight:"56px",boxShadow:"inset 0px 0px 0px 1px #aaaaaa"}}},{key:"onSelectChild",value:function(){var e=this;Object(te.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onRootContainerSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),Object(te.headOption)(this.props.component.children).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectChild},m.createElement(Wr.a,{style:Ui.g})))))}},{key:"isSelected",value:function(e){return Object(te.toOption)(e.component).flatMap(function(t){return e.emailEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this;return m.createElement("div",{onClick:this.onComponentSelected,ref:function(t){return e.rootContainerWidgetContainerRef=Object(te.toOption)(t)},className:this.isSelected(this.props)?"RootContainerWidget__container-selected":"RootContainerWidget__container",style:this.getStyle()},m.createElement("div",{className:"RootContainerWidget__selection"},!this.props.emailEditor.isWYSIWYG&&m.createElement(Vr,{component:this.props.component}),m.createElement(qr,{containerId:this.props.component.id,className:"RootContainerWidget__container-children"},Object(Ni.a)(this.props.component.children,"position").map(function(t,n){return m.createElement("div",{key:t.id,style:{width:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),height:"100%",maxWidth:t.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),margin:Kr(t.elementCss.align.flatMap(function(e){return e.justifySelf}).filter(function(e){return""!==e}).matchWith(function(e){return e},function(){return e.props.component.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"none"})})),borderCollapse:"collapse",borderSpacing:0,minHeight:"100%"}},m.createElement("div",{style:{padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"}),boxSizing:"border-box",height:"100%"}},m.createElement(bo,{key:t.id,position:t.position,component:t,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1})))}))))}}]),t}(m.Component);eo=Qr([g.autobind],eo);var to=Object(v.connect)(function(e){return{emailEditor:e.emailEditor,i18n:e.i18n,auth:e.auth,advancedEmailTemplate:e.advancedEmailTemplate.present,cdnAddress:e.config.cdnAddress}})(gi(eo)),no=n(634),io=n(2004),ro=n(2602),oo=n.n(ro),ao=(n(2600),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),lo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.updateElementWidth),this.updateElementWidth()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateElementWidth)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.component.elementCss.proportions.flatMap(function(e){return e.width}),n=e.component.elementCss.proportions.flatMap(function(e){return e.width}),i=this.props.component.elementCss.proportions.flatMap(function(e){return e.maxWidth}),r=e.component.elementCss.proportions.flatMap(function(e){return e.maxWidth});Object(te.isEqual)(t,n)&&Object(te.isEqual)(i,r)||this.updateElementWidth()}},{key:"onElementsVerticalAlign",value:function(){var e=this.props.component.children,t=e.map(function(e){return e.children.reduce(function(e,t,n){return Object(te.toOption)(document.getElementById(t.id)).map(function(t){return Object(te.toOption)(e[n]).filter(function(e){return e>t.getBoundingClientRect().top}).matchWith(function(){return e},function(){return[].concat(Jt()(e),[t.getBoundingClientRect().top])})}).getOrElse(function(){return e})},[])}),n=t.map(function(e){return e.reduce(function(e,t){return e+t})}).reduce(function(e,t,n,i){return t>i[e]?n:e},0),i=Object(te.lift)(t,n).getOrElse(function(){return Object(te.headOption)(t).getOrElse(function(){return[]})}),r=Object(no.default)(e.map(function(e){return e.children.reduce(function(e,t,n){return Object(te.toOption)(document.getElementById(t.id)).map(function(r){var o=i[n]-r.getBoundingClientRect().top,a={elementId:t.id,marginTop:o+ee.EmailElement.DEFAULT_MARGIN-Object(te.toOption)(e[n-1]).map(function(e){return e.prevMargin||0}).getOrElse(function(){return 0}),prevMargin:o};return[].concat(Jt()(e),[a])}).getOrElse(function(){return e})},[])})).map(function(e){return Object(io.default)(e,"prevMargin")});this.props.dispatch(Object(Re.tb)(r))}},{key:"updateElementWidth",value:function(){var e=this;this.rowWidgetContainerRef.foreach(function(t){e.props.dispatch(Object(Re.rb)({elementId:e.props.component.id,width:t.clientWidth}))})}},{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Gb)(e.id))}),this.onRowSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Cb)(e.id))})}},{key:"getBorderStyle",value:function(){return{boxShadow:"inset 0px 0px 0px 1px #aaaaaa"}}},{key:"onSelectChild",value:function(){var e=this;Object(te.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onDuplicate",value:function(){this.props.dispatch(Object(fe.a)(this.props.component))}},{key:"onRowSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),Object(te.headOption)(this.props.component.children).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectChild},m.createElement(Wr.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дублировать")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onDuplicate},m.createElement(nr.a,{style:Ui.g}))),m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Вертикальное выравнивание")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onElementsVerticalAlign},m.createElement(oo.a,{style:Ui.g}))),m.createElement(pr,{element:this.props.component,parentId:Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id)})))}},{key:"isSelected",value:function(e){return Object(te.toOption)(e.component).flatMap(function(t){return e.emailEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=Object(Ni.a)(this.props.component.children,"position");return m.createElement("div",{id:this.props.component.id,onClick:this.onComponentSelected,ref:function(t){return e.rowWidgetContainerRef=Object(te.toOption)(t)},style:Object.assign({flex:1,margin:"0 0 0 0",minHeight:"56px"},this.getBorderStyle())},m.createElement("div",{className:"RowWidget__selection"},!this.props.emailEditor.isWYSIWYG&&m.createElement(Vr,{component:this.props.component}),m.createElement(qr,{containerId:this.props.component.id,className:"RowWidget__container-children"},m.createElement("div",{style:{width:"100%",textAlign:this.props.component.horizontalContentAlignment}},t.map(function(t,n){return m.createElement("div",{key:t.id,style:{display:"inline-block",width:"100%",maxWidth:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),height:t.elementCss.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"}),padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"}),verticalAlign:e.props.component.elementCss.align.map(function(e){return e.justifyContent}).getOrElse(function(){return"top"})}},m.createElement(bo,{key:t.id,position:t.position,component:t,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1}))})))))}}]),t}(m.Component);lo=ao([g.autobind],lo);var so=Object(v.connect)(function(e){return{emailEditor:e.emailEditor,advancedEmailTemplate:e.advancedEmailTemplate.present,i18n:e.i18n,auth:e.auth,cdnAddress:e.config.cdnAddress}})(gi(lo)),co=(n(2603),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),uo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){!1===this.isSelected(this.props)&&!0===this.isSelected(e)&&this.columWidgetContainerRef.foreach(function(e){return e.click()})}},{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Gb)(e.id))}),this.onColumnSettingsClick(e)}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Cb)(e.id))})}},{key:"getStyle",value:function(e,t){return{flex:1,margin:0,minHeight:t?100:56,background:e?"lightblue":"inherit",boxShadow:"inset 0px 0px 0px 1px #aaaaaa"}}},{key:"getTableStyle",value:function(e){var t=this;return{width:e.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),height:e.proportions.flatMap(function(e){return e.height}).getOrElse(function(){return"auto"}),maxWidth:e.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),margin:Kr(e.align.flatMap(function(e){return e.justifySelf}).filter(function(e){return""!==e}).matchWith(function(e){return e},function(){return t.props.component.horizontalContentAlignment})),borderCollapse:"collapse",borderSpacing:0}}},{key:"onSelectChild",value:function(){var e=this;Object(te.headOption)(this.props.component.children).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t.id))})}},{key:"onSelectParent",value:function(){var e=this;Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).foreach(function(t){return e.props.dispatch(Object(Re.Gb)(t))})}},{key:"onColumnSettingsClick",value:function(e){e.stopPropagation(),this.props.openPopper(Object(te.toOption)(e.currentTarget),m.createElement("div",{style:{padding:10}},Object(xt.e)(this.props.advancedEmailTemplate,this.props.component.id).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Родительский элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectParent},m.createElement(er.a,{style:Ui.g}))),Object(te.headOption)(this.props.component.children).nonEmpty()&&m.createElement(F.a,{placement:"top",title:this.props.i18n.t("Дочерний элемент")},m.createElement(P.a,{style:Object.assign({},Ui.f,{margin:5}),onClick:this.onSelectChild},m.createElement(Wr.a,{style:Ui.g})))))}},{key:"isSelected",value:function(e){return Object(te.toOption)(e.component).flatMap(function(t){return e.emailEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1})}},{key:"render",value:function(){var e=this,t=0===this.props.component.children.length;return m.createElement(Fr.c,{key:this.props.position,droppableId:this.props.component.id},function(n,i){return m.createElement("div",{onClick:e.onComponentSelected,ref:function(t){e.columWidgetContainerRef=Object(te.toOption)(t),n.innerRef(t)},style:e.getStyle(i.isDraggingOver,t)},m.createElement("div",{className:"ColumnWidget__selection"},!e.props.emailEditor.isWYSIWYG&&m.createElement(Vr,{component:e.props.component}),m.createElement(qr,{containerId:e.props.component.id,className:"ColumnWidget__container-children",style:{display:"flex",flexDirection:"column",justifyContent:e.props.component.elementCss.align.map(function(e){return function(e){switch(e){case"top":return"flex-start";case"middle":return"center";case"bottom":return"flex-end";default:return"flex-start"}}(e.justifyContent)}).getOrElse(function(){return"flex-start"})}},Object(Ni.a)(e.props.component.children,"position").map(function(t,n){return m.createElement(Fr.b,{key:t.id,draggableId:t.id,index:n},function(i,r){return e.props.createPortal(m.createElement("table",Object.assign({id:t.id,ref:i.innerRef},i.draggableProps,i.dragHandleProps,{style:Object.assign(e.getTableStyle(t.elementCss),Object(Gr.a)(r,i))}),m.createElement("tbody",null,m.createElement("tr",null,m.createElement("td",{style:{padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultMargin()+"px"}),boxSizing:"border-box"}},m.createElement(bo,{key:t.id,position:t.position,component:t,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:e.props.component.children.length===n+1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1}))))),r.isDragging)})}))),n.placeholder)})}}]),t}(m.Component);uo=co([g.autobind],uo);var po,fo=Object(v.connect)(function(e){return{emailEditor:e.emailEditor,advancedEmailTemplate:e.advancedEmailTemplate.present,i18n:e.i18n,auth:e.auth}})(gi(Object(Jr.a)(uo))),ho=(n(2605),n(2607),n(1475)),mo=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},go=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vo=(po={},r()(po,ee.HtmlContentElement.$Type.value,function(e,t){return m.createElement(hr,{key:t.id,component:t,getDisplayHtml:e.getDisplayHtml,i18n:e.i18n,fields:e.fields,organisationId:e.organisationId})}),r()(po,ee.EmailDividerElement.$Type.value,function(e,t){return m.createElement(Ar,{key:t.id,component:t,onComponentUpdate:e.onComponentUpdate})}),r()(po,ee.EmailImageElement.$Type.value,function(e,t){return m.createElement(Pr,{key:t.id,component:t,organisationId:e.organisationId})}),r()(po,ee.EmailButtonElement.$Type.value,function(e,t){return m.createElement(Or,{key:t.id,i18n:e.i18n,component:t,organisationId:e.organisationId})}),r()(po,ee.EmailRootElement.$Type.value,function(e,t){return m.createElement(Zr,{key:t.id,component:t,position:t.position,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),r()(po,ee.EmailRootContainerElement.$Type.value,function(e,t){return m.createElement(to,{key:t.id,component:t,position:t.position,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),r()(po,ee.EmailRowElement.$Type.value,function(e,t){return m.createElement(so,{key:t.id,component:t,position:t.position,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),r()(po,ee.EmailColumnElement.$Type.value,function(e,t){return m.createElement(fo,{key:t.id,component:t,position:t.position,onComponentAdded:e.onComponentAdded,onComponentUpdate:e.onComponentUpdate,getDisplayHtml:e.getDisplayHtml,isTopPadded:!0,isRightPadded:!0,isBottomPadded:!0,isLeftPadded:!0})}),po),yo=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hovered:!1},n}return d()(t,e),s()(t,[{key:"onComponentSelected",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Gb)(e.id))})}},{key:"onComponentDelete",value:function(e){var t=this;e.stopPropagation(),Object(te.toOption)(this.props.component).foreach(function(e){return t.props.dispatch(Object(Re.Cb)(e.id))})}},{key:"renderComponent",value:function(e){var t=this;return Object(Zi.b)(e.tpe.value)(vo).map(function(n){return n(t.props,e)}).getOrElse(function(){return m.createElement("div",null,t.props.i18n.t("Неизвестный тип элемента"))})}},{key:"onMouseEnter",value:function(e){e.stopPropagation(),this.setState(E(this.state,{hovered:{$set:!0}}))}},{key:"onMouseLeave",value:function(e){e.stopPropagation(),this.setState(E(this.state,{hovered:{$set:!1}}))}},{key:"getElementBorder",value:function(){var e=Object(te.toOption)(this.props.component.elementCss),t=Object(Ei.e)(e).getOrElse(function(){return Ei.a}),n=Object(Ei.e)(e).flatMap(function(e){return e.borderRadius}).getOrElse(function(){return t.getDefaultBorderRadius()});switch(this.props.component.tpe.value){case ee.EmailButtonElement.$Type.value:var i="0px solid ".concat(_r.a[600]);return{borderTop:Object(ho.d)(e).getOrElse(function(){return i}),borderRight:Object(ho.c)(e).getOrElse(function(){return i}),borderBottom:Object(ho.a)(e).getOrElse(function(){return i}),borderLeft:Object(ho.b)(e).getOrElse(function(){return i}),borderRadius:n};default:return{}}}},{key:"render",value:function(){var e=this,t=this.props.component.elementCss.proportions.getOrElse(function(){return new ee.ElementProportions}),n=this.props.component.elementCss.background.getOrElse(function(){return new ee.ElementBackground("inherit")}),i=this.props.emailEditor.draggingElement.map(function(t){return e.props.component.id===t.id}).getOrElse(function(){return!1}),r=n.file.enabled?n.file.fileId.flatMap(function(t){return Object(en.a)(e.props.auth,t,e.props.cdnAddress).map(function(e){return'url("'+e+'")'})}).getOrElse(function(){return"none"}):"none",o=Object.assign({boxSizing:"border-box",maxWidth:t.maxWidth.getOrElse(function(){return"none"}),minWidth:t.minWidth.getOrElse(function(){return"58px"}),overflowY:"hidden",overflowX:"hidden",width:"100%",backgroundColor:i?"#B3E5FC":n.color,backgroundImage:r,backgroundSize:"cover"},this.getElementBorder()),a=Object(te.toOption)(this.props.component).flatMap(function(t){return e.props.emailEditor.selectedElementId.map(function(e){return e===t.id})}).getOrElse(function(){return!1});return m.createElement("div",{className:a?"Email-ElementRenderer__container-selected":"Email-ElementRenderer__container",onMouseOver:this.onMouseEnter,onMouseOut:this.onMouseLeave,onClick:this.onComponentSelected,style:o,id:this.props.component.id,key:this.props.component.id},m.createElement("div",{className:"Email-ElementRenderer__container-selection",style:{boxSizing:"border-box",opacity:i?0:1,padding:t.padding.map(function(e){return e.toString()}).getOrElse(function(){return e.props.component.getDefaultPadding()+"px"})}},this.renderCellBody(a),this.props.component.tpe.value!==ee.EmailRootElement.$Type.value&&this.props.component.tpe.value!==ee.EmailRootContainerElement.$Type.value&&m.createElement(P.a,{className:"Email-ElementRenderer__button",style:{visibility:this.state.hovered?"visible":"hidden"},onClick:this.onComponentDelete},m.createElement(ze.a,{style:Ui.g}))))}},{key:"renderCellBody",value:function(e){return m.createElement("div",{key:this.props.component.id,style:{display:"flex",flex:"1",justifyContent:(new ee.ElementAlign).justifyContent,height:"100%"}},this.renderComponent(this.props.component))}}]),t}(m.Component);yo=mo([g.autobind,go("design:paramtypes",[Object])],yo);var bo=Object(v.connect)(function(e){return{emailEditor:e.emailEditor,i18n:e.i18n,auth:e.auth,fields:e.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.fields.list,t.id.value)}).getOrElse(function(){return[]}),organisationId:e.organisation.organisationId,cdnAddress:e.config.cdnAddress}})(Object(Ze.a)(yo)),Eo=(n(2609),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),Oo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"onComponentUnselected",value:function(){this.props.dispatch(Object(Re.Bb)())}},{key:"render",value:function(){var e=this;return m.createElement(m.Fragment,null,this.props.rootContainerElement.map(function(t){return m.createElement("div",{key:t.id,className:"EmailEditorScene__container",style:{width:t.elementCss.proportions.flatMap(function(e){return e.width}).getOrElse(function(){return"auto"}),maxWidth:t.elementCss.proportions.flatMap(function(e){return e.maxWidth}).getOrElse(function(){return"auto"}),padding:t.elementCss.proportions.flatMap(function(e){return e.margin}).map(function(e){return e.toString()}).getOrElse(function(){return t.getDefaultMargin()+"px"}),boxSizing:"border-box",flex:1,border:"1px solid rgb(117, 117, 117)"}},m.createElement(bo,{key:t.id,position:t.position,component:t,onComponentAdded:e.props.onComponentAdded,onComponentUpdate:e.props.onComponentUpdate,getDisplayHtml:e.props.getDisplayHtml,isLastChild:!1,isTopPadded:!1,isRightPadded:!1,isBottomPadded:!1,isLeftPadded:!1}))}).getOrElse(function(){return m.createElement("div",null)}))}}]),t}(m.Component);Oo=Eo([g.autobind],Oo);var ko=Object(v.connect)(function(e,t){return{i18n:e.i18n,rootContainerElement:e.advancedEmailTemplate.present.rootContainerElement}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.advancedEmailTemplate.present.rootContainerElement===t.advancedEmailTemplate.present.rootContainerElement},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.rootContainerElement===t.rootContainerElement}})(Oo),Co=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},jo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return m.createElement("div",null,m.createElement(zt,{element:this.props.element,fields:this.props.fields,organisationId:this.props.organisationId}))}}]),t}(m.Component);jo=Co([g.autobind],jo);var To=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(jo),wo=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},So=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return m.createElement("div",null,m.createElement(un,{element:this.props.element,organisationId:this.props.organisationId,onDialogClose:this.props.onDialogClose}))}}]),t}(m.Component);So=wo([g.autobind],So);var Io=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(So),Ro=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Po=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return m.createElement("div",null,m.createElement(hn,{element:this.props.element}),m.createElement(hi,{element:this.props.element,hideTitle:!0}),m.createElement(Zn,{element:this.props.element,organisationId:this.props.organisationId,hideTitle:!0}),m.createElement(Rn,{eventLineId:this.props.eventLineId,element:this.props.element,hideTitle:!0}))}}]),t}(m.Component);Po=Ro([g.autobind],Po);var xo=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Po),_o=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Lo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return m.createElement("div",null,m.createElement(Gi,{element:this.props.element,onComponentAdded:this.props.onComponentAdded}))}}]),t}(m.Component);Lo=_o([g.autobind],Lo);var Do=Object(v.connect)(function(e,t){return{i18n:e.i18n}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Lo),Ao=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Fo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return this.props.element.filter(function(e){return e instanceof ee.EmailDividerElement}).map(function(e){return m.createElement("div",null,m.createElement(ji,{element:e,hideTitle:!0}),m.createElement(bn,{element:e}),e.type instanceof ee.EmailDividerElementWithLabel&&m.createElement(hi,{element:e,hideTitle:!0}))}).getOrNull()}}]),t}(m.Component);Fo=Ao([g.autobind],Fo);var $o,Wo=Object(v.connect)(function(e,t){return{i18n:e.i18n,element:Object(xt.c)(e.advancedEmailTemplate.present,t.elementId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.advancedEmailTemplate.present.rootContainerElement,t.advancedEmailTemplate.present.rootContainerElement)},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.element,t.element)}})(Fo),Mo=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},No=($o={},r()($o,ee.HtmlContentElement.$Type.value,function(e,t){return m.createElement(To,{element:t,fields:e.props.fields,organisationId:e.props.organisationId})}),r()($o,ee.EmailRowElement.$Type.value,function(e,t){return m.createElement(Do,{element:t,onComponentAdded:e.props.onComponentAdded})}),r()($o,ee.EmailImageElement.$Type.value,function(e,t){return m.createElement(Io,{element:t,organisationId:e.props.organisationId,onDialogClose:e.props.onDialogClose})}),r()($o,ee.EmailButtonElement.$Type.value,function(e,t){return m.createElement(xo,{eventLineId:e.props.eventLineId,element:t,organisationId:e.props.organisationId})}),r()($o,ee.EmailDividerElement.$Type.value,function(e,t){return m.createElement(Wo,{elementId:t.id})}),$o),Ho=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){var e=this;return this.props.element.flatMap(function(t){return Object(Zi.b)(t.tpe.value)(No).map(function(n){return n(e,t)})}).getOrNull()}}]),t}(m.Component);Ho=Mo([g.autobind],Ho);var zo=Object(v.connect)(function(e,t){return{i18n:e.i18n,element:Object(xt.c)(e.advancedEmailTemplate.present,t.elementId)}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.advancedEmailTemplate.present.rootContainerElement,t.advancedEmailTemplate.present.rootContainerElement)},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.element,t.element)}})(Ho),Bo=n(1895),Vo=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Uo=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qo=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={text:e.text},n}return d()(t,e),s()(t,[{key:"onTextChange",value:function(e){var t=this;this.setState(E(this.state,{text:{$set:e}}),function(){return t.props.onTextChange(e)})}},{key:"handleTextChange",value:function(e){this.onTextChange(e.target.value)}},{key:"render",value:function(){var e=this;return m.createElement("div",null,m.createElement(I.a,{variant:"text",color:"primary",size:"small",onClick:function(){return e.onTextChange(e.props.textFromHtml)},style:{marginBottom:10}},this.props.i18n.t("Создать из HTML")),m.createElement("textarea",{value:this.state.text,onChange:this.handleTextChange,rows:30,style:{width:"100%",boxSizing:"border-box",border:"1px solid ".concat(_r.a[600])}}))}}]),t}(m.Component);qo=Vo([g.autobind,Uo("design:paramtypes",[Object])],qo);var Ko,Go=Object(v.connect)(function(e){return{i18n:e.i18n}})(qo),Jo=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Yo=(Ko={},r()(Ko,ee.HtmlContentElement.$Type.value,function(e,t){return E(new ee.HtmlContentElement("<div>"+e.i18n.t("Контент")+"</div>",t),{elementCss:{background:{$set:Object(te.toOption)(new ee.ElementBackground("transparent"))}}})}),r()(Ko,ee.EmailRowElement.$Type.value,function(e,t){return E(new ee.EmailRowElement([E(new ee.EmailColumnElement([],0),{elementCss:{proportions:{$set:Object(te.toOption)(new ee.ElementProportions(new te.None,new te.None,Object(te.toOption)(new ee.ElementMargin(ee.EmailElement.DEFAULT_MARGIN,0,ee.EmailElement.DEFAULT_MARGIN,0))))},align:{$set:Object(te.toOption)(new ee.ElementAlign(new te.None,"top"))}}})],t),{elementCss:{proportions:{$set:Object(te.toOption)(new ee.ElementProportions(Object(te.toOption)("100%"),new te.None,Object(te.toOption)(new ee.ElementMargin(ee.EmailElement.DEFAULT_MARGIN,0,ee.EmailElement.DEFAULT_MARGIN,0))))}}})}),r()(Ko,ee.EmailColumnElement.$Type.value,function(e,t){return E(new ee.EmailColumnElement([],0),{elementCss:{proportions:{$set:Object(te.toOption)(new ee.ElementProportions(new te.None,new te.None,Object(te.toOption)(new ee.ElementMargin(ee.EmailElement.DEFAULT_MARGIN,0,ee.EmailElement.DEFAULT_MARGIN,0))))}}})}),r()(Ko,ee.EmailImageElement.$Type.value,function(e,t){return E(new ee.EmailImageElement(new ee.ImageSrcFile(new ee.Id("")),"",t),{elementCss:{background:{$set:Object(te.toOption)(new ee.ElementBackground("transparent"))},proportions:{$set:Object(te.toOption)(new ee.ElementProportions(Object(te.toOption)("100%")))}}})}),r()(Ko,ee.EmailButtonElement.$Type.value,function(e,t){return E(new ee.EmailButtonElement(new ee.ButtonHrefExternal(""),"",t),{elementCss:{background:{$set:Object(te.toOption)(new ee.ElementBackground(Ui.a))},proportions:{$set:Object(te.toOption)(new ee.ElementProportions(new te.None,new te.None,new te.None,Object(te.toOption)(new ee.ElementMargin(8,16,8,16))))},border:{$set:Object(te.toOption)(Ei.a)},fonts:{$set:Object(te.toOption)(new ee.ElementFonts(new te.None,Object(te.toOption)(new ee.ElementFont(ee.FontFile.createDefault(),16,!1,"#00000",new ee.ElementHorizontalAlignmentCentered,new ee.ElementVerticalAlignmentMiddle))))}}})}),r()(Ko,ee.EmailDividerElement.$Type.value,function(e,t){return E(new ee.EmailDividerElement(t),{elementCss:{proportions:{$set:Object(te.toOption)(new ee.ElementProportions(Object(te.toOption)("100%"),new te.None,Object(te.toOption)(new ee.ElementMargin(ee.EmailElement.DEFAULT_MARGIN,0,ee.EmailElement.DEFAULT_MARGIN,0))))},border:{$set:Object(te.toOption)(Ei.a)},fonts:{$set:Object(te.toOption)(new ee.ElementFonts(new te.None,Object(te.toOption)(new ee.ElementFont(ee.FontFile.createDefault(),16,!1,"#00000",new ee.ElementHorizontalAlignmentLeft,new ee.ElementVerticalAlignmentMiddle))))}}})}),Ko),Xo=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"getEmailElement",value:function(e,t){var n=this;return Object(Zi.b)(e.value)(Yo).map(function(e){return e(n.props,t)}).getOrElse(function(){return new ee.EmailRowElement([],t)})}},{key:"onComponentAdded",value:function(e,t,n){var i=this.getEmailElement(t,n);this.props.dispatch(Object(Re.U)({parent:e,component:i}))}},{key:"openComponentAttributes",value:function(e,t,n){var i=this.getEmailElement(t,n);this.props.dispatch(Object(Re.U)({parent:e,component:i})),this.props.dispatch(Object(Re.Eb)()),this.onComponentUpdate(e,i)}},{key:"onComponentUpdate",value:function(e,t,n){var i=this;this.props.eventLineId.foreach(function(e){var r=i.props.openDialog(i.props.i18n.t("Редактирование элемента"),m.createElement(zo,{elementId:t.id,fields:i.props.fields,eventLineId:e,organisationId:i.props.organisationId,onComponentAdded:i.onComponentAdded,onComplete:function(){return i.props.handleDialogClose(r)}}),[m.createElement(I.a,{key:"close",variant:"raised",onClick:function(){return i.props.handleDialogClose(r)},style:{marginRight:"10px"}},i.props.i18n.t("Закрыть"))],{onDialogClose:n})})}},{key:"getDisplayHtml",value:function(e){return Object(Bo.a)(e,this.props.fields,this.props.insertions,this.props.urlLinks,this.props.token,this.props.i18n.t,this.props.cdnAddress)}},{key:"openTextDialog",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Текст рассылки (версия без html)"),m.createElement(Go,{text:this.props.advancedEmailTemplateText.getOrElse(function(){return""}),textFromHtml:Object(mn.X)(this.props.dispatch(Object(fe.c)())),onTextChange:function(t){return e.props.dispatch(Object(Re.wb)(t))}}),[m.createElement(I.a,{variant:"raised",onClick:function(){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"addWidgetToScene",value:function(e,t){this.openComponentAttributes(Object(te.toOption)(t.droppableId),new te.TypeId(e.draggableId),t.index)}},{key:"relocateElement",value:function(e,t){e.source.droppableId!==Pt.a&&this.props.dispatch(Object(Re.Fb)({targetId:Object(te.toOption)(t.droppableId),elementId:e.draggableId,position:t.index}))}},{key:"moveElement",value:function(e,t){e.source.droppableId!==Pt.a&&e.source.index!==t.index&&e.source.droppableId===t.droppableId&&this.props.dispatch(Object(Re.Db)({sourcePosition:e.source.index,targetPosition:t.index,parentId:t.droppableId}))}},{key:"onDragEnd",value:function(e){var t=this;Object(te.toOption)(e.destination).foreach(function(n){Object(te.toOption)(e.source.droppableId===Pt.a).filter(function(e){return e}).foreach(function(){return t.addWidgetToScene(e,n)}),Object(te.toOption)(e.source.droppableId!==n.droppableId).filter(function(e){return e}).foreach(function(){return t.relocateElement(e,n)}),t.moveElement(e,n)})}},{key:"render",value:function(){return m.createElement(Fr.a,{onDragEnd:this.onDragEnd},m.createElement("div",{style:{display:"flex",flex:1,height:"100%"}},m.createElement("div",{style:{width:"270px",overflowY:"auto",boxSizing:"border-box"}},m.createElement(Xi,{fields:this.props.fields,organisationId:this.props.organisationId,onComponentAdded:this.onComponentAdded,openComponentAttributes:this.openComponentAttributes}),m.createElement(I.a,{variant:"text",color:"primary",size:"small",onClick:this.openTextDialog},this.props.i18n.t("Открыть текст рассылки"))),m.createElement("div",{style:{flex:1,paddingLeft:"10px",overflowY:"auto",display:"flex",flexDirection:"column"}},m.createElement(ko,{onComponentAdded:this.onComponentAdded,onComponentUpdate:this.onComponentUpdate,getDisplayHtml:this.getDisplayHtml}))))}}]),t}(m.Component);Xo=Jo([g.autobind],Xo);var Zo=Object(v.connect)(function(e,t){return{i18n:e.i18n,token:e.auth.token,cdnAddress:e.config.cdnAddress,insertions:e.advancedEmailTemplate.present.insertions,attachments:e.advancedEmailTemplate.present.attachments,urlLinks:e.advancedEmailTemplate.present.urlLinks,advancedEmailTemplateText:e.advancedEmailTemplate.present.text,advancedEmailTemplate:e.advancedEmailTemplate.present,eventLineId:e.eventLine.eventLineId}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.auth.token,t.auth.token)&&e.advancedEmailTemplate.present.insertions===t.advancedEmailTemplate.present.insertions&&e.advancedEmailTemplate.present.attachments===t.advancedEmailTemplate.present.attachments&&e.advancedEmailTemplate.present.urlLinks===t.advancedEmailTemplate.present.urlLinks&&e.advancedEmailTemplate.present===t.advancedEmailTemplate.present},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&Object(te.isEqual)(e.token,t.token)&&e.insertions===t.insertions&&e.attachments===t.attachments&&e.urlLinks===t.urlLinks&&e.advancedEmailTemplate===t.advancedEmailTemplate}})(Object(Ze.a)(Xo)),Qo=n(278),ea=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ta=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},na=new C.CompositeDecorator([{strategy:Lt.b,component:Lt.a},{strategy:Dt.b,component:Dt.a},{strategy:At.b,component:At.a}]),ia=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=Object(Ft.a)(n.props.html,na,n.props.fields,n.props.insertions,n.props.urlLinks,n.props.i18n.t);C.EditorState.moveSelectionToEnd(i);return n.state={editorState:i,insertions:n.props.insertions,urlLinks:n.props.urlLinks,attachments:n.props.attachments},n}return d()(t,e),s()(t,[{key:"onAttachmentsChange",value:function(e){this.setState(E(this.state,{attachments:{$set:e}}))}},{key:"onInsertionsChange",value:function(e){this.setState(E(this.state,{insertions:{$set:e}}))}},{key:"onUrlLinksChange",value:function(e){this.setState(E(this.state,{urlLinks:{$set:e}}))}},{key:"onEditorStateChange",value:function(e){var t=this;this.setState(E(this.state,{editorState:{$set:e}}),function(){setTimeout(function(){t.state.editorState===e&&t.props.dispatch(Object(Qo.g)({html:Object($t.a)(Object(C.convertToRaw)(e.getCurrentContent())),attachments:t.state.attachments,insertions:t.state.insertions,urlLinks:t.state.urlLinks}))},200)})}},{key:"onShowHTMLChange",value:function(e){this.props.dispatch(Object(Qo.i)())}},{key:"onHtmlChange",value:function(e){this.props.dispatch(Object(Qo.g)({html:e,attachments:this.state.attachments,insertions:this.state.insertions,urlLinks:this.state.urlLinks}))}},{key:"handleTextChange",value:function(e){this.onTextChange(e.target.value)}},{key:"onTextChange",value:function(e){this.props.dispatch(Object(Qo.j)(e))}},{key:"openTextDialog",value:function(){var e=this,t=this.props.openDialog(this.props.i18n.t("Текст рассылки (версия без html)"),m.createElement(Go,{text:this.props.text,textFromHtml:Object(mn.X)(this.props.html),onTextChange:this.onTextChange}),[m.createElement(I.a,{variant:"raised",onClick:function(){return e.props.handleDialogClose(t)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть"))])}},{key:"render",value:function(){return m.createElement("div",{style:{flex:1,paddingLeft:15}},m.createElement(_t.a,{showInsertionButtons:!0,formId:this.props.formId,fields:this.props.fields,organisationId:this.props.organisationId,insertions:this.state.insertions,attachments:this.state.attachments,urlLinks:this.state.urlLinks,onAttachmentsChange:this.onAttachmentsChange,onInsertionsChange:this.onInsertionsChange,onUrlLinksChange:this.onUrlLinksChange,html:this.props.html,showHtml:this.props.showHtml,editorState:this.state.editorState,onChange:this.onEditorStateChange,onShowHTMLChange:this.onShowHTMLChange,onHtmlChange:this.onHtmlChange}),m.createElement(I.a,{variant:"text",color:"primary",size:"small",onClick:this.openTextDialog},this.props.i18n.t("Открыть текст рассылки")))}}]),t}(m.Component);ia=ea([g.autobind,ta("design:paramtypes",[Object])],ia);var ra=Object(v.connect)(function(e,t){return{i18n:e.i18n,html:e.simpleEmailTemplate.present.html.getOrElse(function(){return""}),text:e.simpleEmailTemplate.present.text.getOrElse(function(){return""}),showHtml:e.simpleEmailTemplate.present.showHtml,insertions:e.simpleEmailTemplate.present.insertions,attachments:e.simpleEmailTemplate.present.attachments,urlLinks:e.simpleEmailTemplate.present.urlLinks}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.simpleEmailTemplate.present.showHtml===t.simpleEmailTemplate.present.showHtml&&Object(te.isEqual)(e.simpleEmailTemplate.present.html,t.simpleEmailTemplate.present.html)&&Object(te.isEqual)(e.simpleEmailTemplate.present.text,t.simpleEmailTemplate.present.text)},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.html===t.html&&e.text===t.text&&e.showHtml===t.showHtml}})(Object(Ze.a)(ia)),oa=n(1531),aa=n(1479),la=n(1493),sa=n(1768),ca=n(136),ua=n(1546),pa=n(2015),da=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fa=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){e.currentTab!==this.props.currentTab&&e.dispatch(1===e.currentTab?Object(Re.zb)():Object(Re.yb)())}},{key:"componentDidMount",value:function(){this.props.dispatch(1===this.props.currentTab?Object(Re.zb)():Object(Re.yb)())}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(Re.yb)())}},{key:"handleCreateAnBound",value:function(e){this.props.fields.logField.onChange(e.formField.value)}},{key:"onCreateNewTextField",value:function(){var e=this,t=Object(te.headOption)(this.props.eventLine.data.map(function(t){return Object(xe.f)(e.props.forms,t.id)}).getOrElse(function(){return[]}).filter(function(e){return ee.FormType.isEmail(e.entity.formType)})),n={caption:this.props.i18n.t("Письма"),name:"messages",valueTypeTag:ee.ValueTagEmailLogRefs.$Type.value};t.foreach(function(e){n=Object.assign({},n,{referenceFamily:e.id.value})}),Object(oa.d)({openDialog:this.props.openDialog,handleDialogClose:this.props.handleDialogClose,formId:new ee.Id(this.props.params.formId),i18n:this.props.i18n,handleCreateAnBound:this.handleCreateAnBound,dispatch:this.props.dispatch},n)}},{key:"renderAdvancedEditor",value:function(){return m.createElement(Zo,{fields:Object(Pe.e)(this.props.formFields,this.props.formId).getOrElse(function(){return[]}),organisationId:this.props.organisationId})}},{key:"renderSimpleEditor",value:function(){return m.createElement(ra,{formId:Object(te.toOption)(this.props.formId),fields:Object(Pe.e)(this.props.formFields,this.props.formId).getOrElse(function(){return[]}),organisationId:this.props.organisationId})}},{key:"renderHtmlEditor",value:function(){switch(this.props.fields.editorType.value){case ee.EmailDataEditorTypeSimple.$Type.value:return this.renderSimpleEditor();case ee.EmailDataEditorTypeAdvanced.$Type.value:return this.renderAdvancedEditor();default:return this.renderSimpleEditor()}}},{key:"onUseAltSenderConfig",value:function(e,t){var n=this;Object(te.toOption)(t).filter(function(e){return e}).matchWith(function(){return Object(te.headOption)(n.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.EmailTransport})).foreach(function(e){return n.props.fields.transportId.onChange(e.id.value)})},function(){return n.props.fields.transportId.onChange("")})}},{key:"getSenderConfigValue",value:function(){return this.props.fields.transportId.value||Object(te.headOption)(this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.EmailTransport&&e.entity.isDefault})).map(function(e){return e.id.value}).getOrElse(function(){return""})}},{key:"isSenderConfigsNotEmpty",value:function(){return!Object(te.headOption)(this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.EmailTransport})).isEmpty()}},{key:"handleSenderMailChange",value:function(e){var t=this.props.fields,n=t.senderMail,i=t.replyMail;n.onChange(e),n.value===i.value&&i.onChange(e)}},{key:"renderTabContents",value:function(){var e=this,t=this.props.fields,n=t.name,i=t.senderName,r=t.senderMail,o=t.replyMail,a=t.subject,l=t.manualUseAllowed,s=t.baseUrl,c=t.attachments,u=t.addressTypes,p=t.threadFieldId,d=t.tag;switch(this.props.currentTab){case 0:return m.createElement("div",{style:{padding:15}},m.createElement("h4",{className:"Form__header-first"},this.props.i18n.t("Основное")),m.createElement("div",{className:"Form__content-block"},m.createElement(ye.a,{value:n.value,onChange:n.onChange,fullWidth:!0,label:this.props.i18n.t("Название"),autoFocus:!0}),m.createElement(la.a,{value:d.value,onChange:d.onChange,suggestions:this.props.tags,onBlur:function(){}},m.createElement(ye.a,{label:this.props.i18n.t("Группа"),error:d.touched&&d.error,fullWidth:!0,autoComplete:"off"})),m.createElement(pa.a,{formId:this.props.formId,addressTypes:u.value||[],onChange:u.onChange}),this.isSenderConfigsNotEmpty()&&m.createElement("div",{style:{maxWidth:"400px"}},m.createElement(_.a,{label:this.props.i18n.t("Использовать альтернативную конфигурацию"),control:m.createElement(D.a,{checked:""!==this.props.fields.transportId.value,style:{margin:"10px 0px"},onChange:this.onUseAltSenderConfig})})),this.props.fields.transportId.value&&m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Конфигурация сервиса отправления")),m.createElement(Ie.a,{fullWidth:!0,native:!0,value:this.getSenderConfigValue(),onChange:this.props.fields.transportId.onChange},this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.EmailTransport}).map(function(e){return m.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)}))),Object(te.headOption)(this.props.organisation.messageTransports.list.filter(function(t){return t.entity.transport instanceof ee.EmailTransportGmail&&(t.id.value===e.props.fields.transportId.value||t.entity.isDefault)})).matchWith(function(t){return m.createElement(_e.a,{errorText:new te.None,labelText:new te.Some(e.props.i18n.t("Поле с ид ветки обсуждения")),fullWidth:!0,fields:Object(Pe.e)(e.props.formFields,e.props.formId).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===ee.ValueTypeStr.$Type.value}),onChanged:function(e){return p.onChange(e.map(function(e){return e.value}).getOrElse(function(){return""}))},value:ee.Id.createId(p.value)})},function(){return m.createElement("div",null)}),m.createElement("div",{style:{maxWidth:"400px"}},m.createElement(_.a,{label:this.props.i18n.t("Доступно для ручного использования"),control:m.createElement(D.a,{checked:l.value,style:{margin:"10px 0px"},onChange:function(e,t){l.onChange(t)}})}))),m.createElement("h4",{className:"Form__header"},this.props.i18n.t("Заголовки")),m.createElement("div",{className:"Form__content-block"},m.createElement(ye.a,{fullWidth:!0,value:a.value,onChange:a.onChange,label:this.props.i18n.t("Тема письма"),error:a.touched&&a.error,helperText:a.touched&&Object(te.toOption)(a.error).map(function(e){return e}).getOrNull()}),m.createElement(ye.a,{fullWidth:!0,value:i.value,onChange:i.onChange,label:this.props.i18n.t("Имя отправителя"),error:i.touched&&i.error,helperText:i.touched&&Object(te.toOption)(i.error).map(function(e){return e}).getOrNull()}),m.createElement(la.a,{value:r.value,suggestions:this.props.eventLine.data.map(function(e){return e.entity.emailTemplates.emails}).getOrElse(function(){return[]}),showSuggestionsOnFocus:!0,onChange:this.handleSenderMailChange,onBlur:function(){}},m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("E-mail отправителя"),error:r.touched&&r.error,helperText:r.touched&&Object(te.toOption)(r.error).map(function(e){return e}).getOrNull()})),m.createElement(la.a,{value:o.value,suggestions:this.props.eventLine.data.map(function(e){return e.entity.emailTemplates.emails}).getOrElse(function(){return[]}),showSuggestionsOnFocus:!0,onChange:o.onChange,onBlur:function(){}},m.createElement(ye.a,{fullWidth:!0,label:this.props.i18n.t("E-mail для ответа"),error:o.touched&&o.error,helperText:o.touched&&Object(te.toOption)(o.error).map(function(e){return e}).getOrNull()}))),m.createElement("h4",{className:"Form__header"},this.props.i18n.t("Приложения")),m.createElement("div",{className:"Form__content-block"},m.createElement(at,{formId:this.props.formId,attachments:c.value||[],onChange:c.onChange})),m.createElement("h4",{className:"Form__header"},this.props.i18n.t("Логирование")),m.createElement(_.a,{label:this.props.i18n.t("Логировать отправленные письма"),control:m.createElement(D.a,{checked:this.props.fields.logEnabled.checked,onChange:function(t,n){return e.props.fields.logEnabled.onChange(n)}})}),this.props.fields.logEnabled.checked&&m.createElement("div",{className:"Form__content-block",style:{display:"flex",flexDirection:"column"}},m.createElement(_e.a,{fullWidth:!0,errorText:new te.None,fields:Object(Pe.e)(this.props.formFields,this.props.formId).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===ee.ValueTypeObjectRefs.$Type.value}),labelText:Object(te.toOption)(this.props.i18n.t("Поле для логирования")),value:Object(te.toOption)(new ee.Id(this.props.fields.logField.value)),onChanged:function(t){return e.props.fields.logField.onChange(t.map(function(e){return e.value}).getOrElse(function(){throw new Error("can't be None")}))},emptyDisabled:!0}),m.createElement("p",null,this.props.i18n.t("Или")+" ",m.createElement("span",{className:"link",onClick:this.onCreateNewTextField},this.props.i18n.t("создать новое ссылочное поле")))));case 1:return m.createElement("div",{style:{display:"flex",flex:1,minHeight:0,padding:"15px 15px 15px 0"}},this.renderHtmlEditor());case 2:return m.createElement("div",null,m.createElement(ye.a,{value:s.value,onChange:s.onChange,fullWidth:!0,label:this.props.i18n.t("Адрес сервера файлохранилища")}),m.createElement(pt,{attachments:c.value||[],onChange:c.onChange}));default:return m.createElement("div",null,"unknown content")}}},{key:"render",value:function(){var e=this;return m.createElement("form",{style:{display:"flex",flexDirection:"column",minHeight:0,flex:1}},m.createElement(ke.a,{value:this.props.currentTab,onChange:function(t,n){return e.props.onTabChange(n)},indicatorColor:"primary",textColor:"primary",fullWidth:!0},m.createElement(Ee.a,{value:0,label:this.props.i18n.t("Настройки")}),m.createElement(Ee.a,{value:1,label:this.props.i18n.t("Html")+"/"+this.props.i18n.t("Текст")})),m.createElement(aa.a,{style:{display:"flex",flex:1,minHeight:0}},this.renderTabContents()))}}]),t}(m.Component);fa=da([g.autobind],fa);var ha=Object(v.connect)(function(e){return{i18n:e.i18n,documentTemplates:e.documentTemplates,currentForm:e.currentForm,formFields:e.fields,eventLine:e.eventLine,forms:e.forms,organisation:e.organisation}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(sa.a)(Object(ge.reduxForm)({form:"notifyTemplateForm",fields:["type","name","senderMail","senderName","replyMail","subject","htmlBody","textBody","manualUseAllowed","changeFields","baseUrl","editorState","attachments","insertions","logEnabled","logField","urlLinks","showHtml","editorType","addressTypes","transportId","threadFieldId","tag"],getFormState:function(e){return e.undoableForm.present},validate:function(e,t){var n={};return e.subject||(n.subject=t.i18n.t("Обязательное значение")),e.senderName||(n.senderName=t.i18n.t("Обязательное значение")),e.senderMail||(n.senderMail=t.i18n.t("Обязательное значение")),e.replyMail||(n.replyMail=t.i18n.t("Обязательное значение")),t.form._submitFailed&&(t.openSnackbar(m.createElement("div",null,t.i18n.t("Не заполнены поля в настройках")),Object(te.toOption)(m.createElement(I.a,{color:"secondary",size:"small",style:{marginTop:0},onClick:t.hideSnackbar},t.i18n.t("OK")))),setTimeout(function(){return t.hideSnackbar()},5e3),t.onTabChange(0),t.stopSubmit()),n}})(Object(ca.a)(function(e){e.isTokenChecked&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(ua.a)(t))})})(fa)))),ma=n(190),ga=n.n(ma),va=n(218),ya=n.n(va),ba=n(324),Ea=n.n(ba),Oa=n(265),ka=n.n(Oa),Ca=(n(2611),n(145)),ja=/\$id\d+|\$actionUrl-\d+|\$actionUrl-[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}/gi,Ta=function(e,t,n,i,r){var o=Object(te.toOption)(e.match(ja)).getOrElse(function(){return[]}),a=o.map(function(e){return e.indexOf("$actionUrl-")>-1&&e.split("").filter(function(e){return"-"===e}).length>1?Object(te.headOption)(i.filter(function(t){return t.uid===e.slice("$actionUrl-".length)})).map(function(e){return"{{"+r("cсылка для логина лк")+"}}"}).getOrElse(function(){return"{{"+r("ссылка не найдена")+"}}"}):e.indexOf("$actionUrl-")>-1&&1===e.split("").filter(function(e){return"-"===e}).length?Object(te.headOption)(i.filter(function(t){return t.eventId.value===e.slice("$actionUrl-".length)})).map(function(e){return"{{"+r("cсылка на событие")+"}}"}).getOrElse(function(){return"{{"+r("ссылка не найдена")+"}}"}):Object(te.headOption)(n.filter(function(t){return t.id.value===e.slice("$id".length)})).map(function(e){return"{{"+e.entity.caption+"}}"}).getOrElse(function(){return"{{"+r("Поле не найдено")+"}}"})}),l=Object(Ca.OrderedMap)({}),s=Object(Ca.List)(e.split(ja).map(function(e){return e.split("").map(function(e){return C.CharacterMetadata.create()})}).map(function(e,t){return Object(te.toOption)(o.shift()).map(function(n){var r=void 0;r=n.indexOf("$actionUrl-")>-1&&n.split("").filter(function(e){return"-"===e}).length>1?C.Entity.create("APP_LOGIN_LINK","IMMUTABLE",Object(te.headOption)(i.filter(function(e){return e.uid===n.slice("$actionUrl-".length)})).map(function(e){return{url:e.appUrl,uid:e.uid}}).getOrUndefined()):n.indexOf("$actionUrl-")>-1&&1===n.split("").filter(function(e){return"-"===e}).length?C.Entity.create("EVENT_LINK","IMMUTABLE",Object(te.headOption)(i.filter(function(e){return e.eventId.value===n.slice("$actionUrl-".length)})).map(function(e){return{url:e.redirectUrl,eventId:e.eventId.value}}).getOrUndefined()):C.Entity.create("FIELDID","IMMUTABLE",{fieldId:n.slice("$id".length)}),l=l.set(r,C.Entity.get(r));var o=C.CharacterMetadata.create({style:Object(Ca.OrderedSet)(),entity:r});return e.concat(new Array(a[t].length).fill(o))}).getOrElse(function(){return e})}).reduce(function(e,t){return e.concat(t)},[])),c=new C.ContentBlock({key:Object(C.genKey)(),type:"unstyled",depth:0,data:Object(Ca.Map)({}),text:e.split(ja).map(function(e,t){return Object(te.toOption)(a.shift()).map(function(t){return e+t}).getOrElse(function(){return e})}).join(""),characterList:s}),u=C.ContentState.createFromBlockArray([c],l);return C.EditorState.createWithContent(u,t)},wa=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Sa=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ia=new C.CompositeDecorator([{strategy:function(e,t){e.findEntityRanges(function(e){var t=e.getEntity();return null!==t&&"FIELDID"===C.Entity.get(t).getType()},t)},component:function(e){return m.createElement("span",{style:{color:"#ff0000"}},e.children)}},{strategy:function(e,t){e.findEntityRanges(function(e){var t=e.getEntity();return null!==t&&("LINK"===C.Entity.get(t).getType()||"EVENT_LINK"===C.Entity.get(t).getType()||"APP_LOGIN_LINK"===C.Entity.get(t).getType())},t)},component:function(e){var t=C.Entity.get(e.entityKey).getData().url;return m.createElement("a",{href:t,style:{color:"#3b5998",textDecoration:"underline"}},e.children)}}]),Ra=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=Ta(e.text,Ia,e.fields,e.urlLinks,e.i18n.t);return n.state={editorState:i,addFieldPopover:{open:!1,fieldId:new te.None,anchorElement:new te.None},insertLinkPopover:{open:!1,edit:!1,anchorElement:new te.None,currentBlockKey:new te.None,link:{}}},n.updateEditorState(i),n}return d()(t,e),s()(t,[{key:"componentWillReceiveProps",value:function(e){if(this.props.fields!==e.fields&&e.fields.length>0){var t=Ta(e.text,Ia,e.fields,e.urlLinks,e.i18n.t);this.onChange(t)}}},{key:"onChange",value:function(e){this.setState(E(this.state,{editorState:{$set:e}}),this.updateEditorState(e))}},{key:"updateEditorState",value:function(e){var t=this;setTimeout(function(){t.state.editorState===e&&t.props.onChange(e)},500)}},{key:"handleKeyCommand",value:function(e){var t=C.RichUtils.handleKeyCommand(this.state.editorState,e);return t?(this.onChange(t),Tn.a):Tn.b}},{key:"handleBeforeInput",value:function(e){var t=this.state.editorState,n=t.getSelection(),i=n.getAnchorKey(),r=t.getCurrentContent().getBlockForKey(i),o=n.getStartOffset();return r.getEntityAt(o-1)&&r.getEntityAt(o)&&0!==o&&r.getEntityAt(o-1)===r.getEntityAt(o)?Tn.a:Tn.b}},{key:"openAddFieldPopover",value:function(e){this.state.addFieldPopover.open||this.setState(E(this.state,{addFieldPopover:{$set:{open:!0,fieldId:new te.None,anchorElement:new te.Some(e.currentTarget)}}}))}},{key:"onFieldIdChange",value:function(e){this.setState(E(this.state,{addFieldPopover:{fieldId:{$set:e}}}))}},{key:"getFieldName",value:function(e){var t=this;return Object(te.headOption)(this.props.fields.filter(function(t){return t.id.value===e.map(function(e){return e.value}).getOrElse(function(){return""})})).map(function(e){return"{{"+e.entity.caption+"}}"}).getOrElse(function(){return"{{"+t.props.i18n.t("Поле не найдено")+"}}"})}},{key:"onAddField",value:function(){var e=this.state.editorState,t=C.Entity.create("FIELDID","IMMUTABLE",{fieldId:this.state.addFieldPopover.fieldId.map(function(e){return e.value}).getOrElse(function(){return""})}),n=e.getCurrentContent(),i=e.getSelection(),r=C.Modifier.insertText(n,i,this.getFieldName(this.state.addFieldPopover.fieldId),void 0,t),o=C.EditorState.push(e,r,"insert-characters");this.setState(E(this.state,{editorState:{$set:o},addFieldPopover:{$set:{open:!1,fieldId:new te.None,anchorElement:new te.None}}}),this.updateEditorState(o))}},{key:"closeAddFieldPopover",value:function(){this.setState(E(this.state,{addFieldPopover:{$set:{open:!1,anchorElement:new te.None,fieldId:new te.None}}}))}},{key:"setBlockData",value:function(e){var t=this.state.editorState.getCurrentContent(),n=this.state.editorState.getSelection(),i=C.Modifier.setBlockData(t,n,e);return C.EditorState.push(this.state.editorState,i,"change-block-data")}},{key:"isLinkTracked",value:function(e){return e.includes(Tn.c)}},{key:"rmTrackedLink",value:function(e){return e.replace(Tn.c,"")}},{key:"addTrackedLink",value:function(e){return this.rmTrackedLink(e)+Tn.c}},{key:"setAppLoginLinkInitialState",value:function(e,t,n){var i=this;Object(te.headOption)(this.props.urlLinks.filter(function(e){return e instanceof ee.UrlLinkAppLogin&&e.uid===t.getData().uid})).foreach(function(t){i.setState(E(i.state,{insertLinkPopover:{open:{$set:!0},edit:{$set:!0},anchorElement:{$set:new te.Some(e.currentTarget)},currentBlockKey:{$set:Object(te.toOption)(n.getAnchorKey())},link:r()({},n.getAnchorKey(),{$set:{url:Object(te.toOption)(t.appUrl),urlType:Object(te.toOption)(t.tpe.value),uid:Object(te.toOption)(t.uid),eventId:new te.None,appId:Object(te.toOption)(t.appId),tracked:i.isLinkTracked(t.appUrl)}})}}))})}},{key:"setEventLinkInitialState",value:function(e,t,n){var i=this;Object(te.headOption)(this.props.urlLinks.filter(function(e){return e instanceof ee.UrlLinkJourneyEvent&&e.eventId.value===t.getData().eventId})).foreach(function(t){i.setState(E(i.state,{insertLinkPopover:{open:{$set:!0},edit:{$set:!0},anchorElement:{$set:new te.Some(e.currentTarget)},currentBlockKey:{$set:Object(te.toOption)(n.getAnchorKey())},link:r()({},n.getAnchorKey(),{$set:{url:Object(te.toOption)(t.redirectUrl),urlType:Object(te.toOption)(t.tpe.value),uid:new te.None,eventId:Object(te.toOption)(t.eventId.value),appId:new te.None,tracked:i.isLinkTracked(t.redirectUrl)}})}}))})}},{key:"setLinkDefaultInitialState",value:function(e,t,n){this.setState(E(this.state,{insertLinkPopover:{open:{$set:!0},edit:{$set:!1},anchorElement:{$set:new te.Some(e.currentTarget)},currentBlockKey:{$set:Object(te.toOption)(t.getAnchorKey())},link:r()({},t.getAnchorKey(),{$set:{url:new te.None,urlType:Object(te.toOption)(ee.UrlLinkJourneyEvent.$Type.value),uid:Object(te.toOption)(n),appId:new te.None,eventId:new te.None}})}}))}},{key:"openInsertLinkPopover",value:function(e,t){var n=this;if(!this.state.insertLinkPopover.open){var i=this.state.editorState,r=t.map(function(e){return C.SelectionState.createEmpty(e)}).getOrElse(function(){return i.getSelection()}),o=i.getCurrentContent().getBlockForKey(r.getAnchorKey()).getEntityAt(r.getStartOffset()),a=En.v4();Object(te.toOption)(o).map(function(t){var o=i.getCurrentContent().getEntity(t);switch(o.getType()){case"APP_LOGIN_LINK":n.setAppLoginLinkInitialState(e,o,r);break;case"EVENT_LINK":n.setEventLinkInitialState(e,o,r)}}).getOrElse(function(){return n.setLinkDefaultInitialState(e,r,a)})}}},{key:"getLink",value:function(){var e=this;return this.state.insertLinkPopover.currentBlockKey.map(function(t){var n=Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.url}).getOrElse(function(){return""});return Object(te.liftKey)(e.state.insertLinkPopover.link,t).map(function(e){return e.tracked}).getOrElse(function(){return!1})?e.addTrackedLink(n):e.rmTrackedLink(n)}).getOrElse(function(){return"http://"})}},{key:"getLinkEntityKey",value:function(e,t){switch(Object(te.liftKey)(this.state.insertLinkPopover.link,t).flatMap(function(e){return e.urlType}).getOrElse(function(){return ee.UrlLinkJourneyEvent.$Type.value})){case ee.UrlLinkJourneyEvent.$Type.value:var n=Object(te.liftKey)(this.state.insertLinkPopover.link,t).flatMap(function(e){return e.eventId}).getOrElse(function(){return""}),i=ee.Id.createId(n).getOrElse(function(){throw"wrong journey event id"});return this.props.onUrlLinksChange(e.concat(new ee.UrlLinkJourneyEvent(this.getLink(),i))),C.Entity.create("EVENT_LINK","IMMUTABLE",{url:this.getLink(),eventId:n});case ee.UrlLinkAppLogin.$Type.value:var r=Object(te.liftKey)(this.state.insertLinkPopover.link,t).flatMap(function(e){return e.uid}).getOrElse(function(){return""}),o=Object(te.liftKey)(this.state.insertLinkPopover.link,t).flatMap(function(e){return e.appId}).getOrElse(function(){throw"appid has not been provided"});return this.props.onUrlLinksChange(e.concat(new ee.UrlLinkAppLogin(r,o,this.getLink()))),C.Entity.create("APP_LOGIN_LINK","IMMUTABLE",{url:this.getLink(),uid:r,appId:o});default:throw"Unknown url link type"}}},{key:"editModeSaveLink",value:function(){var e=this;this.state.insertLinkPopover.currentBlockKey.foreach(function(t){var n=Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.eventId}),i=Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.uid}),r=e.props.urlLinks.filter(function(e){return e.uid!==i.getOrNull()}).filter(function(e){return e.eventId.value!==n.getOrNull()}),o=e.state.editorState,a=e.state.insertLinkPopover.currentBlockKey.map(function(e){return"atomic"===o.getCurrentContent().getBlockForKey(e).getType()?C.SelectionState.createEmpty(e):o.getSelection()}).getOrElse(function(){return o.getSelection()}),l=(o.getCurrentContent().getBlockForKey(a.getAnchorKey()).getEntityAt(a.getStartOffset()),C.Modifier.removeRange(e.state.editorState.getCurrentContent(),a,"forward")),s=C.EditorState.push(o,l,"remove-range");e.onInsertLink(s,a,r)})}},{key:"onSaveLink",value:function(){if(this.state.insertLinkPopover.edit)return this.editModeSaveLink();this.onInsertLink(this.state.editorState,this.state.editorState.getSelection(),this.props.urlLinks)}},{key:"getLinkName",value:function(e){switch(Object(te.liftKey)(this.state.insertLinkPopover.link,e).flatMap(function(e){return e.urlType}).getOrElse(function(){return ee.UrlLinkJourneyEvent.$Type.value})){case ee.UrlLinkAppLogin.$Type.value:return"{{"+this.props.i18n.t("cсылка для логина лк")+"}}";case ee.UrlLinkJourneyEvent.$Type.value:return"{{"+this.props.i18n.t("cсылка на событие")+"}}";default:throw"unknwon link type"}}},{key:"onInsertLink",value:function(e,t,n){var i=this;this.state.insertLinkPopover.currentBlockKey.map(function(r){e.getCurrentContent().getBlockForKey(r);var o=i.getLinkEntityKey(n,r),a=e.getCurrentContent(),l=C.Modifier.insertText(a,t,i.getLinkName(r),void 0,o),s=C.EditorState.push(e,l,"insert-characters");i.setState(E(i.state,{editorState:{$set:s},insertLinkPopover:{open:{$set:!1},anchorElement:{$set:new te.None},currentBlockKey:{$set:new te.None}}}),i.updateEditorState(s))})}},{key:"onRemoveLink",value:function(){var e=this;this.state.insertLinkPopover.currentBlockKey.map(function(t){var n=e.state.editorState,i=n.getCurrentContent().getBlockForKey(t),r=C.Entity.get(i.getEntityAt(0));if("atomic"===i.getType()&&"IMAGE_EXTERNAL"===r.getType())return C.Entity.mergeData(i.getEntityAt(0),{linkUrl:""}),e.updateEditorState(n),void e.closeInsertLinkPopover();var o=n.getSelection(),a=C.Modifier.applyEntity(n.getCurrentContent(),o,null),l=C.EditorState.push(n,a,"apply-entity");e.setState(E(e.state,{editorState:{$set:l},insertLinkPopover:{open:{$set:!1},anchorElement:{$set:new te.None},currentBlockKey:{$set:new te.None}}}),e.updateEditorState(l))})}},{key:"onLinkUrlChange",value:function(e){var t=this,n=e.target.value;this.state.insertLinkPopover.currentBlockKey.foreach(function(e){t.setState(E(t.state,{insertLinkPopover:{link:r()({},e,{$merge:{url:new te.Some(n)}})}}))})}},{key:"onLinkUrlTypeChange",value:function(e){var t=this;this.state.insertLinkPopover.currentBlockKey.foreach(function(n){t.setState(E(t.state,{insertLinkPopover:{link:r()({},n,{$merge:{urlType:new te.Some(e.target.value)}})}}))})}},{key:"onLinkEventIdChange",value:function(e){var t=this;this.state.insertLinkPopover.currentBlockKey.foreach(function(n){t.setState(E(t.state,{insertLinkPopover:{link:r()({},n,{$merge:{eventId:new te.Some(e.target.value)}})}}))})}},{key:"onLinkAppIdChange",value:function(e){var t=this;this.state.insertLinkPopover.currentBlockKey.foreach(function(n){t.setState(E(t.state,{insertLinkPopover:{link:r()({},n,{$merge:{appId:new te.Some(new ee.Id(e.target.value))}})}}))})}},{key:"onLinkTrackedChange",value:function(e,t){var n=this;this.state.insertLinkPopover.currentBlockKey.foreach(function(e){n.setState(E(n.state,{insertLinkPopover:{link:r()({},e,{$merge:{tracked:t}})}}))})}},{key:"closeInsertLinkPopover",value:function(){this.setState(E(this.state,{insertLinkPopover:{open:{$set:!1},anchorElement:{$set:new te.None},edit:{$set:!1},currentBlockKey:{$set:new te.None}}}))}},{key:"openInsertLinkPopoverRequest",value:function(e){this.openInsertLinkPopover(e,new te.None)}},{key:"renderLinkButton",value:function(){var e=this,t=this.state.editorState,n=t.getSelection();return Object(te.toOption)(t.getCurrentContent().getBlockForKey(n.getAnchorKey())).flatMap(function(e){return Object(te.toOption)(e.getEntityAt(n.getStartOffset()))}).map(function(t){return e.state.editorState.getCurrentContent().getEntity(t)}).filter(function(e){return e.getData().url}).filter(function(e){return!e.getData().url.includes("$link-")}).filter(function(e){return"APP_LOGIN_LINK"===e.getType()||"EVENT_LINK"===e.getType()||"LINK"===e.getType()}).map(function(t){return m.createElement(F.a,{placement:"bottom",title:e.props.i18n.t("Редактировать ссылку")},m.createElement(P.a,{onClick:e.openInsertLinkPopoverRequest,style:{marginTop:"4px"}},m.createElement(gr.a,{style:{color:Ea.a[500]}})))}).getOrElse(function(){return m.createElement(F.a,{placement:"bottom",title:e.props.i18n.t("Вставить ссылку")},m.createElement(P.a,{onClick:e.openInsertLinkPopoverRequest,style:{marginTop:"4px"}},m.createElement(gr.a,null)))})}},{key:"render",value:function(){var e=this;return m.createElement("div",null,m.createElement(ya.a,{className:"TextEditor__toolbar"},m.createElement(P.a,{onClick:this.openAddFieldPopover,style:{marginTop:"4px"}},m.createElement(ka.a,null)),this.renderLinkButton()),this.state.addFieldPopover.open&&m.createElement(ga.a,{open:this.state.addFieldPopover.open,anchorEl:this.state.addFieldPopover.anchorElement.getOrElse(function(){throw"popover anchor hasn't been provided"}),anchorOrigin:{horizontal:"left",vertical:"bottom"},transformOrigin:{horizontal:"left",vertical:"top"},onClose:this.closeAddFieldPopover,style:{maxWidth:250}},m.createElement("div",{style:{padding:"10px"}},m.createElement(_e.a,{fullWidth:!0,native:!0,errorText:new te.None,labelText:new te.Some(this.props.i18n.t("Поле")),fields:this.props.fields,onChanged:this.onFieldIdChange,value:this.state.addFieldPopover.fieldId}),m.createElement("div",{style:{textAlign:"right"}},m.createElement(I.a,{variant:"raised",onClick:this.onAddField},this.props.i18n.t("Вставить"))))),this.state.insertLinkPopover.open&&this.state.insertLinkPopover.currentBlockKey.map(function(t){return m.createElement(ga.a,{open:e.state.insertLinkPopover.open,anchorEl:e.state.insertLinkPopover.anchorElement.getOrElse(function(){throw"popover anchor hasn't been provided"}),anchorOrigin:{horizontal:"left",vertical:"bottom"},transformOrigin:{horizontal:"left",vertical:"top"},onClose:e.closeInsertLinkPopover,style:{padding:"5px"}},m.createElement("div",{style:{padding:10}},m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,e.props.i18n.t("Тип ссылки")),m.createElement(Ie.a,{value:Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.urlType}).getOrElse(function(){return ee.UrlLinkJourneyEvent.$Type.value}),onChange:e.onLinkUrlTypeChange},m.createElement(Ke.a,{value:ee.UrlLinkJourneyEvent.$Type.value},e.props.i18n.t("Ссылка на событие")),!Cn.default.isA5000&&m.createElement(Ke.a,{value:ee.UrlLinkAppLogin.$Type.value},e.props.i18n.t("Ссылка для логина лк")))),m.createElement(ye.a,{fullWidth:!0,label:e.props.i18n.t("Путь"),value:e.rmTrackedLink(Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.url}).getOrElse(function(){return""})),onChange:e.onLinkUrlChange}),Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.urlType}).matchWith(function(e){return e===ee.UrlLinkJourneyEvent.$Type.value},function(){return!1})&&e.props.eventLineId.map(function(n){return m.createElement(jn.a,{label:e.props.i18n.t("Идентификатор события"),fullWidth:!0,eventLineId:n,value:Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.eventId}).getOrElse(function(){return""}),onChange:e.onLinkEventIdChange})}).getOrNull(),Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.urlType}).matchWith(function(e){return e===ee.UrlLinkAppLogin.$Type.value},function(){return!1})&&m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,e.props.i18n.t("application|Приложение")),m.createElement(Ie.a,{fullWidth:!0,value:Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.appId}).matchWith(function(e){return e.value},function(){return""}),onChange:e.onLinkAppIdChange},e.props.applications.list.map(function(e){return m.createElement(Ke.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),!Cn.default.isA5000&&m.createElement(_.a,{label:e.props.i18n.t("Отслеживаемая ссылка"),control:m.createElement(kn.a,{checked:Object(te.liftKey)(e.state.insertLinkPopover.link,t).map(function(e){return e.tracked}).getOrElse(function(){return!1}),onChange:e.onLinkTrackedChange})}),m.createElement("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"nowrap"}},m.createElement(I.a,{variant:"outlined",color:"primary",onClick:e.onSaveLink,disabled:""===Object(te.liftKey)(e.state.insertLinkPopover.link,t).flatMap(function(e){return e.url}).getOrElse(function(){return""})},e.state.insertLinkPopover.edit?e.props.i18n.t("Сохранить"):e.props.i18n.t("Вставить")))))}).getOrNull(),m.createElement("div",{className:"TextEditor__content"},m.createElement(C.Editor,{editorState:this.state.editorState,onChange:this.onChange,handleBeforeInput:this.handleBeforeInput,handleKeyCommand:this.handleKeyCommand})))}}]),t}(m.Component);Ra=wa([g.autobind,Sa("design:paramtypes",[Object])],Ra);var Pa=Object(v.connect)(function(e){return{i18n:e.i18n,eventLineId:e.eventLine.eventLineId,applications:e.applications}})(Ra),xa=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_a=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleCreateAnBound",value:function(e){this.props.fields.logField.onChange(e.formField.value)}},{key:"onCreateNewTextField",value:function(){var e=this,t=Object(te.headOption)(this.props.eventLine.data.map(function(t){return Object(xe.f)(e.props.forms,t.id)}).getOrElse(function(){return[]}).filter(function(e){return ee.FormType.isEmail(e.entity.formType)})),n={caption:this.props.i18n.t("Письма"),name:"messages",valueTypeTag:ee.ValueTagEmailLogRefs.$Type.value};t.foreach(function(e){n=Object.assign({},n,{referenceFamily:e.id.value})}),Object(oa.d)({openDialog:this.props.openDialog,handleDialogClose:this.props.handleDialogClose,formId:new ee.Id(this.props.params.formId),i18n:this.props.i18n,handleCreateAnBound:this.handleCreateAnBound,dispatch:this.props.dispatch},n)}},{key:"renderLogSettings",value:function(){var e=this;return m.createElement("div",{style:{display:"flex",flexDirection:"column"}},m.createElement(_e.a,{errorText:new te.None,fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===ee.ValueTypeObjectRefs.$Type.value}),labelText:Object(te.toOption)(this.props.i18n.t("Поле для логирования")),value:Object(te.toOption)(new ee.Id(this.props.fields.logField.value)),onChanged:function(t){return e.props.fields.logField.onChange(t.map(function(e){return e.value}).getOrElse(function(){throw new Error("can't be None")}))},emptyDisabled:!0}),m.createElement("p",null,this.props.i18n.t("Или")+" ",m.createElement("span",{className:"link",onClick:this.onCreateNewTextField},this.props.i18n.t("создать новое ссылочное поле"))))}},{key:"render",value:function(){var e=this,t=this.props.fields,n=t.name,i=t.phoneFieldId,r=t.body,o=t.manualUseAllowed,a=t.editorState,l=t.tag;return m.createElement("form",{style:{padding:15}},m.createElement("div",null,m.createElement(ye.a,Object.assign({},n,{fullWidth:!0,label:this.props.i18n.t("Название"),autoFocus:!0})),m.createElement(la.a,{value:l.value,onChange:l.onChange,suggestions:this.props.tags,onBlur:function(){}},m.createElement(ye.a,{label:this.props.i18n.t("Группа"),error:l.touched&&l.error,fullWidth:!0,autoComplete:"off"})),m.createElement(_e.a,{errorText:new te.None,labelText:new te.Some(this.props.i18n.t("Поле с номером телефона")),fullWidth:!0,fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}),onChanged:function(e){return i.onChange(e.map(function(e){return e.value}).getOrElse(function(){return""}))},value:new te.Some(new ee.Id(i.value))}),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Конфигурация сервиса отправления")),m.createElement(Ie.a,{fullWidth:!0,native:!0,value:this.props.fields.transportId.value||Object(te.headOption)(this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.SmsTransport&&e.entity.isDefault})).map(function(e){return e.id.value}).getOrElse(function(){return""}),onChange:this.props.fields.transportId.onChange},m.createElement("option",{value:""}),this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.SmsTransport}).map(function(e){return m.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)}))),m.createElement(_.a,{label:this.props.i18n.t("Доступно для ручного использования"),control:m.createElement(D.a,Object.assign({},o,{style:{margin:"10px 0px"},onChange:function(e,t){o.onChange(t)}}))}),m.createElement(_.a,{label:this.props.i18n.t("Логировать отправленные письма"),control:m.createElement(D.a,{checked:this.props.fields.logEnabled.checked,onChange:function(t,n){return e.props.fields.logEnabled.onChange(n)}})}),this.props.fields.logEnabled.checked&&this.renderLogSettings(),m.createElement(Pa,{fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}),text:r.value,onChange:a.onChange,urlLinks:this.props.fields.urlLinks.value||[],onUrlLinksChange:this.props.fields.urlLinks.onChange})))}}]),t}(m.Component);_a=xa([g.autobind],_a);var La=Object(v.connect)(function(e){return{i18n:e.i18n,documentTemplates:e.documentTemplates,currentForm:e.currentForm,formFields:e.fields,eventLine:e.eventLine,forms:e.forms,organisation:e.organisation}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(ge.reduxForm)({form:"notifyTemplateForm",fields:["type","name","phoneFieldId","body","manualUseAllowed","changeFields","editorState","logEnabled","logField","transportId","tag","urlLinks"]})(Object(ca.a)(function(e){e.isTokenChecked&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(ua.a)(t))})})(_a))),Da=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Aa=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleCreateAnBound",value:function(e){this.props.fields.logField.onChange(e.formField.value)}},{key:"onCreateNewTextField",value:function(){var e=this,t=Object(te.headOption)(this.props.eventLine.data.map(function(t){return Object(xe.f)(e.props.forms,t.id)}).getOrElse(function(){return[]}).filter(function(e){return ee.FormType.isEmail(e.entity.formType)})),n={caption:this.props.i18n.t("Письма"),name:"messages",valueTypeTag:ee.ValueTagEmailLogRefs.$Type.value};t.foreach(function(e){n=Object.assign({},n,{referenceFamily:e.id.value})}),Object(oa.d)({openDialog:this.props.openDialog,handleDialogClose:this.props.handleDialogClose,formId:new ee.Id(this.props.params.formId),i18n:this.props.i18n,handleCreateAnBound:this.handleCreateAnBound,dispatch:this.props.dispatch},n)}},{key:"renderLogSettings",value:function(){var e=this;return m.createElement("div",{style:{display:"flex",flexDirection:"column"}},m.createElement(_e.a,{errorText:new te.None,fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===ee.ValueTypeObjectRefs.$Type.value}),labelText:Object(te.toOption)(this.props.i18n.t("Поле для логирования")),value:Object(te.toOption)(new ee.Id(this.props.fields.logField.value)),onChanged:function(t){return e.props.fields.logField.onChange(t.map(function(e){return e.value}).getOrElse(function(){throw new Error("can't be None")}))},emptyDisabled:!0}),m.createElement("p",null,this.props.i18n.t("Или")+" ",m.createElement("span",{className:"link",onClick:this.onCreateNewTextField},this.props.i18n.t("создать новое ссылочное поле"))))}},{key:"render",value:function(){var e=this,t=this.props.fields,n=t.name,i=(t.phoneFieldId,t.body),r=t.manualUseAllowed,o=t.editorState,a=t.tag;return m.createElement("form",{style:{padding:15}},m.createElement("div",null,m.createElement(ye.a,Object.assign({},n,{fullWidth:!0,label:this.props.i18n.t("Название"),autoFocus:!0})),m.createElement(la.a,{value:a.value,onChange:a.onChange,suggestions:this.props.tags,onBlur:function(){}},m.createElement(ye.a,{label:this.props.i18n.t("Группа"),error:a.touched&&a.error,fullWidth:!0,autoComplete:"off"})),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Конфигурация сервиса отправления")),m.createElement(Ie.a,{fullWidth:!0,native:!0,value:this.props.fields.transportId.value||Object(te.headOption)(this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.SmsTransport&&e.entity.isDefault})).map(function(e){return e.id.value}).getOrElse(function(){return""}),onChange:this.props.fields.transportId.onChange},m.createElement("option",{value:""}),this.props.organisation.messageTransports.list.filter(function(e){return e.entity.transport instanceof ee.SmsTransport}).map(function(e){return m.createElement("option",{key:e.id.value,value:e.id.value},e.entity.name)}))),m.createElement(_.a,{label:this.props.i18n.t("Доступно для ручного использования"),control:m.createElement(D.a,Object.assign({},r,{style:{margin:"10px 0px"},onChange:function(e,t){r.onChange(t)}}))}),m.createElement(_.a,{label:this.props.i18n.t("Логировать отправленные письма"),control:m.createElement(D.a,{checked:this.props.fields.logEnabled.checked,onChange:function(t,n){return e.props.fields.logEnabled.onChange(n)}})}),this.props.fields.logEnabled.checked&&this.renderLogSettings(),m.createElement(Pa,{fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}),text:i.value,onChange:o.onChange,urlLinks:this.props.fields.urlLinks.value||[],onUrlLinksChange:this.props.fields.urlLinks.onChange})))}}]),t}(m.Component);Aa=Da([g.autobind],Aa);var Fa=Object(v.connect)(function(e){return{i18n:e.i18n,documentTemplates:e.documentTemplates,currentForm:e.currentForm,formFields:e.fields,eventLine:e.eventLine,forms:e.forms,organisation:e.organisation}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(ge.reduxForm)({form:"notifyTemplateForm",fields:["type","name","body","manualUseAllowed","changeFields","editorState","logEnabled","logField","transportId","tag","urlLinks"]})(Object(ca.a)(function(e){e.isTokenChecked&&e.organisation.organisationId.foreach(function(t){e.dispatch(Object(ua.a)(t))})})(Aa))),$a=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Wa=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleCreateAnBound",value:function(e){this.props.fields.logField.onChange(e.formField.value)}},{key:"onCreateNewTextField",value:function(){var e=this,t=Object(te.headOption)(this.props.eventLine.data.map(function(t){return Object(xe.f)(e.props.forms,t.id)}).getOrElse(function(){return[]}).filter(function(e){return ee.FormType.isEmail(e.entity.formType)})),n={caption:this.props.i18n.t("Письма"),name:"messages",valueTypeTag:ee.ValueTagEmailLogRefs.$Type.value};t.foreach(function(e){n=Object.assign({},n,{referenceFamily:e.id.value})}),Object(oa.d)({openDialog:this.props.openDialog,handleDialogClose:this.props.handleDialogClose,formId:new ee.Id(this.props.params.formId),i18n:this.props.i18n,handleCreateAnBound:this.handleCreateAnBound,dispatch:this.props.dispatch},n)}},{key:"onAppIdSelect",value:function(e){this.props.fields.applicationId.onChange(e.target.value)}},{key:"renderMessengerTypeSelect",value:function(){return m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Тип мессенджера")),m.createElement(Ie.a,{fullWidth:!0,value:this.props.fields.messengerType.value,onChange:this.props.fields.messengerType.onChange},m.createElement(Ke.a,{value:ee.MessengerTypeFacebook.$Type.value},this.props.i18n.t("Facebook")),m.createElement(Ke.a,{value:ee.MessengerTypeTelegram.$Type.value},this.props.i18n.t("Телеграм"))))}},{key:"renderParseModeSelect",value:function(){if(this.props.fields.messengerType.value===ee.MessengerTypeTelegram.$Type.value)return m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Язык разметки")),m.createElement(Ie.a,{fullWidth:!0,value:this.props.fields.parseModeType.value,onChange:this.props.fields.parseModeType.onChange},m.createElement(Ke.a,{value:"EMPTY"},this.props.i18n.t("Без разметки")),m.createElement(Ke.a,{value:ee.TelegramParseModeHTML.$Type.value},this.props.i18n.t("Html")),m.createElement(Ke.a,{value:ee.TelegramParseModeMarkdown.$Type.value},this.props.i18n.t("Markdown"))))}},{key:"renderLogSettings",value:function(){var e=this;return m.createElement("div",{style:{display:"flex",flexDirection:"column"}},m.createElement(_e.a,{errorText:new te.None,fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===ee.ValueTypeObjectRefs.$Type.value}),labelText:Object(te.toOption)(this.props.i18n.t("Поле для логирования")),value:Object(te.toOption)(new ee.Id(this.props.fields.logField.value)),onChanged:function(t){return e.props.fields.logField.onChange(t.map(function(e){return e.value}).getOrElse(function(){throw new Error("can't be None")}))},emptyDisabled:!0}),m.createElement("p",null,this.props.i18n.t("Или")+" ",m.createElement("span",{className:"link",onClick:this.onCreateNewTextField},this.props.i18n.t("создать новое ссылочное поле"))))}},{key:"render",value:function(){var e=this;return m.createElement("form",{style:{padding:15}},m.createElement("div",null,m.createElement(ye.a,{value:this.props.fields.name.value,onChange:this.props.fields.name.onChange,fullWidth:!0,label:this.props.i18n.t("Название"),autoFocus:!0}),m.createElement(la.a,{value:this.props.fields.tag.value,onChange:this.props.fields.tag.onChange,suggestions:this.props.tags,onBlur:function(){}},m.createElement(ye.a,Object.assign({},this.props.fields.tag,{label:this.props.i18n.t("Группа"),error:this.props.fields.tag.touched&&this.props.fields.tag.error,fullWidth:!0,autoComplete:"off"}))),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Приложение бота")),m.createElement(Ie.a,{fullWidth:!0,value:this.props.fields.applicationId.value,onChange:this.onAppIdSelect},this.props.applications.list.filter(function(t){return e.props.fields.messengerType.value===ee.MessengerTypeFacebook.$Type.value&&t.entity.appType.tpe.value===ee.ApplicationTypeFacebookBot.$Type.value||e.props.fields.messengerType.value===ee.MessengerTypeTelegram.$Type.value&&t.entity.appType.tpe.value===ee.ApplicationTypeTelegramBot.$Type.value}).map(function(e){return m.createElement(Ke.a,{key:e.id.value,value:e.id.value},e.entity.name)}))),m.createElement(_e.a,{errorText:new te.None,labelText:new te.Some(this.props.i18n.t("Поле с ид чата")),fullWidth:!0,fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}),onChanged:function(t){return e.props.fields.chatFieldId.onChange(t.map(function(e){return e.value}).getOrElse(function(){return""}))},value:new te.Some(new ee.Id(this.props.fields.chatFieldId.value))}),this.renderMessengerTypeSelect(),this.renderParseModeSelect(),m.createElement(_.a,{label:this.props.i18n.t("Доступно для ручного использования"),control:m.createElement(D.a,{checked:this.props.fields.manualUseAllowed.value,style:{margin:"10px 0px"},onChange:function(t,n){e.props.fields.manualUseAllowed.onChange(n)}})}),m.createElement(_.a,{label:this.props.i18n.t("Логировать отправленные письма"),control:m.createElement(D.a,{checked:this.props.fields.logEnabled.checked,onChange:function(t,n){return e.props.fields.logEnabled.onChange(n)}})}),this.props.fields.logEnabled.checked&&this.renderLogSettings(),m.createElement(Pa,{fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}),text:this.props.fields.body.value,onChange:this.props.fields.editorState.onChange,urlLinks:this.props.fields.urlLinks.value||[],onUrlLinksChange:this.props.fields.urlLinks.onChange})))}}]),t}(m.Component);Wa=$a([g.autobind],Wa);var Ma=Object(v.connect)(function(e){return{i18n:e.i18n,applications:e.applications,currentForm:e.currentForm,formFields:e.fields,eventLine:e.eventLine,forms:e.forms}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(ge.reduxForm)({form:"notifyTemplateForm",fields:["type","name","applicationId","chatFieldId","parseModeType","messengerType","body","manualUseAllowed","changeFields","editorState","logEnabled","logField","urlLinks"]})(Wa)),Na=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ha=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"handleCreateAnBound",value:function(e){this.props.fields.logField.onChange(e.formField.value)}},{key:"onCreateNewTextField",value:function(){var e=this,t=Object(te.headOption)(this.props.eventLine.data.map(function(t){return Object(xe.f)(e.props.forms,t.id)}).getOrElse(function(){return[]}).filter(function(e){return ee.FormType.isEmail(e.entity.formType)})),n={caption:this.props.i18n.t("Письма"),name:"messages",valueTypeTag:ee.ValueTagEmailLogRefs.$Type.value};t.foreach(function(e){n=Object.assign({},n,{referenceFamily:e.id.value})}),Object(oa.d)({openDialog:this.props.openDialog,handleDialogClose:this.props.handleDialogClose,formId:new ee.Id(this.props.params.formId),i18n:this.props.i18n,handleCreateAnBound:this.handleCreateAnBound,dispatch:this.props.dispatch},n)}},{key:"renderFacebookData",value:function(){var e=this.props.fields,t=e.postType,n=e.socialConnectionId,i=e.facebookPageId,r=e.facebookGroupId;return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Соединение")),m.createElement(Ie.a,{fullWidth:!0,value:n.value,onChange:function(e){return n.onChange(e.target.value)}},this.props.socialConnections.list.filter(function(e){return e.entity.connector.tpe.value===ee.FacebookPagesApp.$Type.value}).map(function(e,t){return m.createElement(Ke.a,{key:t,value:e.id.value},e.entity.name)}))),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Тип назначения")),m.createElement(Ie.a,{fullWidth:!0,value:t.value,onChange:function(e){return t.onChange(e.target.value)}},m.createElement(Ke.a,{value:ee.FacebookPostTypeGroup.$Type.value},this.props.i18n.t("Группа")),m.createElement(Ke.a,{value:ee.FacebookPostTypePage.$Type.value},this.props.i18n.t("Страница")),m.createElement(Ke.a,{value:ee.FacebookPostTypeUserFeed.$Type.value},this.props.i18n.t("Стена пользователя")))),!!n&&t.value===ee.FacebookPostTypePage.$Type.value&&m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Страница")),m.createElement(Ie.a,{fullWidth:!0,value:i.value,onChange:function(e){return i.onChange(e.target.value)}},Object(te.headOption)(this.props.socialConnections.list.filter(function(e){return e.entity.connector.tpe.value===ee.FacebookPagesApp.$Type.value}).filter(function(e){return e.id.value===n.value})).map(function(e){return e.entity.connector.pages}).getOrElse(function(){return[]}).map(function(e,t){return m.createElement(Ke.a,{key:t,value:e.id},e.name)}))),!!n&&t.value===ee.FacebookPostTypeGroup.$Type.value&&m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Группа")),m.createElement(Ie.a,{fullWidth:!0,value:r.value,onChange:function(e){return r.onChange(e.target.value)}},Object(te.headOption)(this.props.socialConnections.list.filter(function(e){return e.entity.connector.tpe.value===ee.FacebookPagesApp.$Type.value}).filter(function(e){return e.id.value===n.value})).map(function(e){return e.entity.connector.groups}).getOrElse(function(){return[]}).map(function(e,t){return m.createElement(Ke.a,{key:t,value:e.id},e.name)}),this.props.socialConnections.list.map(function(e,t){return m.createElement(Ke.a,{key:t,value:e.id.value},e.entity.name)}))))}},{key:"renderLinkedInData",value:function(){var e=this.props.fields,t=e.postType,n=e.socialConnectionId,i=e.linkedInCompanyPageId;return m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Соединение")),m.createElement(Ie.a,{fullWidth:!0,value:n.value,onChange:function(e){return n.onChange(e.target.value)}},this.props.socialConnections.list.filter(function(e){return e.entity.connector.tpe.value===ee.LinkedInApp.$Type.value}).map(function(e,t){return m.createElement(Ke.a,{key:t,value:e.id.value},e.entity.name)}))),m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Тип назначения")),m.createElement(Ie.a,{fullWidth:!0,value:t.value,onChange:function(e){return t.onChange(e.target.value)}},m.createElement(Ke.a,{value:ee.LinkedInPostTypeCompanyPage.$Type.value},this.props.i18n.t("Страница организации")),m.createElement(Ke.a,{value:ee.FacebookPostTypeUserFeed.$Type.value},this.props.i18n.t("Страница пользователя")))),!!n&&t.value===ee.LinkedInPostTypeCompanyPage.$Type.value&&m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,null,this.props.i18n.t("Страницы организации")),m.createElement(Ie.a,{fullWidth:!0,value:i.value,onChange:function(e){return i.onChange(e.target.value)}},Object(te.headOption)(this.props.socialConnections.list.filter(function(e){return e.entity.connector.tpe.value===ee.LinkedInApp.$Type.value}).filter(function(e){return e.id.value===n.value})).map(function(e){return e.entity.connector.companies}).getOrElse(function(){return[]}).map(function(e,t){return m.createElement(Ke.a,{key:t,value:e.id},e.name)}))))}},{key:"renderLogSettings",value:function(){var e=this;return m.createElement("div",{style:{display:"flex",flexDirection:"column"}},m.createElement(_e.a,{errorText:new te.None,fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}).filter(function(e){return e.entity.valueType.tpe.value===ee.ValueTypeObjectRefs.$Type.value}),labelText:Object(te.toOption)(this.props.i18n.t("Поле для логирования")),value:Object(te.toOption)(new ee.Id(this.props.fields.logField.value)),onChanged:function(t){return e.props.fields.logField.onChange(t.map(function(e){return e.value}).getOrElse(function(){throw new Error("can't be None")}))},emptyDisabled:!0}),m.createElement("p",null,this.props.i18n.t("Или")+" ",m.createElement("span",{className:"link",onClick:this.onCreateNewTextField},this.props.i18n.t("создать новое ссылочное поле"))))}},{key:"render",value:function(){var e=this,t=this.props.fields,n=t.name,i=t.body,r=t.type,o=t.manualUseAllowed,a=t.editorState,l=t.tag;return m.createElement("form",{style:{padding:15}},m.createElement("div",null,m.createElement(je.a,{fullWidth:!0},m.createElement(we.a,{shrink:!0},this.props.i18n.t("Название")),m.createElement(ye.a,{value:n.value,onChange:n.onChange,fullWidth:!0,autoFocus:!0})),m.createElement(la.a,{value:l.value,onChange:l.onChange,suggestions:this.props.tags,onBlur:function(){}},m.createElement(ye.a,{label:this.props.i18n.t("Группа"),error:l.touched&&l.error,fullWidth:!0,autoComplete:"off"})),r.value===ee.MessageParamsDataFacebookData.$Type.value&&this.renderFacebookData(),r.value===ee.MessageParamsDataLinkedInData.$Type.value&&this.renderLinkedInData(),m.createElement(_.a,{label:this.props.i18n.t("Доступно для ручного использования"),control:m.createElement(D.a,{checked:o.checked,style:{margin:"10px 0px"},onChange:function(e,t){o.onChange(t)}})}),m.createElement(_.a,{label:this.props.i18n.t("Логировать отправленные письма"),control:m.createElement(D.a,{checked:this.props.fields.logEnabled.checked,style:{margin:"10px 0px"},onChange:function(t,n){return e.props.fields.logEnabled.onChange(n)}})}),this.props.fields.logEnabled.checked&&this.renderLogSettings(),m.createElement(Pa,{fields:this.props.currentForm.data.flatMap(function(t){return Object(te.liftKey)(e.props.formFields.list,t.id.value)}).getOrElse(function(){return[]}),text:i.value,onChange:a.onChange,urlLinks:this.props.fields.urlLinks.value||[],onUrlLinksChange:this.props.fields.urlLinks.onChange})))}}]),t}(m.Component);Ha=Na([g.autobind],Ha);var za,Ba=Object(v.connect)(function(e){return{i18n:e.i18n,documentTemplates:e.documentTemplates,socialConnections:e.socialConnections,currentForm:e.currentForm,formFields:e.fields,eventLine:e.eventLine,forms:e.forms}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(ge.reduxForm)({form:"notifyTemplateForm",fields:["type","name","phoneFieldId","body","manualUseAllowed","changeFields","editorState","logEnabled","logField","socialConnectionId","postType","facebookPageId","facebookGroupId","linkedInCompanyPageId","tag","urlLinks"]})(Ha)),Va=n(1943),Ua=n(441),qa=n.n(Ua),Ka=n(1594),Ga=n.n(Ka),Ja=n(1944),Ya=n.n(Ja),Xa=n(262),Za=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Qa=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},el=function e(t,n,i){a()(this,e),this.code=t,this.width=n,this.height=i},tl=[new el("GALAXY_S5",360,640),new el("PIXEL_2",411,731),new el("PIXEL_2_XL",411,823),new el("IPHONE_5_SE",320,568),new el("IPHONE_6_7_8",375,667),new el("IPHONE_6_7_8_PLUS",414,736),new el("IPHONE_X",375,812),new el("IPAD",768,1024),new el("IPAD_PRO",1024,1366)],nl=(za={},r()(za,"GALAXY_S5","Galaxy S5"),r()(za,"PIXEL_2","Pixel 2"),r()(za,"PIXEL_2_XL","Pixel 2 XL"),r()(za,"IPHONE_5_SE","iPhone 5 SE"),r()(za,"IPHONE_6_7_8","iPhone 6/7/8"),r()(za,"IPHONE_6_7_8_PLUS","iPhone 6/7/8 Plus"),r()(za,"IPHONE_X","iPhone X"),r()(za,"IPAD","iPad"),r()(za,"IPAD_PRO","iPad Pro"),za),il=function(e){return Object(Zi.b)(e.code)(nl).getOrElse(function(){throw"unknown device type"})},rl=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:800,height:600,tempHeight:new te.None,tempWidth:new te.None,responsive:!0,device:new te.None},n}return d()(t,e),s()(t,[{key:"changeScreenSize",value:function(e,t){this.setState(E(this.state,{width:{$set:e},height:{$set:t}}))}},{key:"onScreenSizeMenuSelect",value:function(e,t,n,i){this.setState(E(this.state,{width:{$set:e},height:{$set:t},responsive:{$set:n},device:{$set:i}}))}},{key:"openScreenSizeMenu",value:function(e){var t=this;this.props.openMenu(e.currentTarget,[m.createElement(Ke.a,{key:"RESPONSIVE",value:"RESPONSIVE",onClick:function(){return t.onScreenSizeMenuSelect(t.state.width,t.state.height,!0,new te.None)}},this.props.i18n.t("Responsive"))].concat(tl.map(function(e){return m.createElement(Ke.a,{key:e.code,value:e.code,onClick:function(){return t.onScreenSizeMenuSelect(e.width,e.height,!1,Object(te.toOption)(e))}},il(e))})))}},{key:"onRotationChange",value:function(){this.setState(E(this.state,{width:{$set:this.state.height},height:{$set:this.state.width}}))}},{key:"onWidthChange",value:function(e){/^\d+$/.test(e.target.value)&&this.changeScreenSize(parseInt(e.target.value),this.state.height)}},{key:"onHeightChange",value:function(e){/^\d+$/.test(e.target.value)&&this.changeScreenSize(this.state.height,parseInt(e.target.value))}},{key:"onResizeStart",value:function(e,t,n,i){this.setState(E(this.state,{tempWidth:{$set:Object(te.toOption)(this.state.width)},tempHeight:{$set:Object(te.toOption)(this.state.height)}}))}},{key:"onResizeStop",value:function(e,t,n,i){this.setState(E(this.state,{width:{$set:this.state.width+i.width},height:{$set:this.state.height+i.height},tempWidth:{$set:new te.None},tempHeight:{$set:new te.None}}))}},{key:"onResize",value:function(e,t,n,i){this.setState(E(this.state,{tempWidth:{$set:Object(te.toOption)(this.state.width+i.width)},tempHeight:{$set:Object(te.toOption)(this.state.height+i.height)}}))}},{key:"render",value:function(){var e=this;return m.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"#eeeded"}},m.createElement(qa.a,{position:"static",style:{flexShrink:0}},m.createElement(ya.a,null,m.createElement("div",{style:{flex:1,flexDirection:"column",display:"flex"}},m.createElement("div",{style:{alignSelf:"center"}},m.createElement(I.a,{onClick:this.openScreenSizeMenu,color:"inherit"},this.state.responsive?this.props.i18n.t("Responsive"):this.state.device.map(function(e){return il(e)}).getOrElse(function(){throw"device has not been provided"}),m.createElement(Vi.a,null)),m.createElement(ye.a,{disabled:!this.state.responsive,value:this.state.tempWidth.getOrElse(function(){return e.state.width}),onChange:this.onWidthChange,style:{marginRight:"5px",width:"50px",color:"inherit"},InputProps:{style:{color:"inherit"}},inputProps:{style:{textAlign:"center",color:"inherit"}}}),m.createElement("div",{style:{marginTop:"20px",display:"inline-flex"}},m.createElement("span",{style:{verticalAlign:"baseline"}},"x")),m.createElement(ye.a,{disabled:!this.state.responsive,value:this.state.tempHeight.getOrElse(function(){return e.state.height}),onChange:this.onHeightChange,style:{marginLeft:"5px",width:"50px",color:"inherit"},InputProps:{style:{color:"inherit"}},inputProps:{style:{textAlign:"center",color:"inherit"}}}),m.createElement(P.a,{color:"inherit",onClick:this.onRotationChange,style:{marginLeft:"10px"}},m.createElement(Ya.a,null)))),m.createElement(P.a,{color:"inherit",onClick:this.props.handleClose,style:{flexShrink:0}},m.createElement(Ga.a,null)))),m.createElement("div",{style:{overflow:"auto",minHeight:0}},m.createElement(Va.a,{style:{margin:"20px auto"},enable:{top:this.state.responsive,left:this.state.responsive,right:this.state.responsive,bottom:this.state.responsive,topLeft:this.state.responsive,topRight:this.state.responsive,bottomLeft:this.state.responsive,bottomRight:this.state.responsive},onResize:this.onResize,onResizeStart:this.onResizeStart,onResizeStop:this.onResizeStop,resizeRatioX:2,resizeRatioY:1,size:{width:this.state.tempWidth.getOrElse(function(){return e.state.width}),height:this.state.tempHeight.getOrElse(function(){return e.state.height})}},m.createElement(w.a,{style:{width:"100%",height:"100%"}},m.createElement("iframe",{width:"100%",height:"100%",frameBorder:0,srcDoc:Object(Bo.a)(this.props.isAdvancedEditorType?this.props.dispatch(Object(fe.c)()):this.props.emailEditor.html.getOrElse(function(){return""}),this.props.fields,this.props.emailEditor.insertions,this.props.emailEditor.urlLinks,this.props.token,this.props.i18n.t,this.props.cdnAddress)})))))}}]),t}(m.Component);rl=Za([g.autobind,Qa("design:paramtypes",[Object])],rl);var ol=Object(v.connect)(function(e,t){return{i18n:e.i18n,emailEditor:t.isAdvancedEditorType?e.advancedEmailTemplate.present:e.simpleEmailTemplate.present,fields:Object(Pe.e)(e.fields,t.formId).getOrElse(function(){return[]}),token:e.auth.token,cdnAddress:e.config.cdnAddress}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n},areStatePropsEqual:function(e,t){return e.i18n===t.i18n}})(Object(Xa.a)(rl)),al=n(1461),ll=n(176),sl=n(626),cl=n(1941),ul=n.n(cl),pl=n(1942),dl=n.n(pl),fl=n(280),hl=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ml=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"onUndo",value:function(){return this.isEmailTemplateTab()?this.props.dispatch(Object(Re.xb)()):this.isFormTab()?this.props.dispatch(fl.ActionCreators.undo()):void 0}},{key:"onRedo",value:function(){return this.isEmailTemplateTab()?this.props.dispatch(Object(Re.vb)()):this.isFormTab()?this.props.dispatch(fl.ActionCreators.redo()):void 0}},{key:"isEmailTemplateTab",value:function(){return 1===this.props.currentTab}},{key:"isFormTab",value:function(){return 0===this.props.currentTab}},{key:"isUndoDisabled",value:function(){return this.isEmailTemplateTab()?0===this.props.undoableEmailTemplate.past.length:!!this.isFormTab()&&0===this.props.undoableForm.past.length}},{key:"isRedoDisabled",value:function(){return this.isEmailTemplateTab()?0===this.props.undoableEmailTemplate.future.length:!!this.isFormTab()&&0===this.props.undoableForm.future.length}},{key:"render",value:function(){return m.createElement(m.Fragment,null,m.createElement(P.a,{disabled:this.isUndoDisabled(),onClick:this.onUndo},m.createElement(ul.a,null)),m.createElement(P.a,{disabled:this.isRedoDisabled(),onClick:this.onRedo},m.createElement(dl.a,null)))}}]),t}(m.Component);ml=hl([g.autobind],ml);var gl=Object(v.connect)(function(e,t){return{i18n:e.i18n,undoableForm:e.undoableForm,undoableEmailTemplate:e.advancedEmailTemplate}},function(e,t){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.undoableForm===t.undoableForm&&e.advancedEmailTemplate===t.advancedEmailTemplate},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.undoableForm===t.undoableForm&&e.undoableEmailTemplate===t.undoableEmailTemplate}})(Object(sa.a)(ml)),vl=n(156),yl=n.n(vl),bl=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},El=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=(e.i18n,e.fields.email),n=e.handleSubmit,i=e.onSubmit;return m.createElement("form",{onSubmit:function(e){e.preventDefault(),n(i)}},m.createElement(ye.a,{fullWidth:!0,autoFocus:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Email"),error:t.touched&&t.error,helperText:t.touched&&Object(te.toOption)(t.error).map(function(e){return m.createElement(yl.a,null,e)}).getOrNull()}))}}]),t}(m.Component);El=bl([g.autobind],El);var Ol=Object(v.connect)(function(e){return{i18n:e.i18n}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(ge.reduxForm)({form:"testNotificationSendForm",fields:["email"],validate:function(e,t){var n={};return e.email&&0!==e.email.trim().length?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(n.email=t.i18n.t("Неверный адрес")):n.email=t.i18n.t("Обязательное значение"),n}})(El)),kl=n(96),Cl=n(105),jl=n(142),Tl=n(544),wl=n.n(Tl),Sl=n(538),Il=n.n(Sl),Rl=n(2613),Pl=n.n(Rl),xl=n(194),_l=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ll=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Dl=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={imagesNotificationData:[],buttonsNotificationData:[]},n}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.initNotifications()}},{key:"componentWillReceiveProps",value:function(e){this.updateNotifications(e)}},{key:"initNotifications",value:function(){var e=this.props.advancedEmailTemplate.rootContainerElement.map(function(e){return e.children}).getOrElse(function(){return[]}),t=Object(xt.d)(e).filter(function(e){return e.src instanceof ee.ImageSrcFile}).filter(function(e){return e.src.file.value}).map(function(e){return{id:e.id,fileMetaId:e.src.file}});this.updateImageNotifications(t);var n=Object(xt.b)(e);this.updateButtonNotifications(n)}},{key:"updateNotifications",value:function(e){var t=this,n=this.props.advancedEmailTemplate.rootContainerElement.map(function(e){return e.children}).getOrElse(function(){return[]}),i=e.advancedEmailTemplate.rootContainerElement.map(function(e){return e.children}).getOrElse(function(){return[]}),r=Object(xt.d)(n).filter(function(e){return e.src instanceof ee.ImageSrcFile}).filter(function(e){return e.src.file.value}),o=Object(xt.d)(i).filter(function(e){return e.src instanceof ee.ImageSrcFile}).filter(function(e){return e.src.file.value});Object(te.toOption)(r.length!==o.length).filter(function(e){return e}).foreach(function(){return t.updateImageNotifications(o.map(function(e){return{id:e.id,fileMetaId:e.src.file}}))});var a=Object(xt.b)(n),l=Object(xt.b)(i);Object(te.toOption)(!Object(jl.a)(a,l)).filter(function(e){return e}).foreach(function(){return t.updateButtonNotifications(l)})}},{key:"updateImageNotifications",value:function(e){var t=this;this.props.dispatch(Object(Ve.d)(e.map(function(e){return e.fileMetaId}))).then(function(n){var i=n.list.reduce(function(n,i,r){var o=Math.floor(parseInt(i.entity.size)/1024);if(o>xl.a){var a=Object(en.a)(t.props.auth,i.id,t.props.cdnAddress);return[].concat(Jt()(n),[{id:e[r].id,fileMetaId:i.id,size:o,name:i.entity.originalName,src:a,width:new te.None}])}return n},[]);t.setState(E(t.state,{imagesNotificationData:{$set:i}}),function(){return i.map(function(e){return e.src.foreach(function(n){return t.getImgSize(e.fileMetaId,n)})})})})}},{key:"getImgSize",value:function(e,t){var n=this,i=new Image;i.onload=function(){var t=i.width,r=n.state.imagesNotificationData.findIndex(function(t){return t.fileMetaId.value===e.value});Object(te.lift)(n.state.imagesNotificationData,r).foreach(function(e){return Object(te.toOption)(t>xl.b).filter(function(e){return e}).foreach(function(){return n.setState(E(n.state,{imagesNotificationData:{$splice:[[r,1,E(e,{width:{$set:Object(te.toOption)(t)}})]]}}))})})},i.src=t}},{key:"updateButtonNotifications",value:function(e){var t=function(e,t){return[].concat(Jt()(e),[{id:t.id,label:t.label}])},n=e.reduce(function(e,n){switch(n.href.tpe.value){case ee.ButtonHrefExternal.$Type.value:return""===n.href.link?t(e,n):e;case ee.ButtonHrefAppLogin.$Type.value:return""===n.href.uid?t(e,n):e;case ee.ButtonHrefJourneyEvent.$Type.value:return""===n.href.eventId?t(e,n):e;default:return e}},[]);this.setState(E(this.state,{buttonsNotificationData:{$set:n}}))}},{key:"renderImageSizeNotificationText",value:function(e){var t=this.props.i18n.t;return m.createElement(Ot.a,{component:"span",color:"textPrimary"},t("Размер изображения")+" "+e+t("Кб")+" "+t("превышает рекомендуемый")+" "+xl.a+t("Кб"))}},{key:"renderImageWidthNotificationText",value:function(e){var t=this.props.i18n.t;return e.matchWith(function(e){return m.createElement(Ot.a,{component:"span",color:"textPrimary"},t("Ширина изображения")+" "+e+"px "+t("превышает рекомендуемую")+" "+xl.b+"px")},function(){return m.createElement(m.Fragment,null)})}},{key:"renderButtonHrefNotificationText",value:function(){var e=this.props.i18n.t;return m.createElement(Ot.a,{component:"span",color:"textPrimary"},e("Кнопка не несет в себе ссылок"))}},{key:"requiredFieldsNotFilled",value:function(){return this.props.notifyTemplate.data.filter(function(e){return e.entity.body instanceof ee.MessageParamsDataEmailData}).map(function(e){var t=e.entity.body;return""===t.subject||""===t.senderName||""===t.senderMail||""===t.replyMail}).getOrElse(function(){return!1})}},{key:"renderNotifyTemplateRequiredFieldsNotification",value:function(){var e=this.props.i18n.t;return this.props.notifyTemplate.data.filter(function(e){return e.entity.body instanceof ee.MessageParamsDataEmailData}).map(function(t){var n=t.entity.body,i=[].concat(Jt()(""===n.subject?[e("Тема письма")]:[]),Jt()(""===n.senderName?[e("Имя отправителя")]:[]),Jt()(""===n.senderMail?[e("E-mail отправителя")]:[]),Jt()(""===n.replyMail?[e("E-mail для ответа")]:[]));return m.createElement(Ot.a,{component:"span",color:"textPrimary"},i.join(", "))}).getOrNull()}},{key:"onNotificationMouseClick",value:function(e){this.props.dispatch(Object(Re.Gb)(e))}},{key:"openNotifications",value:function(e){var t=this;this.props.openPopover(Object(te.toOption)(e.currentTarget),m.createElement(De.a,null,this.state.imagesNotificationData.map(function(e,i){return m.createElement(Fe.a,{key:i,className:"NotifyTemplatePage__notificationItem",onClick:function(){return t.onNotificationMouseClick(e.id)}},m.createElement(wl.a,null,m.createElement(Il.a,{src:e.src.getOrElse(function(){return n(854)})})),m.createElement(Ne.a,{primary:e.name+" ("+t.props.i18n.t("Кликните чтобы выбрать элемент")+")",secondary:m.createElement(m.Fragment,null,t.renderImageSizeNotificationText(e.size),t.renderImageWidthNotificationText(e.width))}))}),this.state.buttonsNotificationData.map(function(e,n){return m.createElement(Fe.a,{key:n,className:"NotifyTemplatePage__notificationItem",onClick:function(){return t.onNotificationMouseClick(e.id)}},m.createElement(wl.a,null,m.createElement(Il.a,null,"B")),m.createElement(Ne.a,{primary:e.label+" ("+t.props.i18n.t("Кликните чтобы выбрать элемент")+")",secondary:t.renderButtonHrefNotificationText()}))}),this.requiredFieldsNotFilled()&&m.createElement(Fe.a,{className:"NotifyTemplatePage__notificationItem"},m.createElement(wl.a,null,m.createElement(Il.a,null,"I")),m.createElement(Ne.a,{primary:this.props.i18n.t("Обязательные поля не заполнены"),secondary:this.renderNotifyTemplateRequiredFieldsNotification()}))))}},{key:"render",value:function(){var e=0===this.state.imagesNotificationData.length&&0===this.state.buttonsNotificationData.length&&!this.requiredFieldsNotFilled();return m.createElement(P.a,{disabled:e,onClick:this.openNotifications},m.createElement(Pl.a,{color:e?"inherit":"secondary",className:e?"":"bell fa fa-bell"}))}}]),t}(m.Component);Dl=_l([g.autobind,Ll("design:paramtypes",[Object])],Dl);var Al=Object(v.connect)(function(e){return{i18n:e.i18n,notifyTemplate:e.notifyTemplate,advancedEmailTemplate:e.advancedEmailTemplate.present,auth:e.auth,cdnAddress:e.config.cdnAddress}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n,t)},{areStatesEqual:function(e,t){return e.i18n===t.i18n&&e.notifyTemplate===t.notifyTemplate&&e.advancedEmailTemplate===t.advancedEmailTemplate&&e.auth===t.auth&&e.config===t.config},areStatePropsEqual:function(e,t){return e.i18n===t.i18n&&e.notifyTemplate===t.notifyTemplate&&e.advancedEmailTemplate===t.advancedEmailTemplate&&e.auth===t.auth&&e.cdnAddress===t.cdnAddress}})(Object(Cl.a)(Dl)),Fl=(n(2614),function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}),$l=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Wl=new C.CompositeDecorator([{strategy:Lt.b,component:Lt.a},{strategy:Dt.b,component:Dt.a},{strategy:At.b,component:At.a}]),Ml=new C.CompositeDecorator([{strategy:Dt.b,component:Dt.a}]),Nl=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(re.a.screenInitialState(),{formInstance:new te.None,savedValues:new te.None,initialFormValues:new te.None,autoSave:!0,openPreviewDialog:!1})));return n.interval=new te.None,n.runAutoSave(),n}return d()(t,e),s()(t,[{key:"isValuesChanged",value:function(){var e=this;return this.state.savedValues.matchWith(function(t){return!(b()(t.formValues,e.getFormValues().getOrElse(function(){return{}}))&&Object(te.isEqual)(e.props.advancedEmailTemplate.rootContainerElement,t.templateRootContainer)&&Object(te.isEqual)(e.props.simpleEmailTemplate.html,t.html)&&Object(te.isEqual)(e.props.simpleEmailTemplate.text,t.text))},function(){return!1})}},{key:"runAutoSave",value:function(){var e=this;this.interval=Object(te.toOption)(setInterval(function(){if(!e.state.savedValues.isEmpty()&&!e.props.isDragging&&e.state.autoSave){var t=e.getFormValues();e.isValuesChanged()&&t.foreach(function(t){e.setState(E(e.state,{savedValues:{$set:Object(te.toOption)({formValues:t,templateRootContainer:e.props.advancedEmailTemplate.rootContainerElement,html:e.props.simpleEmailTemplate.html,text:e.props.simpleEmailTemplate.text})}}),function(){e.saveTemplate(t).then(function(t){e.props.dispatch(ce(t.id))})})})}},1e3))}},{key:"componentWillUnmount",value:function(){this.interval.foreach(function(e){clearInterval(e)}),this.props.dispatch(ce(new ee.Id(this.props.params.notifyTemplateId)))}},{key:"getRootContainer",value:function(e){return Object(te.toOption)(e.editorType).filter(function(e){return e===ee.EmailDataEditorTypeAdvanced.$Type.value}).map(function(t){return e.editorState.rootContainerElement})}},{key:"initAdvancedEmailEditor",value:function(e){var t=this;return Object(te.toOption)(e.entity.body).filter(function(e){return e instanceof ee.MessageParamsDataEmailData&&e.editorType instanceof ee.EmailDataEditorTypeAdvanced}).map(function(n){var i=Object(fe.b)(n.editorState).rootContainerElement;return t.props.dispatch(Object(Re.ub)({rootContainer:i,urlLinks:e.entity.urlLinks,attachments:n.attachments.filter(function(e){return e instanceof ee.AttachmentLinkAttachment}),insertions:e.entity.textFields,text:Object(te.toOption)(n.textBody)})),i})}},{key:"initSimpleEmailEditor",value:function(e){var t=this;return Object(te.toOption)(e.entity.body).filter(function(e){return e instanceof ee.MessageParamsDataEmailData&&e.editorType instanceof ee.EmailDataEditorTypeSimple}).map(function(n){return t.props.dispatch(Object(Qo.h)({html:n.htmlBody,text:n.textBody,showHtml:n.showHtml,urlLinks:e.entity.urlLinks,attachments:n.attachments.filter(function(e){return e instanceof ee.AttachmentLinkAttachment}),insertions:e.entity.textFields})),{html:n.htmlBody,text:n.textBody}})}},{key:"componentDidMount",value:function(){var e=this;this.props.notifyTemplate.data.foreach(function(t){var n=e.getInitialValues(t);e.setState(E(e.state,{savedValues:{$set:Object(te.toOption)(Object.assign({formValues:n,templateRootContainer:e.initAdvancedEmailEditor(t)},e.initSimpleEmailEditor(t).matchWith(function(e){return{html:Object(te.toOption)(e.html),text:Object(te.toOption)(e.text)}},function(){return{html:new te.None,text:new te.None}})))},initialFormValues:{$set:Object(te.toOption)(n)}}))})}},{key:"componentWillReceiveProps",value:function(e){var t=this;!Object(te.isEqual)(this.props.notifyTemplate.data.map(function(e){return e.id.value}),e.notifyTemplate.data.map(function(e){return e.id.value}))&&this.state.savedValues.isEmpty()&&e.notifyTemplate.data.foreach(function(e){var n=t.getInitialValues(e);t.setState(E(t.state,{savedValues:{$set:Object(te.toOption)(Object.assign({formValues:n,templateRootContainer:t.initAdvancedEmailEditor(e)},t.initSimpleEmailEditor(e).matchWith(function(e){return{html:Object(te.toOption)(e.html),text:Object(te.toOption)(e.text)}},function(){return{html:new te.None,text:new te.None}})))},initialFormValues:{$set:Object(te.toOption)(n)}}))}),this.props.params.notifyTemplateId!==e.params.notifyTemplateId&&e.notifyTemplate.data.foreach(function(e){t.setState(E(t.state,{savedValues:{$set:new te.None},initialFormValues:{$set:new te.None}}))})}},{key:"renderNavigation",value:function(){return m.createElement(ne.a,null)}},{key:"notifyTemplateFormRefHandler",value:function(e){this.setState(E(this.state,{formInstance:{$set:Object(te.toOption)(e).flatMap(function(e){return Object(te.toOption)(e.wrappedInstance)})}}))}},{key:"notifyTemplateEmailFormRefHandler",value:function(e){this.setState(E(this.state,{formInstance:{$set:Object(te.toOption)(e).flatMap(function(e){return Object(te.toOption)(e.wrappedInstance.ref)})}}))}},{key:"onSaveClick",value:function(){this.state.formInstance.map(function(e){return e.submit()})}},{key:"getTelegramParseMode",value:function(e){switch(e){case ee.TelegramParseModeHTML.$Type.value:return Object(te.toOption)(new ee.TelegramParseModeHTML);case ee.TelegramParseModeMarkdown.$Type.value:return Object(te.toOption)(new ee.TelegramParseModeMarkdown);default:return new te.None}}},{key:"getMessengerType",value:function(e,t){switch(e){case ee.MessengerTypeFacebook.$Type.value:return new ee.MessengerTypeFacebook;case ee.MessengerTypeTelegram.$Type.value:return new ee.MessengerTypeTelegram(this.getTelegramParseMode(t));default:return new ee.MessengerTypeFacebook}}},{key:"getHtmlBody",value:function(e){switch(e.editorType){case ee.EmailDataEditorTypeSimple.$Type.value:return this.props.simpleEmailTemplate.html.getOrElse(function(){return""});case ee.EmailDataEditorTypeAdvanced.$Type.value:return this.props.dispatch(Object(fe.c)());default:return e.htmlBody}}},{key:"getEditorType",value:function(e){switch(e.editorType){case ee.EmailDataEditorTypeSimple.$Type.value:return new ee.EmailDataEditorTypeSimple;case ee.EmailDataEditorTypeAdvanced.$Type.value:return new ee.EmailDataEditorTypeAdvanced;default:return new ee.EmailDataEditorTypeSimple}}},{key:"getMessageParamsData",value:function(e){switch(e.type){case ee.MessageParamsDataEmailData.$Type.value:return new ee.MessageParamsDataEmailData([],e.senderName,e.senderMail,e.replyMail,e.subject,this.getHtmlBody(e),this.props.advancedEmailTemplate.text.getOrElse(function(){return""}),this.props.advancedEmailTemplate.attachments.concat(e.attachments).concat(this.props.simpleEmailTemplate.attachments),e.baseUrl,this.props.simpleEmailTemplate.showHtml,this.getEditorType(e),JSON.stringify(me.a.transformValues(this.props.advancedEmailTemplate.rootContainerElement.matchWith(function(e){return new ee.EmailEditorState(e)},function(){return e.editorState||{}}))),(new Array).concat(e.addressTypes||[]).map(function(e){return Object(mn.D)(e)}),ee.Id.createId(e.threadFieldId));case ee.MessageParamsDataSmsData.$Type.value:return new ee.MessageParamsDataSmsData(new ee.Id(e.phoneFieldId),Q(Object(C.convertToRaw)(e.editorState.getCurrentContent())));case ee.MessageParamsDataWebPushData.$Type.value:return new ee.MessageParamsDataWebPushData(Q(Object(C.convertToRaw)(e.editorState.getCurrentContent())));case ee.MessengerParamsData.$Type.value:return new ee.MessengerParamsData(new ee.Id(e.applicationId),new ee.Id(e.chatFieldId),Q(Object(C.convertToRaw)(e.editorState.getCurrentContent())),this.getMessengerType(e.messengerType,e.parseModeType));case ee.MessageParamsDataFacebookData.$Type.value:case ee.MessageParamsDataLinkedInData.$Type.value:return new ee.MessageParamsDataFacebookData(new ee.Id(e.socialConnectionId),Object(mn.J)(e),Q(Object(C.convertToRaw)(e.editorState.getCurrentContent())));default:throw"Unknown message params data type"}}},{key:"saveTemplate",value:function(e){var t=this;return this.props.notifyTemplate.data.map(function(n){var i=t.getMessageParamsData(e);return Object(ae.k)(E(n,{entity:{$set:new ee.NotifyTemplate(e.name,new ee.Id(t.props.params.formId),e.manualUseAllowed,e.changeFields,i,t.props.advancedEmailTemplate.insertions.concat(t.props.simpleEmailTemplate.insertions),new ee.LogParams(e.logEnabled,e.logField?Object(te.toOption)(new ee.Id(e.logField)):new te.None),t.props.advancedEmailTemplate.urlLinks.concat(t.props.simpleEmailTemplate.urlLinks).concat(e.urlLinks||[]),ee.Id.createId(e.transportId),""===e.tag?new te.None:Object(te.toOption)(e.tag))}}))}).getOrElse(function(){return Promise.reject(t.props.i18n.t("Ошибка, шаблон не был загружен"))})}},{key:"onSave",value:function(e){var t=this;return new Promise(function(n,i){t.saveTemplate(e).then(function(e){t.setState(E(t.state,{savedValues:{$set:new te.None}}),function(){n(e),t.props.dispatch(ce(new ee.Id(t.props.params.notifyTemplateId))).then(function(e){t.setState(E(t.state,{savedValues:{$set:Object(te.toOption)(t.getInitialValues(e))}}))}),t.props.dispatch(Object(pe.a)(new ee.Id(t.props.params.formId))),t.props.dispatch(Object(tn.h)(t.props.i18n.t("Сохранение успешно завершено"))),t.handleDialogClose(!1)})}).catch(function(e){i(e),t.props.dispatch(Object(tn.h)(t.props.i18n.t("Сохранение завершилось ошибкой")))})})}},{key:"onGoBackRequested",value:function(){this.props.dispatch(Object(oe.cb)(new ee.Id(this.props.params.eventLineId),new ee.Id(this.props.params.formTypeId),new ee.Id(this.props.params.formId)))}},{key:"getSimpleEditorState",value:function(e,t){var n=Object(Ft.a)(t.htmlBody,Wl,Object(te.liftKey)(this.props.fields.list,this.props.params.formId).getOrElse(function(){return[]}),e.entity.textFields,e.entity.urlLinks,this.props.i18n.t);return C.EditorState.moveSelectionToEnd(n)}},{key:"getEmailInitialValues",value:function(e){var t=e.entity.body;return{type:t.tpe.value,name:e.entity.name,senderName:t.senderName,senderMail:t.senderMail,replyMail:t.replyMail,subject:t.subject,htmlBody:t.htmlBody,textBody:t.textBody,manualUseAllowed:e.entity.manualUseAllowed,changeFields:e.entity.changeFields,editorState:t.editorType.tpe.value===ee.EmailDataEditorTypeSimple.$Type.value?this.getSimpleEditorState(e,t):Object(fe.b)(t.editorState),attachments:t.attachments.filter(function(e){return e instanceof ee.AttachmentFileAttachment||e instanceof ee.AttachmentDocumentAttachment||e instanceof ee.AttachmentFormDataAttachment}),insertions:e.entity.textFields,baseUrl:t.baseUrl,logEnabled:e.entity.logParams.enabled,logField:e.entity.logParams.refId.map(function(e){return e.value}).getOrElse(function(){return""}),urlLinks:e.entity.urlLinks,showHtml:t.showHtml,editorType:t.editorType.tpe.value,addressTypes:t.addressTypes.map(function(e){return{type:e.tpe.value,fieldId:e instanceof ee.EmailAddressTypeFieldId?e.id.value:"",template:e instanceof ee.EmailAddressTypeTemplate?e.value:""}}),transportId:e.entity.transportId.map(function(e){return e.value}).getOrUndefined(),threadFieldId:t.threadId.map(function(e){return e.value}).getOrUndefined(),tag:e.entity.tag.getOrElse(function(){return""})}}},{key:"getSmsInitialValues",value:function(e){var t=e.entity.body;return{type:t.tpe.value,name:e.entity.name,phoneFieldId:t.phone.value,body:t.body,manualUseAllowed:e.entity.manualUseAllowed,changeFields:e.entity.changeFields,editorState:Ta(t.body,Ml,[],e.entity.urlLinks,this.props.i18n.t),logEnabled:e.entity.logParams.enabled,logField:e.entity.logParams.refId.map(function(e){return e.value}).getOrElse(function(){return""}),transportId:e.entity.transportId.map(function(e){return e.value}).getOrUndefined(),tag:e.entity.tag.getOrElse(function(){return""}),urlLinks:e.entity.urlLinks}}},{key:"getWebPushInitialValues",value:function(e){var t=e.entity.body;return{type:t.tpe.value,name:e.entity.name,body:t.body,manualUseAllowed:e.entity.manualUseAllowed,changeFields:e.entity.changeFields,editorState:Ta(t.body,Ml,[],e.entity.urlLinks,this.props.i18n.t),logEnabled:e.entity.logParams.enabled,logField:e.entity.logParams.refId.map(function(e){return e.value}).getOrElse(function(){return""}),transportId:e.entity.transportId.map(function(e){return e.value}).getOrUndefined(),tag:e.entity.tag.getOrElse(function(){return""}),urlLinks:e.entity.urlLinks}}},{key:"getMessengerInitialValues",value:function(e){var t=e.entity.body;return{type:t.tpe.value,name:e.entity.name,applicationId:t.appId.value,chatFieldId:t.chatId.value,messengerType:t.botType.tpe.value,parseModeType:t.botType instanceof ee.MessengerTypeTelegram?t.botType.parseMode.map(function(e){return e.tpe.value}).getOrElse(function(){return""}):"",body:t.body,manualUseAllowed:e.entity.manualUseAllowed,changeFields:e.entity.changeFields,editorState:Ta(t.body,Ml,[],e.entity.urlLinks,this.props.i18n.t),logEnabled:e.entity.logParams.enabled,logField:e.entity.logParams.refId.map(function(e){return e.value}).getOrElse(function(){return""}),tag:e.entity.tag.getOrElse(function(){return""}),urlLinks:e.entity.urlLinks}}},{key:"getSocialPageInitialValues",value:function(e){var t=e.entity.body||ee.MessageParamsDataLinkedInData,n=t.postType;return{type:t.tpe.value,name:e.entity.name,postType:n.tpe.value,socialConnectionId:t.connectorId.value,facebookPageId:n instanceof ee.FacebookPostTypePage?n.pageId:"",facebookGroupId:n instanceof ee.FacebookPostTypeGroup?n.groupId:"",linkedInCompanyPageId:n instanceof ee.LinkedInPostTypeCompanyPage?n.pageId:"",body:t.body,manualUseAllowed:e.entity.manualUseAllowed,changeFields:e.entity.changeFields,editorState:C.EditorState.createEmpty(),logEnabled:e.entity.logParams.enabled,logField:e.entity.logParams.refId.map(function(e){return e.value}).getOrElse(function(){return""}),tag:e.entity.tag.getOrElse(function(){return""}),urlLinks:e.entity.urlLinks}}},{key:"getInitialValues",value:function(e){switch(e.entity.body.tpe.value){case ee.MessageParamsDataSmsData.$Type.value:return this.getSmsInitialValues(e);case ee.MessageParamsDataWebPushData.$Type.value:return this.getWebPushInitialValues(e);case ee.MessageParamsDataEmailData.$Type.value:return this.getEmailInitialValues(e);case ee.MessageParamsDataFacebookData.$Type.value:return this.getSocialPageInitialValues(e);case ee.MessengerParamsData.$Type.value:return this.getMessengerInitialValues(e);case ee.MessageParamsDataLinkedInData.$Type.value:return this.getSocialPageInitialValues(e);default:throw"Unknown message params data type"}}},{key:"getForm",value:function(e){switch(e.type){case ee.MessageParamsDataSmsData.$Type.value:return m.createElement(La,{ref:this.notifyTemplateFormRefHandler,initialValues:e,onSubmit:this.onSave,openDialog:this.openDialog,handleDialogClose:this.handleDialogClose,params:this.props.params,tags:this.props.tags});case ee.MessageParamsDataWebPushData.$Type.value:return m.createElement(Fa,{ref:this.notifyTemplateFormRefHandler,initialValues:e,onSubmit:this.onSave,openDialog:this.openDialog,handleDialogClose:this.handleDialogClose,params:this.props.params,tags:this.props.tags});case ee.MessageParamsDataEmailData.$Type.value:return m.createElement(ha,{formId:ee.Id.createId(this.props.params.formId).getOrElse(function(){throw"wrong form id"}),ref:this.notifyTemplateEmailFormRefHandler,initialValues:e,organisationId:this.props.organisation.data.map(function(e){return e.id}),onSubmit:this.onSave,openDialog:this.openDialog,handleDialogClose:this.handleDialogClose,openSnackbar:this.props.openSnackbar,hideSnackbar:this.props.hideSnackbar,params:this.props.params,overwriteOnInitialValuesChange:!1,tags:this.props.tags});case ee.MessageParamsDataFacebookData.$Type.value:return m.createElement(Ba,{ref:this.notifyTemplateFormRefHandler,initialValues:e,onSubmit:this.onSave,openDialog:this.openDialog,handleDialogClose:this.handleDialogClose,params:this.props.params,tags:this.props.tags});case ee.MessengerParamsData.$Type.value:return m.createElement(Ma,{ref:this.notifyTemplateFormRefHandler,initialValues:e,onSubmit:this.onSave,openDialog:this.openDialog,handleDialogClose:this.handleDialogClose,params:this.props.params,tags:this.props.tags});case ee.MessageParamsDataLinkedInData.$Type.value:return m.createElement(Ba,{ref:this.notifyTemplateFormRefHandler,initialValues:e,onSubmit:this.onSave,openDialog:this.openDialog,handleDialogClose:this.handleDialogClose,params:this.props.params,tags:this.props.tags});default:throw"Unknown message params data type"}}},{key:"onWYSIWYGToggled",value:function(){this.props.dispatch(Object(Re.Ab)())}},{key:"getFormValues",value:function(){return Object(te.toOption)(this.props.undoableForm.present.notifyTemplateForm).flatMap(function(e){return Object(te.toOption)(Object.keys(e).filter(function(e){return 0!==e.indexOf("_")})).filter(function(e){return e.length>0}).map(function(t){return t.reduce(function(t,n){return Object(te.toOption)(e[n]).flatMap(function(e){return Object(te.toOption)(e.value)}).matchWith(function(e){return E(t,r()({},n,{$set:e}))},function(){return t})},{})})})}},{key:"onAutoSaveToggled",value:function(){this.setState(E(this.state,{autoSave:{$set:!this.state.autoSave}}))}},{key:"openPreviewDialog",value:function(){this.setState(E(this.state,{openPreviewDialog:{$set:!0}}))}},{key:"closePreviewDialog",value:function(){this.setState(E(this.state,{openPreviewDialog:{$set:!1}}))}},{key:"renderTemplatePreviewDialog",value:function(){var e=this.props.notifyTemplate.data.filter(function(e){return e.entity.body instanceof ee.MessageParamsDataEmailData}).map(function(e){return e.entity.body.editorType}).map(function(e){return e instanceof ee.EmailDataEditorTypeAdvanced}).getOrElse(function(){return!1});return m.createElement(W.a,{fullWidth:!0,fullScreen:!0,open:this.state.openPreviewDialog},m.createElement(ol,{formId:ee.Id.createId(this.props.params.formId).getOrElse(function(){throw"wrong form id"}),handleClose:this.closePreviewDialog,isAdvancedEditorType:e}))}},{key:"onSendTestNotificationClick",value:function(){var e=this,t=void 0,n=this.props.openDialog(this.props.i18n.t("Пробная отправка письма"),m.createElement(Ol,{ref:function(e){return t=Object(te.toOption)(e).flatMap(function(e){return Object(te.toOption)(e.wrappedInstance)})},onSubmit:function(t){return new Promise(function(i,r){e.props.dispatch(Object(kl.p)(t.email)),Object(ae.j)(ee.Id.createId(e.props.params.notifyTemplateId).getOrElse(function(){throw"wrong notify template id"}),t.email).then(function(t){e.props.dispatch(Object(tn.h)(e.props.i18n.t("Письмо отправлено!"))),e.props.handleDialogClose(n)}).catch(function(t){e.props.dispatch(Object(tn.h)(e.props.i18n.t("Ошибка при отправке письма")))})})},initialValues:{email:this.props.dispatch(function(e,t){return t().userUi.notificationEmail.testEmailAddress})}}),[m.createElement(I.a,{variant:"raised",onClick:function(t){return e.props.handleDialogClose(n)},style:{marginRight:"10px"}},this.props.i18n.t("Закрыть")),m.createElement(I.a,{variant:"raised",onClick:function(){return t.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Отправить"))])}},{key:"render",value:function(){var e=this,t=this.props.notifyTemplate.data,n=t.map(function(e){return e.entity.name}).getOrElse(function(){return""}),i=t.filter(function(e){return e.entity.body instanceof ee.MessageParamsDataEmailData}).map(function(e){return e.entity.body.editorType instanceof ee.EmailDataEditorTypeAdvanced}).getOrElse(function(){return!1});return this.renderScreenBody({className:""},m.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:0,flex:1}},m.createElement(k.a,{when:this.isValuesChanged()},function(t){var n=t.isActive,i=t.onCancel,r=t.onConfirm;return m.createElement(W.a,{fullWidth:!0,open:n},m.createElement(N.a,{style:{borderBottom:"none"}},e.props.i18n.t("Выход из редактора")),m.createElement(z.a,null,e.props.i18n.t("Есть несохраненные изменения. Вы действительно хотите покинуть редактор?")),m.createElement(V.a,{style:{borderTop:"none"}},m.createElement(I.a,{key:"close",variant:"raised",onClick:i,style:{marginRight:"10px"}},e.props.i18n.t("Нет")),",",m.createElement(I.a,{key:"save",variant:"raised",onClick:r,color:"primary"},e.props.i18n.t("Да"))))}),m.createElement(ie.a,{title:this.props.i18n.t("Шаблон рассылки")+" "+n,onGoBackRequested:this.onGoBackRequested,rightButtonGroup:[m.createElement("div",null,m.createElement(Al,null),m.createElement(gl,null),m.createElement(P.a,{onClick:this.onAutoSaveToggled},this.state.autoSave?m.createElement(U.a,{style:{fill:"#E91E63"}}):m.createElement(U.a,null)),this.props.showWYSIWYGToggle&&i&&m.createElement(_.a,{label:this.props.i18n.t("WYSIWYG"),control:m.createElement(D.a,{checked:this.props.isWYSIWYG,onChange:function(){return e.onWYSIWYGToggled()}})}),this.props.showWYSIWYGToggle&&m.createElement(P.a,{onClick:this.openPreviewDialog},m.createElement(K.a,null)),m.createElement(F.a,{placement:"bottom",title:this.props.i18n.t("Пробная отправка письма")},m.createElement(P.a,{onClick:this.onSendTestNotificationClick},m.createElement(J.a,null))),m.createElement(I.a,{variant:"raised",style:{margin:"0px 15px"},onClick:this.onSaveClick,color:"primary"},this.props.i18n.t("Сохранить")))]}),m.createElement(w.a,{className:"DefaultPage__paper",style:{boxSizing:"border-box",flex:1}},this.state.initialFormValues.map(function(t){return e.getForm(t)}).getOrElse(function(){return m.createElement("div",null)})),this.renderTemplatePreviewDialog()))}}]),t}(re.a);Nl=Fl([g.autobind,$l("design:paramtypes",[Object])],Nl);t.default=Object(v.connect)(function(e){return{notifyTemplate:e.notifyTemplate,organisation:e.organisation,undoableForm:e.undoableForm,fields:e.fields,showWYSIWYGToggle:e.emailEditor.showWYSIWYGToggle,isWYSIWYG:e.emailEditor.isWYSIWYG,advancedEmailTemplate:e.advancedEmailTemplate.present,simpleEmailTemplate:e.simpleEmailTemplate.present,i18n:e.i18n,isDragging:e.emailEditor.draggingElement.nonEmpty(),auth:e.auth,cdnAddress:e.config.cdnAddress,tags:Object(j.a)(e.notifyTemplates.descriptionsList.map(function(e){return e.tag}).filter(function(e){return e.nonEmpty()}).map(function(e){return e.getOrElse(function(){return""})}))}})(Object(al.a)(Object(ca.a)(function(e){e.isTokenChecked&&(e.dispatch(ue(new ee.Id(e.params.notifyTemplateId))),e.dispatch(Object(ll.j)(new ee.Id(e.params.formId))),e.dispatch(Object(he.d)(new ee.Id(e.params.eventLineId))),e.organisation.organisationId.foreach(function(t){e.dispatch(Object(de.b)(t))}))},function(){},function(e,t){e.params.formId!==t.params.formId&&(e.dispatch(Object(ll.j)(new ee.Id(e.params.formId))),e.dispatch(ue(new ee.Id(e.params.notifyTemplateId))),e.dispatch(Object(he.d)(new ee.Id(e.params.eventLineId))),e.organisation.organisationId.foreach(function(t){e.dispatch(Object(de.a)(t))})),e.params.formId===t.params.formId&&e.isTokenChecked&&!t.isTokenChecked&&(e.dispatch(Object(ll.j)(new ee.Id(e.params.formId))),e.dispatch(ue(new ee.Id(e.params.notifyTemplateId))),e.dispatch(Object(he.d)(new ee.Id(e.params.eventLineId))),e.organisation.organisationId.foreach(function(t){e.dispatch(Object(de.a)(t))}))})(Object(Ze.a)(Object(sl.a)(Object(Cl.a)(Nl))))))}}]);