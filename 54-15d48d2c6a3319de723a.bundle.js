(window.webpackJsonpwww=window.webpackJsonpwww||[]).push([[54],{1459:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(79),o=n(104),i=n(82),a=function(){return function(e,t){return e(i.default.isA5000?Object(r.Mb)():Object(r.h)())}},c=function(e,t){return function(n,i){return i().eventLine.data.foreach(function(a){Object(o.e)(i().forms,e).foreach(function(o){n(Object(r.H)(a.id,o.entity.formType.getFormTypeId(),e,t))})})}}},1461:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(10),a=n.n(i),c=n(7),s=n.n(c),u=n(8),p=n.n(u),l=n(2),d=n(14),f=n(1469),h=n(1459),m=n(320),v=n(69),g=n(0),b=n(624);t.a=function(e){return Object(d.connect)(function(e){return{auth:e.auth,websocket:e.websocket,routing:e.routing}})(function(e){return function(t){function n(){return o()(this,n),s()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return p()(n,t),a()(n,[{key:"componentWillMount",value:function(){var e=this;this.props.auth.signedOut||this.props.websocket.active&&(this.props.auth.checking||this.props.auth.checked&&this.props.auth.signedIn||this.props.auth.signingIn||this.props.auth.signedIn||Object(g.toOption)(this.props.routing.location).map(function(t){Object(g.liftKey)(Object(b.a)(t.search),"token").map(function(t){t.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})})}).getOrElse(function(){e.props.auth.token.map(function(t){e.props.dispatch(Object(f.d)(t)).catch(function(t){e.signOut()})}).getOrElse(function(){e.signOut()})})}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.auth.signedOut||e.websocket.active&&(e.auth.checking||(e.auth.checked&&e.auth.signedIn||e.auth.signingIn||e.auth.signedIn)&&(!e.websocket.active||this.props.websocket.active)||e.auth.token.map(function(n){e.dispatch(Object(f.d)(n)).catch(function(e){t.signOut()})}).getOrElse(function(){t.signOut()}))}},{key:"signOut",value:function(){this.props.dispatch(Object(v.r)()),this.props.dispatch(Object(m.c)()),this.props.dispatch(Object(h.b)())}},{key:"render",value:function(){return this.props.auth.signedIn&&!this.props.auth.signingIn?l.createElement(e,this.props):l.createElement("div",null)}}]),n}(l.Component)}(e))}},1462:function(e,t,n){"use strict";var r=n(855);Object.defineProperty(t,"__esModule",{value:!0});var o={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var i=r(n(1464));Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))})},1463:function(e,t,n){"use strict";var r=n(855),o=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(36)),a=o(n(2)),c=(o(n(31)),r(n(1462))),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.breakpoint,r=void 0===n?"sm":n;return(0,c.default)()(function(e){return a.default.createElement(t,(0,i.default)({fullScreen:(0,c.isWidthDown)(r,e.width)},e))})}};t.default=s},1464:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.isWidthDown=t.isWidthUp=void 0;var o=r(n(36)),i=r(n(39)),a=r(n(73)),c=r(n(74)),s=r(n(76)),u=r(n(77)),p=r(n(78)),l=r(n(2)),d=(r(n(31)),r(n(217))),f=r(n(373)),h=(n(61),r(n(539))),m=r(n(263)),v=n(859),g=r(n(860));t.isWidthUp=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?v.keys.indexOf(e)<v.keys.indexOf(t):v.keys.indexOf(e)<=v.keys.indexOf(t)};t.isWidthDown=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?v.keys.indexOf(t)<v.keys.indexOf(e):v.keys.indexOf(t)<=v.keys.indexOf(e)};var b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.withTheme,r=void 0!==n&&n,b=e.noSSR,y=void 0!==b&&b,O=e.initialWidth,j=e.resizeInterval,k=void 0===j?166:j,w=function(e){function n(e){var t;return(0,a.default)(this,n),(t=(0,s.default)(this,(0,u.default)(n).call(this,e))).state={width:y?t.getWidth():void 0},"undefined"!=typeof window&&(t.handleResize=(0,f.default)(function(){var e=t.getWidth();e!==t.state.width&&t.setState({width:e})},k)),t}return(0,p.default)(n,e),(0,c.default)(n,[{key:"componentDidMount",value:function(){var e=this.getWidth();e!==this.state.width&&this.setState({width:e})}},{key:"componentWillUnmount",value:function(){this.handleResize.clear()}},{key:"getWidth",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,t=this.props.theme.breakpoints,n=null,r=1;null===n&&r<v.keys.length;){var o=v.keys[r];if(e<t.values[o]){n=v.keys[r-1];break}r+=1}return n=n||"xl"}},{key:"render",value:function(){var e=(0,g.default)({theme:this.props.theme,name:"MuiWithWidth",props:(0,o.default)({},this.props)}),n=e.initialWidth,a=e.theme,c=e.width,s=(0,i.default)(e,["initialWidth","theme","width"]),u=(0,o.default)({width:c||this.state.width||n||O},s);return void 0===u.width?null:(r&&(u.theme=a),l.default.createElement(l.default.Fragment,null,l.default.createElement(t,u),l.default.createElement(d.default,{target:"window",onResize:this.handleResize})))}}]),n}(l.default.Component);return(0,h.default)(w,t),(0,m.default)()(w)}};t.default=b},1465:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),t.isHorizontal=j,t.getAnchor=k,t.default=t.styles=void 0;var o=r(n(36)),i=r(n(55)),a=r(n(39)),c=r(n(73)),s=r(n(74)),u=r(n(76)),p=r(n(77)),l=r(n(78)),d=r(n(2)),f=(r(n(31)),r(n(47))),h=r(n(625)),m=r(n(38)),v=r(n(858)),g=r(n(93)),b=n(110),y=n(321),O={left:"right",right:"left",top:"down",bottom:"up"};function j(e){return-1!==["left","right"].indexOf(e.anchor)}function k(e){return"rtl"===e.theme.direction&&j(e)?O[e.anchor]:e.anchor}var w=function(e){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:e.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:"none"},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(e.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(e.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(e.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(e.palette.divider)},modal:{}}};t.styles=w;var _=function(e){function t(){var e,n;(0,c.default)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=(0,u.default)(this,(e=(0,p.default)(t)).call.apply(e,[this].concat(o)))).mounted=!1,n}return(0,l.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){var e=this.props,t=(e.anchor,e.BackdropProps),n=e.children,r=e.classes,c=e.className,s=e.elevation,u=e.ModalProps,p=(u=void 0===u?{}:u).BackdropProps,l=(0,a.default)(u,["BackdropProps"]),m=e.onClose,y=e.open,j=e.PaperProps,w=e.SlideProps,_=(e.theme,e.transitionDuration),E=e.variant,C=(0,a.default)(e,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","theme","transitionDuration","variant"]),R=k(this.props),P=d.default.createElement(g.default,(0,o.default)({elevation:"temporary"===E?s:0,square:!0,className:(0,f.default)(r.paper,r["paperAnchor".concat((0,b.capitalize)(R))],(0,i.default)({},r["paperAnchorDocked".concat((0,b.capitalize)(R))],"temporary"!==E))},j),n);if("permanent"===E)return d.default.createElement("div",(0,o.default)({className:(0,f.default)(r.root,r.docked,c)},C),P);var x=d.default.createElement(v.default,(0,o.default)({in:y,direction:O[R],timeout:_,appear:this.mounted},w),P);return"persistent"===E?d.default.createElement("div",(0,o.default)({className:(0,f.default)(r.root,r.docked,c)},C),x):d.default.createElement(h.default,(0,o.default)({BackdropProps:(0,o.default)({},t,p,{transitionDuration:_}),className:(0,f.default)(r.root,r.modal,c),open:y,onClose:m},C,l),x)}}]),t}(d.default.Component);_.defaultProps={anchor:"left",elevation:16,open:!1,transitionDuration:{enter:y.duration.enteringScreen,exit:y.duration.leavingScreen},variant:"temporary"};var E=(0,m.default)(w,{name:"MuiDrawer",flip:!1,withTheme:!0})(_);t.default=E},1473:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var o=r(n(1463))},1474:function(e,t,n){"use strict";var r=n(12);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var o=r(n(1465))},1896:function(e,t,n){"use strict";n.d(t,"e",function(){return p}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return m});var r=n(6),o=n.n(r),i=n(7),a=n.n(i),c=n(8),s=n.n(c),u=n(18),p=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Request",{id:e}))}return s()(t,e),t}(u.a),l=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Delete",{id:e}))}return s()(t,e),t}(u.a),d=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Create",{template:e}))}return s()(t,e),t}(u.a),f=function(e){function t(e){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","Update",{template:e}))}return s()(t,e),t}(u.a),h=function(e){function t(){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","List",{}))}return s()(t,e),t}(u.a),m=function(e){function t(){return o()(this,t),a()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SeatmapTemplates","ListDescriptions",{}))}return s()(t,e),t}(u.a)},2226:function(e,t,n){var r=n(2227);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(121)(r,o);r.locals&&(e.exports=r.locals)},2227:function(e,t,n){(e.exports=n(120)(!1)).push([e.i,".SeatMapTemplateForm__dropzone {\n  position: relative;\n  width: 100%;\n  height: 100px;\n  margin-top: 15px;\n  border-width: 2px;\n  border-color: #666666;\n  border-style: dashed;\n  border-radius: 5px;\n  cursor: pointer; }\n\n.SeatMapTemplateForm__dropzone-message {\n  position: absolute;\n  text-align: center;\n  display: inline-block;\n  top: 50%;\n  left: 50%;\n  width: 50%;\n  transform: translate(-50%, -50%); }\n\n.SeatMapTemplateForm__dropzone-wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f8ff; }\n",""])},2728:function(e,t,n){"use strict";n.r(t);var r=n(6),o=n.n(r),i=n(10),a=n.n(i),c=n(7),s=n.n(c),u=n(8),p=n.n(u),l=n(11),d=n.n(l),f=n(2),h=n(13),m=n(14),v=n(3),g=n(856),b=n.n(g),y=n(857),O=n.n(y),j=n(627),k=n(1467),w=n(136),_=n(1461),E=n(19),C=n.n(E),R=n(25),P=n.n(R),x=n(93),D=n.n(x),T=n(1),S=n(0),I=n(414),M=n.n(I),W=n(86),N=n.n(W),V=n(216),F=n(415),q=n(71),A=n(95),z=n(26),L=n.n(z),B=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},U=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.fields,t=e.name,n=e.roomName,r=e.roomCapacity;return f.createElement("form",null,f.createElement(L.a,{fullWidth:!0,autoFocus:!0,value:t.value,onChange:t.onChange,label:this.props.i18n.t("Название"),error:t.touched&&t.error,helperText:t.touched&&Object(S.toOption)(t.error).map(function(e){return e}).getOrNull()}),f.createElement(L.a,{fullWidth:!0,value:n.value,onChange:n.onChange,label:this.props.i18n.t("Название помещения"),error:r.touched&&n.error,helperText:n.touched&&Object(S.toOption)(n.error).map(function(e){return e}).getOrNull()}),f.createElement(L.a,{fullWidth:!0,type:"number",value:r.value,onChange:r.onChange,label:this.props.i18n.t("Вместимость"),error:r.touched&&r.error,helperText:r.touched&&Object(S.toOption)(r.error).map(function(e){return e}).getOrNull()}))}}]),t}(f.Component);U=B([h.autobind],U);var $=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation}},function(e){return{dispatch:e}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(A.reduxForm)({form:"newVenuesConfigForm",fields:["name","roomName","roomCapacity"],validate:function(e,t){var n={};return e.name&&0!==e.name.trim().length||(n.name=t.i18n.t("Обязательное значение")),n}})(U)),H=n(201),J=n(46),Y=n(17),K=n(18),G=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Venues","Update",{venue:e}))}return p()(t,e),t}(K.a),Q=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Venues","Create",{venue:e}))}return p()(t,e),t}(K.a),X=(function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Venues","Request",{id:e}))}p()(t,e)}(K.a),function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Venues","Delete",{id:e}))}return p()(t,e),t}(K.a)),Z=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Venues","List"))}return p()(t,e),t}(K.a),ee=n(21),te=n(497),ne=function(){return function(e){return e(Object(te.i)()),Y.a.send(new Z,function(e){return e}).then(function(t){return e(Object(te.j)(t)),t}).catch(function(t){throw e(Object(te.f)(t)),t})}},re=n(83),oe=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ie=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(ne())}},{key:"getClassByTpe",value:function(e){switch(e){case T.VenueTypeUser.$Type.value:return new T.VenueTypeUser;case T.VenueTypeStandard.$Type.value:default:return new T.VenueTypeStandard}}},{key:"getVenueNameByType",value:function(e){switch(e){case T.VenueTypeUser.$Type.value:return this.props.i18n.t("Пользователь");case T.VenueTypeStandard.$Type.value:default:return this.props.i18n.t("Стандартный")}}},{key:"onCreateRequested",value:function(){var e=this,t=function(t,n){return new Promise(function(r,o){return e.props.organisation.data.map(function(i){var a;(a=new T.Venue(t.name,new T.VenueTypeUser,new T.VenueRoom(t.roomName,t.roomCapacity,new T.RoomSchema)),Y.a.send(new Q(a),Object(ee.f)())).then(function(t){r(t),e.props.dispatch(Object(te.d)(t.id)),e.props.dispatch(ne()),e.props.dispatch(Object(q.h)(e.props.i18n.t("Успешно создано"))),e.props.handleDialogClose(n)}).catch(function(e){o(e)})}).getOrElse(function(){o("Organisation has not been provided")})}).catch(function(t){return e.props.dispatch(Object(H.a)(t))})},n=void 0,r=this.props.openDialog(this.props.i18n.t("Создание"),f.createElement($,{ref:function(e){return n=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},onSubmit:function(e){return t(e,r)}}),[f.createElement(C.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return e.props.handleDialogClose(r)}},this.props.i18n.t("Закрыть")),f.createElement(C.a,{variant:"raised",onClick:function(){return n.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onEditRequest",value:function(e){var t=this,n=function(n,r){return new Promise(function(o,i){return t.props.organisation.data.map(function(a){(function(e){return Y.a.send(new G(e),Object(ee.f)())})(v(e,{entity:{name:{$set:n.name},venueType:{$set:new T.VenueTypeUser},rooms:{$set:new T.VenueRoom(n.roomName,n.roomCapacity,new T.RoomSchema)}}})).then(function(e){o(e),t.props.dispatch(Object(te.h)(e.id)),t.props.dispatch(ne()),t.props.dispatch(Object(q.h)(t.props.i18n.t("Изменения успешно сохранены"))),t.props.handleDialogClose(r)}).catch(function(e){i(e)})}).getOrElse(function(){i("Organisation has not been provided")})}).catch(function(e){return t.props.dispatch(Object(H.a)(e))})},r=void 0,o=this.props.openDialog(this.props.i18n.t("Редактирование"),f.createElement($,{ref:function(e){return r=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},onSubmit:function(e){return n(e,o)},initialValues:{name:e.entity.name,roomName:e.entity.rooms.name,roomCapacity:e.entity.rooms.capacity}}),[f.createElement(C.a,{variant:"raised",style:{marginRight:"10px"},onClick:function(){return t.props.handleDialogClose(o)}},this.props.i18n.t("Закрыть")),f.createElement(C.a,{variant:"raised",onClick:function(){return r.map(function(e){return e.submit()})},color:"primary"},this.props.i18n.t("Сохранить"))])}},{key:"onDeleteRequested",value:function(e){var t=this,n=function(n){var r;(r=e.id,Y.a.send(new X(r),Object(ee.f)())).then(function(){t.props.dispatch(Object(te.e)(e.id)),t.props.dispatch(ne()),t.props.handleDialogClose(n),t.props.dispatch(Object(q.h)(t.props.i18n.t("Успешно удалёно")))}).catch(function(e){t.props.dispatch(Object(H.a)(e))})},r=this.props.openDialog(this.props.i18n.t("Удаление"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить помещение, это действие нельзя будет отменить?")),[f.createElement(C.a,{variant:"raised",onClick:function(){t.props.handleDialogClose(r)},style:{marginRight:"10px"}},this.props.i18n.t("Нет")),f.createElement(C.a,{variant:"raised",onClick:function(){return n(r)},color:"primary"},this.props.i18n.t("Да"))])}},{key:"render",value:function(){var e=this;return f.createElement(D.a,{style:{flex:1,padding:15}},f.createElement(V.b,null,f.createElement(C.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Создать"))),f.createElement(F.a,{showId:!1,error:this.props.venues.error,fetching:this.props.venues.fetching,onRecordSelected:this.onEditRequest,empty:!this.props.venues.fetching&&0===this.props.venues.list.length,withActions:!0,headers:[{id:"venueName",title:this.props.i18n.t("Название")},{id:"venueRoomName",title:this.props.i18n.t("Название помещения")},{id:"venueRoomCapacity",title:this.props.i18n.t("Вместимость")}],rows:this.props.venues.list.map(function(t,n){return{id:t.id.value,payload:t,fields:[t.entity.name,t.entity.rooms.name,t.entity.rooms.capacity],buttons:[f.createElement(P.a,{key:"edit",style:J.f,onClick:function(n){n.stopPropagation(),e.onEditRequest(t)}},f.createElement(N.a,{style:J.g})),f.createElement(P.a,{key:"delete",style:J.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},f.createElement(M.a,{style:J.g}))]}})}))}}]),t}(f.Component);ie=oe([h.autobind],ie);var ae=Object(m.connect)(function(e){return{i18n:e.i18n,organisation:e.organisation,venues:e.venues}})(Object(re.a)(ie)),ce=n(1896),se=n(79),ue=n(324),pe=n.n(ue),le=n(556),de=(n(2226),function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}),fe=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.auth.token.map(function(t){return e.props.dispatch(Object(le.a)(t))})}},{key:"handleFilesDrop",value:function(e){this.props.fields.fileId.onChange(e.value)}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onSubmit,r=e.fields.name,o=0!==this.props.fonts.list.length,i=0!==this.props.fonts.blockFontsList.length,a=this.props.fonts.fetching,c=this.props.fonts.blockFontsFetching,s=this.props.i18n.t("Обратите внимание, что для организации не добавленно ни одного шрифта, рекомендуем добавить хотя бы один прежде чем продолжить");return f.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),t(n)}},f.createElement("div",{className:"field"},f.createElement(L.a,{fullWidth:!0,autoFocus:!0,value:r.value,onChange:r.onChange,label:this.props.i18n.t("Название шаблона"),error:r.touched&&r.error,helperText:r.touched&&Object(S.toOption)(r.error).map(function(e){return e}).getOrNull()})),(!a&&!o||!c&&!i)&&f.createElement("p",{style:{color:pe.a[500]}},s))}}]),t}(f.Component);fe=de([h.autobind],fe);var he=Object(m.connect)(function(e){return{i18n:e.i18n,fonts:e.fonts,auth:e.auth,organisationId:e.organisation.organisationId,eventLineId:e.eventLine.eventLineId}},function(e){return{}},function(e,t,n){return Object.assign({},e,n)},{withRef:!0})(Object(A.reduxForm)({form:"seatmapTemplateForm",fields:["name"],validate:function(e){var t={};return e.name||(t.name="Обязательное значение"),t}})(fe)),me=n(317),ve=function(){return function(e){return e(Object(me.h)()),Y.a.send(new ce.d,Object(ee.g)()).then(function(t){return e(Object(me.i)(t.list)),t}).catch(function(t){throw e(Object(me.g)(t)),t})}},ge=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},be=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ye=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return p()(t,e),a()(t,[{key:"onCreateRequested",value:function(){var e=this,t=function(t,n){var r,o=new T.SeatmapTemplate(t.name,(new Date).getTime(),(new Date).getTime(),new T.SeatmapSchema([new T.SeatmapPage(new T.ElementSize(210,297))],[]));return(r=o,Y.a.send(new ce.a(r),Object(ee.f)())).then(function(t){return e.props.dispatch(ve()).then(function(){e.props.handleDialogClose(n),e.props.dispatch(Object(q.h)(e.props.i18n.t("Шаблон создан")))})}).catch(function(t){return e.props.dispatch(Object(H.a)(t))})},n=void 0,r=this.props.openDialog(this.props.i18n.t("Новый шаблон"),f.createElement(he,{ref:function(e){return n=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},onSubmit:function(e){return t(e,r)}}),[f.createElement(C.a,{variant:"raised",style:{marginRight:15},onClick:function(){return e.props.handleDialogClose(r)}},this.props.i18n.t("Закрыть")),f.createElement(C.a,{variant:"raised",color:"primary",onClick:function(){return n.map(function(e){return e.submit()})}},this.props.i18n.t("Сохранить"))])}},{key:"handleAddFonts",value:function(){this.props.dispatch(Object(se.pb)())}},{key:"onEditRequested",value:function(e){var t=this,n=function(n,r){return(o=T.Id.createId(e.id).getOrElse(function(){throw"wrong seatmap template id"}),Y.a.send(new ce.e(o),Object(ee.e)())).then(function(e){var o,i=v(e.record,{entity:{name:{$set:n.name}}});return(o=i,Y.a.send(new ce.f(o),Object(ee.f)())).then(function(){return t.props.dispatch(ve()).then(function(){t.props.handleDialogClose(r),t.props.dispatch(Object(q.h)(t.props.i18n.t("Шаблон изменён")))})}).catch(function(e){return t.props.dispatch(Object(H.a)(e))})});var o},r=void 0,o=this.props.openDialog(this.props.i18n.t("Редактирование шаблона"),f.createElement(he,{ref:function(e){return r=Object(S.toOption)(e).flatMap(function(e){return Object(S.toOption)(e.wrappedInstance)})},onSubmit:function(e){return n(e,o)},initialValues:{name:e.name}}),[f.createElement(C.a,{variant:"raised",style:{marginRight:15},onClick:function(){return t.props.handleDialogClose(o)}},this.props.i18n.t("Закрыть")),f.createElement(C.a,{variant:"raised",color:"primary",onClick:function(){return r.map(function(e){return e.submit()})}},this.props.i18n.t("Сохранить"))])}},{key:"onCellClickHandler",value:function(e){this.props.dispatch(Object(se.ob)(T.Id.createId(e.id).getOrElse(function(){throw"wrong seatmapId"})))}},{key:"onDeleteRequested",value:function(e){var t=this,n=function(n){var r;(r=T.Id.createId(e.id).getOrElse(function(){throw"wrong seatmapId"}),Y.a.send(new ce.b(r),Object(ee.f)())).then(function(e){return t.props.dispatch(ve()).then(function(){t.props.handleDialogClose(n),t.props.dispatch(Object(q.h)(t.props.i18n.t("Удалено")))})}).catch(function(e){return t.props.dispatch(Object(H.a)(e))})},r=this.props.openDialog(this.props.i18n.t("Удаление шаблона"),f.createElement("div",null,this.props.i18n.t("Вы действительно хотите удалить шаблон? Это действие нельзя будет отменить.")),[f.createElement(C.a,{key:"cancel",variant:"raised",onClick:function(){return t.props.handleDialogClose(r)},style:{marginRight:"10px"}},this.props.i18n.t("Нет")),f.createElement(C.a,{key:"confirm",variant:"raised",onClick:function(){return n(r)}},this.props.i18n.t("Да"))])}},{key:"render",value:function(){var e=this;return f.createElement(D.a,{style:{display:"flex",flex:1,flexDirection:"column",minHeight:"0",overflowY:"auto",padding:15}},f.createElement(V.b,null,f.createElement(C.a,{variant:"raised",onClick:this.onCreateRequested,color:"primary"},this.props.i18n.t("Новый шаблон"))),f.createElement(F.a,{showId:!0,error:this.props.seatmapTemplates.descriptionsError,onRecordSelected:this.onCellClickHandler,fetching:this.props.seatmapTemplates.descriptionsFetching,empty:!this.props.seatmapTemplates.descriptionsFetching&&0==this.props.seatmapTemplates.descriptionsList.length,withActions:!0,headers:[{id:"seatmapTemplateName",title:this.props.i18n.t("Название")},{id:"seatmapTemplateType",title:this.props.i18n.t("Тип")}],rows:this.props.seatmapTemplates.descriptionsList.map(function(t){return{id:t.id,payload:t,fields:[t.name],buttons:[f.createElement(P.a,{key:"edit",style:J.f,onClick:function(n){n.stopPropagation(),e.onEditRequested(t)}},f.createElement(N.a,{style:J.g})),f.createElement(P.a,{key:"delete",style:J.f,onClick:function(n){n.stopPropagation(),e.onDeleteRequested(t)}},f.createElement(M.a,{style:J.g}))]}})}))}}]),t}(f.Component);ye=ge([h.autobind,be("design:paramtypes",[Object])],ye);var Oe,je=Object(m.connect)(function(e){return{seatmapTemplates:e.seatmapTemplates,i18n:e.i18n}})(Object(w.a)(function(e){e.isTokenChecked&&e.dispatch(ve())})(Object(re.a)(ye))),ke=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},we=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":d()(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_e=Oe=function(e){function t(e){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(k.a.screenInitialState(),{selectedIndex:Oe.selectedIndex()})))}return p()(t,e),a()(t,[{key:"renderNavigation",value:function(){return f.createElement(j.a,null)}},{key:"renderTabsContent",value:function(){switch(this.state.selectedIndex){case 0:return f.createElement(ae,null);case 1:return f.createElement(je,null);default:return f.createElement("div",null,"unknown blocks content")}}},{key:"onSelected",value:function(e){switch(e){case 0:this.props.dispatch(Object(se.Ob)());break;case 1:this.props.dispatch(Object(se.Cb)())}this.setState(v(this.state,{selectedIndex:{$set:e}}))}},{key:"render",value:function(){var e=this;return this.renderScreenBody({className:"Venues"},f.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},f.createElement(O.a,{onChange:function(t,n){return e.onSelected(n)},indicatorColor:"primary",textColor:"primary",fullWidth:!0,value:this.state.selectedIndex},f.createElement(b.a,{value:0,label:this.props.i18n.t("Помещения")}),",",f.createElement(b.a,{value:1,label:this.props.i18n.t("Схемы")})),this.renderTabsContent()))}}],[{key:"selectedIndex",value:function(){return-1!==location.href.indexOf("/venues")?0:-1!==location.href.indexOf("/seatmapTemplates")?1:0}}]),t}(k.a);_e=Oe=ke([h.autobind,we("design:paramtypes",[Object])],_e);t.default=Object(m.connect)(function(e){return{i18n:e.i18n}})(Object(_.a)(Object(w.a)()(_e)))}}]);